{"version":3,"file":"static/js/481.5c0912c0.chunk.js","mappings":"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","sources":["Components/Artifact/ArtifactLevelSlider.tsx","Components/Conditional/ConditionalSelector.tsx","Components/Conditional/ConditionalDisplay.tsx","Components/DocumentDisplay.tsx","Components/TextButton.tsx","Data/Characters/dataUtil.tsx","Formula/reaction.ts","Components/StatInput.tsx","Components/ExpandButton.tsx","Components/EnemyEditor.tsx","Components/HitModeEditor.tsx","Formula/DisplayUtil.tsx","Components/Artifact/SetEffectDisplay.tsx","Context/OptimizationTargetContext.tsx","Components/Character/StatDisplayComponent.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/useBuildSetting.ts","Components/Artifact/ArtifactCardNano.tsx","Components/Weapon/WeaponCardNano.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildDisplayItem.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/CompareBuildButton.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/ArtifactSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/WeaponSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/BackgroundWorker.ts","Formula/optimize2.ts","Formula/addedUtils.ts","Formula/expandPoly.ts","Formula/solveLP_simplex.ts","Formula/linearUpperBound.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/common.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetConfig.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/AssumeFullLevelToggle.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BonusStatsCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildAlert.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/MainStatSelectionCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/OptimizationTargetSelector.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/DBState.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseEquipped.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseExcluded.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/foreground.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/subproblemUtil.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/StatFilterCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview.tsx","PageCharacter/CharacterDisplay/Tabs/TabTalent.tsx","PageCharacter/CharacterDisplay/Tabs/TabTeambuffs.tsx","Formula/differentiate.ts","Util/MathUtil.ts","PageCharacter/CharacterDisplay/Tabs/TabUpgradeOpt/artifactUpgradeCrawl.ts","PageCharacter/CharacterDisplay/Tabs/TabUpgradeOpt/mvncdf.ts","PageCharacter/CharacterDisplay/Tabs/TabUpgradeOpt/artifactQuery.ts","PageCharacter/CharacterDisplay/Tabs/TabUpgradeOpt/UpgradeOptChartCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabUpgradeOpt/index.tsx","PageCharacter/CharacterDisplay/index.tsx","PageWeapon/WeaponCard.tsx","ReactHooks/useBoolState.tsx","Util/TimeUtil.ts","Util/WeaponSort.ts","../wasmpack/assembly.js"],"sourcesContent":["import { Card, Slider } from \"@mui/material\"\nimport { useCallback, useEffect, useState } from \"react\"\nimport { clamp } from \"../../Util/Util\"\nimport CustomNumberInput from \"../CustomNumberInput\"\n\nexport default function ArtifactLevelSlider({ levelLow, levelHigh, setLow, setHigh, setBoth, dark = false, disabled = false, showLevelText = false }: {\n  levelLow: number,\n  levelHigh: number,\n  setLow: (low: number) => void,\n  setHigh: (high: number) => void,\n  setBoth: (low: number, high: number) => void,\n  dark?: boolean,\n  disabled?: boolean,\n  showLevelText?: boolean,\n}) {\n  const [sliderLow, setsliderLow] = useState(levelLow)\n  const [sliderHigh, setsliderHigh] = useState(levelHigh)\n  const setSlider = useCallback(\n    (e: unknown, value: number | number[]) => {\n      if (typeof value == \"number\") throw new TypeError()\n      const [l, h] = value\n      setsliderLow(l)\n      setsliderHigh(h)\n    },\n    [setsliderLow, setsliderHigh])\n  useEffect(() => setsliderLow(levelLow), [setsliderLow, levelLow])\n\n  useEffect(() => setsliderHigh(levelHigh), [setsliderHigh, levelHigh])\n  return <Card sx={{ width: \"100%\", display: \"flex\", alignItems: \"center\", bgcolor: dark ? \"contentDark.main\" : \"contentLight.main\" }}>\n    <CustomNumberInput\n      value={sliderLow}\n      onChange={val => setLow(clamp(val, 0, levelHigh))}\n      sx={{ px: 1, pl: showLevelText ? 2 : undefined, width: showLevelText ? 100 : 50, }}\n      inputProps={{ sx: { textAlign: \"center\" } }}\n      startAdornment={showLevelText ? \"Level: \" : undefined}\n      disabled={disabled}\n    />\n    <Slider sx={{ width: 100, flexGrow: 1, mx: 2 }}\n      getAriaLabel={() => 'Arifact Level Range'}\n      value={[sliderLow, sliderHigh]}\n      onChange={setSlider}\n      onChangeCommitted={(e, value) => setBoth(value[0], value[1])}\n      valueLabelDisplay=\"auto\"\n      min={0} max={20} step={1} marks\n      disabled={disabled}\n    />\n    <CustomNumberInput\n      value={sliderHigh}\n      onChange={val => setHigh(clamp(val, levelLow, 20))}\n      sx={{ px: 1, width: 50, }}\n      inputProps={{ sx: { textAlign: \"center\" } }}\n      disabled={disabled}\n    />\n  </Card>\n}\n","import { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\nimport { Button, ButtonGroup, Divider, MenuItem } from '@mui/material';\nimport React, { useCallback, useContext } from 'react';\nimport { CharacterContext } from '../../Context/CharacterContext';\nimport { DataContext } from '../../Context/DataContext';\nimport { DocumentConditional, IDocumentConditionalExclusive, IDocumentConditionalMultiple } from '../../Types/sheet';\nimport { deepClone, deletePropPath, layeredAssignment } from '../../Util/Util';\nimport DropdownButton from '../DropdownMenu/DropdownButton';\nimport SqBadge from '../SqBadge';\nimport { Translate } from '../Translate';\n\ninterface ConditionalSelectorProps {\n  conditional: DocumentConditional,\n  disabled?: boolean,\n}\nexport default function ConditionalSelector({ conditional, disabled = false, }: ConditionalSelectorProps) {\n  if (Object.keys(conditional.states).length === 1 && \"path\" in conditional) {\n    return <SimpleConditionalSelector conditional={conditional} disabled={disabled} />\n  } else if (\"path\" in conditional) {\n    return <ExclusiveConditionalSelector conditional={conditional} disabled={disabled} />\n  } else /*if (\"path\" in Object.entries(conditional.states)[0]) */ {\n    return <MultipleConditionalSelector conditional={conditional} disabled={disabled} />\n  }\n}\n\ninterface SimpleConditionalSelectorProps extends ConditionalSelectorProps {\n  conditional: IDocumentConditionalExclusive\n}\nfunction SimpleConditionalSelector({ conditional, disabled }: SimpleConditionalSelectorProps) {\n  const { character, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const setConditional = useCallback((v?: string) => {\n    const conditionalValues = deepClone(character.conditional)\n    if (v) {\n      layeredAssignment(conditionalValues, conditional.path, v)\n    } else {\n      deletePropPath(conditionalValues, conditional.path)\n    }\n    characterDispatch({ conditional: conditionalValues })\n  }, [conditional, character, characterDispatch])\n\n  const conditionalValue = data.get(conditional.value).value\n  const [stateKey, st] = Object.entries(conditional.states)[0]\n  const badge = getStateBadge(st.name)\n  const condName = getCondName(conditional.name)\n\n  return <Button fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} onClick={() => setConditional(conditionalValue ? undefined : stateKey)} disabled={disabled} startIcon={conditionalValue ? <CheckBox /> : <CheckBoxOutlineBlank />}>\n    {condName} {badge}\n  </Button>\n}\n\ninterface ExclusiveConditionalSelectorProps extends ConditionalSelectorProps {\n  conditional: IDocumentConditionalExclusive\n}\nfunction ExclusiveConditionalSelector({ conditional, disabled }: ExclusiveConditionalSelectorProps) {\n  const { character, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const setConditional = useCallback((v?: string) => {\n    const conditionalValues = deepClone(character.conditional)\n    if (v) {\n      layeredAssignment(conditionalValues, conditional.path, v)\n    } else {\n      deletePropPath(conditionalValues, conditional.path)\n    }\n    characterDispatch({ conditional: conditionalValues })\n  }, [conditional, character, characterDispatch])\n\n  const conditionalValue = data.get(conditional.value).value\n  const state = conditionalValue ? conditional.states[conditionalValue] : undefined\n  const badge = state ? getStateBadge(state.name) : <SqBadge color=\"secondary\">Not Active</SqBadge>\n  const condName = getCondName(conditional.name)\n\n  return <DropdownButton fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} title={<span>{condName} {badge}</span>} disabled={disabled}>\n    <MenuItem onClick={() => setConditional()} selected={!state} disabled={!state}>\n      <span>Not Active</span>\n    </MenuItem>\n    <Divider />\n    {Object.entries(conditional.states).map(([stateKey, st]) =>\n      <MenuItem key={stateKey} onClick={() => setConditional(stateKey)} selected={conditionalValue === stateKey} disabled={conditionalValue === stateKey} >{st.name}</MenuItem>)}\n  </DropdownButton>\n}\n\ninterface MultipleConditionalSelectorProps extends ConditionalSelectorProps {\n  conditional: IDocumentConditionalMultiple\n}\nfunction MultipleConditionalSelector({ conditional, disabled }: MultipleConditionalSelectorProps) {\n  const { character, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const setConditional = useCallback((path: readonly string[], v?: string) => {\n    const conditionalValues = deepClone(character.conditional)\n    if (v) {\n      layeredAssignment(conditionalValues, path, v)\n    } else {\n      deletePropPath(conditionalValues, path)\n    }\n    characterDispatch({ conditional: conditionalValues })\n  }, [character, characterDispatch])\n\n  return <ButtonGroup fullWidth orientation=\"vertical\" disableElevation color=\"secondary\" >\n    {Object.entries(conditional.states).map(([stateKey, st]) => {\n      const conditionalValue = data.get(st.value).value\n      const isSelected = conditionalValue === stateKey\n      return <Button\n        color={isSelected ? \"success\" : \"primary\"}\n        disabled={disabled}\n        fullWidth\n        key={stateKey}\n        onClick={() => setConditional(st.path, conditionalValue ? undefined : stateKey)}\n        size=\"small\"\n        startIcon={isSelected ? <CheckBox /> : <CheckBoxOutlineBlank />}\n        sx={{ borderRadius: 0 }}\n      >\n        {getCondName(st.name)}\n      </Button>\n    })}\n  </ButtonGroup>\n}\n\nfunction isElement(disp: Displayable): disp is JSX.Element {\n  return (typeof disp !== \"string\")\n}\n\n// Use colored badges instead of colored text inside these buttons\nfunction getStateBadge(stateName: Displayable | undefined): Displayable {\n  if (!stateName) return \"\"\n\n  let badgeColor = \"primary\"\n  let badgeText = stateName\n  if (stateName && isElement(stateName)) {\n    if (stateName.props.color) {\n      badgeColor = stateName.props.color\n      badgeText = <span>{stateName.props.children}</span>\n    }\n  }\n  return <SqBadge sx={{ ml: 0.5 }} color={badgeColor}>{badgeText}</SqBadge>\n}\n\n// Use colored badges instead of colored text inside these buttons\nfunction getCondName(condName: Displayable): Displayable {\n  if (isElement(condName)) {\n    const key = condName.props.key18\n    const ns = condName.props.ns\n    const values = condName.props.values\n    return <Translate ns={ns} key18={key} values={values} useBadge />\n  }\n  return condName\n}\n","import { CardContent } from \"@mui/material\"\nimport { useContext } from \"react\"\nimport { DataContext } from \"../../Context/DataContext\"\nimport { DocumentConditional, DocumentSection } from \"../../Types/sheet\"\nimport { evalIfFunc } from \"../../Util/Util\"\nimport CardDark from \"../Card/CardDark\"\nimport { HeaderDisplay } from \"../DocumentDisplay\"\nimport FieldsDisplay from \"../FieldDisplay\"\nimport ConditionalSelector from \"./ConditionalSelector\"\n\ntype ConditionalDisplayProps = {\n  conditional: DocumentConditional,\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\n  hideDesc?: boolean,\n}\n\nexport default function ConditionalDisplay({ conditional, hideHeader = false, hideDesc = false }: ConditionalDisplayProps) {\n  const { data } = useContext(DataContext)\n  let fields\n  if (\"path\" in conditional) {\n    const condVal = data.get(conditional.value).value\n    fields = condVal && conditional.states[condVal]?.fields\n  } else /* if (\"path\" in Object.entries(conditional.states)[0]) */ {\n    fields = Object.values(conditional.states).flatMap(state => {\n      const stateVal = data.get(state.value).value\n      return stateVal ? state.fields : []\n    })\n  }\n  return <CardDark>\n    {!evalIfFunc(hideHeader, conditional) && <HeaderDisplay header={conditional.header} hideDesc={hideDesc} />}\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\n      <ConditionalSelector conditional={conditional} />\n    </CardContent>\n    {fields && <FieldsDisplay fields={fields} />}\n  </CardDark>\n}\n","import { Box, CardHeader, Divider, Typography } from \"@mui/material\"\nimport { useContext } from \"react\"\nimport { DataContext } from \"../Context/DataContext\"\nimport { DocumentSection, IDocumentFields, IDocumentHeader, IDocumentText } from \"../Types/sheet\"\nimport { evalIfFunc } from \"../Util/Util\"\nimport CardDark from \"./Card/CardDark\"\nimport ConditionalDisplay from \"./Conditional/ConditionalDisplay\"\nimport FieldsDisplay from \"./FieldDisplay\"\nimport InfoTooltip from \"./InfoTooltip\"\n\ntype DocumentDisplayProps = {\n  sections: DocumentSection[],\n  teamBuffOnly?: boolean,\n  hideDesc?: boolean,\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\n}\n\nexport default function DocumentDisplay({ sections, teamBuffOnly, hideDesc = false, hideHeader = false }: DocumentDisplayProps) {\n  const { data } = useContext(DataContext)\n  if (!sections.length) return null\n  const sectionDisplays = sections.map((s, i) => {\n    // If we can't show this section, return null\n    if (s.canShow && !data.get(s.canShow).value ) return null\n    // If we are showing only teambuffs, and this section is not a teambuff, return null\n    if (teamBuffOnly && !s.teamBuff) return null\n    return <SectionDisplay section={s} key={i} hideDesc={hideDesc} hideHeader={hideHeader} />\n  }).filter(s => s)\n  if (!sectionDisplays.length) return null\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>{sectionDisplays}</Box>\n}\n\nfunction SectionDisplay({ section, hideDesc = false, hideHeader = false }: { section: DocumentSection, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\n  if (\"fields\" in section) {\n    return <FieldsSectionDisplay section={section} hideDesc={hideDesc} hideHeader={hideHeader} />\n  } else if (\"states\" in section) {\n    return <ConditionalDisplay conditional={section} hideDesc={hideDesc} hideHeader={hideHeader} />\n  } else /* if (\"text\" in section) */ {\n    return <TextSectionDisplay section={section} />\n  }\n}\n\nfunction FieldsSectionDisplay({ section, hideDesc, hideHeader }: { section: IDocumentFields, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\n  return <CardDark>\n    {!evalIfFunc(hideHeader, section) && section.header &&\n      <HeaderDisplay header={section.header} hideDesc={hideDesc} hideDivider={section.fields.length === 0} />\n    }\n    <FieldsDisplay fields={section.fields} />\n  </CardDark>\n}\n\nfunction TextSectionDisplay({ section }: { section: IDocumentText }) {\n  const { data } = useContext(DataContext)\n  return <div>\n    {evalIfFunc(section.text, data)}\n  </div>\n}\n\nexport function HeaderDisplay({ header, hideDesc, hideDivider }: { header: IDocumentHeader, hideDesc?: boolean, hideDivider?: boolean | ((section: DocumentSection) => boolean) }) {\n  const { data } = useContext(DataContext)\n  let { icon, title, action } = header\n  icon = evalIfFunc(icon, data)\n  const description = !hideDesc && evalIfFunc(header.description, data)\n  const displayTitle = hideDesc ? title : <span>{title} <InfoTooltip title={<Typography>{description}</Typography>} /></span>\n  return <>\n    <CardHeader avatar={icon} title={displayTitle} action={action} titleTypographyProps={{ variant: \"subtitle2\" }} />\n    {!hideDivider && <Divider />}\n  </>\n}\n","import { Button, ButtonProps, styled } from \"@mui/material\";\n\nconst DisabledButton = styled(Button)(({ theme }) => ({\n  \"&.Mui-disabled\": {\n    backgroundColor: theme.palette.primary.dark,\n    color: theme.palette.text.secondary,\n  }\n}))\n\nexport default function TextButton({ children, disabled, ...props }: ButtonProps) {\n  return <DisabledButton {...props} disabled  >\n    {children}\n  </DisabledButton>\n}\n","import { SubstatKey } from \"pipeline\";\nimport { input } from \"../../Formula\";\nimport { inferInfoMut, mergeData } from \"../../Formula/api\";\nimport { reactions } from \"../../Formula/reaction\";\nimport { Data, DisplaySub, NumNode } from \"../../Formula/type\";\nimport { constant, data, infoMut, lookup, percent, prod, stringPrio, subscript, sum, one } from \"../../Formula/utils\";\nimport { allMainStatKeys, MainStatKey } from \"../../Types/artifact\";\nimport { CharacterKey, ElementKey, Region } from \"../../Types/consts\";\nimport { layeredAssignment, objectKeyMap, objectMap } from \"../../Util/Util\";\nimport _charCurves from \"./expCurve_gen.json\";\n\n// TODO: Remove this conversion after changing the file format\nconst charCurves = objectMap(_charCurves, value => [0, ...Object.values(value)])\n\nconst commonBasic = objectKeyMap([\"hp\", \"atk\", \"def\", \"eleMas\", \"enerRech_\", \"critRate_\", \"critDMG_\", \"heal_\"], key => input.total[key])\n\nexport const infusionNode = stringPrio(\n  input.infusion.nonOverridableSelf,\n  input.infusion.team,\n  input.infusion.overridableSelf)\nconst inferredHitEle = stringPrio(\n  lookup(input.hit.move, {\n    \"skill\": input.charEle, \"burst\": input.charEle,\n  }, undefined),\n  lookup(input.weaponType, {\n    sword: infusionNode, claymore: infusionNode, polearm: infusionNode,\n    catalyst: input.charEle,\n  }, undefined),\n  \"physical\"\n)\n\nfunction getTalentType(move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\") {\n  switch (move) {\n    case \"normal\": case \"charged\": case \"plunging\": return \"auto\";\n    case \"skill\": return \"skill\";\n    case \"burst\": return \"burst\";\n  }\n}\n\n/** Note: `additional` applies only to this formula */\nexport function customDmgNode(base: NumNode, move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\" | \"elemental\", additional: Data = {}): NumNode {\n  return data(input.hit.dmg, mergeData([{\n    hit: { base, move: constant(move), ele: additional?.hit?.ele ? undefined : inferredHitEle },\n  }, additional]))\n}\n/** Note: `additional` applies only to this formula */\nexport function customShieldNode(base: NumNode, additional?: Data): NumNode {\n  const shieldNode = prod(base, sum(one, input.total.shield_))\n  return additional ? data(shieldNode, additional) : shieldNode\n}\n/** Note: `additional` applies only to this formula */\nexport function customHealNode(base: NumNode, additional?: Data): NumNode {\n  const healInc = input.total.healInc\n  const healNode = prod(sum(base, healInc), sum(one, input.total.heal_, input.total.incHeal_))\n\n  return additional ? data(healNode, additional) : healNode\n}\n/** Note: `additional` applies only to this formula */\nexport function dmgNode(base: MainStatKey | SubstatKey, lvlMultiplier: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional: Data = {}): NumNode {\n  const talentType = getTalentType(move)\n  return customDmgNode(prod(subscript(input.total[`${talentType}Index`], lvlMultiplier, { key: '_' }), input.total[base]), move, additional)\n}\n/** Note: `additional` applies only to this formula */\nexport function shieldNode(base: MainStatKey | SubstatKey, percent: NumNode | number, flat: NumNode | number, additional?: Data): NumNode {\n  return customShieldNode(sum(prod(percent, input.total[base]), flat), additional)\n}\n/** Note: `additional` applies only to this formula */\nexport function healNode(base: MainStatKey | SubstatKey, percent: NumNode | number, flat: NumNode | number, additional?: Data): NumNode {\n  return customHealNode(sum(prod(percent, input.total[base]), flat), additional)\n}\n/** Note: `additional` applies only to this formula */\nexport function shieldNodeTalent(base: MainStatKey | SubstatKey, baseMultiplier: number[], flat: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional?: Data): NumNode {\n  const talentType = getTalentType(move)\n  const talentIndex = input.total[`${talentType}Index`]\n  return customShieldNode(sum(\n    prod(subscript(talentIndex, baseMultiplier, { key: '_' }), input.total[base]),\n    subscript(talentIndex, flat)\n  ), additional)\n}\nexport function shieldElement(element: \"electro\" | \"cryo\" | \"hydro\" | \"pyro\" | \"geo\", shieldNode: NumNode) {\n  return infoMut(prod(percent(element === \"geo\" ? 1.5 : 2.5), shieldNode), { variant: element })\n}\n/** Note: `additional` applies only to this formula */\nexport function healNodeTalent(base: MainStatKey | SubstatKey, baseMultiplier: number[], flat: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional?: Data): NumNode {\n  const talentType = getTalentType(move)\n  const talentIndex = input.total[`${talentType}Index`]\n  return customHealNode(sum(\n    prod(subscript(talentIndex, baseMultiplier, { key: '_' }), input.total[base]),\n    subscript(talentIndex, flat)\n  ), additional)\n}\nexport function dataObjForCharacterSheet(\n  key: CharacterKey,\n  element: ElementKey | undefined,\n  region: Region | undefined,\n  gen: {\n    weaponTypeKey: string,\n    base: { hp: number, atk: number, def: number },\n    curves: { [key in string]?: string },\n    ascensions: { props: { [key in string]?: number } }[]\n  },\n  display: { [key: string]: DisplaySub },\n  additional: Data = {},\n): Data {\n  function curve(base: number, lvlCurve: string): NumNode {\n    return prod(base, subscript(input.lvl, charCurves[lvlCurve]))\n  }\n  display.basic = { ...commonBasic }\n  const data: Data = {\n    charKey: constant(key),\n    base: {},\n    weaponType: constant(gen.weaponTypeKey),\n    premod: {},\n    display,\n  }\n  if (element) {\n    data.charEle = constant(element)\n    data.teamBuff = { tally: { [element]: constant(1) } }\n    data.display!.basic[`${element}_dmg_`] = input.total[`${element}_dmg_`]\n    data.display!.reaction = reactions[element]\n  }\n  if (region)\n    layeredAssignment(data, [\"teamBuff\", \"tally\", region], constant(1))\n  if (gen.weaponTypeKey !== \"catalyst\") {\n    if (!data.display!.basic) data.display!.basic = {}\n    data.display!.basic!.physical_dmg_ = input.total.physical_dmg_\n  }\n\n  let foundSpecial: boolean | undefined\n  for (const stat of [...allMainStatKeys, \"def\" as const]) {\n    const list: NumNode[] = []\n    if (gen.curves[stat])\n      list.push(curve(gen.base[stat], gen.curves[stat]!))\n    const asc = gen.ascensions.some(x => x.props[stat])\n    if (asc)\n      list.push(subscript(input.asc, gen.ascensions.map(x => x.props[stat] ?? NaN)))\n\n    if (!list.length) continue\n\n    const result = infoMut(list.length === 1 ? list[0] : sum(...list), { key: stat, prefix: \"char\", asConst: true })\n    if (stat.endsWith(\"_dmg_\")) result.info!.variant = stat.slice(0, -5) as any\n    if (stat === \"atk\" || stat === \"def\" || stat === \"hp\")\n      data.base![stat] = result\n    else {\n      if (foundSpecial) throw new Error(\"Duplicated Char Special\")\n      foundSpecial = true\n      data.special = result\n      data.premod![stat] = input.special\n    }\n  }\n\n  return mergeData([data, inferInfoMut(additional)])\n}\n","import { transformativeReactions } from \"../KeyMap/StatConstants\";\nimport { absorbableEle } from \"../Types/consts\";\nimport { objectKeyMap } from \"../Util/Util\";\nimport { input } from \"./index\";\nimport { frac, infoMut, percent, prod, subscript, sum, one } from \"./utils\";\n\n// https://github.com/Dimbreath/GenshinData/blob/72c9112a7c5e8e5014f61009a1a2764e266aeab7/ExcelBinOutput/ElementCoeffExcelConfigData.json\n//   or if the permalink is dead,\n// https://github.com/Dimbreath/GenshinData/blob/master/ExcelBinOutput/ElementCoeffExcelConfigData.json\n//\n// PlayerElementLevelCo\nexport const transformativeReactionLevelMultipliers = [-1.0, // lvl 0\n  17.165606, 18.535048, 19.904854, 21.274902, 22.6454, 24.649612, 26.640642, 28.868587, 31.36768, 34.143345, 37.201, 40.66, 44.446667, 48.56352, 53.74848, 59.081898, 64.420044, 69.72446, 75.12314, 80.58478, 86.11203, 91.70374, 97.24463, 102.812645, 108.40956, 113.20169, 118.102905, 122.97932, 129.72733, 136.29291, 142.67085, 149.02902, 155.41699, 161.8255, 169.10631, 176.51808, 184.07274, 191.70952, 199.55692, 207.38205, 215.3989, 224.16566, 233.50217, 243.35057, 256.06308, 268.5435, 281.52606, 295.01364, 309.0672, 323.6016, 336.75754, 350.5303, 364.4827, 378.61917, 398.6004, 416.39825, 434.387, 452.95105, 472.60623, 492.8849, 513.56854, 539.1032, 565.51056, 592.53876, 624.4434, 651.47015, 679.4968, 707.79407, 736.67145, 765.64026, 794.7734, 824.67737, 851.1578, 877.74207, 914.2291, 946.74677, 979.4114, 1011.223, 1044.7917, 1077.4437, 1109.9976, 1142.9766, 1176.3695, 1210.1844, 1253.8357, 1288.9528, 1325.4841, 1363.4569, 1405.0974, 1446.8535]\n// PlayerShieldLevelCo\nexport const crystallizeLevelMultipliers = [-1.0, // lvl 0\n  91.1791, 98.707664, 106.23622, 113.76477, 121.29332, 128.82188, 136.35042, 143.87898, 151.40752, 158.93608, 169.99149, 181.07625, 192.19037, 204.0482, 215.939, 227.86275, 247.68594, 267.5421, 287.4312, 303.82642, 320.22522, 336.62762, 352.31927, 368.01093, 383.70255, 394.43237, 405.18146, 415.94992, 426.73764, 437.5447, 450.6, 463.7003, 476.84558, 491.1275, 502.55457, 514.0121, 531.4096, 549.9796, 568.5849, 584.9965, 605.67035, 626.3862, 646.0523, 665.7556, 685.4961, 700.8394, 723.3331, 745.8653, 768.4357, 786.79193, 809.5388, 832.32904, 855.16266, 878.0396, 899.4848, 919.362, 946.0396, 974.7642, 1003.5786, 1030.077, 1056.635, 1085.2463, 1113.9244, 1149.2587, 1178.0648, 1200.2238, 1227.6603, 1257.243, 1284.9174, 1314.7529, 1342.6652, 1372.7524, 1396.321, 1427.3124, 1458.3745, 1482.3358, 1511.9109, 1541.5493, 1569.1537, 1596.8143, 1622.4197, 1648.074, 1666.3761, 1684.6782, 1702.9803, 1726.1047, 1754.6715, 1785.8666, 1817.1375, 1851.0603]\n\n\nconst asConst = true as const\n\nconst crystallizeMulti1 = subscript(input.lvl, crystallizeLevelMultipliers)\nconst crystallizeElemas = prod(40 / 9, frac(input.total.eleMas, 1400))\nconst crystallizeHit = infoMut(prod(sum(one, /** + Crystallize bonus */ crystallizeElemas), crystallizeMulti1), { key: \"crystallize\", variant: \"geo\" })\n\nconst transMulti1 = subscript(input.lvl, transformativeReactionLevelMultipliers)\nconst transMulti2 = prod(16, frac(input.total.eleMas, 2000))\nconst trans = {\n  ...objectKeyMap([\"overloaded\", \"electrocharged\", \"superconduct\", \"shattered\"] as const, reaction => {\n    const { multi, variants: [ele] } = transformativeReactions[reaction]\n    return infoMut(prod(\n      infoMut(prod(multi, transMulti1), { asConst }),\n      sum(one, transMulti2, input.total[`${reaction}_dmg_`]),\n      input.enemy[`${ele}_resMulti`]),\n      { key: `${reaction}_hit`, variant: reaction })\n  }),\n  swirl: objectKeyMap(transformativeReactions.swirl.variants, ele => infoMut(\n    prod(\n      infoMut(prod(transformativeReactions.swirl.multi, transMulti1), { asConst }),\n      sum(one, transMulti2, input.total.swirl_dmg_),\n      input.enemy[`${ele}_resMulti`]),\n    { key: `${ele}_swirl_hit`, variant: ele }))\n}\nexport const reactions = {\n  anemo: {\n    electroSwirl: trans.swirl.electro,\n    pyroSwirl: trans.swirl.pyro,\n    cryoSwirl: trans.swirl.cryo,\n    hydroSwirl: trans.swirl.hydro,\n    shattered: trans.shattered,\n  },\n  geo: {\n    crystallize: crystallizeHit,\n    ...Object.fromEntries(absorbableEle.map(e => [`${e}Crystallize`,\n    infoMut(prod(percent(2.5), crystallizeHit), { key: `${e}_crystallize`, variant: e })])),\n    shattered: trans.shattered,\n  },\n  electro: {\n    overloaded: trans.overloaded,\n    electrocharged: trans.electrocharged,\n    superconduct: trans.superconduct,\n    shattered: trans.shattered,\n  },\n  hydro: {\n    electrocharged: trans.electrocharged,\n    shattered: trans.shattered,\n  },\n  pyro: {\n    overloaded: trans.overloaded,\n    shattered: trans.shattered,\n  },\n  cryo: {\n    superconduct: trans.superconduct,\n    shattered: trans.shattered,\n  },\n}\n","import { Replay } from \"@mui/icons-material\"\nimport { Button, ButtonGroup, ButtonGroupProps, styled } from \"@mui/material\"\nimport { ReactNode } from \"react\"\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"./CustomNumberInput\"\nimport TextButton from \"./TextButton\"\n\ntype StatInputInput = ButtonGroupProps & {\n  name: Displayable,\n  children?: ReactNode,\n  value: number,\n  placeholder?: string,\n  defaultValue?: number,\n  onValueChange: (newValue: number | undefined) => void,\n  percent?: boolean,\n  disabled?: boolean,\n  onReset?: () => void\n}\nconst FlexButtonGroup = styled(ButtonGroup)({\n  display: \"flex\"\n})\n\nexport default function StatInput({ name, children, value, placeholder, defaultValue = 0, onValueChange, percent = false, disabled = false, onReset, ...restProps }: StatInputInput) {\n\n  return <FlexButtonGroup {...restProps} >\n    {children}\n    <TextButton sx={{ whiteSpace: \"nowrap\" }} >\n      {name}\n    </TextButton>\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: 30, flexGrow: 1 }} >\n      <CustomNumberInput\n        sx={{ px: 1 }}\n        inputProps={{\n          sx: { textAlign: \"right\" }\n        }}\n        float={percent}\n        placeholder={placeholder}\n        value={value}\n        onChange={onValueChange}\n        disabled={disabled}\n        endAdornment={percent ? \"%\" : undefined}\n      />\n    </CustomNumberInputButtonGroupWrapper>\n    <Button color=\"error\" onClick={() => onReset ? onReset() : onValueChange(defaultValue)} disabled={disabled || value === defaultValue} >\n      <Replay />\n    </Button>\n  </FlexButtonGroup>\n}\n","import { IconButton, IconButtonProps, styled } from \"@mui/material\";\n\ninterface ExpandMoreProps extends IconButtonProps {\n  expand: boolean;\n}\nconst ExpandButton = styled((props: ExpandMoreProps) => {\n  const { expand, ...other } = props;\n  return <IconButton {...other} />;\n})(({ theme, expand }) => ({\n  transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',\n  marginLeft: 'auto',\n  transition: (theme as any).transitions.create('transform', {\n    duration: (theme as any).transitions.duration.shortest,\n  }),\n}));\n\nexport default ExpandButton","import { faCheckSquare, faSquare } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { ExpandMore } from \"@mui/icons-material\";\nimport { Button, CardContent, Chip, Collapse, Grid, Typography } from \"@mui/material\";\nimport { useCallback, useContext, useState } from 'react';\nimport StatInput from \"./StatInput\";\nimport { DataContext } from \"../Context/DataContext\";\nimport { uiInput as input } from \"../Formula\";\nimport KeyMap, { valueString } from '../KeyMap';\nimport { allElementsWithPhy, ElementKeyWithPhy } from \"../Types/consts\";\nimport CardLight from \"./Card/CardLight\";\nimport ColorText from \"./ColoredText\";\nimport ExpandButton from \"./ExpandButton\";\nimport { uncoloredEleIcons } from \"./StatIcon\";\nimport { CharacterContext } from \"../Context/CharacterContext\";\n\nexport function EnemyExpandCard() {\n  const { data } = useContext(DataContext)\n  const [expanded, setexpanded] = useState(false)\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\n  const eLvlNode = data.get(input.enemy.level)\n  const eDefRed = data.get(input.enemy.defRed)\n  const eDefIgn = data.get(input.enemy.defIgn)\n  return <CardLight>\n    <CardContent>\n      <Grid container>\n        <Grid item flexGrow={1} alignItems=\"center\">\n          <Grid container spacing={1}>\n            <Grid item>\n              <Chip size=\"small\" color=\"success\" label={<span>{KeyMap.get(eLvlNode.info.key)} <strong>{eLvlNode.value}</strong></span>} />\n            </Grid>\n            {allElementsWithPhy.map(element => <Grid item key={element}>\n              <Typography key={element} ><EnemyResText element={element} /></Typography>\n            </Grid>)}\n            <Grid item>\n              <Typography>DEF Reduction {valueString(eDefRed.value, eDefRed.unit)}</Typography>\n            </Grid>\n            <Grid item>\n              <Typography>DEF Ignore {valueString(eDefIgn.value, eDefIgn.unit)}</Typography>\n            </Grid>\n          </Grid>\n        </Grid>\n        <Grid item>\n          <ExpandButton\n            expand={expanded}\n            onClick={toggle}\n            aria-expanded={expanded}\n            aria-label=\"show more\"\n            size=\"small\"\n            sx={{ p: 0 }}\n          >\n            <ExpandMore />\n          </ExpandButton>\n        </Grid>\n      </Grid>\n    </CardContent>\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\n      <CardContent sx={{ pt: 0 }}>\n        <EnemyEditor />\n      </CardContent>\n    </Collapse>\n  </CardLight>\n}\n\nexport function EnemyResText({ element }: { element: ElementKeyWithPhy }) {\n  const { data } = useContext(DataContext)\n  const node = data.get(input.enemy[`${element}_res_`])\n  const immune = !isFinite(node.value)\n  const content = immune ? <span >{uncoloredEleIcons[element]} IMMUNE</span> :\n    <span >{uncoloredEleIcons[element]}RES <strong>{valueString(node.value, node.unit)}</strong></span>\n  return <ColorText color={element}>{content}</ColorText>\n}\n\nexport function EnemyEditor({ bsProps = { xs: 12, md: 6 } }: { bsProps?: object }) {\n  const { character: { enemyOverride }, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const defaultVal = 10\n\n  const eLvl = enemyOverride.enemyLevel ?? data.get(input.lvl).value\n  const eDefRed = enemyOverride.enemyDefIgn_ ?? 0\n  const eDefIgn = enemyOverride.enemyDefRed_ ?? 0\n  return <Grid container spacing={1}>\n    <Grid item {...bsProps}>\n      <Button fullWidth sx={{ height: \"100%\" }} size=\"small\" component=\"a\" color=\"warning\" href=\"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances\" target=\"_blank\" rel=\"noreferrer\">\n        To get the specific resistance values of enemies, please visit the wiki.\n      </Button>\n    </Grid>\n    <Grid item {...bsProps}>\n      <StatInput\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n        name={<b>{KeyMap.get(\"enemyLevel\")}</b>}\n        value={eLvl}\n        placeholder={KeyMap.getStr(\"enemyLevel\")}\n        defaultValue={data.get(input.lvl).value}\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value })}\n        onReset={() => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value: undefined })}\n      />\n    </Grid>\n    {allElementsWithPhy.map(eleKey => {\n      const statKey = `${eleKey}_enemyRes_`\n      const val = enemyOverride[statKey]\n      const elementImmunity = val === Number.MAX_VALUE\n      return <Grid item key={eleKey} {...bsProps}>\n        <StatInput\n          sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n          name={<ColorText color={eleKey}><b>{KeyMap.get(statKey)}</b></ColorText>}\n          value={val ? (elementImmunity ? Infinity : val) : 10}\n          placeholder={elementImmunity ? \"Immune \" : KeyMap.getStr(statKey)}\n          defaultValue={defaultVal}\n          onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey, value })}\n          disabled={elementImmunity}\n          percent\n        >\n          <Button color={eleKey} onClick={() => characterDispatch({ type: \"enemyOverride\", statKey, value: elementImmunity ? defaultVal : Number.MAX_VALUE })} >\n            <FontAwesomeIcon icon={elementImmunity ? faCheckSquare : faSquare} className=\"fa-fw\" /> Immunity\n          </Button>\n        </StatInput>\n      </Grid>\n    })}\n    <Grid item {...bsProps}>\n      <StatInput\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n        name={<b>{KeyMap.get(\"enemyDefIgn_\")}</b>}\n        value={eDefRed}\n        placeholder={KeyMap.getStr(\"enemyDefIgn_\")}\n        defaultValue={0}\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefIgn_\", value })}\n        percent\n      />\n    </Grid>\n    <Grid item {...bsProps}>\n      <StatInput\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n        name={<b>{KeyMap.get(\"enemyDefRed_\")}</b>}\n        value={eDefIgn}\n        placeholder={KeyMap.getStr(\"enemyDefRed_\")}\n        defaultValue={0}\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefRed_\", value })}\n        percent\n      />\n    </Grid>\n    <Grid item xs={12}>\n      <small>Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)</small>\n    </Grid>\n  </Grid>\n}\n","import { Box, MenuItem, ToggleButton, ToggleButtonGroupProps } from \"@mui/material\";\nimport { useContext } from 'react';\nimport { useTranslation } from \"react-i18next\";\nimport { CharacterContext } from \"../Context/CharacterContext\";\nimport { infusionNode } from \"../Data/Characters/dataUtil\";\nimport { DataContext } from \"../Context/DataContext\";\nimport { uiInput as input } from \"../Formula\";\nimport { allHitModes, allReactionModes, ElementKey } from \"../Types/consts\";\nimport ColorText from \"./ColoredText\";\nimport DropdownButton, { DropdownButtonProps } from \"./DropdownMenu/DropdownButton\";\nimport SolidToggleButtonGroup from \"./SolidToggleButtonGroup\";\nimport SqBadge from \"./SqBadge\";\nimport { uncoloredEleIcons } from \"./StatIcon\";\nexport const infusionVals = {\n  \"\": <span>No Team Melee Infusion</span>,\n  \"pyro\": <span >{uncoloredEleIcons.pyro} <SqBadge>Bennett C6</SqBadge> Fire Ventures with Me</span>,\n  \"cryo\": <span >{uncoloredEleIcons.cryo} <SqBadge>Chongyun Skill</SqBadge> Spirit Blade: Chonghua's Layered Frost</span>,\n}\ntype InfusionAuraDropdownProps = Omit<DropdownButtonProps, \"title\" | \"onChange\" | \"children\">\nexport function InfusionAuraDropdown(props: InfusionAuraDropdownProps) {\n  const { characterSheet, character: { infusionAura }, characterDispatch } = useContext(CharacterContext)\n  if (!characterSheet?.isMelee()) return null\n  return <DropdownButton title={infusionVals[infusionAura]} color={infusionAura || \"secondary\"} disableElevation {...props}>\n    {Object.entries(infusionVals).map(([key, text]) =>\n      <MenuItem key={key} sx={key ? { color: `${key}.main` } : undefined}\n        selected={key === infusionAura} disabled={key === infusionAura}\n        onClick={() => characterDispatch({ infusionAura: key })}>{text}</MenuItem>)}\n  </DropdownButton>\n}\n\nconst sqBadgeStyle = { mx: 0.25, px: 0.25, fontSize: \"1em\" }\nexport const reactionModeText = {\n  pyro_vaporize: (t) => <Box display=\"flex\" alignItems=\"center\">\n    <ColorText color=\"vaporize\">{t`ampReaction.pyro_vaporize`}</ColorText>\n    <SqBadge sx={sqBadgeStyle} color=\"hydro\">{uncoloredEleIcons.hydro}</SqBadge>\n    {`+`}\n    <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\n  </Box>,\n  pyro_melt: (t) => <Box display=\"flex\" alignItems=\"center\">\n    <ColorText color=\"melt\">{t`ampReaction.pyro_melt`}</ColorText>\n    <SqBadge sx={sqBadgeStyle} color=\"cryo\">{uncoloredEleIcons.cryo}</SqBadge>\n    {`+`}\n    <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\n  </Box>,\n  hydro_vaporize: (t) => <Box display=\"flex\" alignItems=\"center\">\n    <ColorText color=\"vaporize\">{t`ampReaction.hydro_vaporize`}</ColorText>\n    <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\n    {`+`}\n    <SqBadge sx={sqBadgeStyle} color=\"hydro\">{uncoloredEleIcons.hydro}</SqBadge>\n  </Box>,\n  cryo_melt: (t) => <Box display=\"flex\" alignItems=\"center\">\n    <ColorText color=\"melt\">{t`ampReaction.cryo_melt`}</ColorText>\n    <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\n    {`+`}\n    <SqBadge sx={sqBadgeStyle} color=\"cryo\">{uncoloredEleIcons.cryo}</SqBadge>\n  </Box>\n\n} as const\n\ntype ReactionToggleProps = Omit<ToggleButtonGroupProps, \"color\">\nexport function ReactionToggle(props: ReactionToggleProps) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { reactionMode }, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const charEleKey = data.get(input.charEle).value as ElementKey\n  const infusion = data.get(infusionNode).value as ElementKey\n  if (![\"pyro\", \"hydro\", \"cryo\"].includes(charEleKey) && ![\"pyro\", \"hydro\", \"cryo\"].includes(infusion)) return null\n  return <SolidToggleButtonGroup exclusive baseColor=\"secondary\"\n    value={reactionMode} onChange={(_, reactionMode) => characterDispatch({ reactionMode })} {...props}>\n    <ToggleButton value=\"\" disabled={reactionMode === \"\"} >No Reactions</ToggleButton >\n    {allReactionModes.map(rm => (charEleKey === rm.split(\"_\")[0] || infusion === rm.split(\"_\")[0]) && <ToggleButton key={rm} value={rm} disabled={reactionMode === rm}>\n      {reactionModeText[rm](t)}\n    </ToggleButton >)}\n  </SolidToggleButtonGroup>\n}\ntype HitModeToggleProps = Omit<ToggleButtonGroupProps, \"color\">\nexport function HitModeToggle(props: HitModeToggleProps) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { hitMode }, characterDispatch } = useContext(CharacterContext)\n  return <SolidToggleButtonGroup exclusive baseColor=\"secondary\"\n    value={hitMode} onChange={(_, hitMode) => characterDispatch({ hitMode })} {...props} >\n    {allHitModes.map(hm => <ToggleButton key={hm} value={hm} disabled={hitMode === hm}>{t(`hitmode.${hm}`)}</ToggleButton>)}\n  </SolidToggleButtonGroup>\n}\n","import { Typography } from \"@mui/material\";\nimport { input } from \".\";\nimport { ArtifactSheet } from \"../Data/Artifacts/ArtifactSheet\";\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\";\nimport ColorText from \"../Components/ColoredText\";\nimport SqBadge from \"../Components/SqBadge\";\nimport { ArtifactSetKey, CharacterKey, ElementKey, WeaponKey } from \"../Types/consts\";\nimport { range } from \"../Util/Util\";\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\nimport { DisplaySub } from \"./type\";\nimport { NodeDisplay, UIData } from \"./uiData\";\n\nconst errHeader = {\n  title: <ColorText color=\"warning\">ERROR</ColorText>\n}\n\nconst talentMap = {\n  normal: \"Normal Atk.\",\n  charged: \"Charged Atk.\",\n  plunging: \"Plunging Atk.\",\n  skill: \"Ele. Skill\",\n  burst: \"Ele. Burst\",\n  passive: \"Passive\",\n  passive1: \"1st Asc. Pass.\",\n  passive2: \"4th Asc. Pass.\",\n  passive3: \"Util. Pass.\",\n  ...Object.fromEntries(range(1, 6).map(i => [`constellation${i}`, `Const. ${i}`]))\n}\nexport async function getDisplayHeader(data: UIData, sectionKey: string): Promise<{\n  title: Displayable,\n  icon?: string,\n  action?: Displayable\n}> {\n  if (!sectionKey) return errHeader\n  if (sectionKey === \"basic\") return { title: \"Basic Stats\" }\n  else if (sectionKey === \"reaction\") return { title: \"Transformative Reactions\" }\n  else if (sectionKey.includes(\":\")) {\n    const [namespace, key] = sectionKey.split(\":\")\n    if (namespace === \"artifact\") {\n      const sheet = await ArtifactSheet.get(key as ArtifactSetKey)\n      if (!sheet) return errHeader\n      return {\n        title: sheet.name,\n        icon: sheet.defIconSrc\n      }\n    } else if (namespace === \"weapon\") {\n      const sheet = await WeaponSheet.get(key as WeaponKey)\n      if (!sheet) return errHeader\n      const asc = data.get(input.weapon.asc).value\n      return {\n        title: sheet.name,\n        icon: sheet.getImg(asc)\n      }\n    }\n  } else {\n    const cKey = data.get(input.charKey).value\n    const cEle = data.get(input.charEle).value\n    if (!cKey || !cEle) return errHeader\n    const sheet = await CharacterSheet.get(cKey as CharacterKey)\n    const talentKey = [\"normal\", \"charged\", \"plunging\"].includes(sectionKey) ? \"auto\" : sectionKey\n    const talent = sheet?.getTalentOfKey(talentKey as any, cEle as ElementKey)\n    if (!talent) return errHeader\n    const actionText = talentMap[sectionKey]\n    return {\n      icon: talent.img,\n      title: talent.name,\n      action: actionText ? <SqBadge ><Typography variant=\"subtitle2\">{actionText}</Typography></SqBadge> : undefined\n    }\n  }\n  return errHeader\n}\n/**\n * Use this function to reorganize the sections to have basic stats at the beginning, and reation at the end.\n * @param data\n * @returns\n */\nexport function getDisplaySections(data: UIData,): [string, DisplaySub<NodeDisplay>][] {\n  const display = data.getDisplay()\n  const sections = Object.entries(display).filter(([key, nodes]) => !Object.values(nodes).every(x => x.isEmpty))\n  const basic = sections.filter(([k]) => k === \"basic\")\n  const reaction = sections.filter(([k]) => k === \"reaction\")\n  const weapon = sections.filter(([k]) => k.startsWith(\"weapon\"))\n  const artifact = sections.filter(([k]) => k.startsWith(\"artifact\"))\n  const rest = sections.filter(([k]) => k !== \"basic\" && k !== \"reaction\" && !k.startsWith(\"weapon\") && !k.startsWith(\"artifact\"))\n\n  return [\n    ...basic,\n    ...rest,\n    ...weapon,\n    ...artifact,\n    ...reaction\n  ]\n}\n","import { Box } from \"@mui/material\"\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\"\nimport usePromise from \"../../ReactHooks/usePromise\"\nimport { ArtifactSetKey, SetNum } from \"../../Types/consts\"\nimport DocumentDisplay from \"../DocumentDisplay\"\n\ntype Data = {\n  setKey: ArtifactSetKey,\n  setNumKey: SetNum,\n  hideHeader?: boolean,\n  conditionalsOnly?: boolean\n}\n\nexport default function SetEffectDisplay({ setKey, setNumKey, hideHeader = false, conditionalsOnly = false }: Data) {\n  const sheet = usePromise(() => ArtifactSheet.get(setKey), [setKey])\n  if (!sheet) return null\n\n  const document = conditionalsOnly ? sheet.setEffectDocument(setNumKey)?.filter(section => \"states\" in section) : sheet.setEffectDocument(setNumKey)\n  return <Box display=\"flex\" flexDirection=\"column\">\n    {document ? <DocumentDisplay sections={document} hideHeader={hideHeader} /> : null}\n  </Box>\n}\n","import { createContext } from \"react\";\n\nexport const OptimizationTargetContext = createContext(undefined as string[] | undefined)\n","import { Masonry } from \"@mui/lab\"\nimport { CardContent, CardHeader, Divider, ListItem } from \"@mui/material\"\nimport { Box } from \"@mui/system\"\nimport { useContext, useMemo } from \"react\"\nimport CardDark from \"../Card/CardDark\"\nimport { FieldDisplayList, NodeFieldDisplay } from \"../FieldDisplay\"\nimport ImgIcon from \"../Image/ImgIcon\"\nimport { DataContext } from \"../../Context/DataContext\"\nimport { getDisplayHeader, getDisplaySections } from \"../../Formula/DisplayUtil\"\nimport { DisplaySub } from \"../../Formula/type\"\nimport { NodeDisplay } from \"../../Formula/uiData\"\nimport { customRead } from \"../../Formula/utils\"\nimport usePromise from \"../../ReactHooks/usePromise\"\nimport { objectMap } from \"../../Util/Util\"\nimport { OptimizationTargetContext } from \"../../Context/OptimizationTargetContext\"\n\nexport default function StatDisplayComponent() {\n  const { data } = useContext(DataContext)\n  const sections = getDisplaySections(data)\n  return <Box sx={{ mr: -1, mb: -1 }}>\n    <Masonry columns={{ xs: 1, sm: 2, md: 3, xl: 4 }} spacing={1}>\n      {sections.map(([key, Nodes]) =>\n        <Section key={key} displayNs={Nodes} sectionKey={key} />)}\n    </Masonry >\n  </Box>\n}\n\nfunction Section({ displayNs, sectionKey }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\n  const optimizationTarget = useContext(OptimizationTargetContext)\n  const { data, oldData } = useContext(DataContext)\n  const header = usePromise(() => getDisplayHeader(data, sectionKey), [data, sectionKey])\n  const displayNsReads = useMemo(() => objectMap(displayNs, (n, nodeKey) => customRead([\"display\", sectionKey, nodeKey])), [displayNs, sectionKey]);\n  if (!header) return <CardDark></CardDark>\n\n  const { title, icon, action } = header\n  return <CardDark >\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\n    <Divider />\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\n      <FieldDisplayList sx={{ m: 0 }}>\n        {Object.entries(displayNs).map(([nodeKey, n]) =>\n          <NodeFieldDisplay key={nodeKey} node={n} oldValue={oldData ? oldData.get(displayNsReads[nodeKey]!).value : undefined} component={ListItem}\n            emphasize={JSON.stringify(optimizationTarget) === JSON.stringify([sectionKey, nodeKey])}\n          />)}\n      </FieldDisplayList>\n    </CardContent>\n  </CardDark>\n}\n","import { useCallback, useContext, useEffect, useState } from \"react\";\nimport { DatabaseContext } from \"../../../../Database/Database\";\nimport { BuildSetting, BuildSettingReducerAction } from \"../../../../Database/Data/BuildsettingData\";\nimport { CharacterKey } from \"../../../../Types/consts\";\n\nexport default function useBuildSetting(characterKey: CharacterKey) {\n  const { database } = useContext(DatabaseContext)\n  const [buildSetting, setBuildSetting] = useState(() => database.buildSettings.get(characterKey))\n  useEffect(() => setBuildSetting(database.buildSettings.get(characterKey)), [database, characterKey])\n  useEffect(() =>\n    database.buildSettings.follow(characterKey, setBuildSetting),\n    [characterKey, setBuildSetting, database])\n  const buildSettingDispatch = useCallback((action: BuildSettingReducerAction) => characterKey && database.buildSettings.set(characterKey, action), [characterKey, database],)\n\n  return { buildSetting: buildSetting as BuildSetting, buildSettingDispatch }\n}\n","import { BusinessCenter } from \"@mui/icons-material\";\nimport { alpha, Box, CardActionArea, Chip, Typography, useTheme } from \"@mui/material\";\nimport { useCallback } from \"react\";\nimport Assets from \"../../Assets/Assets\";\nimport Artifact from \"../../Data/Artifacts/Artifact\";\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport KeyMap, { cacheValueString } from \"../../KeyMap\";\nimport useArtifact from \"../../ReactHooks/useArtifact\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport { ICachedSubstat } from \"../../Types/artifact\";\nimport { allElementsWithPhy, CharacterKey, SlotKey } from \"../../Types/consts\";\nimport { clamp } from \"../../Util/Util\";\nimport BootstrapTooltip from \"../BootstrapTooltip\";\nimport CardDark from \"../Card/CardDark\";\nimport ColorText from \"../ColoredText\";\nimport ConditionalWrapper from \"../ConditionalWrapper\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport StatIcon, { uncoloredEleIcons } from \"../StatIcon\";\nimport ArtifactSetSlotTooltip from \"./ArtifactSetSlotTooltip\";\n\ntype Data = {\n  artifactId?: string,\n  slotKey: SlotKey,\n  mainStatAssumptionLevel?: number,\n  onClick?: () => void,\n  showLocation?: boolean,\n  BGComponent?: React.ElementType\n}\n\nexport default function ArtifactCardNano({ artifactId, slotKey: pSlotKey, mainStatAssumptionLevel = 0, showLocation = false, onClick, BGComponent = CardDark }: Data) {\n  const art = useArtifact(artifactId)\n  const sheet = usePromise(() => ArtifactSheet.get(art?.setKey), [art?.setKey])\n  const actionWrapperFunc = useCallback(children => <CardActionArea onClick={onClick} sx={{ height: \"100%\" }}>{children}</CardActionArea>, [onClick],)\n  const theme = useTheme()\n  if (!art) return <BGComponent sx={{ display: \"flex\", height: \"100%\", alignItems: \"center\", justifyContent: \"center\" }}>\n    <Box component=\"img\" src={Assets.slot[pSlotKey]} sx={{ width: \"25%\", height: \"auto\", opacity: 0.7 }} />\n  </BGComponent>\n\n  const { slotKey, rarity, level, mainStatKey, substats, location } = art\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\n  const mainStatUnit = KeyMap.unit(mainStatKey)\n  const levelVariant = \"roll\" + (Math.floor(Math.max(level, 0) / 4) + 1)\n  const element = allElementsWithPhy.find(ele => art.mainStatKey.includes(ele))\n  const color = element ? alpha(theme.palette[element].main, 0.6) : alpha(theme.palette.secondary.main, 0.6)\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\n    <Box display=\"flex\" height=\"100%\">\n      <Box className={`grad-${rarity}star`} sx={{ position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"center\" }} >\n        <ArtifactSetSlotTooltip slotKey={slotKey} sheet={sheet}>\n          <Box\n            component=\"img\"\n            src={sheet?.slotIcons[slotKey] ?? \"\"}\n            sx={{ m: -1, maxHeight: \"110%\", maxWidth: \"110%\" }}\n          />\n        </ArtifactSetSlotTooltip>\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={levelVariant as any} />\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\n            overflow: \"visible\", \".MuiChip-label\": {\n              overflow: \"visible\"\n            }\n          }} />}\n        </Box>\n        {/* mainstats */}\n        <Chip size=\"small\" sx={{ position: \"absolute\", bottom: 0, mb: 1, backgroundColor: color }}\n          label={<Typography variant=\"h6\" sx={{ display: \"flex\", gap: 1, px: 1, zIndex: 1 }}>\n            <BootstrapTooltip placement=\"top\" title={<Typography>{KeyMap.getArtStr(mainStatKey)}</Typography>} disableInteractive>\n              <span>{element ? uncoloredEleIcons[element] : StatIcon[mainStatKey]}</span>\n            </BootstrapTooltip>\n            <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{cacheValueString(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}{mainStatUnit}</ColorText>\n          </Typography>} />\n      </Box>\n      {/* substats */}\n      <Box display=\"flex\" flexDirection=\"column\" justifyContent=\"space-between\" sx={{ p: 1, }}>\n        {substats.map((stat: ICachedSubstat, i: number) => <SubstatDisplay key={i + stat.key} stat={stat} />)}\n      </Box>\n    </Box>\n  </ConditionalWrapper></BGComponent >\n}\nfunction SubstatDisplay({ stat }: { stat: ICachedSubstat }) {\n  if (!stat.value) return null\n  const numRolls = stat.rolls?.length ?? 0\n  const rollColor = `roll${clamp(numRolls, 1, 6)}`\n  const unit = KeyMap.unit(stat.key)\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">\n      <BootstrapTooltip placement=\"top\" title={<Typography>{stat.key && KeyMap.getArtStr(stat.key)}</Typography>} disableInteractive>\n        <span>{StatIcon[stat.key]}</span>\n      </BootstrapTooltip>\n      <span>{`${cacheValueString(stat.value, KeyMap.unit(stat.key))}${unit}`}</span>\n    </Typography>\n  </Box>)\n}\nfunction LocationIcon({ location }: { location: CharacterKey | \"\" }) {\n  const characterSheet = usePromise(() => CharacterSheet.get(location ?? \"\"), [location])\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\n}\n","import { BusinessCenter } from \"@mui/icons-material\";\nimport { Box, CardActionArea, Chip, Skeleton, Typography } from \"@mui/material\";\nimport { useCallback, useMemo } from \"react\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\";\nimport { input } from \"../../Formula\";\nimport { computeUIData, dataObjForWeapon } from \"../../Formula/api\";\nimport { NodeDisplay } from '../../Formula/uiData';\nimport KeyMap, { valueString } from \"../../KeyMap\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport useWeapon from \"../../ReactHooks/useWeapon\";\nimport { MainStatKey, SubstatKey } from \"../../Types/artifact\";\nimport BootstrapTooltip from \"../BootstrapTooltip\";\nimport CardDark from \"../Card/CardDark\";\nimport ConditionalWrapper from \"../ConditionalWrapper\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport StatIcon from \"../StatIcon\";\nimport WeaponNameTooltip from \"./WeaponNameTooltip\";\n\ntype Data = {\n  weaponId?: string,\n  onClick?: () => void,\n  showLocation?: boolean,\n  BGComponent?: React.ElementType,\n}\n\nexport default function WeaponCardNano({ weaponId, showLocation = false, onClick, BGComponent = CardDark, }: Data) {\n  const weapon = useWeapon(weaponId)\n  const weaponSheet = usePromise(() => weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\n  const actionWrapperFunc = useCallback(children => <CardActionArea sx={{ height: \"100%\" }} onClick={onClick}>{children}</CardActionArea>, [onClick],)\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n  if (!weapon || !weaponSheet || !UIData) return <BGComponent sx={{ height: \"100%\" }}><Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\" }} /></BGComponent>;\n  const { refinement, location } = weapon\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\n    <Box display=\"flex\" height=\"100%\" alignItems=\"stretch\" >\n      <Box className={`grad-${weaponSheet.rarity}star`} sx={{ height: \"100%\", position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"flex-end\" }} >\n        <WeaponNameTooltip sheet={weaponSheet}>\n          <Box\n            component=\"img\"\n            src={weaponSheet.getImg(weapon.ascension)}\n            sx={{ mx: -1, maxHeight: \"100%\", maxWidth: \"100%\" }}\n          />\n        </WeaponNameTooltip>\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\n          <Chip size=\"small\" label={<strong>{WeaponSheet.getLevelString(weapon)}</strong>} color=\"primary\" />\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\n            overflow: \"visible\", \".MuiChip-label\": {\n              overflow: \"visible\"\n            }\n          }} />}\n        </Box>\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"flex-end\", alignItems: \"flex-end\" }} >\n          {weaponSheet.hasRefinement && <Chip size=\"small\" color=\"info\" label={<strong>R{refinement}</strong>} />}\n        </Box>\n      </Box>\n      <Box display=\"flex\" flexDirection=\"column\" sx={{ p: 1, }}>\n        <WeaponStat node={UIData.get(input.weapon.main)} />\n        <WeaponStat node={UIData.get(input.weapon.sub)} />\n      </Box>\n    </Box>\n  </ConditionalWrapper></BGComponent >\n}\nfunction WeaponStat({ node }: { node: NodeDisplay }) {\n  if (!node.info.key) return null\n  const val = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} component=\"span\">\n      <BootstrapTooltip placement=\"top\" title={<Typography>{node.info.key && KeyMap.getArtStr(node.info.key as MainStatKey | SubstatKey)}</Typography>} disableInteractive>\n        <span>{StatIcon[node.info.key]}</span>\n      </BootstrapTooltip>\n      <span>{val}</span>\n    </Typography>\n  </Box>)\n}\nfunction LocationIcon({ location }) {\n  const characterSheet = usePromise(() => CharacterSheet.get(location ?? \"\"), [location])\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\n}\n","import { ChevronRight } from '@mui/icons-material';\nimport { Button, CardContent, Grid, Skeleton, Typography } from '@mui/material';\nimport { Box } from '@mui/system';\nimport React, { Suspense, useCallback, useContext, useMemo, useState } from 'react';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport ArtifactCardNano from '../../../../../Components/Artifact/ArtifactCardNano';\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\nimport CardDark from '../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport StatDisplayComponent from '../../../../../Components/Character/StatDisplayComponent';\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\nimport SqBadge from '../../../../../Components/SqBadge';\nimport WeaponCardNano from '../../../../../Components/Weapon/WeaponCardNano';\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\nimport { DatabaseContext } from '../../../../../Database/Database';\nimport { DataContext } from '../../../../../Context/DataContext';\nimport { uiInput as input } from '../../../../../Formula';\nimport ArtifactCard from '../../../../../PageArtifact/ArtifactCard';\nimport usePromise from '../../../../../ReactHooks/usePromise';\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from '../../../../../Types/consts';\nimport useBuildSetting from '../useBuildSetting';\n\ntype NewOld = {\n  newId: string,\n  oldId?: string\n}\n\ntype BuildDisplayItemProps = {\n  index?: number,\n  compareBuild: boolean,\n  disabled?: boolean,\n  extraButtons?: JSX.Element\n}\n//for displaying each artifact build\nexport default function BuildDisplayItem({ index, compareBuild, extraButtons, disabled }: BuildDisplayItemProps) {\n  const { character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const { database } = useContext(DatabaseContext)\n  const dataContext = useContext(DataContext)\n\n  const { data, oldData } = dataContext\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const [newOld, setNewOld] = useState(undefined as NewOld | undefined)\n  const close = useCallback(() => setNewOld(undefined), [setNewOld],)\n\n  const equipBuild = useCallback(() => {\n    if (!window.confirm(\"Do you want to equip this build to this character?\")) return\n    const newBuild = Object.fromEntries(allSlotKeys.map(s => [s, data.get(input.art[s].id).value])) as Record<SlotKey, string>\n    database.chars.equipArtifacts(characterKey, newBuild)\n    database.weapons.set(data.get(input.weapon.id).value!, { location: characterKey })\n  }, [characterKey, data, database])\n\n  const statProviderContext = useMemo(() => {\n    const dataContext_ = { ...dataContext }\n    if (!compareBuild) dataContext_.oldData = undefined\n    return dataContext_\n  }, [dataContext, compareBuild])\n\n  // Memoize Arts because of its dynamic onClick\n  const artNanos = useMemo(() => allSlotKeys.map(slotKey =>\n    <Grid item xs={1} key={slotKey} >\n      <ArtifactCardNano showLocation slotKey={slotKey} artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} onClick={() => {\n        const oldId = equippedArtifacts[slotKey]\n        const newId = data.get(input.art[slotKey].id).value!\n        setNewOld({ oldId: oldId !== newId ? oldId : undefined, newId })\n      }} />\n    </Grid>), [data, setNewOld, equippedArtifacts, mainStatAssumptionLevel])\n\n  if (!artifactSheets || !oldData) return null\n  const currentlyEquipped = allSlotKeys.every(slotKey => data.get(input.art[slotKey].id).value === oldData.get(input.art[slotKey].id).value) && data.get(input.weapon.id).value === oldData.get(input.weapon.id).value\n\n  const setToSlots: Partial<Record<ArtifactSetKey, SlotKey[]>> = {}\n  allSlotKeys.forEach(slotKey => {\n    const set = data.get(input.art[slotKey].set).value as ArtifactSetKey | undefined\n    if (!set) return\n    if (setToSlots[set]) setToSlots[set]!.push(slotKey)\n    else setToSlots[set] = [slotKey]\n  })\n\n  return <CardLight>\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\n      {newOld && <CompareArtifactModal newOld={newOld} mainStatAssumptionLevel={mainStatAssumptionLevel} onClose={close} />}\n      <CardContent>\n        <Box display=\"flex\" gap={1} sx={{ pb: 1 }} flexWrap=\"wrap\">\n          {index !== undefined && <SqBadge color=\"info\"><Typography><strong>#{index + 1}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></Typography></SqBadge>}\n          {(Object.entries(setToSlots) as [ArtifactSetKey, SlotKey[]][]).sort(([k1, slotarr1], [k2, slotarr2]) => slotarr2.length - slotarr1.length).map(([key, slotarr]) =>\n            <Box key={key}><SqBadge color={currentlyEquipped ? \"success\" : \"primary\"} ><Typography >\n              {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheets?.[key].name ?? \"\"}\n            </Typography></SqBadge></Box>\n          )}\n          <Box sx={{ flexGrow: 1, display: \"flex\", justifyContent: \"flex-end\" }}>\n          </Box>\n          <Button size='small' color=\"success\" onClick={equipBuild} disabled={disabled || currentlyEquipped}>Equip Build</Button>\n          {extraButtons}\n        </Box>\n        <Grid container spacing={1} sx={{ pb: 1 }} columns={{ xs: 2, sm: 3, md: 4, lg: 6 }}>\n          <Grid item xs={1}>\n            <WeaponCardNano showLocation weaponId={data.get(input.weapon.id).value} />\n          </Grid>\n          {artNanos}\n        </Grid>\n        <DataContext.Provider value={statProviderContext}>\n          <StatDisplayComponent />\n        </DataContext.Provider>\n      </CardContent>\n    </Suspense>\n  </CardLight>\n}\n\nfunction CompareArtifactModal({ newOld: { newId, oldId }, mainStatAssumptionLevel, onClose }: { newOld: NewOld, mainStatAssumptionLevel: number, onClose: () => void }) {\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const onEquip = useCallback(() => {\n    if (!window.confirm(\"Do you want to equip this artifact to this character?\")) return\n    database.arts.set(newId, { location: characterKey })\n    onClose()\n  }, [newId, database, characterKey, onClose])\n\n  return <ModalWrapper open={!!newId} onClose={onClose} containerProps={{ maxWidth: oldId ? \"md\" : \"xs\" }}>\n    <CardDark>\n      <CardContent sx={{ display: \"flex\", justifyContent: \"center\", alignItems: \"stretch\", gap: 2, height: \"100%\" }}>\n        {oldId && <Box minWidth={320}><ArtifactCard artifactId={oldId} mainStatAssumptionLevel={mainStatAssumptionLevel} canExclude canEquip /></Box>}\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\n        {oldId && <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"><Button onClick={onEquip} sx={{ display: \"flex\" }}><ChevronRight sx={{ fontSize: 40 }} /></Button></Box>}\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\n        <Box minWidth={320}><ArtifactCard artifactId={newId} mainStatAssumptionLevel={mainStatAssumptionLevel} canExclude canEquip /></Box>\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { Close, Difference } from \"@mui/icons-material\"\nimport { Button, Skeleton, Tooltip, Typography } from \"@mui/material\"\nimport { Suspense, useContext, useMemo } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport { CharacterContext } from \"../../../../Context/CharacterContext\"\nimport { HitModeToggle, ReactionToggle } from \"../../../../Components/HitModeEditor\"\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport { DataContext } from \"../../../../Context/DataContext\"\nimport useBoolState from \"../../../../ReactHooks/useBoolState\"\nimport useTeamData from \"../../../../ReactHooks/useTeamData\"\nimport { objectMap } from \"../../../../Util/Util\"\nimport useBuildSetting from \"../TabOptimize/useBuildSetting\"\nimport BuildDisplayItem from \"../TabOptimize/Components/BuildDisplayItem\"\n\nexport default function CompareBuildButton({ artId, weaponId }: { artId?: string, weaponId?: string }) {\n  const { t } = useTranslation(\"page_character\")\n  const [show, onShow, onHide] = useBoolState(false)\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const { data: oldData } = useContext(DataContext)\n  const build = useMemo(() => {\n    const newArt = database.arts.get(artId ?? \"\")\n    const artmap = objectMap(equippedArtifacts, (id, slot) => slot === newArt?.slotKey ? newArt : database.arts.get(id))\n    return Object.values(artmap)\n  }, [database, equippedArtifacts, artId])\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build, weaponId ? database.weapons.get(weaponId) : undefined)\n  const dataProviderValue = useMemo(() => teamData && ({ data: teamData[characterKey]!.target, teamData, oldData }), [characterKey, teamData, oldData])\n  return <>\n    <ModalWrapper open={show} onClose={onHide} containerProps={{ maxWidth: \"xl\" }}>\n      <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\n        {dataProviderValue && <DataContext.Provider value={dataProviderValue}>\n          <BuildDisplayItem compareBuild={true} extraButtons={<><HitModeToggle size=\"small\" /><ReactionToggle size=\"small\" /><Button size='small' color=\"error\" onClick={onHide} ><Close /></Button></>} />\n        </DataContext.Provider>}\n      </Suspense>\n    </ModalWrapper>\n    <Tooltip title={<Typography>{t`tabEquip.compare`}</Typography>} placement=\"top\" arrow>\n      <Button color=\"info\" size=\"small\" onClick={onShow} ><Difference /></Button>\n    </Tooltip>\n  </>\n}\n","import { Box, CardContent, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useReducer } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Assets from \"../../../../Assets/Assets\"\nimport CardDark from \"../../../../Components/Card/CardDark\"\nimport CloseButton from \"../../../../Components/CloseButton\"\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport ArtifactCard from \"../../../../PageArtifact/ArtifactCard\"\nimport { artifactFilterConfigs, FilterOption, initialFilterOption } from \"../../../../PageArtifact/ArtifactSort\"\nimport useForceUpdate from \"../../../../ReactHooks/useForceUpdate\"\nimport useMediaQueryUp from \"../../../../ReactHooks/useMediaQueryUp\"\nimport { SlotKey } from \"../../../../Types/consts\"\nimport { filterFunction } from \"../../../../Util/SortByFilters\"\nimport CompareBuildButton from \"./CompareBuildButton\"\nconst numToShowMap = { xs: 6, sm: 6, md: 9, lg: 12, xl: 12 }\n\nconst ArtifactFilterDisplay = lazy(() => import('../../../../Components/Artifact/ArtifactFilterDisplay'))\n\nexport default function ArtifactSwapModal({ onChangeId, slotKey, show, onClose }:\n  { onChangeId: (id: string) => void, slotKey: SlotKey, show: boolean, onClose: () => void }) {\n  const { t } = useTranslation(\"page_character\")\n  const { database } = useContext(DatabaseContext)\n  const clickHandler = useCallback((id) => {\n    onChangeId(id)\n    onClose()\n  }, [onChangeId, onClose])\n  const filterOptionReducer = useCallback((state, action) => ({ ...state, ...action, slotKeys: [slotKey] }), [slotKey],)\n\n  const [filterOption, filterOptionDispatch]: [FilterOption, (action: any) => void] = useReducer(filterOptionReducer, { ...initialFilterOption(), slotKeys: [slotKey] })\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  useEffect(() => { return database.arts.followAny(forceUpdate) }, [database, forceUpdate])\n\n  const brPt = useMediaQueryUp()\n\n  const filterConfigs = useMemo(() => artifactFilterConfigs(), [])\n  const artIdList = useMemo(() => {\n    const filterFunc = filterFunction(filterOption, filterConfigs)\n    return dbDirty && database.arts.values.filter(filterFunc).map(art => art.id).slice(0, numToShowMap[brPt])\n  }, [dbDirty, database, filterConfigs, filterOption, brPt])\n\n  return <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"xl\" }} >\n    <CardDark>\n      <CardContent sx={{ py: 1, display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n        <Typography variant=\"h6\">{slotKey ? <ImgIcon src={Assets.slot[slotKey]} /> : null} {t`tabEquip.swapArt`}</Typography>\n        <CloseButton onClick={onClose} />\n      </CardContent>\n      <Divider />\n      <CardContent>\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={200} />}>\n          <ArtifactFilterDisplay filterOption={filterOption} filterOptionDispatch={filterOptionDispatch} disableSlotFilter />\n        </Suspense>\n        <Box mt={1}>\n          <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={300} />}>\n            <Grid container spacing={1} columns={{ xs: 2, md: 3, lg: 4 }}>\n              {artIdList.map(id =>\n                <Grid item key={id} xs={1} >\n                  <ArtifactCard\n                    artifactId={id}\n                    extraButtons={<CompareBuildButton artId={id} />}\n                    onClick={clickHandler}\n                  />\n                </Grid>)}\n            </Grid>\n          </Suspense>\n        </Box>\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { Box, CardContent, Divider, Grid, TextField, ToggleButton, Typography } from \"@mui/material\"\nimport { ChangeEvent, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Assets from \"../../../../Assets/Assets\"\nimport CardDark from \"../../../../Components/Card/CardDark\"\nimport CloseButton from \"../../../../Components/CloseButton\"\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\"\nimport { Stars } from \"../../../../Components/StarDisplay\"\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport WeaponCard from \"../../../../PageWeapon/WeaponCard\"\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate'\nimport usePromise from \"../../../../ReactHooks/usePromise\"\nimport { allRarities, Rarity, WeaponTypeKey } from \"../../../../Types/consts\"\nimport { handleMultiSelect } from \"../../../../Util/MultiSelect\"\nimport { filterFunction, sortFunction } from '../../../../Util/SortByFilters'\nimport { weaponFilterConfigs, weaponSortConfigs } from '../../../../Util/WeaponSort'\nimport CompareBuildButton from \"./CompareBuildButton\"\n\nconst rarityHandler = handleMultiSelect([...allRarities])\n\nexport default function WeaponSwapModal({ onChangeId, weaponTypeKey, show, onClose }: { onChangeId: (id: string) => void, weaponTypeKey: WeaponTypeKey, show: boolean, onClose: () => void }) {\n  const { t } = useTranslation([\"page_character\", \"page_weapon\", \"weaponNames_gen\"])\n  const { database } = useContext(DatabaseContext)\n  const clickHandler = useCallback((id: string) => {\n    onChangeId(id)\n    onClose()\n  }, [onChangeId, onClose])\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  useEffect(() => database.weapons.followAny(forceUpdate), [forceUpdate, database])\n\n  const weaponSheets = usePromise(() => WeaponSheet.getAll, [])\n\n  const filterConfigs = useMemo(() => weaponSheets && weaponFilterConfigs(weaponSheets), [weaponSheets])\n  const sortConfigs = useMemo(() => weaponSheets && weaponSortConfigs(weaponSheets), [weaponSheets])\n\n  const [rarity, setRarity] = useState<Rarity[]>([5, 4, 3])\n\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const deferredSearchTerm = useDeferredValue(searchTerm)\n\n  const weaponIdList = useMemo(() => (filterConfigs && sortConfigs && dbDirty && database.weapons.values\n    .filter(filterFunction({ weaponType: weaponTypeKey, rarity, name: deferredSearchTerm }, filterConfigs))\n    .sort(sortFunction(\"level\", false, sortConfigs))\n    .map(weapon => weapon.id)) ?? []\n    , [dbDirty, database, filterConfigs, sortConfigs, rarity, weaponTypeKey, deferredSearchTerm])\n\n  return <ModalWrapper open={show} onClose={onClose} >\n    <CardDark>\n      <CardContent sx={{ py: 1 }}>\n        <Grid container>\n          <Grid item flexGrow={1}>\n            <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} {t`page_character:tabEquip.swapWeapon`}</Typography>\n          </Grid>\n          <Grid item>\n            <CloseButton onClick={onClose} />\n          </Grid>\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent>\n        <Grid container spacing={1} mb={1}>\n          <Grid item>\n            <SolidToggleButtonGroup sx={{ height: \"100%\" }} value={rarity} size=\"small\">\n              {allRarities.map(star => <ToggleButton key={star} value={star} onClick={() => setRarity(rarityHandler(rarity, star))}>\n                <Box display=\"flex\" gap={1}><strong>{star}</strong><Stars stars={1} /></Box>\n              </ToggleButton>)}\n            </SolidToggleButtonGroup>\n          </Grid>\n          <Grid item flexGrow={1}>\n            <TextField\n              autoFocus\n              size=\"small\"\n              value={searchTerm}\n              onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setSearchTerm(e.target.value)}\n              label={t(\"page_weapon:weaponName\")}\n              sx={{ height: \"100%\" }}\n              InputProps={{\n                sx: { height: \"100%\" }\n              }}\n            />\n          </Grid>\n        </Grid>\n        <Grid container spacing={1}>\n          {weaponIdList.map(weaponId =>\n            <Grid item key={weaponId} xs={6} sm={6} md={4} lg={3} >\n              <WeaponCard\n                weaponId={weaponId}\n                onClick={clickHandler}\n                extraButtons={<CompareBuildButton weaponId={weaponId} />}\n              />\n            </Grid>)}\n        </Grid>\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { Settings, SwapHoriz } from '@mui/icons-material';\nimport { Box, Button, CardContent, Divider, Grid, ListItem, Tooltip, Typography, useMediaQuery } from '@mui/material';\nimport { useTheme } from \"@mui/system\";\nimport { lazy, Suspense, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport SetEffectDisplay from '../../../../Components/Artifact/SetEffectDisplay';\nimport SlotNameWithIcon from '../../../../Components/Artifact/SlotNameWIthIcon';\nimport SubstatToggle from '../../../../Components/Artifact/SubstatToggle';\nimport CardDark from '../../../../Components/Card/CardDark';\nimport CardLight from '../../../../Components/Card/CardLight';\nimport StatDisplayComponent from '../../../../Components/Character/StatDisplayComponent';\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\nimport { BasicFieldDisplay, FieldDisplayList } from '../../../../Components/FieldDisplay';\nimport ModalWrapper from '../../../../Components/ModalWrapper';\nimport PercentBadge from '../../../../Components/PercentBadge';\nimport { CharacterContext } from '../../../../Context/CharacterContext';\nimport { DataContext } from '../../../../Context/DataContext';\nimport Artifact from '../../../../Data/Artifacts/Artifact';\nimport { ArtifactSheet } from '../../../../Data/Artifacts/ArtifactSheet';\nimport { DatabaseContext } from '../../../../Database/Database';\nimport { uiInput as input } from '../../../../Formula';\nimport ArtifactCard from '../../../../PageArtifact/ArtifactCard';\nimport WeaponCard from '../../../../PageWeapon/WeaponCard';\nimport useBoolState from '../../../../ReactHooks/useBoolState';\nimport useDBState from \"../../../../ReactHooks/useDBState\";\nimport usePromise from '../../../../ReactHooks/usePromise';\nimport { initCharMeta } from '../../../../stateInit';\nimport { allSubstatKeys } from '../../../../Types/artifact';\nimport { allSlotKeys, SlotKey, WeaponTypeKey } from '../../../../Types/consts';\nimport { IFieldDisplay } from '../../../../Types/fieldDisplay';\nimport useBuildSetting from '../TabOptimize/useBuildSetting';\nimport ArtifactSwapModal from './ArtifactSwapModal';\nimport WeaponSwapModal from './WeaponSwapModal';\n\nconst WeaponEditor = lazy(() => import('../../../../PageWeapon/WeaponEditor'))\n\nfunction TabEquip() {\n  const { character: { equippedWeapon, key: characterKey }, characterSheet } = useContext(CharacterContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const { teamData, data } = useContext(DataContext)\n  const weaponSheet = teamData[characterKey]?.weaponSheet\n  const [weaponId, setweaponId] = useState(\"\")\n  const showWeapon = useCallback(() => setweaponId(equippedWeapon), [equippedWeapon],)\n  const hideWeapon = useCallback(() => setweaponId(\"\"), [])\n\n  //triggers when character swap weapons\n  useEffect(() => {\n    if (weaponId && weaponId !== equippedWeapon)\n      setweaponId(equippedWeapon)\n  }, [weaponId, equippedWeapon])\n\n  const theme = useTheme();\n  const grxl = useMediaQuery(theme.breakpoints.up('xl'));\n\n  const weaponDoc = useMemo(() => weaponSheet && weaponSheet.document.length > 0 && <CardLight><CardContent><DocumentDisplay sections={weaponSheet.document} /></CardContent></CardLight>, [weaponSheet])\n  const [{ rvFilter }] = useDBState(`charMeta_${characterKey}`, initCharMeta)\n  const deferredRvFilter = useDeferredValue(rvFilter)\n  const deferredRvSet = useMemo(() => new Set(deferredRvFilter), [deferredRvFilter])\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n    <Suspense fallback={false}>\n      <WeaponEditor\n        weaponId={weaponId}\n        footer\n        onClose={hideWeapon}\n        extraButtons={<LargeWeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />}\n      />\n    </Suspense>\n    <CardLight >\n      <CardContent>\n        <StatDisplayComponent />\n      </CardContent>\n    </CardLight>\n    <Grid container spacing={1}>\n      {grxl && <Grid item xs={12} md={12} xl={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\n        {weaponDoc && weaponDoc}\n        <ArtifactSectionCard />\n      </Grid>}\n      <Grid item xs={12} md={12} xl={9} container spacing={1}>\n        <Grid item xs={12} sm={6} md={4} display=\"flex\" flexDirection=\"column\" gap={1}>\n          <WeaponCard weaponId={equippedWeapon} onEdit={showWeapon} canEquip extraButtons={<WeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />} />\n        </Grid>\n        {allSlotKeys.map(slotKey => <Grid item xs={12} sm={6} md={4} key={slotKey} >\n          {!!data.get(input.art[slotKey].id).value ?\n            <ArtifactCard artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} effFilter={deferredRvSet}\n              extraButtons={<ArtifactSwapButton slotKey={slotKey} />} editor canExclude canEquip /> :\n            <ArtSwapCard slotKey={slotKey} />}\n        </Grid>)}\n      </Grid>\n      {!grxl && <Grid item xs={12} md={12} xl={3} container spacing={1} >\n        {weaponDoc && <Grid item xs={12} md={6} lg={4}>{weaponDoc}</Grid>}\n        <Grid item xs={12} md={6} lg={4} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n          <ArtifactSectionCard />\n        </Grid>\n      </Grid>}\n    </Grid>\n  </Box>\n}\nexport default TabEquip\nfunction ArtSwapCard({ slotKey }: { slotKey: SlotKey }) {\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <CardLight sx={{ height: \"100%\", width: \"100%\", minHeight: 300, display: \"flex\", flexDirection: \"column\" }}>\n    <CardContent>\n      <Typography><SlotNameWithIcon slotKey={slotKey} /></Typography>\n    </CardContent>\n    <Divider />\n    <Box sx={{\n      flexGrow: 1,\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    }}\n    >\n      <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.arts.set(id, { location: characterKey })} />\n      <Button onClick={onOpen} color=\"info\" sx={{ borderRadius: \"1em\", }}>\n        <SwapHoriz sx={{ height: 100, width: 100 }} />\n      </Button>\n    </Box>\n  </CardLight>\n}\nfunction WeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <>\n    <Tooltip title={<Typography>{t`tabEquip.swapWeapon`}</Typography>} placement=\"top\" arrow>\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\n    </Tooltip>\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.weapons.set(id, { location: characterKey })} show={show} onClose={onClose} />\n  </>\n}\nfunction LargeWeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <>\n    <Button color=\"info\" onClick={onOpen} startIcon={<SwapHoriz />} >{t`tabEquip.swapWeapon`}</Button>\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.weapons.set(id, { location: characterKey })} show={show} onClose={onClose} />\n  </>\n}\nfunction ArtifactSwapButton({ slotKey }: { slotKey: SlotKey }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <>\n    <Tooltip title={<Typography>{t`tabEquip.swapArt`}</Typography>} placement=\"top\" arrow>\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\n    </Tooltip>\n    <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.arts.set(id, { location: characterKey })} />\n  </>\n}\nfunction ArtifactSectionCard() {\n  const { t } = useTranslation([\"page_character\", \"artifact\"])\n  const { database } = useContext(DatabaseContext)\n  const { character, character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const hasEquipped = useMemo(() => !!Object.values(equippedArtifacts).filter(i => i).length, [equippedArtifacts])\n  const unequipArts = useCallback(() => {\n    if (!character) return\n    if (!window.confirm(\"Do you want to move all currently equipped artifacts to inventory?\")) return\n    Object.values(equippedArtifacts).forEach(aid => database.arts.set(aid, { location: \"\" }))\n  }, [character, database, equippedArtifacts])\n\n  const setEffects = useMemo(() => artifactSheets && ArtifactSheet.setEffects(artifactSheets, data), [artifactSheets, data])\n  const [{ rvFilter }, setCharMeta] = useDBState(`charMeta_${characterKey}`, initCharMeta)\n  const setRVFilter = useCallback(rvFilter => setCharMeta({ rvFilter }), [setCharMeta],)\n\n  const [show, onShow, onHide] = useBoolState()\n  const deferredrvFilter = useDeferredValue(rvFilter)\n  const { rvField, rvmField } = useMemo(() => {\n    const { currentEfficiency, currentEfficiency_, maxEfficiency, maxEfficiency_ } = Object.values(equippedArtifacts).reduce((a, artid) => {\n      const art = database.arts.get(artid)\n      if (art) {\n        const { currentEfficiency, maxEfficiency } = Artifact.getArtifactEfficiency(art, new Set(deferredrvFilter))\n        const { currentEfficiency: currentEfficiency_, maxEfficiency: maxEfficiency_ } = Artifact.getArtifactEfficiency(art, new Set(allSubstatKeys))\n        a.currentEfficiency = a.currentEfficiency + currentEfficiency\n        a.maxEfficiency = a.maxEfficiency + maxEfficiency\n\n        a.currentEfficiency_ = a.currentEfficiency_ + currentEfficiency_\n        a.maxEfficiency_ = a.maxEfficiency_ + maxEfficiency_\n      }\n      return a\n    }, { currentEfficiency: 0, currentEfficiency_: 0, maxEfficiency: 0, maxEfficiency_: 0 })\n    const rvField: IFieldDisplay = {\n      text: t`artifact:editor.curSubEff`,\n      value: currentEfficiency === currentEfficiency_ ? <PercentBadge value={currentEfficiency} max={4500} valid /> :\n        <span><PercentBadge value={currentEfficiency} max={4500} valid /> / <PercentBadge value={currentEfficiency_} max={4500} valid /></span>\n    }\n    const rvmField: IFieldDisplay = {\n      text: t`artifact:editor.maxSubEff`,\n      canShow: () => currentEfficiency_ !== maxEfficiency_,\n      value: maxEfficiency === maxEfficiency_ ? <PercentBadge value={maxEfficiency} max={4500} valid /> :\n        <span><PercentBadge value={maxEfficiency} max={4500} valid /> / <PercentBadge value={maxEfficiency_} max={4500} valid /></span>\n    }\n    return { rvField, rvmField }\n  }, [t, deferredrvFilter, equippedArtifacts, database])\n\n  return <CardLight>\n    {hasEquipped && <Button color=\"error\" onClick={unequipArts} fullWidth sx={{ borderBottomRightRadius: 0, borderBottomLeftRadius: 0 }}>{t`tabEquip.unequipArts`}</Button>}\n    <CardContent >\n      <CardDark sx={{ mb: 2 }}>\n        <Button fullWidth color=\"info\" startIcon={<Settings />} sx={{ borderBottomLeftRadius: 0, borderBottomRightRadius: 0 }} onClick={onShow}>RV Filter</Button>\n        <ModalWrapper open={show} onClose={onHide}>\n          <CardDark>\n            <CardContent>\n              <SubstatToggle selectedKeys={rvFilter} onChange={setRVFilter} />\n            </CardContent>\n          </CardDark>\n        </ModalWrapper>\n        <FieldDisplayList >\n          < BasicFieldDisplay field={rvField} component={ListItem} />\n          < BasicFieldDisplay field={rvmField} component={ListItem} />\n        </FieldDisplayList>\n      </CardDark>\n      <Box display=\"flex\" gap={1} flexDirection=\"column\">\n        {artifactSheets && setEffects && Object.entries(setEffects).map(([setKey, setNumKeyArr]) =>\n          <CardDark key={setKey} sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n            {setNumKeyArr.map(setNumKey => <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />)}\n          </CardDark>)}\n      </Box>\n    </CardContent>\n  </CardLight>\n}\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/BackgroundWorker.4dbc6f86.worker.js\");\n}\n","import { ArtifactsBySlot, DynStat } from \"../PageCharacter/CharacterDisplay/Tabs/TabOptimize/common\";\nimport { ArtifactSetKey } from \"../Types/consts\";\nimport { reduceFormula, statsUpperLower } from \"./addedUtils\";\nimport { foldProd, foldSum } from \"./addedUtils\";\nimport { forEachNodes, mapFormulas } from \"./internal\";\nimport { NumNode, ReadNode } from \"./type\";\nimport { cmp, constant, prod, sum } from './utils';\n\nexport function makeid(length: number, disallowed?: string[]) {\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n  for (let _ = 0; _ < 5; _++) {\n    var result = '';\n    for (var i = 0; i < length; i++)\n      result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    if (disallowed && disallowed.includes(result)) continue\n    return result;\n  }\n  throw Error('Too many collisions in `makeid`')\n}\n\nfunction readKey(k: string): ReadNode<number> {\n  return { operation: \"read\", operands: [], path: ['dyn', k], type: \"number\", accu: 'add' }\n}\n\nfunction isShallow(f: NumNode) {\n  if (f.operation === 'const' || f.operation === 'read' || f.operation === 'threshold') return true\n  if (f.operation !== 'add') return false\n  return f.operands.every(n => n.operation === 'const' || n.operation === 'read' || n.operation === 'threshold')\n}\n\nfunction deleteKey(a: ArtifactsBySlot, key: string) {\n  delete a.base[key]\n  a.values.flower.forEach(art => delete art.values[key])\n  a.values.plume.forEach(art => delete art.values[key])\n  a.values.sands.forEach(art => delete art.values[key])\n  a.values.goblet.forEach(art => delete art.values[key])\n  a.values.circlet.forEach(art => delete art.values[key])\n}\n\n/**\n * Folds the formula along addable parameters. For example:\n *            `atk + 790 * atk_ + 667` <=> `kf3Dk`\n *   where\n * @param a     ArtifactsBySlot, modified in-place\n * @param nodes Objective function and/or constraints\n */\nfunction collapseAffine(a: ArtifactsBySlot, nodes: NumNode[]) {\n  const allKeys = Object.keys(a.base)\n  let addedRegisters = {} as { [key: string]: { base: number, coeff: number, sumKeys: string[] } }\n  function distributeProd(n: NumNode, v: number) {\n    if (!isShallow(n)) throw Error('`distribute` only works on shallow node type.')\n    if (v === 1) return n\n    switch (n.operation) {\n      case 'threshold':\n        let [branch, bval, ge, lt] = n.operands\n        if (branch.operation === 'read') {\n          return cmp(branch, bval, foldProd([ge, constant(v)]), foldProd([lt, constant(v)]), { source: branch.path[1] as ArtifactSetKey })\n        }\n        console.log(n)\n        throw Error('branch is not read...?')\n      case 'const':\n        return constant(v * n.value)\n      case 'add':\n        return sum(...n.operands.map(ni => distributeProd(ni, v)))\n      case 'read':\n        let newID = makeid(5, [...allKeys, ...Object.keys(addedRegisters)])\n        addedRegisters[newID] = { base: 0, coeff: v, sumKeys: [n.path[1]] }\n        return readKey(newID)\n      default:\n        throw Error('Should not reach here...')\n    }\n  }\n\n  const newNodes = mapFormulas(nodes, n => n, f => {\n    switch (f.operation) {\n      case 'mul':\n        let fMops = f.operands\n        if (fMops.some(n => n.operation === 'mul')) {\n          const toFold = fMops.filter(n => n.operation === 'mul').flatMap(n => [...n.operands]) as NumNode[]\n          const orig = fMops.filter(n => n.operation !== 'mul')\n          fMops = [...orig, ...toFold]\n        }\n        if (fMops.every(isShallow) && fMops.some(n => n.operation === 'const')) {\n          let coeff = fMops.reduce((coeff, n) => n.operation === 'const' ? coeff * n.value : coeff, 1)\n          const todistrib = fMops.filter(n => n.operation !== 'const')\n          if (todistrib.length === 0) return constant(coeff)\n          const mapped = distributeProd(todistrib.pop()!, coeff)\n\n          if (todistrib.length === 0) return mapped\n          return prod(mapped, ...todistrib)\n        }\n        return f\n      case 'add':\n        let fAops = f.operands\n        if (fAops.some(n => n.operation === 'add')) {\n          const toFold = fAops.filter(n => n.operation === 'add').flatMap(n => [...n.operands]) as NumNode[]\n          const goodboyes = fAops.filter(n => n.operation !== 'add')\n          fAops = [...goodboyes, ...toFold]\n        }\n        if (fAops.filter(n => n.operation === 'const' || n.operation === 'read').length > 1) {\n          const nofold = fAops.filter(n => n.operation !== 'const' && n.operation !== 'read')\n          const tofold = fAops.filter(n => n.operation === 'const' || n.operation === 'read')\n          let newID = makeid(5, [...allKeys, ...Object.keys(addedRegisters)])\n          const base = tofold.reduce((tot, n) => n.operation === 'const' ? tot + n.value : tot, 0)\n          const sumKeys = tofold.map(n => n.operation === 'read' ? n.path[1] : undefined).filter(n => n) as string[]\n          addedRegisters[newID] = { base, coeff: 1, sumKeys }\n\n          if (nofold.length === 0) return readKey(newID)\n          return sum(...nofold, readKey(newID))\n        }\n        return f\n      default:\n        return f\n    }\n  })\n\n  // Add `addedRegisters` to all the stats\n  let instKeys = new Set(Object.keys(a.base))\n  let resolveStack = Object.entries(addedRegisters)\n  while (resolveStack.length > 0) {\n    let [s, { base, coeff, sumKeys }] = resolveStack.shift()!\n    if (!sumKeys.every(k => instKeys.has(k))) {\n      resolveStack.push([s, { base, coeff, sumKeys }])\n      continue\n    }\n\n    let getV = (stats: DynStat) => {\n      return coeff * sumKeys.reduce((v, key) => v + stats[key], 0)\n    }\n\n    a.base[s] = base + getV(a.base)\n    a.values.flower.forEach(art => art.values[s] = getV(art.values))\n    a.values.plume.forEach(art => art.values[s] = getV(art.values))\n    a.values.sands.forEach(art => art.values[s] = getV(art.values))\n    a.values.goblet.forEach(art => art.values[s] = getV(art.values))\n    a.values.circlet.forEach(art => art.values[s] = getV(art.values))\n\n    instKeys.add(s)\n  }\n\n  // Remove all unused keys from all the stats\n  let unusedKeys = new Set<string>(instKeys)\n  forEachNodes(newNodes, _ => { }, n => {\n    if (n.operation === 'read') unusedKeys.delete(n.path[1])\n  })\n  unusedKeys.forEach(k => deleteKey(a, k))\n\n  return { a, nodes: newNodes }\n}\n\nexport function elimLinDepStats(a: ArtifactsBySlot, nodes: NumNode[]) {\n  // Step 1. Find all constants and eliminate them from the equation.\n  const { statsMin, statsMax } = statsUpperLower(a)\n  nodes = reduceFormula(nodes, statsMin, statsMax);\n\n  // Step 2. Find all sums of variables and constants, and combine these values into named registers\n  ({ a, nodes } = collapseAffine(a, nodes))\n\n  // Step 3. Use Gaussian elimination to find all linear dependencies\n  const allKeys = Object.keys(a.base)\n  const allStats = [a.base, ...Object.values(a.values).flatMap(slotArts => slotArts.map(art => art.values))]\n\n  const rows = allKeys.length\n  const cols = allStats.length\n\n  let mat = allKeys.map(k => allStats.map(dyn => dyn[k]))\n  let record: number[][] = Array(rows).fill(0).map(_ => Array(rows).fill(0))\n  for (let i = 0; i < rows; i++) record[i][i] = 1\n\n  let selectedPivots = new Set<number>()\n  for (let c = 0; c < cols; c++) {\n    let pivot = -1\n    for (let r = 0; r < rows; r++) {\n      if (selectedPivots.has(r)) continue\n      if (Math.abs(mat[r][c]) > 1e-8) {\n        pivot = r\n        break\n      }\n    }\n    if (pivot < 0) continue\n\n    selectedPivots.add(pivot)\n    const j = pivot\n\n    for (let r = 0; r < rows; r++) {\n      if (selectedPivots.has(r)) continue\n      if (Math.abs(mat[r][c]) > 1e-8) {\n        const coeff = mat[r][c] / mat[j][c]\n        mat[r] = mat[r].map((mr, i) => mr - coeff * mat[j][i])\n        record[r] = record[r].map((ri, i) => ri - coeff * record[j][i])  // record this transform in a matrix\n      }\n    }\n    if (selectedPivots.size === rows) break\n  }\n  if (selectedPivots.size === rows) {\n    return { a, nodes }\n  }\n\n  // Step 4. Eliminate the found dependencies.\n  for (let n = 0; n < rows; n++) {\n    if (!selectedPivots.has(n)) {\n      // If the row is linearly dependent on some shit\n      let depOn = record[n]\n        .map((ri, i) => ({ w: i === n ? 0 : -ri, key: allKeys[i] }))\n        .filter(({ w }) => Math.abs(w) > 1e-8)\n\n      if (depOn.some(({ w }) => w < 0)) continue  // Ignore lindep if any negative coeff\n      const replaceWith = foldSum(depOn.map(({ w, key }) => w === 1 ? readKey(key) : prod(w, readKey(key))))\n      nodes = mapFormulas(nodes, n => n, f => {\n        if (f.operation === 'read' && f.path[1] === allKeys[n]) {\n          return replaceWith\n        }\n        return f\n      })\n      deleteKey(a, allKeys[n])\n    }\n  }\n\n  return { a, nodes }\n}\n\nexport function thresholdToConstBranchForm(nodes: NumNode[]) {\n  return mapFormulas(nodes, n => n, n => {\n    switch (n.operation) {\n      case \"threshold\":\n        const [branch, bval, ge, lt] = n.operands\n        if (branch.operation === 'const' && bval.operation === 'const') {\n          return branch.value >= bval.value ? ge : lt\n        }\n        if (branch.operation === 'threshold' && bval.operation === 'const') {\n          // Reserved for non-stacking buffs\n          const [br2, bv2, ge2, lt2] = branch.operands\n          if (br2.operation === 'read' && bv2.operation === 'const' && ge2.operation === 'const' && lt2.operation === 'const') {\n            let left = ge2.value >= bval.value ? ge : lt\n            let right = lt2.value >= bval.value ? ge : lt\n\n            console.log('non-stacking buff', n, cmp(br2, bv2, left, right))\n            return cmp(br2, bv2, left, right)\n          }\n          console.log('faulty node:', n)\n          throw Error('Not Implemented: nested threshold must follow the form [read, const, const, const]')\n        }\n        if (ge.operation !== 'const' || lt.operation !== 'const') {\n          if (lt.operation === 'const' && lt.value === 0) {\n            return prod(cmp(branch, bval, 1, 0), ge)\n          }\n          console.log('faulty node:', n)\n          throw Error('Not Implemented: threshold() node with non-constant `pass` AND non-zero `fail`')\n        }\n\n        if (branch.operation !== 'read') {\n          console.log('faulty node:', n)\n          throw Error('Not Implemented: threshold() node with non-read `branch`')\n        }\n        return n\n      default:\n        return n\n    }\n  })\n}\n","import { constant, sum, prod, cmp } from \"./utils\"\nimport { NumNode } from \"./type\"\nimport { allOperations } from \"./optimization\"\nimport { mapFormulas } from \"./internal\"\nimport { ArtifactBuildData, ArtifactsBySlot, DynStat } from \"../PageCharacter/CharacterDisplay/Tabs/TabOptimize/common\"\nimport { LinearForm, maxWeight, toLinearUpperBound } from \"./linearUpperBound\"\nimport { foldLikeTerms, ExpandedPolynomial } from \"./expandPoly\"\nimport { ArtifactSetKey } from \"../Types/consts\"\nimport { ArtSetExclusion } from \"../Database/Data/BuildsettingData\"\n\nexport function foldSum(nodes: readonly NumNode[]) {\n  if (nodes.length === 1) return nodes[0]\n  nodes = nodes.flatMap(n => n.operation === 'add' ? n.operands : n)\n  let constVal = nodes.reduce((pv, n) => n.operation === 'const' ? pv + n.value : pv, 0)\n  nodes = nodes.filter(n => n.operation !== 'const')\n\n  if (nodes.length === 0) return constant(constVal)\n  if (constVal === 0) {\n    if (nodes.length === 1) return nodes[0]\n    return sum(...nodes)\n  }\n  return sum(...nodes, constant(constVal))\n}\n\nexport function foldProd(nodes: readonly NumNode[]) {\n  if (nodes.length === 1) return nodes[0]\n  nodes = nodes.flatMap(n => n.operation === 'mul' ? n.operands : n)\n  let constVal = nodes.reduce((pv, n) => n.operation === 'const' ? pv * n.value : pv, 1)\n  nodes = nodes.filter(n => n.operation !== 'const')\n\n  if (nodes.length === 0) return constant(constVal)\n  if (constVal === 1) return prod(...nodes)\n  return prod(...nodes, constant(constVal))\n}\n\nexport function slotUpperLower(a: ArtifactBuildData[]) {\n  if (a.length === 0) return { statsMin: {}, statsMax: {} }\n  // Assume keys are the same for all artifacts.\n  const keys = Object.keys(a[0].values)\n  let statsMin: DynStat = {}\n  let statsMax: DynStat = {}\n  let sets = new Set<ArtifactSetKey>()\n  keys.forEach(k => {\n    statsMin[k] = Infinity\n    statsMax[k] = -Infinity\n  })\n  for (let i = 0; i < a.length; i++) {\n    for (let j = 0; j < keys.length; j++) {\n      const k = keys[j]\n      statsMin[k] = Math.min(a[i].values[k], statsMin[k])\n      statsMax[k] = Math.max(a[i].values[k], statsMax[k])\n    }\n    if (a[i].set) sets.add(a[i].set!)\n  }\n  sets.forEach(set => {\n    statsMax[set] = 1\n    statsMin[set] = 0\n  })\n  if (sets.size === 1) {\n    const [s] = sets\n    statsMin[s] = 1\n  }\n  return { statsMin, statsMax }\n}\n\nexport function statsUpperLower(a: ArtifactsBySlot) {\n  let statsMin: DynStat = { ...a.base }\n  let statsMax: DynStat = { ...a.base }\n  Object.entries(a.values).forEach(([slotKey, slotArts]) => {\n    const { statsMin: smin, statsMax: smax } = slotUpperLower(slotArts)\n    Object.keys(smin).forEach(sk => {\n      statsMin[sk] = smin[sk] + (statsMin[sk] ?? 0)\n      statsMax[sk] = smax[sk] + (statsMax[sk] ?? 0)\n    })\n  })\n  return { statsMin, statsMax }\n}\n\nexport function reduceFormula(f: NumNode[], lower: DynStat, upper: DynStat) {\n  const fixedStats = Object.keys(lower).filter(statKey => lower[statKey] === upper[statKey])\n  let f2 = mapFormulas(f, n => n, n => {\n    switch (n.operation) {\n      case 'add':\n        return foldSum(n.operands)\n      case 'mul':\n        return foldProd(n.operands)\n\n      case 'read':\n        if (fixedStats.includes(n.path[1])) return constant(lower[n.path[1]])\n        return n\n      case 'threshold':\n        const [branch, branchVal, ge, lt] = n.operands\n        if (branch.operation === 'const' && branchVal.operation === 'const')\n          return branch.value >= branchVal.value ? ge : lt\n        if (branch.operation === 'read' && branchVal.operation === 'const') {\n          if (lower[branch.path[1]] >= branchVal.value) return ge\n          if (upper[branch.path[1]] < branchVal.value) return lt\n        }\n        return n\n      case 'min': case 'max':\n      case 'res': case 'sum_frac':\n        if (n.operands.every(ni => ni.operation === 'const')) {\n          const out = allOperations[n.operation](n.operands.map(ni => ni.operation === 'const' ? ni.value : NaN))\n          return constant(out)\n        }\n        return n\n      default:\n        return n\n    }\n  })\n\n  // f2 = optimize(f2, {})\n  return f2\n}\n\nexport function reducePolynomial(f: ExpandedPolynomial[], lower: DynStat, upper: DynStat): ExpandedPolynomial[] {\n  const fixedStats = Object.keys(lower).filter(statKey => Math.abs(lower[statKey] - upper[statKey]) < 1e-6)\n  return f.map(({ nodes, terms }) => {\n    // 1. Reduce nodes by substituting constants\n    const tagNodePairs = Object.entries(nodes)\n    const reducedNodes = mapFormulas(tagNodePairs.map(([k, v]) => v), n => n, n => {\n      switch (n.operation) {\n        case 'read':\n          if (fixedStats.includes(n.path[1])) return constant(lower[n.path[1]])\n          return n\n        case 'threshold':\n          const [branch, branchVal, ge, lt] = n.operands\n          if (branch.operation === 'const' && branchVal.operation === 'const')\n            return branch.value >= branchVal.value ? ge : lt\n          if (branch.operation === 'read' && branchVal.operation === 'const') {\n            if (lower[branch.path[1]] >= branchVal.value) return ge\n            if (upper[branch.path[1]] < branchVal.value) return lt\n          }\n          else throw Error('Branch between non-read and non-const!!!')\n          return n\n        case 'add':\n          return foldSum(n.operands)\n        case 'mul':\n          return foldProd(n.operands)\n        case 'res': case 'sum_frac':\n          if (n.operands.every(ni => ni.operation === 'const')) {\n            const out = allOperations[n.operation](n.operands.map(ni => ni.operation === 'const' ? ni.value : NaN))\n            return constant(out)\n          }\n          return n\n        case 'min': case 'max':\n          // TODO: reduce min & max\n          if (n.operands.every(ni => ni.operation === 'const')) {\n            const out = allOperations[n.operation](n.operands.map(ni => ni.operation === 'const' ? ni.value : NaN))\n            return constant(out)\n          }\n          return n\n        default:\n          return n\n      }\n    })\n\n    // 2a. Find all the nodes that have been reduced to constants\n    let tagsToKill = {} as Dict<string, number>\n    reducedNodes.forEach((n, i) => {\n      if (n.operation !== 'const') return\n      const [tag] = tagNodePairs[i]\n      tagsToKill[tag] = n.value\n    })\n\n    // 2b. Substitute the constant nodes in where possible\n    let newTerms = terms.map(mon => {\n      let c = mon.coeff\n      const newTerms = mon.terms.filter(t => {\n        if (tagsToKill[t] !== undefined) {\n          c *= tagsToKill[t]!\n          return false\n        }\n        return true\n      })\n      if (c === 0) return { coeff: 0, terms: [] }\n      return { coeff: c, terms: newTerms }\n    })\n\n    // 3. Delete all the constant tags & add like terms together\n    let newNodes = Object.fromEntries(reducedNodes.map((n, i) => [tagNodePairs[i][0], n]))\n    Object.keys(tagsToKill).forEach(t => delete newNodes[t])\n    return { nodes: newNodes, terms: foldLikeTerms(newTerms) }\n  })\n}\n\n/**\n * Estimates maximum value across an array of formulas\n * @param f              Functions to maximize\n * @param a              Artifact set\n * @param cachedCompute  Optional Prior cached compute. If specified, will re-calculate `maxEst` assuming `lin, lower, upper` are correct.\n * @returns              CachedCompute\n */\ntype MaxEstQuery2 = { f: ExpandedPolynomial[], a: ArtifactsBySlot, cachedCompute: { lower: DynStat, upper: DynStat } }\n  | { f?: undefined, cachedCompute: { lin: LinearForm[], lower: DynStat, upper: DynStat }, a: ArtifactsBySlot }\nexport function estimateMaximum({ f, a, cachedCompute }: MaxEstQuery2) {\n  if (f === undefined) {\n    return { maxEst: cachedCompute.lin.map(l => maxWeight(a, l)), ...cachedCompute }\n  }\n\n  const { lower, upper } = cachedCompute\n  const est = f.map(fi => {\n    const lin = toLinearUpperBound(fi, lower, upper)\n    return { maxEst: maxWeight(a, lin), lin }\n  })\n\n  return {\n    maxEst: est.map(({ maxEst }) => maxEst),\n    lin: est.map(({ lin }) => lin),\n    lower, upper\n  }\n}\n\nexport function fillBuffer(stats: DynStat, mapping: Dict<string, number>, buffer: Float64Array) {\n  Object.entries(stats)\n    .filter(([k]) => mapping[k] !== undefined)\n    .forEach(([k, v]) => buffer[mapping[k]!] = v)\n}\n\nexport function thresholdExclusions(nodes: NumNode[], excl: ArtSetExclusion) {\n  nodes = mapFormulas(nodes, n => n, n => {\n    switch (n.operation) {\n      case 'threshold':\n        const [branch, branchVal, ge, lt] = n.operands\n        if (branch.operation === 'read' && branchVal.operation === 'const') {\n          const key = branch.path[1] as ArtifactSetKey\n          if (excl[key] !== undefined) {\n            const exc = excl[key] as (2 | 4)[]\n            // Based on exclusion, either return `lt` or shift `branchVal` to 4.\n            if (branchVal.value === 2 && exc.includes(2)) {\n              if (exc.includes(4)) return lt\n              return cmp(branch, 4, ge, lt)\n            }\n            if (branchVal.value === 4 && exc.includes(4))\n              return lt\n          }\n        }\n        return n\n      default:\n        return n\n    }\n  })\n  return nodes\n}\n","import { sum, prod, hashNode, cmpNode } from \"./utils\"\nimport { ConstantNode, NumNode } from \"./type\"\nimport { allArtifactSets } from \"../Types/consts\"\nimport { cartesian } from '../Util/Util'\nimport { forEachNodes } from \"./internal\"\nimport { makeid } from \"./optimize2\"\nimport { DynStat } from \"../PageCharacter/CharacterDisplay/Tabs/TabOptimize/common\"\n\nfunction countSlotUsage(node: NumNode): DynStat {\n  if (node.operation === 'add') {\n    return node.operands.map(n => countSlotUsage(n)).reduce((a, b) => {\n      Object.entries(b).forEach(([slotKey, n]) => a[slotKey] = Math.min(n, a[slotKey] ?? 0))\n      return a\n    }, {})\n  }\n  else if (node.operation === 'mul') {\n    return node.operands.map(n => countSlotUsage(n)).reduce((a, b) => {\n      Object.entries(b).forEach(([slotKey, n]) => a[slotKey] = Math.max(n, a[slotKey] ?? 0))\n      return a\n    }, {})\n  }\n  else if (node.operation === 'threshold') {\n    const branch = node.operands[0]\n    if (branch.operation === 'read' && (allArtifactSets as readonly string[]).includes(branch.path[1])) {\n      let con = node.operands[1] as ConstantNode<number>\n      return { [branch.path[1]]: con.value }\n    }\n  }\n  return {}\n}\n\nfunction filterProductPossible({ terms, nodes }: ExpandedPolynomial, slotsLeft = 5) {\n  let sCount = Object.fromEntries(Object.entries(nodes).map(([tag, n]) => [tag, countSlotUsage(n)]))\n\n  terms = terms.filter(({ terms }) => {\n    const slotUsage = terms.reduce((tot, s) => {\n      Object.entries(sCount[s]).forEach(([slotKey, n]) => tot[slotKey] = Math.max(n, tot[slotKey] ?? 0))\n      return tot\n    }, {} as DynStat)\n    return Object.values(slotUsage).reduce((a, b) => a + b, 0) <= slotsLeft\n  })\n  return { terms, nodes }\n}\n\nexport type Monomial = {\n  coeff: number,\n  terms: string[]\n}\nexport type ExpandedPolynomial = {\n  terms: Monomial[],\n  nodes: Dict<string, NumNode>,\n}\n\nexport function sumM(...monomials: Monomial[][]): Monomial[] {\n  return monomials.flat()\n}\nexport function prodM(...monomials: Monomial[][]): Monomial[] {\n  return cartesian(...monomials).map(monos => monos.reduce((ret, nxt) => {\n    ret.coeff *= nxt.coeff\n    ret.terms.push(...nxt.terms)\n    return ret\n  }, { coeff: 1, terms: [] }))\n}\nexport function constantM(v: number): Monomial[] {\n  return [{ coeff: v, terms: [] }]\n}\nexport function readM(tag: string): Monomial[] {\n  return [{ coeff: 1, terms: [tag] }]\n}\n\nexport function foldLikeTerms(mono: Monomial[]): Monomial[] {\n  let mon = [...mono]\n  mon.forEach(m => m.terms.sort())\n  mon.sort(({ terms: termsA }, { terms: termsB }) => {\n    if (termsA.length !== termsB.length) return termsA.length - termsB.length\n    for (let i = 0; i < termsA.length; i++) {\n      if (termsA[i] !== termsB[i]) return termsA[i] < termsB[i] ? -1 : 1\n    }\n    return 0\n  })\n\n  for (let i = mon.length - 2; i >= 0; i--) {\n    let a = mon[i].terms\n    let b = mon[i + 1].terms\n    if (a.length !== b.length) continue\n    if (a.every((ai, i) => ai === b[i])) {\n      mon[i].coeff = (mon[i].coeff ?? 0) + (mon[i + 1].coeff ?? 0)\n      mon.splice(i + 1, 1)\n    }\n  }\n  return mon\n}\n\n/**\n * Factors damage formula into sums of monomials in each variable.\n * For example:  (1700 * atk_ + atk) * (1 + cr * cd) * (1 + sum_frac(EM))\n *   -> 1700 * atk_ + 1700 * atk_ * cr * cd + 1700 * atk_ * sum_frac(EM) + 1700 * atk_ * cr * cd * sum_frac(EM)\n *            + atk +         atk * cr * cd +         atk * sum_frac(EM) +         atk * cr * cd * sum_frac(EM)\n *\n * For a total of 8 terms, since there are 3 pairs of additions, for 2^3 sum-of-product terms.\n *\n * isVar() is used to check whether any node should be considered a variable on its own.\n */\ntype NodeLinkedList = { n: NumNode, tag: string, next: NodeLinkedList | undefined }\nexport function expandPoly(node: NumNode, inheritTags?: string[]): ExpandedPolynomial {\n  let varMap = {} as Dict<number, NodeLinkedList> // my shitty hashmap\n  let tagMap = {} as Dict<string, NumNode>\n  const varTags = inheritTags ?? []\n  function lookup(n: NumNode) {\n    let hsh = hashNode(n)\n    let z = varMap[hsh]\n    while (z !== undefined) {\n      if (cmpNode(z.n, n)) return z.tag\n      z = z.next\n    }\n    const newTag = makeid(10, varTags)\n    varMap[hsh] = { n, tag: newTag, next: varMap[hsh] }\n    tagMap[newTag] = n\n    varTags.push(newTag)\n    return newTag\n  }\n\n  let stat2tag = {} as Dict<string, string>\n  forEachNodes([node], _ => { }, n => {\n    if (n.operation === 'read') stat2tag[n.path[1]] = lookup(n as NumNode)\n  })\n\n  function toSOP(n: NumNode): Monomial[] {\n    switch (n.operation) {\n      case 'add':\n        return sumM(...n.operands.map(toSOP))\n      case 'mul':\n        return prodM(...n.operands.map(toSOP))\n      case 'const':\n        return constantM(n.value)\n      default:\n        return readM(lookup(n))\n    }\n  }\n\n  // let sop = toSOP(node)\n  let sop = foldLikeTerms(toSOP(node))\n  return filterProductPossible({\n    terms: sop,\n    nodes: tagMap,\n  })\n}\n\n// Really should avoid using this function ever\nexport function toNumNode({ nodes, terms }: ExpandedPolynomial) {\n  return sum(...terms.map(({ coeff, terms }) => prod(coeff, ...terms.map(t => nodes[t]!))))\n}\n","function pivotInplace(A: number[][], { i, j }: { i: number, j: number }) {\n  const Aij = A[i][j]\n  for (let h = 0; h < A.length; h++) {\n    if (h === i) continue\n    for (let k = 0; k < A[0].length; k++) {\n      if (k === j) continue\n      A[h][k] -= A[i][k] * A[h][j] / Aij\n    }\n  }\n  for (let h = 0; h < A.length; h++) {\n    if (h === i) continue\n    A[h][j] = -A[h][j] / Aij\n  }\n  for (let k = 0; k < A[0].length; k++) {\n    if (k === j) continue\n    A[i][k] = A[i][k] / Aij\n  }\n  A[i][j] = 1 / Aij\n}\n\nfunction findPiv1(A: number[][]) {\n  const r = A.length, c = A[0].length\n  let minloc = { i: -1, j: -1, cmp: Infinity }\n  for (let j = 0; j < c - 1; j++) {\n    if (A[r - 1][j] >= 0) continue\n    for (let i = 0; i < r - 1; i++) {\n      if (A[i][j] > 1e-5) {\n        const cmp = A[i][c - 1] / A[i][j]\n        if (cmp < minloc.cmp) minloc = { i, j, cmp }\n      }\n    }\n\n    if (minloc.i < 0) throw Error('UNBOUNDED FEASIBLE')\n  }\n\n  if (minloc.i < 0) throw Error('NO PIVOTS (done)')\n  return { i: minloc.i, j: minloc.j }\n}\n\nfunction findPiv2(A: number[][]) {\n  const r = A.length, c = A[0].length\n  let minloc = { i: -1, j: -1, cmp: Infinity }\n  for (let i = 0; i < r - 1; i++) {\n    if (A[i][c - 1] >= 0) continue\n    for (let j = 0; j < c - 1; j++) {\n      if (A[i][j] < -1e-5) {\n        const cmp = A[i][c - 1] / A[i][j]\n        if (cmp < minloc.cmp) minloc = { i, j, cmp }\n      }\n    }\n\n    if (minloc.i < 0) throw Error('INFEASIBLE')\n    return { i: minloc.i, j: minloc.j }\n  }\n  throw Error('NO PIVOTS (done)')\n}\n\nfunction backtrack(tableau: number[][], ijTrack: { i: number, j: number }[], targ: number) {\n  let side = 1;  // 0 left, 1 right\n  ijTrack.forEach(({ i, j }) => {\n    if (side === 1 && j === targ) {\n      targ = i\n      side = 0\n    }\n    else if (side === 0 && i === targ) {\n      targ = j\n      side = 1\n    }\n  })\n\n  const ncol = tableau[0].length\n  return side === 0 ? tableau[targ][ncol - 1] : 0\n}\n\n/**\n * Solve a Linear Program defined by:\n *              min  c^T x\n *               x\n *   Subject to:     Ax <= b\n *                    x >= 0\n *\n * Implemented according to:\n *   https://www.math.ucla.edu/~tom/LP.pdf\n *\n * Does not implement any cycle detection, though that *shouldnt* a problem for GO's use\n *   case. This algorithm is fairly numerically unstable though, use with care & always\n *   try to verify the solution. It's also a fair bit slower than it needs to be.\n *\n * @param c        Objective vector\n * @param Ab       Constraints matrix with thresholds. Inputted in block form [A, b]\n * @returns        the optimal solution x\n */\nexport function solveLP(c: number[], Ab: number[][]) {\n  let rows = Ab.length + 1\n  let cols = Ab[0].length\n\n  let tableau = Array(rows).fill(0).map(_ => Array(cols).fill(0))\n  Ab.forEach((Ai, i) => Ai.forEach((Aij, j) => tableau[i][j] = Aij))\n  // b.forEach((bi, i) => tableau[i][cols - 1] = bi)\n  c.forEach((cj, j) => tableau[rows - 1][j] = cj)\n  // console.log('tab', tableau)\n\n  let ijTrack: { i: number, j: number }[] = []\n\n  while (tableau.some((t, i) => i < rows - 1 && t[cols - 1] < 0)) {\n    const ij = findPiv2(tableau)\n    ijTrack.push(ij)\n    // tableau = pivot(tableau, ij)\n    pivotInplace(tableau, ij)\n  }\n\n  while (tableau[rows - 1].some((t, j) => j < cols - 1 && t < 0)) {\n    const ij = findPiv1(tableau)\n    ijTrack.push(ij)\n    // tableau = pivot(tableau, ij)\n    pivotInplace(tableau, ij)\n  }\n\n  return c.map((_, i) => backtrack(tableau, ijTrack, i))\n}\n","import { NumNode } from \"./type\"\nimport { ArtifactsBySlot, ArtifactsBySlotVec, DynStat } from \"../PageCharacter/CharacterDisplay/Tabs/TabOptimize/common\"\nimport { constant, sum, prod, cmp } from \"./utils\"\nimport { ExpandedPolynomial, Monomial, sumM, prodM, constantM, readM, foldLikeTerms } from './expandPoly'\nimport { precompute, allOperations } from \"./optimization\"\nimport { solveLP } from './solveLP_simplex'\nimport { cartesian } from '../Util/Util'\nimport { fillBuffer } from \"./addedUtils\"\n\nexport type LinearForm = {\n  w: DynStat,\n  c: number,\n  err: number\n}\nexport type LinearFormVec = {\n  w: number[],\n  c: number,\n  err: number\n}\n\nfunction minMax(node: NumNode, lower: DynStat, upper: DynStat) {\n  let [compute, mapping, buffer] = precompute([node], n => n.path[1])\n  fillBuffer(lower, mapping, buffer)\n  const minval = compute()[0]\n  fillBuffer(upper, mapping, buffer)\n  const maxval = compute()[0]\n  return [minval, maxval]\n}\n\n/**\n * `res` is the ONE place where negative arguments & negative slopes are allowed.\n * @param node\n */\nfunction handleResArg(node: { 'operation': 'res', 'operands': NumNode[] }, lower: DynStat, upper: DynStat) {\n  function flipOps(n: NumNode): NumNode {\n    switch (n.operation) {\n      case 'add':\n        return sum(...n.operands.map(n => flipOps(n)))\n      case 'const':\n        return constant(-n.value)\n      case 'threshold':\n        const [branch, bval, ge, lt] = n.operands\n        if (ge.operation === 'const' && lt.operation === 'const') {\n          if (ge.value <= lt.value) {\n            return cmp(branch, bval, -ge.value, -lt.value)\n          }\n        }\n        console.log(n)\n        throw Error('(res neg slope): threshold. Something went wrong.')\n      default:\n        console.log(n)\n        throw Error('(res neg slope) Havent written logic to handle this')\n    }\n  }\n\n  const flippedResOp = flipOps(node.operands[0])\n\n  let [a, b] = minMax(flippedResOp, lower, upper)\n  let resf = allOperations['res']\n  let [c, d] = [resf([-a]), resf([-b])]\n\n  if (b > 0 && a > -1.75) {\n    // 1 + x / 2\n    return sum(1, prod(.5, flippedResOp))\n  }\n\n  const intercept = (b * c - a * d) / (b - a)\n  const slope = (c - d) / (b - a)\n  return sum(intercept, prod(slope, flippedResOp))\n}\n\n/**\n * First converts a product of variables (including max, min, sum_frac, threshold, etc.) to\n *   a pure product form consisting of only `read` and `const` nodes, guaranteeing the\n *   product form is an upper bound.\n *\n * Then on the product form, create a linear upper bound using `lub` and return it.\n *\n * @param node The formula to expand\n * @param lower Stat lower bounds\n * @param upper Stat upper bounds\n * @returns\n */\nexport function toLinearUpperBound({ nodes, terms }: ExpandedPolynomial, lower: DynStat, upper: DynStat): LinearForm {\n  let stat2tag = {} as Dict<string, string>\n  Object.entries(nodes).forEach(([tag, n]) => {\n    if (n.operation === 'read') stat2tag[n.path[1]] = tag\n  })\n\n  let linerr = 0\n  function toPureRead(n: NumNode): Monomial[] {\n    switch (n.operation) {\n      case 'const':\n        return constantM(n.value)\n      case 'read':\n        return readM(stat2tag[n.path[1]]!)\n      case 'add':\n        return sumM(...n.operands.map(toPureRead))\n      case 'mul':\n        return prodM(...n.operands.map(toPureRead))\n\n      case 'threshold':\n        const [branch, bval, ge, lt] = n.operands\n        if (branch.operation === 'read' && bval.operation === 'const'\n          && lt.operation === 'const' && ge.operation === 'const') {\n          if (ge.value < lt.value) {\n            console.log(n)\n            throw Error('Not Implemented (threshold must be increasing)')\n          }\n\n          let key = branch.path[1]\n          if (lower[key] >= bval.value) return constantM(ge.value)\n          if (upper[key] < bval.value) return constantM(lt.value)\n\n          const slope = (ge.value - lt.value) / (bval.value - lower[key])\n          const mon1 = prodM(constantM(slope), readM(stat2tag[branch.path[1]]!))\n          if (lt.value === 0) return mon1\n          return sumM(constantM(lt.value), mon1)\n        }\n        console.log(n)\n        throw Error('Not Implemented (threshold must branch between constants)')\n      case 'res':\n        let op = handleResArg(n as { 'operation': 'res', 'operands': NumNode[] }, lower, upper)\n        return toPureRead(op)\n\n      case 'min': case 'max':\n        let [rop, cop] = n.operands\n        if (cop.operation !== 'const')\n          [rop, cop] = [cop, rop]  // Assume min(const, read)\n        if (n.operation === 'min') return toPureRead(rop)\n\n        if (cop.operation === 'const') {\n          const thresh = cop.value\n          const [minVal, maxVal] = minMax(rop, lower, upper)\n          if (minVal > thresh) return toPureRead(rop)\n          if (thresh > maxVal) return constantM(thresh)\n\n          // rescale `rop` to be above thresh, since max(f, 0) is a convex function\n          const m = (maxVal - thresh) / (maxVal - minVal)\n          const b = thresh - minVal\n          return sumM(constantM(b), prodM(constantM(m), toPureRead(rop)))\n        }\n        console.log(n)\n        throw Error('Not Implemented (max between two non-constants)')\n\n      case 'sum_frac':\n        const [em, denom] = n.operands\n        if (denom.operation !== 'const') throw Error('Not Implemented (non-constant sum_frac denominator)')\n\n        const [minEM, maxEM] = minMax(em, lower, upper)\n        const k = denom.value\n        // The sum_frac form is concave, so any Taylor expansion of EM / (EM + k) gives an upper bound.\n        // We can solve for the best Taylor approximation location with the following formula.\n        let loc = Math.sqrt((minEM + k) * (maxEM + k)) - k\n        let below = (k + loc) * (k + loc)\n        let slope = k / below\n        let c = loc * loc / below\n\n        // TODO: update linerr\n        return sumM(constantM(c), prodM(constantM(slope), toPureRead(em)))\n\n      default:\n        console.log(n)\n        throw Error('Not Implemented')\n    }\n  }\n\n  // 1. Turn all nodes into linear upper bounds\n  const nodesToMap = Object.fromEntries(Object.entries(nodes).filter(([tag, n]) => n.operation !== 'read').map(([tag, n]) => [tag, toPureRead(n)]))\n\n  // 2. substitute into `terms` and construct a new SOPForm whose nodes are all pure read nodes\n  let t2 = terms.flatMap(({ coeff, terms }) => prodM(constantM(coeff), ...terms.map(t => nodesToMap[t] ?? readM(t))))\n  t2 = foldLikeTerms(t2)\n\n  // 2.5 Re-name all the tags to their read node version\n  t2 = t2.map(({ coeff, terms }) => {\n    terms = terms.map(t => {\n      const nt = nodes[t]\n      if (!nt || nt.operation !== 'read') throw Error('MUST be a read node.')\n      return nt.path[1]\n    })\n    return { coeff, terms }\n  })\n\n  // 3. call lub() on each term\n  const lins = t2.map(({ coeff, terms }) => {\n    if (terms.length === 0) return { w: {}, c: coeff, err: 0 }\n    if (terms.length === 1) return { w: { [terms[0]]: coeff }, c: 0, err: 0 }\n    const { w, c, err } = lub(terms.map(k => ({ lower: lower[k], upper: upper[k] })))\n    const retw = w.reduce((ret, wi, i) => {\n      ret[terms[i]] = wi * coeff + (ret[terms[i]] ?? 0)\n      return ret\n    }, {} as DynStat)\n    return { w: retw, c: coeff * c, err: coeff * err + linerr }\n  })\n\n  return lins.reduce((lin, l) => {\n    lin.c += l.c; lin.err += l.err\n    Object.entries(l.w).forEach(([k, v]) => lin.w[k] = v + (lin.w[k] ?? 0))\n    return lin\n  }, { w: {}, c: 0, err: 0 })\n}\n\n/**\n * Constructs an upper bounding linear form for a function x_1 * x_2 * ... * x_n\n * @param bounds upper and lower bounds for each x_i\n * @returns { w, c, err } with\n */\nfunction lub(bounds: { lower: number, upper: number }[]): { w: number[], c: number, err: number } {\n  if (bounds.length === 0) return { w: [], c: 0, err: 0 }\n  const nVar = bounds.length\n\n  // Re-scale bounds to [0, 1] for numerical stability.\n  const boundScale = bounds.map(({ upper }) => upper)\n  const scaleProd = boundScale.reduce((prod, v) => prod * v, 1)\n  bounds = bounds.map(({ lower, upper }) => ({ lower: lower / upper, upper: 1 }))\n\n  // Setting up the linear program in terms of constraints.\n  let cons = cartesian(...bounds.map(({ lower, upper }) => [lower, upper])).flatMap((coords) => {\n    const prod = coords.reduce((prod, v) => prod * v, 1)\n    return [\n      [...coords.map(v => -v), 1, 0, -prod],\n      [...coords, -1, -1, prod],\n    ]\n  })\n\n  // Force equality at upper & lower corners?\n  // cons.push([...bounds.map(lu => lu.lower), -1, 0, bounds.reduce((prod, { lower }) => prod * lower, 1)])\n  // cons.push([...bounds.map(lu => lu.upper), -1, 0, bounds.reduce((prod, { upper }) => prod * upper, 1)])\n\n  let soln: any\n  const objective = [...bounds.map(_ => 0), 0, 1]\n  try {\n    // TODO: verify solution\n    soln = solveLP(objective, cons)\n  }\n  catch (e) {\n    console.log('ERROR on bounds', bounds)\n    console.log('Possibly numerical instability issue.')\n    throw e\n  }\n  return {\n    w: soln.slice(0, nVar).map((wi, i) => wi * scaleProd / boundScale[i]),\n    c: -scaleProd * soln[nVar],\n    err: scaleProd * soln[nVar + 1]\n  }\n}\n\nexport function maxWeight(a: ArtifactsBySlot, lin: LinearForm) {\n  const baseVal = sparseMatmulMax([lin], [a.base])[0] + lin.c\n\n  return baseVal + Object.entries(a.values)\n    .reduce((maxTotVal, [slotKey, slotArts]) => maxTotVal + sparseMatmulMax([lin], slotArts.map(a => a.values))[0], 0)\n}\nexport function minWeight(a: ArtifactsBySlot, lin: LinearForm) {\n  const baseVal = sparseMatmulMin([lin], [a.base])[0] + lin.c\n\n  return baseVal + Object.entries(a.values)\n    .reduce((minTotVal, [slotKey, slotArts]) => minTotVal + sparseMatmulMin([lin], slotArts.map(a => a.values))[0], 0)\n}\n\nexport function maxWeightVec(a: ArtifactsBySlotVec, lin: LinearForm) {\n  const ixs: number[] = []\n  const w: number[] = []\n  Object.entries(lin.w).forEach(([k, ww]) => {\n    ixs.push(a.keys.indexOf(k))\n    w.push(ww)\n  })\n\n  const baseVal = ixs.reduce((accum, ix, i) => accum + a.base[ix] * w[i], lin.c)\n  return Object.values(a.values)\n    .reduce((wtot, arts) => wtot + Math.max(\n      ...arts.map(art => ixs.reduce((accum, ix, i) => accum + art.values[ix] * w[i], 0))\n    ), baseVal)\n}\nexport function minMaxWeightVec(a: ArtifactsBySlotVec, lin: LinearForm) {\n  const ixs: number[] = []\n  const w: number[] = []\n  Object.entries(lin.w).forEach(([k, ww]) => {\n    ixs.push(a.keys.indexOf(k))\n    w.push(ww)\n  })\n\n  const baseVal = ixs.reduce((accum, ix, i) => accum + a.base[ix] * w[i], lin.c)\n  const maxw = Object.values(a.values)\n    .reduce((wtot, arts) => wtot + Math.max(\n      ...arts.map(art => ixs.reduce((accum, ix, i) => accum + art.values[ix] * w[i], 0))\n    ), baseVal)\n\n  const minw = Object.values(a.values)\n    .reduce((wtot, arts) => wtot + Math.min(\n      ...arts.map(art => ixs.reduce((accum, ix, i) => accum + art.values[ix] * w[i], 0))\n    ), baseVal)\n  return { minw, maxw }\n}\n\n\n\n// Implement matrix multiply between row-major w's of LinearForm and col-major DynStats that represent artifacts.\n/**\n * Implements sparse matrix multiplication between A and x\n * @param A A list of row-major w's of some LinearForm\n * @param x A list of col-major DynStats that represent some artifacts\n * @returns A col-major 2d array number[][] with shape (A.length, x.length).\n *          ret[0] is [A1 @ x1, A2 @ x1, ..., An @ x1]\n */\nexport function sparseMatmul(A: LinearForm[], x: DynStat[]) {\n  return x.map(dyn => A.map(({ w }) => Object.entries(w).reduce((a, [k, wk]) => a + wk * (dyn[k] ?? 0), 0)))\n}\n\n/**\n * Sparse matrix multiplication between A and x, followed by a max() along the rows.\n */\nexport function sparseMatmulMax(A: LinearForm[], x: DynStat[]) {\n  return A.map(({ w }) => Math.max(...x.map(dyn => Object.entries(w).reduce((a, [k, wk]) => a + wk * (dyn[k] ?? 0), 0))))\n}\n\n/**\n * Sparse matrix multiplication between A and x, followed by a min() along the rows.\n */\nexport function sparseMatmulMin(A: LinearForm[], x: DynStat[]) {\n  return A.map(({ w }) => Math.min(...x.map(dyn => Object.entries(w).reduce((a, [k, wk]) => a + wk * (dyn[k] ?? 0), 0))))\n}\n","import { ArtSetExclusion } from \"../../../../Database/Data/BuildsettingData\";\nimport { forEachNodes, mapFormulas } from \"../../../../Formula/internal\";\nimport { allOperations, constantFold } from \"../../../../Formula/optimization\";\nimport { ConstantNode, NumNode } from \"../../../../Formula/type\";\nimport { constant, customRead, max, min } from \"../../../../Formula/utils\";\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from \"../../../../Types/consts\";\nimport { assertUnreachable, objectKeyMap, objectMap, range } from \"../../../../Util/Util\";\n\ntype DynMinMax = { [key in string]: MinMax }\ntype MinMax = { min: number, max: number }\n\ntype MicropassOperation = \"reaffine\" | \"pruneArtRange\" | \"pruneNodeRange\" | \"pruneOrder\"\nexport function pruneAll(nodes: NumNode[], minimum: number[], arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion, forced: Dict<MicropassOperation, boolean>): { nodes: NumNode[], arts: ArtifactsBySlot } {\n  let should = forced\n  /** If `key` makes progress, all operations in `value` should be performed */\n  const deps: StrictDict<MicropassOperation, Dict<MicropassOperation, true>> = {\n    pruneOrder: { pruneNodeRange: true },\n    pruneArtRange: { pruneNodeRange: true },\n    pruneNodeRange: { reaffine: true },\n    reaffine: { pruneOrder: true, pruneArtRange: true, pruneNodeRange: true }\n  }\n  let count = 0\n  while (Object.values(should).some(x => x) && count++ < 20) {\n    if (should.pruneOrder) {\n      delete should.pruneOrder\n      const newArts = pruneOrder(arts, numTop, exclusion)\n      if (arts !== newArts) {\n        arts = newArts\n        should = { ...should, ...deps.pruneOrder }\n      }\n    }\n    if (should.pruneArtRange) {\n      delete should.pruneArtRange\n      const newArts = pruneArtRange(nodes, arts, minimum)\n      if (arts !== newArts) {\n        arts = newArts\n        should = { ...should, ...deps.pruneArtRange }\n      }\n    }\n    if (should.pruneNodeRange) {\n      delete should.pruneNodeRange\n      const newNodes = pruneNodeRange(nodes, arts)\n      if (nodes !== newNodes) {\n        nodes = newNodes\n        should = { ...should, ...deps.pruneNodeRange }\n      }\n    }\n    if (should.reaffine) {\n      delete should.reaffine\n      const { nodes: newNodes, arts: newArts } = reaffine(nodes, arts)\n      if (nodes !== newNodes || arts !== newArts) {\n        nodes = newNodes\n        arts = newArts\n        should = { ...should, ...deps.reaffine }\n      }\n    }\n  }\n  return { nodes, arts }\n}\n\nexport function reaffine(nodes: NumNode[], arts: ArtifactsBySlot, forceRename: boolean = false): { nodes: NumNode[], arts: ArtifactsBySlot } {\n  const affineNodes = new Set<NumNode>(), topLevelAffine = new Set<NumNode>()\n\n  function visit(node: NumNode, isAffine: boolean) {\n    if (isAffine) affineNodes.add(node)\n    else node.operands.forEach(_op => {\n      const op = _op as NumNode\n      affineNodes.has(op) && topLevelAffine.add(op)\n    })\n  }\n\n  const dynKeys = new Set<string>()\n\n  forEachNodes(nodes, _ => { }, f => {\n    const operation = f.operation\n    switch (operation) {\n      case \"read\":\n        if (f.type !== \"number\" || f.path[0] !== \"dyn\" || f.accu !== \"add\")\n          throw new Error(`Found unsupported ${operation} node at path ${f.path} when computing affine nodes`)\n        dynKeys.add(f.path[1])\n        visit(f, true)\n        break\n      case \"add\": visit(f, f.operands.every(op => affineNodes.has(op))); break\n      case \"mul\": {\n        const nonConst = f.operands.filter(op => op.operation !== \"const\")\n        visit(f, nonConst.length === 0 || (nonConst.length === 1 && affineNodes.has(nonConst[0])))\n        break\n      }\n      case \"const\":\n        if (typeof f.value === \"string\" || f.value === undefined)\n          throw new Error(`Found constant ${f.value} while compacting`)\n        visit(f as NumNode, true); break\n      case \"res\": case \"threshold\": case \"sum_frac\":\n      case \"max\": case \"min\": visit(f, false); break\n      case \"data\": case \"subscript\": case \"lookup\": case \"match\": case \"prio\": case \"small\":\n        throw new Error(`Found unsupported ${operation} node when computing affine nodes`)\n      default: assertUnreachable(operation)\n    }\n  })\n\n  if ([...topLevelAffine].every(({ operation }) => operation === \"read\" || operation === \"const\") &&\n    Object.keys(arts.base).length === dynKeys.size)\n    return { nodes, arts }\n\n  let current = -1\n  function nextDynKey(): string {\n    while (dynKeys.has(`${++current}`));\n    return `${current}`\n  }\n\n  nodes.forEach(node => affineNodes.has(node) && topLevelAffine.add(node))\n  const affine = [...topLevelAffine].filter(f => f.operation !== \"const\")\n  const affineMap = new Map(affine.map(node => [node,\n    !forceRename && node.operation === \"read\" && node.path[0] === \"dyn\"\n      ? node\n      : { ...customRead([\"dyn\", `${nextDynKey()}`]), accu: \"add\" as const }]))\n  nodes = mapFormulas(nodes, f => affineMap.get(f as NumNode) ?? f, f => f)\n\n  function reaffineArt(stat: DynStat): DynStat {\n    const values = constantFold([...affineMap.keys()], {\n      dyn: objectMap(stat, (value) => constant(value))\n    } as any, _ => true)\n    return Object.fromEntries([...affineMap.values()].map((v, i) => [v.path[1], (values[i] as ConstantNode<number>).value]))\n  }\n  const result = {\n    nodes, arts: {\n      base: reaffineArt(arts.base),\n      values: objectKeyMap(allSlotKeys, slot =>\n        arts.values[slot].map(({ id, set, values }) => ({ id, set, values: reaffineArt(values) })))\n    }\n  }\n  const offsets = Object.entries(reaffineArt({}))\n  for (const arts of Object.values(result.arts.values))\n    for (const { values } of arts)\n      for (const [key, baseValue] of offsets)\n        values[key] -= baseValue\n  return result\n}\n/** Remove artifacts that cannot be in top `numTop` builds */\nexport function pruneOrder(arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion): ArtifactsBySlot {\n  let progress = false\n  const noRainbow = !exclusion.rainbow?.length\n  const noSwitchIn = new Set(Object.entries(exclusion).filter(([_, v]) => v.length).map(([k]) => k) as ArtifactSetKey[])\n  const noSwitchOut = new Set(Object.entries(exclusion).filter(([_, v]) => v.includes(2) && !v.includes(4)).map(([k]) => k) as ArtifactSetKey[])\n  const values = objectKeyMap(allSlotKeys, slot => {\n    const list = arts.values[slot]\n    const newList = list.filter(art => {\n      let count = 0\n      return list.every(other => {\n        const greaterEqual = Object.entries(other.values).every(([k, o]) => o >= art.values[k])\n        const greater = Object.entries(other.values).some(([k, o]) => o > art.values[k])\n        if (greaterEqual && (greater || other.id > art.id) &&\n          ((noRainbow && !noSwitchIn.has(other.set!) && !noSwitchOut.has(art.set!)) || art.set === other.set))\n          count++\n        return count < numTop\n      })\n    })\n    if (newList.length !== list.length) progress = true\n    return newList\n  })\n  return progress ? { base: arts.base, values } : arts\n}\n/** Remove artifacts that cannot reach `minimum` in any build */\nfunction pruneArtRange(nodes: NumNode[], arts: ArtifactsBySlot, minimum: number[]): ArtifactsBySlot {\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\n  const wrap = { arts }\n  while (true) {\n    const artRanges = objectKeyMap(allSlotKeys, slot => computeArtRange(wrap.arts.values[slot]))\n    const otherArtRanges = objectKeyMap(allSlotKeys, key =>\n      addArtRange(Object.entries(artRanges).map(a => a[0] === key ? baseRange : a[1]).filter(x => x)))\n\n    let progress = false\n    const values = objectKeyMap(allSlotKeys, slot => {\n      const result = wrap.arts.values[slot].filter(art => {\n        const read = addArtRange([computeArtRange([art]), otherArtRanges[slot]])\n        const newRange = computeNodeRange(nodes, read)\n        return nodes.every((node, i) => newRange.get(node)!.max >= (minimum[i] ?? -Infinity))\n      })\n      if (result.length !== wrap.arts.values[slot].length)\n        progress = true\n      return result\n    })\n    if (!progress) break\n    wrap.arts = { base: wrap.arts.base, values }\n  }\n  return wrap.arts\n}\nfunction pruneNodeRange(nodes: NumNode[], arts: ArtifactsBySlot): NumNode[] {\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\n  const reads = addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\n  const nodeRange = computeNodeRange(nodes, reads)\n\n  return mapFormulas(nodes, f => {\n    const { operation } = f\n    const operandRanges = f.operands.map(x => nodeRange.get(x)!)\n    switch (operation) {\n      case \"threshold\": {\n        const [value, threshold, pass, fail] = operandRanges\n        if (value.min >= threshold.max) return f.operands[2]\n        else if (value.max < threshold.min) return constant(0)\n        if (pass.max === pass.min &&\n          fail.max === fail.min &&\n          pass.min === fail.min && isFinite(pass.min))\n          return constant(pass.max)\n        break\n      }\n      case \"min\": {\n        const newOperands = f.operands.filter((_, i) => {\n          const op1 = operandRanges[i]\n          return operandRanges.every((op2, j) => op1.min <= op2.max)\n        })\n        if (newOperands.length < operandRanges.length) return min(...newOperands)\n        break\n      }\n      case \"max\": {\n        const newOperands = f.operands.filter((_, i) => {\n          const op1 = operandRanges[i]\n          return operandRanges.every(op2 => op1.max >= op2.min)\n        })\n        if (newOperands.length < operandRanges.length) return max(...newOperands)\n        break\n      }\n    }\n    return f\n  }, f => f)\n}\nfunction addArtRange(ranges: DynMinMax[]): DynMinMax {\n  const result: DynMinMax = {}\n  ranges.forEach(range => {\n    Object.entries(range).forEach(([key, value]) => {\n      if (result[key]) {\n        result[key].min += value.min\n        result[key].max += value.max\n      } else result[key] = { ...value }\n    })\n  })\n  return result\n}\nfunction computeArtRange(arts: ArtifactBuildData[]): DynMinMax {\n  const result: DynMinMax = {}\n  if (arts.length) {\n    Object.keys(arts[0].values)\n      .filter(key => arts.every(art => art.values[key]))\n      .forEach(key => result[key] = { min: arts[0].values[key], max: arts[0].values[key] })\n    arts.forEach(({ values }) => {\n      for (const [key, value] of Object.entries(values)) {\n        if (!result[key]) result[key] = { min: 0, max: value }\n        else {\n          if (result[key].max < value) result[key].max = value\n          if (result[key].min > value) result[key].min = value\n        }\n      }\n    })\n  }\n  return result\n}\nfunction computeNodeRange(nodes: NumNode[], reads: DynMinMax): Map<NumNode, MinMax> {\n  const range = new Map<NumNode, MinMax>()\n\n  forEachNodes(nodes, _ => { }, _f => {\n    const f = _f as NumNode\n    const { operation } = f\n    const operands = f.operands.map(op => range.get(op)!)\n    let current: MinMax\n    switch (operation) {\n      case \"read\":\n        if (f.path[0] !== \"dyn\")\n          throw new Error(`Found non-dyn path ${f.path} while computing range`)\n        current = reads[f.path[1]] ?? { min: 0, max: 0 }\n        break\n      case \"const\": current = computeMinMax([f.value]); break\n      case \"subscript\": current = computeMinMax(f.list); break\n      case \"add\": case \"min\": case \"max\":\n        current = {\n          min: allOperations[operation](operands.map(x => x.min)),\n          max: allOperations[operation](operands.map(x => x.max)),\n        }; break\n      case \"res\": current = {\n        min: allOperations[operation]([operands[0].max]),\n        max: allOperations[operation]([operands[0].min]),\n      }; break\n      case \"mul\": current = operands.reduce((accu, current) => computeMinMax([\n        accu.min * current.min, accu.min * current.max,\n        accu.max * current.min, accu.max * current.max,\n      ])); break\n      case \"threshold\":\n        if (operands[0].min >= operands[1].max) current = operands[2]\n        else if (operands[0].max < operands[1].min) current = computeMinMax([0])\n        else current = computeMinMax([0], [operands[2]])\n        break\n      case \"sum_frac\": {\n        const [x, c] = operands, sum = { min: x.min + c.min, max: x.max + c.max }\n        if (sum.min <= 0 && sum.max >= 0)\n          current = (x.min <= 0 && x.max >= 0) ? { min: NaN, max: NaN } : { min: -Infinity, max: Infinity }\n        else\n          // TODO: Check this\n          current = computeMinMax([\n            x.min / sum.min, x.min / sum.max,\n            x.max / sum.min, x.max / sum.max\n          ])\n        break\n      }\n      case \"data\": case \"lookup\": case \"match\":\n        throw new Error(`Unsupported ${operation} node`)\n      default: assertUnreachable(operation)\n    }\n    range.set(f, current)\n  })\n  return range\n}\nfunction computeMinMax(values: readonly number[], minMaxes: readonly MinMax[] = []): MinMax {\n  const max = Math.max(...values, ...minMaxes.map(x => x.max))\n  const min = Math.min(...values, ...minMaxes.map(x => x.min))\n  return { min, max }\n}\n\nexport function filterArts(arts: ArtifactsBySlot, filters: RequestFilter): ArtifactsBySlot {\n  return {\n    base: arts.base,\n    values: objectKeyMap(allSlotKeys, slot => {\n      const filter = filters[slot]\n      switch (filter.kind) {\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set!))\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set!))\n      }\n    })\n  }\n}\nexport function filterArtsVec(arts: ArtifactsBySlotVec, filters: RequestFilter): ArtifactsBySlotVec {\n  return {\n    keys: arts.keys, base: arts.base, baseBuffer: arts.baseBuffer,\n    values: objectKeyMap(allSlotKeys, slot => {\n      const filter = filters[slot]\n      switch (filter.kind) {\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set!))\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set!))\n      }\n    })\n  }\n}\nexport function filterArts2(arts: ArtifactsBySlot, filterVec: StrictDict<SlotKey, number[]>): ArtifactsBySlot {\n  return {\n    base: arts.base,\n    values: objectKeyMap(allSlotKeys, slot => {\n      const filterIxs = filterVec[slot]\n      const slotVals = arts.values[slot]\n      return filterIxs.map(ix => slotVals[ix])\n    })\n  }\n}\nexport function filterArtsVec2(arts: ArtifactsBySlotVec, filterVec: StrictDict<SlotKey, number[]>): ArtifactsBySlotVec {\n  return {\n    keys: arts.keys, base: arts.base, baseBuffer: arts.baseBuffer,\n    values: objectKeyMap(allSlotKeys, slot => {\n      const filterIxs = filterVec[slot]\n      const slotVals = arts.values[slot]\n      return filterIxs.map(ix => slotVals[ix])\n    })\n  }\n}\nexport function mergeBuilds(builds: Build[][], maxNum: number): Build[] {\n  return builds.flatMap(x => x).sort((a, b) => b.value - a.value).slice(0, maxNum)\n}\nexport function mergePlot(plots: PlotData[]): PlotData {\n  let scale = 0.01, reductionScaling = 2, maxCount = 1500\n  let keys = new Set(plots.flatMap(x => Object.values(x).map(v => Math.round(v.plot! / scale))))\n  while (keys.size > maxCount) {\n    scale *= reductionScaling\n    keys = new Set([...keys].map(key => Math.round(key / reductionScaling)))\n  }\n  const result: PlotData = {}\n  for (const plot of plots)\n    for (const build of Object.values(plot)) {\n      const x = Math.round(build.plot! / scale) * scale\n      if (!result[x] || result[x]!.value < build.value)\n        result[x] = build\n    }\n  return result\n}\n\nexport function countBuilds(arts: ArtifactsBySlot): number {\n  return allSlotKeys.reduce((_count, slot) => _count * arts.values[slot].length, 1)\n}\n\n\nexport function* filterFeasiblePerm(filters: Iterable<RequestFilter>, _artSets: ArtifactsBySlot): Iterable<RequestFilter> {\n  const artSets = objectMap(_artSets.values, values => new Set(values.map(v => v.set)))\n  filter_loop: for (const filter of filters) {\n    for (const [slot, f] of Object.entries(filter)) {\n      const available = artSets[slot]!\n      switch (f.kind) {\n        case \"required\": if ([...f.sets].every(s => !available.has(s))) continue filter_loop; break\n        case \"exclude\": if ([...available].every(s => f.sets.has(s!))) continue filter_loop; break\n        case \"id\": break\n      }\n    }\n    yield filter\n  }\n}\nexport function exclusionToAllowed(exclusion: number[] | undefined): Set<number> {\n  return new Set(exclusion?.includes(2)\n    ? exclusion.includes(4) ? [0, 1] : [0, 1, 4, 5]\n    : exclusion?.includes(4) ? [0, 1, 2, 3] : [0, 1, 2, 3, 4, 5])\n}\n/** A *disjoint* set of `RequestFilter` satisfying the exclusion rules */\nexport function* artSetPerm(exclusion: ArtSetExclusion, _artSets: ArtifactSetKey[]): Iterable<RequestFilter> {\n  /**\n   * This generation algorithm is separated into two parts:\n   * - \"Shape\" generation\n   *   - It first generates all build \"shapes\", e.g., AABBC, ABBCD\n   *   - It then filters the generated shapes according to the rainbow exclusion, e.g., removes ABBCD if excluding 3 rainbows\n   *   - It then merges the remaining shapes into wildcards, e.g. AABAA + AABAB + AABAC => AABA*\n   * - Shape filling\n   *   - From the given shapes, it tries to fill in all non-rainbow slots, e.g., slots A and B of AABBC, with actual artifacts\n   *   - It then fills the rainbow slots, e.g., slot C of AABBC while ensuring the exclusion rule of each sets\n   */\n  const artSets = [...new Set(_artSets)], allowedRainbows = exclusionToAllowed(exclusion.rainbow)\n  let shapes: number[][] = []\n  function populateShapes(current: number[], list: Set<number>, rainbows: number[]) {\n    if (current.length === 5) {\n      if (allowedRainbows.has(rainbows.length))\n        shapes.push(current)\n      return\n    }\n    for (const i of list) populateShapes([...current, i], list, rainbows.filter(j => j !== i))\n    populateShapes([...current, current.length], new Set([...list, current.length]), [...rainbows, current.length])\n  }\n  populateShapes([0], new Set([0]), [0])\n  function indexOfShape(shape: number[], replacing: number) {\n    if (range(replacing + 1, 4).some(i => shape[i] !== 5))\n      return undefined\n    shape = [...shape]\n    shape[replacing] = 5\n    return shape.reduce((a, b) => a * 6 + b, 0)\n  }\n  for (let replacing = 4; replacing >= 0; replacing--) {\n    const required: Map<number, number> = new Map()\n    for (const shape of shapes) {\n      const id = indexOfShape(shape, replacing)\n      if (id === undefined) continue\n      required.set(id, (required.get(id) ?? new Set(shape.slice(0, replacing)).size + 1) - 1)\n    }\n    for (const [id, remaining] of required.entries()) {\n      if (remaining === 0) {\n        const shape = [...shapes.find(shape => indexOfShape(shape, replacing) === id)!]\n        shape[replacing] = 5\n        shapes = shapes.filter(shape => indexOfShape(shape, replacing) !== id)\n        shapes.push(shape)\n      }\n    }\n  }\n\n  // Shapes are now calculated and merged, proceed to fill in the sets\n\n  const noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\n  const result: RequestFilter = objectKeyMap(allSlotKeys, _ => noFilter)\n\n  const counts = { ...objectMap(exclusion, _ => 0), ...objectKeyMap(artSets, _ => 0) }\n  const allowedCounts = objectMap(exclusion, exclusionToAllowed)\n\n  function* check(shape: number[]) {\n    const used: Set<ArtifactSetKey> = new Set()\n    let groupped: number[][] = [], rainbows: number[] = []\n    for (const i of shape) {\n      groupped.push([])\n      if (i === 5) rainbows.push(groupped.length - 1)\n      else groupped[i].push(groupped.length - 1)\n    }\n    groupped = groupped.filter(v => v.length).sort((a, b) => b.length - a.length)\n    let usableRainbows = rainbows.length\n\n    // Inception.. because js doesn't like functions inside a for-loop\n    function* check(i: number) {\n      if (i === groupped.length)\n        return yield* check_free(0)\n\n      for (const set of artSets) {\n        if (used.has(set)) continue\n        const length = groupped[i].length, allowedSet = allowedCounts[set]\n        let requiredRainbows = 0\n\n        if (allowedSet && !allowedSet.has(length)) {\n          // Look ahead and see if we have enough rainbows to fill to the next `allowedSet` if we use the current set\n          requiredRainbows = (range(length + 1, 5).find(l => allowedSet.has(l)) ?? 6) - length\n          if (requiredRainbows > usableRainbows) continue // Not enough rainbows. Next..\n        }\n\n        used.add(set)\n        counts[set] = groupped[i].length\n        groupped[i].forEach(j => result[allSlotKeys[j]] = { kind: \"required\", sets: new Set([set]) })\n        usableRainbows -= requiredRainbows\n\n        yield* check(i + 1)\n\n        usableRainbows += requiredRainbows\n        counts[set] = 0\n        used.delete(set)\n      }\n    }\n    // We separate filling rainbow slots from groupped slots because it has an entirely\n    // different set of rules regarding what can be filled and what states to be kept.\n    function* check_free(i: number) {\n      const remaining = rainbows.length - i, isolated: ArtifactSetKey[] = [], missing: ArtifactSetKey[] = [], rejected: ArtifactSetKey[] = []\n      let required = 0\n      for (const set of artSets) {\n        const allowedSet = allowedCounts[set], count = counts[set]\n        if (!allowedSet) continue\n        if (range(1, remaining).every(j => !allowedSet.has(count + j))) rejected.push(set)\n        else if (!allowedSet.has(count)) {\n          required += [...allowedSet].find(x => x > count)! - count\n          missing.push(set)\n        }\n        else if (range(0, remaining).some(j => !allowedSet.has(count + j))) isolated.push(set)\n      }\n      if (required > remaining) return\n      if (i === rainbows.length) {\n        yield { ...result }\n        return\n      }\n      if (required === remaining) {\n        for (const set of missing) {\n          counts[set]++\n          result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\n          yield* check_free(i + 1)\n          counts[set]--\n        }\n        return\n      }\n      for (const set of [...isolated, ...missing]) {\n        counts[set]++\n        result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\n        yield* check_free(i + 1)\n        counts[set]--\n      }\n      result[allSlotKeys[rainbows[i]]] = { kind: \"exclude\", sets: new Set([...missing, ...rejected, ...isolated]) }\n      yield* check_free(i + 1)\n    }\n    yield* check(0)\n  }\n  for (const shape of shapes) yield* check(shape)\n}\n\nexport type RequestFilter = StrictDict<SlotKey,\n  { kind: \"required\", sets: Set<ArtifactSetKey> } |\n  { kind: \"exclude\", sets: Set<ArtifactSetKey> } |\n  { kind: \"id\", ids: Set<string> }\n>\nexport const emptyfilter: RequestFilter = objectKeyMap(allSlotKeys, _ => ({ kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }));\n\nexport type DynStat = { [key in string]: number }\nexport type ArtifactBuildData = {\n  id: string\n  set?: ArtifactSetKey\n  values: DynStat\n}\nexport type ArtifactsBySlot = { base: DynStat, values: StrictDict<SlotKey, ArtifactBuildData[]> }\n\n\nexport type ArtifactBuildDataVecDense = {\n  id: string\n  set?: ArtifactSetKey\n  values: number[]\n  buffer: number[]\n}\n// I dont *think* its worth it to implement sparse vectors n shit\n// export type ArtifactBuildDataVecSparse = {\n//   id: string\n//   set?: ArtifactSetKey\n//   values: number[][]\n// }\nexport type ArtifactsBySlotVec = { keys: string[], base: number[], values: StrictDict<SlotKey, ArtifactBuildDataVecDense[]>, baseBuffer: number[] }\n\nexport type PlotData = Dict<number, Build>\nexport interface Build {\n  value: number\n  plot?: number\n  artifactIds: string[]\n}\n","import { faBan, faChartLine } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { CheckBoxOutlineBlank, CheckBox, Replay, Settings } from '@mui/icons-material';\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from '@mui/material';\nimport React, { useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport SetEffectDisplay from '../../../../../Components/Artifact/SetEffectDisplay';\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\nimport CardDark from '../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport CloseButton from '../../../../../Components/CloseButton';\nimport ColorText from '../../../../../Components/ColoredText';\nimport InfoTooltip from '../../../../../Components/InfoTooltip';\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\nimport SqBadge from '../../../../../Components/SqBadge';\nimport { Stars } from '../../../../../Components/StarDisplay';\nimport { Translate } from '../../../../../Components/Translate';\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\nimport { DatabaseContext } from '../../../../../Database/Database';\nimport { DataContext, dataContextObj } from '../../../../../Context/DataContext';\nimport { UIData } from '../../../../../Formula/uiData';\nimport { constant } from '../../../../../Formula/utils';\nimport useForceUpdate from '../../../../../ReactHooks/useForceUpdate';\nimport usePromise from '../../../../../ReactHooks/usePromise';\nimport { allArtifactSets, allSlotKeys, ArtifactSetKey, SetNum, SlotKey } from '../../../../../Types/consts';\nimport { deepClone, objectKeyMap } from '../../../../../Util/Util';\nimport useBuildSetting from '../useBuildSetting';\n\nexport default function ArtifactSetConfig({ disabled }: { disabled?: boolean, }) {\n  const { t } = useTranslation([\"page_character\", \"sheet\"])\n  const dataContext = useContext(DataContext)\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey, conditional }, characterDispatch } = useContext(CharacterContext)\n  const { buildSetting: { artSetExclusion }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const [open, setOpen] = useState(false)\n  const onOpen = useCallback(() => setOpen(true), [setOpen])\n  const onClose = useCallback(() => setOpen(false), [setOpen])\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const artSetKeyList = useMemo(() => artifactSheets ? Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets)).reverse().flatMap(([, sets]) => sets).filter(key => !key.includes(\"Prayers\")) : [], [artifactSheets])\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  useEffect(() => database.arts.followAny(forceUpdate), [database, forceUpdate])\n\n  const artSlotCount = useMemo(() => {\n    const artSlotCount: Dict<ArtifactSetKey, Record<SlotKey, number>> = Object.fromEntries(artSetKeyList.map(k => [k, Object.fromEntries(allSlotKeys.map(sk => [sk, 0]))]))\n    database.arts.values.map(art => artSlotCount[art.setKey] && artSlotCount[art.setKey]![art.slotKey]++)\n    return dbDirty && artSlotCount\n  }, [dbDirty, database, artSetKeyList])\n  const allowRainbow2 = !artSetExclusion.rainbow?.includes(2)\n  const allowRainbow4 = !artSetExclusion.rainbow?.includes(4)\n\n  const { allow2, allow4, exclude2, exclude4 } = useMemo(() => ({\n    allow2: artSetKeyList.filter(k => !artSetExclusion[k]?.includes(2)).length,\n    allow4: artSetKeyList.filter(k => !artSetExclusion[k]?.includes(4)).length,\n    exclude2: artSetKeyList.filter(k => artSetExclusion[k]?.includes(2)).length,\n    exclude4: artSetKeyList.filter(k => artSetExclusion[k]?.includes(4)).length,\n  }), [artSetKeyList, artSetExclusion])\n  const artifactCondCount = useMemo(() =>\n    (Object.keys(conditional)).filter(k =>\n      allArtifactSets.includes(k as ArtifactSetKey) && Object.keys(conditional[k]).length !== 0).length\n    , [conditional])\n  const fakeDataContextObj = useMemo(() => fakeData(dataContext), [dataContext])\n  const resetArtConds = useCallback(() => {\n    const tconditional = Object.fromEntries(Object.entries(conditional).filter(([k, v]) => !allArtifactSets.includes(k as any)))\n    characterDispatch({ conditional: tconditional })\n  }, [conditional, characterDispatch]);\n  const setAllExclusion = useCallback(\n    (setnum: number, exclude = true) => {\n      const artSetExclusion_ = deepClone(artSetExclusion)\n      artSetKeyList.forEach(k => {\n        if (exclude) artSetExclusion_[k] = [...(artSetExclusion_[k] ?? []), setnum];\n        else if (artSetExclusion_[k]) artSetExclusion_[k] = artSetExclusion_[k].filter(n => n !== setnum);\n      })\n      buildSettingDispatch({ artSetExclusion: artSetExclusion_ })\n    },\n    [artSetKeyList, artSetExclusion, buildSettingDispatch],\n  )\n\n  return <>\n    <CardLight sx={{ display: \"flex\" }}>\n      <CardContent sx={{ flexGrow: 1 }} >\n        <Typography>\n          <strong>{t`tabOptimize.artSetConfig.title`}</strong>\n        </Typography>\n        <Typography>{t`tabOptimize.artSetConfig.setEffCond`} <SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"tabOptimize.artSetConfig.enabled\")}</SqBadge></Typography>\n        <Typography>{t`sheet:2set`} <SqBadge color=\"success\">{allow2} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.allowed\")}</SqBadge>{!!exclude2 && \" / \"}{!!exclude2 && <SqBadge color=\"secondary\">{exclude2} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.excluded\")}</SqBadge>}</Typography>\n        <Typography>{t`sheet:4set`} <SqBadge color=\"success\">{allow4} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.allowed\")}</SqBadge>{!!exclude4 && \" / \"}{!!exclude4 && <SqBadge color=\"secondary\">{exclude4} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.excluded\")}</SqBadge>}</Typography>\n        <Typography>{t`tabOptimize.artSetConfig.2rainbow`} <SqBadge color={allowRainbow2 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow2 ? t<string>(\"tabOptimize.artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\n        <Typography>{t`tabOptimize.artSetConfig.4rainbow`} <SqBadge color={allowRainbow4 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow4 ? t<string>(\"tabOptimize.artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\n      </CardContent>\n      <Button onClick={onOpen} disabled={disabled} color=\"info\" sx={{ borderRadius: 0 }}>\n        <Settings />\n      </Button>\n    </CardLight>\n    {artifactSheets && <ModalWrapper open={open} onClose={onClose} ><CardDark>\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\n        <Typography variant=\"h6\" >{t`tabOptimize.artSetConfig.title`}</Typography>\n        <CloseButton onClick={onClose} />\n      </CardContent>\n      <Divider />\n      <CardContent >\n        <CardLight sx={{ mb: 1 }}><CardContent>\n          <Box display=\"flex\" gap={1}>\n            <Typography><strong>{t`tabOptimize.artSetConfig.modal.setCond.title`}</strong></Typography>\n            <Typography sx={{ flexGrow: 1 }}><SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"tabOptimize.artSetConfig.selected\")}</SqBadge></Typography>\n            <Button size='small' onClick={resetArtConds} color=\"error\" startIcon={<Replay />}>{t`tabOptimize.artSetConfig.modal.setCond.reset`}</Button>\n          </Box>\n          <Typography>{t`tabOptimize.artSetConfig.modal.setCond.text`}</Typography>\n        </CardContent></CardLight>\n        <CardLight sx={{ mb: 1 }}><CardContent>\n          <Typography sx={{ flexGrow: 1 }}><strong>\n            <Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.title\" >Artifact Sets <ColorText color='success'>Allowed<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Excluded<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText></Trans>\n          </strong></Typography>\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.intro\">You can allow/exclude which sets you want the builder to consider. In the following examples, <strong>A</strong> is on-set, and <strong>R</strong> is rainbow(off-set)</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.2set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 2-Set</ColorText></strong> would exclude 2-Set builds: <strong><ColorText color='secondary' variant='light'>AA</ColorText>RRR</strong> and <strong><ColorText color='secondary' variant='light'>AAA</ColorText>RR</strong>.</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.4set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 4-Set</ColorText></strong> would exclude 4-Set builds: <strong><ColorText color='secondary' variant='light'>AAAA</ColorText>R</strong> and <strong><ColorText color='secondary' variant='light'>AAAAA</ColorText></strong>.</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.2rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 3-Rainbow</ColorText></strong> would exclude 2-Set + 3-Rainbow builds: <strong>AA<ColorText color='secondary' variant='light'>RRR</ColorText></strong> and <strong>AAA<ColorText color='secondary' variant='light'>RR</ColorText></strong>.</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.4rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 5-Rainbow</ColorText></strong> would exclude full 5-Rainbow builds: <strong><ColorText color='secondary' variant='light'>RRRRR</ColorText></strong>.</Trans></Typography>\n        </CardContent></CardLight>\n        <Grid container columns={{ xs: 2, lg: 3 }} sx={{ mb: 1 }} spacing={1}>\n          <Grid item xs={1}>\n            <AllSetAllowExcludeCard setNum={2} numAllow={allow2} numExclude={exclude2} setAllExclusion={setAllExclusion} />\n          </Grid>\n          <Grid item xs={1}>\n            <AllSetAllowExcludeCard setNum={4} numAllow={allow4} numExclude={exclude4} setAllExclusion={setAllExclusion} />\n          </Grid>\n          <Grid item xs={1}>\n            <CardLight>\n              <CardContent>\n                <Typography gutterBottom><strong><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.alExRainbow\"><ColorText color='success'>Allow <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Exclude <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText> Rainbow Builds</Trans></strong></Typography>\n                <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 2 })} color={allowRainbow2 ? \"success\" : \"secondary\"} startIcon={!allowRainbow2 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`tabOptimize.artSetConfig.2rainbow`}</Button>\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 4 })} color={allowRainbow4 ? \"success\" : \"secondary\"} startIcon={!allowRainbow4 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`tabOptimize.artSetConfig.4rainbow`}</Button>\n                </Box>\n              </CardContent>\n            </CardLight>\n          </Grid>\n        </Grid>\n        <Grid container spacing={1} columns={{ xs: 2, lg: 3 }}>\n          {artSetKeyList.map(setKey => {\n            return <ArtifactSetCard key={setKey} setKey={setKey} sheet={artifactSheets[setKey]} fakeDataContextObj={fakeDataContextObj} slotCount={artSlotCount[setKey]!} />\n          })}\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent sx={{ py: 1 }}>\n        <CloseButton large onClick={onClose} />\n      </CardContent>\n    </CardDark></ModalWrapper >}\n  </>\n}\nfunction AllSetAllowExcludeCard({ numAllow, numExclude, setNum, setAllExclusion }: { numAllow: number, numExclude: number, setNum: 2 | 4, setAllExclusion: (setNum: 2 | 4, exclude?: boolean) => void }) {\n  const { t } = useTranslation([\"page_character\", \"sheet\"])\n  return <CardLight>\n    <CardContent>\n      <Typography gutterBottom><strong>{t(`sheet:${setNum}set`)}</strong> <SqBadge color=\"success\">{numAllow} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.allowed\")}</SqBadge>{!!numExclude && \" / \"}{!!numExclude && <SqBadge color=\"secondary\">{numExclude} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.excluded\")}</SqBadge>}</Typography>\n      <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n        <Button fullWidth disabled={!numExclude} onClick={() => setAllExclusion(setNum, false)} color='success' startIcon={<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" />}>{t(`tabOptimize.artSetConfig.allowAll${setNum}set`)}</Button>\n        <Button fullWidth disabled={!numAllow} onClick={() => setAllExclusion(setNum, true)} color='secondary' startIcon={<FontAwesomeIcon icon={faBan} className=\"fa-fw\" />}>{t(`tabOptimize.artSetConfig.excludeAll${setNum}set`)}</Button>\n      </Box>\n    </CardContent>\n  </CardLight>\n}\nfunction ArtifactSetCard({ sheet, setKey, fakeDataContextObj, slotCount }: { setKey: ArtifactSetKey, sheet: ArtifactSheet, fakeDataContextObj: dataContextObj, slotCount: Record<SlotKey, number> }) {\n  const { t } = useTranslation(\"sheet\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\n  const setExclusionSet = buildSetting?.artSetExclusion?.[setKey] ?? []\n  const allow4 = !setExclusionSet.includes(4)\n  const slots = useMemo(() => Object.values(slotCount).reduce((tot, v) => tot + (v ? 1 : 0), 0), [slotCount])\n\n  /* Assumes that all conditionals are from 4-Set. needs to change if there are 2-Set conditionals */\n  const set4CondNums = useMemo(() => {\n    if (!allow4 || slots < 4) return []\n    return Object.keys(sheet.setEffects).filter(setNumKey => sheet.setEffects[setNumKey]?.document.some(doc => \"states\" in doc))\n  }, [sheet.setEffects, allow4, slots])\n  const exclude2 = setExclusionSet.includes(2)\n  const exclude4 = setExclusionSet.includes(4)\n  if (slots < 2) return null\n  return <Grid item key={setKey} xs={1}>\n    <CardLight sx={{ height: \"100%\" }}>\n      <Box className={`grad-${sheet.rarity[0]}star`} width=\"100%\" sx={{ display: \"flex\" }} >\n        <Box component=\"img\" src={sheet.defIconSrc} sx={{ height: 100, width: \"auto\" }} />\n        <Box sx={{ flexGrow: 1, px: 1, display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }}>\n          <Typography variant=\"h6\">{sheet.name ?? \"\"}</Typography>\n          <Box display=\"flex\" gap={1}>\n            <Typography variant=\"subtitle1\">{sheet.rarity.map((ns, i) => <span key={ns}>{ns} <Stars stars={1} /> {i < (sheet.rarity.length - 1) ? \"/ \" : null}</span>)}</Typography>\n            {/* If there is ever a 2-Set conditional, we will need to change this */}\n            <InfoTooltip title={<Box>\n              <Typography><SqBadge color=\"success\">{t`2set`}</SqBadge></Typography>\n              <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.2\"} /></Typography>\n              <Box paddingTop={1} sx={{ opacity: setExclusionSet.includes(4) ? 0.6 : 1 }} >\n                <Typography><SqBadge color=\"success\">{t`4set`}</SqBadge></Typography>\n                <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.4\"} /></Typography>\n              </Box>\n            </Box>} />\n          </Box>\n          <Box sx={{ display: \"flex\", gap: 1 }}>{Object.entries(slotCount).map(([slotKey, count]) => <Typography key={slotKey} sx={{ flexGrow: 1 }} variant=\"subtitle1\" ><SqBadge sx={{ width: \"100%\" }} color={count ? \"primary\" : \"secondary\"}>{artifactSlotIcon(slotKey)} {count}</SqBadge></Typography>)}</Box>\n        </Box>\n      </Box>\n      <ButtonGroup sx={{ \".MuiButton-root\": { borderRadius: 0 } }} fullWidth>\n        {slots >= 2 && <Button startIcon={exclude2 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 2 })} color={exclude2 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude2 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`2set`}</Button>}\n        {slots >= 4 && <Button startIcon={exclude4 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 4 })} color={exclude4 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude4 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`4set`}</Button>}\n      </ButtonGroup>\n\n      {!!set4CondNums.length && <DataContext.Provider value={fakeDataContextObj}>\n        <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n          {set4CondNums.map(setNumKey =>\n            <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\n          )}\n        </CardContent>\n      </DataContext.Provider>}\n    </CardLight>\n  </Grid >\n}\nfunction fakeData(currentContext: dataContextObj): dataContextObj {\n  return {\n    ...currentContext,\n    data: new UIData({ ...currentContext.data.data[0], artSet: objectKeyMap(allArtifactSets, _ => constant(4)) }, undefined)\n  }\n}\n","import { MenuItem } from \"@mui/material\"\nimport { useTranslation } from \"react-i18next\"\nimport DropdownButton from \"../../../../../Components/DropdownMenu/DropdownButton\"\n\nconst levels = [0, 4, 8, 12, 16, 20] as const\nexport default function AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\n  const { t } = useTranslation(\"page_character\")\n  return <DropdownButton fullWidth color={mainStatAssumptionLevel ? \"success\" : \"primary\"} disabled={disabled}\n    title={mainStatAssumptionLevel ? t(\"tabOptimize.assumptionLvl.lvl\", { lvl: mainStatAssumptionLevel }) : t(\"tabOptimize.assumptionLvl.no\")}>\n    {levels.map((lvl) => <MenuItem key={lvl} onClick={() => setmainStatAssumptionLevel(lvl)}>{lvl ? t(\"tabOptimize.assumptionLvl.lvl\", { lvl }) : t(\"tabOptimize.assumptionLvl.no\")}</MenuItem>)}\n  </DropdownButton>\n}\n","import { CardContent, Divider, Typography } from '@mui/material';\nimport { useContext } from 'react';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport { NodeFieldDisplay } from '../../../../../Components/FieldDisplay';\nimport { DataContext } from '../../../../../Context/DataContext';\nimport { uiInput as input } from '../../../../../Formula';\nimport { NumNode } from '../../../../../Formula/type';\nexport default function BonusStatsCard() {\n  const { character: { bonusStats } } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const bonusStatsKeys = Object.keys(bonusStats)\n  if (!bonusStatsKeys.length) return null\n  const nodes = bonusStatsKeys.map(k => data.get(input.customBonus[k] as NumNode))\n  return <CardLight>\n    <CardContent sx={{ py: 1 }}>\n      <Typography>Bonus Stats</Typography>\n    </CardContent>\n    <Divider />\n    <CardContent>\n      {nodes.map(n => <NodeFieldDisplay key={n.info.key} node={n} />)}\n    </CardContent>\n  </CardLight>\n}\n","import { Alert, Grid, LinearProgress, styled, Typography } from '@mui/material';\nimport { ReactNode } from 'react';\nimport { timeStringMs } from '../../../../../Util/TimeUtil';\n\nexport const warningBuildNumber = 10000000\nexport type BuildStatus = {\n  type: \"active\" | \"inactive\"\n  tested: number      // tested, including `failed`\n  failed: number      // tested but fail the filter criteria, e.g., not enough EM\n  skipped: number\n  total: number\n  startTime?: number\n  finishTime?: number\n}\n\nconst Monospace = styled(\"strong\")({\n  fontFamily: \"monospace\"\n})\n\nconst BorderLinearProgress = styled(LinearProgress)(({ theme }) => ({\n  height: 10,\n  borderRadius: 5,\n}));\nexport default function BuildAlert({ status: { type, tested, failed, skipped, total, startTime, finishTime }, characterName }: { status: BuildStatus, characterName: Displayable }) {\n  const hasTotal = isFinite(total)\n\n  const generatingBuilds = type !== \"inactive\"\n  const unskipped = total - skipped\n\n  const testedString = <Monospace>{tested.toLocaleString()}</Monospace>\n  const unskippedString = <Monospace>{unskipped.toLocaleString()}</Monospace>\n  const skippedText = !!skipped && <span>(<b>{<Monospace>{skipped.toLocaleString()}</Monospace>}</b> skipped)</span>\n\n  const durationString = <Monospace>{timeStringMs(Math.round((finishTime ?? performance.now()) - (startTime ?? NaN)))}</Monospace>\n\n  let color = \"success\" as \"success\" | \"warning\" | \"error\"\n  let title = \"\" as ReactNode\n  let subtitle = \"\" as ReactNode\n  let progress = undefined as undefined | number\n\n  if (generatingBuilds) {\n    progress = (skipped + tested) * 100 / (skipped + unskipped)\n    title = <Typography>Generating and testing {testedString}{hasTotal ? <>/{unskippedString}</> : undefined} build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\n    subtitle = <Typography>Time elapsed: {durationString}</Typography>\n  } else if (tested + skipped) {\n    progress = 100\n    title = <Typography>Generated and tested {testedString} Build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\n    subtitle = <Typography>Total duration: {durationString}</Typography>\n  } else {\n    return null\n  }\n\n  return <Alert severity={color} variant=\"filled\" sx={{\n    \"& .MuiAlert-message\": {\n      flexGrow: 1\n    }\n  }}>\n    {title}\n    {subtitle}\n    {progress !== undefined && <Grid container spacing={1} alignItems=\"center\">\n      {hasTotal && <Grid item>\n        <Typography>{`${progress.toFixed(1)}%`}</Typography>\n      </Grid>}\n      <Grid item flexGrow={1} >\n        <BorderLinearProgress variant={hasTotal ? \"determinate\" : \"indeterminate\"} value={progress} color=\"primary\" />\n      </Grid>\n    </Grid>}\n  </Alert>\n}\n","import { CheckBox, CheckBoxOutlineBlank, Download, Info } from '@mui/icons-material';\nimport { Button, CardContent, Collapse, Divider, Grid, MenuItem, styled, Tooltip, Typography } from '@mui/material';\nimport { useContext, useMemo, useState } from 'react';\nimport { CartesianGrid, ComposedChart, Legend, Line, ResponsiveContainer, Scatter, XAxis, YAxis, ZAxis } from 'recharts';\nimport CardDark from '../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport DropdownButton from '../../../../../Components/DropdownMenu/DropdownButton';\nimport { DataContext } from '../../../../../Context/DataContext';\nimport { uiInput as input } from '../../../../../Formula';\nimport { NumNode } from '../../../../../Formula/type';\nimport KeyMap from '../../../../../KeyMap';\nimport { MainStatKey, SubstatKey } from '../../../../../Types/artifact';\nimport { Build } from '../common';\n\nexport type ChartData = {\n  valueNode: NumNode,\n  plotNode: NumNode,\n  data: Build[]\n}\ntype ChartCardProps = {\n  chartData?: ChartData\n  plotBase: MainStatKey | SubstatKey | \"\",\n  setPlotBase: (key: MainStatKey | SubstatKey | \"\") => void\n  disabled?: boolean\n}\ntype Point = { x: number, y: number, min?: number }\nexport default function ChartCard({ chartData, plotBase, setPlotBase, disabled = false }: ChartCardProps) {\n  const [showDownload, setshowDownload] = useState(false)\n  const [showMin, setshowMin] = useState(true)\n  const { data } = useContext(DataContext)\n  const statKeys = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\n  if (data.get(input.weaponType).value !== \"catalyst\") statKeys.push(\"physical_dmg_\")\n  statKeys.push(`${data.get(input.charEle).value}_dmg_`)\n\n  const { displayData, downloadData } = useMemo(() => {\n    if (!chartData) return { displayData: null, downloadData: null }\n    const points = chartData.data.map(({ value: y, plot: x }) => ({ x, y })) as Point[]\n    const increasingX: Point[] = points.sort((a, b) => a.x - b.x)\n    const minimumData: Point[] = []\n    for (const point of increasingX) {\n      let last: Point | undefined\n      while ((last = minimumData.pop())) {\n        if (last.y > point.y) {\n          minimumData.push(last)\n          break\n        }\n      }\n      minimumData.push(point)\n    }\n\n    // Note:\n    // We can also just use `minimumData` if the plotter supports multiple data sources.\n    // It could be faster too since there're no empty entries in `minimumData`.\n    if (minimumData[0]?.x !== increasingX[0]?.x)\n      increasingX[0].min = minimumData[0].y\n    minimumData.forEach(x => { x.min = x.y })\n\n    const downloadData = {\n      minimum: minimumData.map(({ x, y }) => [x, y]),\n      allData: increasingX.map(({ x, y }) => [x, y]),\n    }\n    return { displayData: increasingX, downloadData }\n  }, [chartData])\n\n  return <CardLight>\n    <CardContent>\n      <Grid container spacing={1} alignItems=\"center\">\n        <Grid item>\n          <Typography variant=\"h6\" >Optimization Target vs</Typography>\n        </Grid>\n        <Grid item>\n          <DropdownButton title={plotBase ? KeyMap.get(plotBase) : \"Not Selected\"}\n            color={plotBase ? \"success\" : \"primary\"}\n            disabled={disabled}\n          >\n            <MenuItem onClick={() => { setPlotBase(\"\") }}>Unselect</MenuItem>\n            <Divider />\n            {statKeys.map(sKey => <MenuItem key={sKey} onClick={() => { setPlotBase(sKey as any) }}>{KeyMap.get(sKey)}</MenuItem>)}\n          </DropdownButton>\n        </Grid>\n        <Grid item flexGrow={1}>\n          <Tooltip placement=\"top\" title=\"Using data from the builder, this will generate a graph to visualize Optimization Target vs. a selected stat. The graph will show the maximum Optimization Target value per 0.01 of the selected stat.\">\n            <Info />\n          </Tooltip>\n        </Grid>\n        {!!downloadData && <Grid item>\n          <Button startIcon={showMin ? <CheckBox /> : <CheckBoxOutlineBlank />}\n            color={showMin ? \"success\" : \"secondary\"}\n            onClick={() => setshowMin(!showMin)}>Show Min Stat Threshold</Button>\n        </Grid>}\n        {!!downloadData && <Grid item>\n          <Button color=\"info\" startIcon={<Download />} onClick={() => setshowDownload(!showDownload)}>Download Data</Button>\n        </Grid>}\n      </Grid>\n    </CardContent>\n    {!!displayData && <Divider />}\n    {chartData && !!displayData && <CardContent>\n      <Collapse in={!!downloadData && showDownload}>\n        <CardDark sx={{ mb: 2 }}>\n          <CardContent>\n            <Typography>Min Data</Typography>\n            <DataDisplay data={downloadData?.minimum} />\n            <Typography>All Data</Typography>\n            <DataDisplay data={downloadData?.allData} />\n          </CardContent>\n        </CardDark>\n      </Collapse>\n      <Chart displayData={displayData} plotNode={chartData.plotNode} valueNode={chartData.valueNode} showMin={showMin} />\n    </CardContent>}\n  </CardLight >\n}\nconst TextArea = styled(\"textarea\")({\n  width: \"100%\",\n  fontFamily: \"monospace\",\n  resize: \"vertical\",\n  minHeight: \"5em\"\n})\nfunction DataDisplay({ data, }: { data?: object }) {\n  return <TextArea readOnly value={JSON.stringify(data)} onClick={e => {\n    const target = e.target as HTMLTextAreaElement;\n    target.selectionStart = 0;\n    target.selectionEnd = target.value.length;\n  }} />\n}\nfunction Chart({ displayData, plotNode, valueNode, showMin }: {\n  displayData: Point[],\n  plotNode: NumNode,\n  valueNode: NumNode,\n  showMin: boolean\n}) {\n  const plotBaseUnit = KeyMap.unit(plotNode.info?.key)\n  const valueUnit = KeyMap.unit(valueNode.info?.key)\n  return <ResponsiveContainer width=\"100%\" height={600}>\n    <ComposedChart data={displayData}>\n      <CartesianGrid strokeDasharray=\"3 3\" />\n      <XAxis dataKey=\"x\" scale=\"linear\" unit={plotBaseUnit} domain={[\"auto\", \"auto\"]} tick={{ fill: 'white' }} type=\"number\" tickFormatter={n => n > 10000 ? n.toFixed() : n.toFixed(1)} />\n      <YAxis name=\"DMG\" domain={[\"auto\", \"auto\"]} unit={valueUnit} allowDecimals={false} tick={{ fill: 'white' }} type=\"number\" />\n      <ZAxis dataKey=\"y\" range={[3, 25]} />\n      <Legend />\n      <Scatter name=\"Optimization Target\" dataKey=\"y\" fill=\"#8884d8\" line lineType=\"fitting\" isAnimationActive={false} />\n      {showMin && <Line name=\"Minimum Stat Requirement Threshold\" dataKey=\"min\" stroke=\"#ff7300\" type=\"stepBefore\" connectNulls strokeWidth={2} isAnimationActive={false} />}\n    </ComposedChart>\n  </ResponsiveContainer>\n}\n","import { Replay } from '@mui/icons-material';\nimport { Button, CardContent, Divider, Grid, Typography } from '@mui/material';\nimport { Box } from '@mui/system';\nimport React, { useContext } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\nimport BootstrapTooltip from '../../../../../Components/BootstrapTooltip';\nimport SqBadge from '../../../../../Components/SqBadge';\nimport StatIcon, { uncoloredEleIcons } from '../../../../../Components/StatIcon';\nimport Artifact from '../../../../../Data/Artifacts/Artifact';\nimport KeyMap from '../../../../../KeyMap';\nimport { allElementsWithPhy } from '../../../../../Types/consts';\nimport useBuildSetting from '../useBuildSetting';\n\nexport const artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\n\nexport default function MainStatSelectionCard({ disabled = false, }: {\n  disabled?: boolean\n}) {\n  const { t } = useTranslation(\"artifact\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { mainStatKeys }, buildSettingDispatch } = useBuildSetting(characterKey)\n\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n    {artifactsSlotsToSelectMainStats.map(slotKey => {\n      const numSel = mainStatKeys[slotKey].length\n      return <Box key={slotKey}>\n        <Divider />\n        <CardContent sx={{ pt: 1 }}>\n          <Box sx={{ display: \"flex\", gap: 1, alignItems: \"center\", pb: 1 }}>\n            <BootstrapTooltip placement=\"top\" title={<Typography>{t(`slotName.${slotKey}`)}</Typography>}>\n              <span>{artifactSlotIcon(slotKey)}</span>\n            </BootstrapTooltip>\n            <Box flexGrow={1}>\n              <SqBadge color=\"info\">{numSel ? `${numSel} Selected` : `Any`}</SqBadge>\n            </Box>\n            <Button color=\"error\" size=\"small\" disabled={!mainStatKeys[slotKey].length || disabled} sx={{ mt: -1, mb: -1 }}\n              onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey })}>\n              <Replay />\n            </Button>\n          </Box>\n          <Grid container spacing={1}>\n            {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\n              const element = allElementsWithPhy.find(ele => mainStatKey.includes(ele))\n              const color = mainStatKeys[slotKey].includes(mainStatKey)\n                ? element ?? \"success\"\n                : \"secondary\"\n              return <Grid item key={mainStatKey} flexGrow={1} xs={i < 3 ? 4 : undefined} >\n                <BootstrapTooltip placement=\"top\" title={<Typography><strong>{KeyMap.getArtStr(mainStatKey)}</strong></Typography>} disableInteractive>\n                  <Button fullWidth size=\"small\" color={color} sx={{ fontSize: \"1.2em\", height: \"100%\", pointerEvents: disabled ? \"none\" : undefined, cursor: disabled ? \"none\" : undefined }}\n                    onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })}>\n                    {element ? uncoloredEleIcons[element] : StatIcon[mainStatKey]}\n                  </Button>\n                </BootstrapTooltip>\n              </Grid>\n            })}\n          </Grid>\n        </CardContent>\n      </Box>\n    })}\n  </Box >\n}\n","import { Masonry } from '@mui/lab';\nimport { Button, CardContent, CardHeader, Divider, MenuItem, MenuList } from '@mui/material';\nimport React, { useCallback, useContext, useState } from 'react';\nimport CardDark from '../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport ColorText from '../../../../../Components/ColoredText';\nimport ImgIcon from '../../../../../Components/Image/ImgIcon';\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\nimport { DataContext } from '../../../../../Context/DataContext';\nimport { getDisplayHeader, getDisplaySections } from '../../../../../Formula/DisplayUtil';\nimport { DisplaySub } from '../../../../../Formula/type';\nimport { NodeDisplay } from '../../../../../Formula/uiData';\nimport KeyMap from '../../../../../KeyMap';\nimport usePromise from '../../../../../ReactHooks/usePromise';\nimport { objPathValue } from '../../../../../Util/Util';\n\nexport default function OptimizationTargetSelector({ optimizationTarget, setTarget, disabled = false }: {\n  optimizationTarget?: string[], setTarget: (target: string[]) => void, disabled\n}) {\n  const [open, setOpen] = useState(false)\n  const onOpen = useCallback(() => !disabled && setOpen(true), [setOpen, disabled])\n  const onClose = useCallback(() => setOpen(false), [setOpen])\n\n  const setTargetHandler = useCallback(\n    (target: string[]) => {\n      onClose()\n      setTarget(target)\n    },\n    [onClose, setTarget],\n  )\n  const { data } = useContext(DataContext)\n  const sections = getDisplaySections(data)\n  return <>\n    <Button color=\"white\" onClick={onOpen} disabled={disabled} >\n      <TargetDisplayText optimizationTarget={optimizationTarget} />\n    </Button>\n    <ModalWrapper open={open} onClose={onClose}>\n      <CardDark >\n        <CardContent>\n          <Masonry columns={{ xs: 1, sm: 2, md: 3 }} spacing={1}>\n            {sections.map(([key, Nodes]) =>\n              <SelectorSection key={key} displayNs={Nodes} sectionKey={key} setTarget={setTargetHandler} />)}\n          </Masonry >\n        </CardContent>\n      </CardDark>\n    </ModalWrapper>\n  </>\n}\nfunction SelectorSection({ displayNs, sectionKey, setTarget }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string, setTarget: (target: string[]) => void }) {\n  const { data } = useContext(DataContext)\n  const header = usePromise(() => getDisplayHeader(data, sectionKey), [data, sectionKey])\n  return <CardLight key={sectionKey as string}>\n    {header && <CardHeader avatar={header.icon && <ImgIcon size={2} sx={{ m: -1 }} src={header.icon} />} title={header.title} action={header.action} titleTypographyProps={{ variant: \"subtitle1\" }} />}\n    <Divider />\n    <MenuList>\n      {Object.entries(displayNs).map(([key, n]) =>\n        <TargetSelectorMenuItem key={key} node={n} onClick={() => setTarget([sectionKey, key])} />)}\n    </MenuList>\n  </CardLight>\n}\nfunction NoTarget() {\n  return <b>Select an Optimization Target</b>\n}\nfunction TargetDisplayText({ optimizationTarget }: { optimizationTarget?: string[] }) {\n  const { data } = useContext(DataContext)\n  const displayHeader = usePromise(() => optimizationTarget && getDisplayHeader(data, optimizationTarget[0]), [data, optimizationTarget])\n\n  if (!optimizationTarget || !displayHeader) return <NoTarget />\n  const node: NodeDisplay | undefined = objPathValue(data.getDisplay(), optimizationTarget) as any\n  if (!node) return <NoTarget />\n\n  return <b>{displayHeader.title} : {<ColorText color={node.info.variant}>{KeyMap.get(node.info.key)}</ColorText>}</b>\n}\nfunction TargetSelectorMenuItem({ node, onClick }: { node: NodeDisplay, onClick: () => void }) {\n  if (node.isEmpty) return null\n  return <MenuItem onClick={onClick} style={{ overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\n    <ColorText color={node.info.variant} >{KeyMap.get(node.info.key)}</ColorText>\n  </MenuItem>\n}\n","import useDBState from \"../../../../ReactHooks/useDBState\";\nimport { CharacterKey } from \"../../../../Types/consts\";\n\nexport const defThreads = navigator.hardwareConcurrency || 4\n\nexport function initialTabOptimizeDBState(): {\n  equipmentPriority: CharacterKey[],\n  threads: number,\n} {\n  return {\n    equipmentPriority: [],\n    threads: defThreads\n  }\n}\n\nexport function useOptimizeDBState() {\n  return useDBState(\"TabOptimize\", initialTabOptimizeDBState)\n}\n","import { Add, CheckBox, CheckBoxOutlineBlank, Close, KeyboardArrowDown, KeyboardArrowUp, KeyboardDoubleArrowDown, KeyboardDoubleArrowUp, Replay, Settings } from \"@mui/icons-material\";\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from \"@mui/material\";\nimport { useCallback, useContext, useMemo } from \"react\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\";\nimport ArtifactCardPico from \"../../../../../Components/Artifact/ArtifactCardPico\";\nimport CardDark from \"../../../../../Components/Card/CardDark\";\nimport CardLight from \"../../../../../Components/Card/CardLight\";\nimport CharacterCardPico from \"../../../../../Components/Character/CharacterCardPico\";\nimport { CharacterSelectionModal } from \"../../../../../Components/Character/CharacterSelectionModal\";\nimport CloseButton from \"../../../../../Components/CloseButton\";\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../../../../../Components/CustomNumberInput\";\nimport ModalWrapper from \"../../../../../Components/ModalWrapper\";\nimport SqBadge from \"../../../../../Components/SqBadge\";\nimport WeaponCardPico from \"../../../../../Components/Weapon/WeaponCardPico\";\nimport { DatabaseContext } from \"../../../../../Database/Database\";\nimport useBoolState from \"../../../../../ReactHooks/useBoolState\";\nimport useCharacter from \"../../../../../ReactHooks/useCharacter\";\nimport useCharSelectionCallback from \"../../../../../ReactHooks/useCharSelectionCallback\";\nimport { ICachedCharacter } from \"../../../../../Types/character\";\nimport { CharacterKey } from \"../../../../../Types/consts\";\nimport useBuildSetting from \"../useBuildSetting\";\nimport { useOptimizeDBState } from \"../DBState\";\n\nexport default function UseEquipped({ disabled = false }: { disabled?: boolean }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { useEquippedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState(false)\n  const [{ equipmentPriority: tempEquipmentPriority }, setOptimizeDBState] = useOptimizeDBState()\n  //Basic validate for the equipmentPrio list to remove dups and characters that doesnt exist.\n  const equipmentPriority = useMemo(() => [...new Set(tempEquipmentPriority)].filter(ck => database.chars.get(ck)), [database, tempEquipmentPriority])\n  const setPrio = useCallback((equipmentPriority: CharacterKey[]) => setOptimizeDBState({ equipmentPriority }), [setOptimizeDBState])\n\n  const setPrioRank = useCallback((fromIndex, toIndex) => {\n    const arr = [...equipmentPriority]\n    var element = arr[fromIndex];\n    arr.splice(fromIndex, 1);\n    arr.splice(toIndex, 0, element);\n    setPrio(arr)\n  }, [equipmentPriority, setPrio])\n  const removePrio = useCallback((fromIndex) => {\n    const arr = [...equipmentPriority]\n    arr.splice(fromIndex, 1)\n    setPrio(arr)\n  }, [equipmentPriority, setPrio])\n  const addPrio = useCallback((ck: CharacterKey) => setPrio([...equipmentPriority, ck]), [equipmentPriority, setPrio])\n  const resetPrio = useCallback(() => setPrio([]), [setPrio])\n\n  const numAbove = useMemo(() => {\n    let numAbove = equipmentPriority.length\n    const index = equipmentPriority.indexOf(characterKey)\n    if (index >= 0) numAbove = index\n    return numAbove\n  }, [characterKey, equipmentPriority])\n  const numUseEquippedChar = useMemo(() => {\n    return database.chars.keys.length - 1 - numAbove\n  }, [numAbove, database])\n  const numUnlisted = useMemo(() => {\n    return database.chars.keys.length - equipmentPriority.length\n  }, [equipmentPriority, database])\n\n  return <Box display=\"flex\" gap={1}>\n    <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"sm\" }}><CardDark>\n      <CardContent>\n        <Grid container spacing={1}>\n          <Grid item flexGrow={1}>\n            <Typography variant=\"h6\"><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.title\">Character Priority for Equipped Artifacts</Trans></Typography>\n          </Grid>\n          <Grid item sx={{ mb: -1 }}>\n            <CloseButton onClick={onClose} />\n          </Grid>\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent>\n        <CardLight sx={{ mb: 1 }}>\n          <CardContent>\n            <Typography gutterBottom><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.desc1\">When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list.</Trans></Typography>\n            <Typography gutterBottom><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.desc2\">If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list.</Trans></Typography>\n          </CardContent>\n        </CardLight>\n        <Box display=\"flex\" flexDirection=\"column\" gap={2}>\n          {equipmentPriority.map((ck, i) =>\n            <SelectItem key={ck} characterKey={ck} rank={i + 1} maxRank={equipmentPriority.length} setRank={(num) => num && setPrioRank(i, num - 1)} onRemove={() => removePrio(i)} numAbove={numAbove} />)}\n          <Box sx={{ display: \"flex\", gap: 1 }}>\n            <NewItem onAdd={addPrio} list={equipmentPriority} />\n            <Button color=\"error\" onClick={resetPrio} startIcon={<Replay />}><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.clearList\">Clear List</Trans></Button>\n          </Box>\n          {!!numUseEquippedChar && <SqBadge color=\"success\"><Typography><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.usingNum\" count={numUnlisted}>Using artifacts from <strong>{{ count: numUnlisted }}</strong> unlisted characters</Trans></Typography></SqBadge>}\n        </Box>\n      </CardContent>\n    </CardDark ></ModalWrapper>\n    <ButtonGroup sx={{ display: \"flex\", width: \"100%\" }}>\n      <Button sx={{ flexGrow: 1 }} onClick={() => buildSettingDispatch({ useEquippedArts: !useEquippedArts })} disabled={disabled} startIcon={useEquippedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useEquippedArts ? \"success\" : \"secondary\"}>\n        <Box>\n          <span><Trans t={t} i18nKey=\"tabOptimize.useEquipped.title\">Use Equipped Artifacts</Trans></span>\n          {useEquippedArts && <SqBadge><Trans t={t} i18nKey=\"tabOptimize.useEquipped.usingNum\" count={numUseEquippedChar}>Using from <strong>{{ count: numUseEquippedChar }}</strong> characters</Trans></SqBadge>}\n        </Box>\n      </Button>\n      {useEquippedArts && <Button sx={{ flexShrink: 1 }} color=\"info\" onClick={onOpen} disabled={disabled}><Settings /></Button>}\n    </ButtonGroup>\n  </Box>\n}\n\nconst itemSize = 60\nfunction SelectItem({ characterKey, rank, maxRank, setRank, onRemove, numAbove }: {\n  characterKey: CharacterKey,\n  rank: number,\n  maxRank: number,\n  setRank: (r: number | undefined) => void,\n  onRemove: () => void,\n  numAbove: number,\n}) {\n  const { t } = useTranslation(\"page_character\")\n  const { database } = useContext(DatabaseContext)\n  const character = useCharacter(characterKey)\n  const onClick = useCharSelectionCallback()\n  if (!character) return null\n  const { equippedWeapon, equippedArtifacts } = character\n  return <CardLight sx={{ p: 1 }}  >\n    <Box sx={{ pb: 1, display: \"flex\", justifyContent: \"space-between\", gap: 1 }}>\n      <SqBadge color=\"info\">\n        <Typography>#{rank}</Typography>\n      </SqBadge>\n      <SqBadge sx={{ flexGrow: 1 }} color={numAbove === (rank - 1) ? \"warning\" : (rank - 1) < numAbove ? \"error\" : \"success\"}>\n        <Typography>{numAbove === (rank - 1) ? <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.curr\">Current character</Trans>\n          : (rank - 1) < numAbove ? <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.dont\">Don't Use artifacts</Trans> :\n            <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.use\">Use artifacts</Trans>}</Typography>\n      </SqBadge>\n      <Box>\n        <ButtonGroup sx={{ flexGrow: 1 }} size=\"small\">\n          <CustomNumberInputButtonGroupWrapper >\n            <CustomNumberInput onChange={setRank} value={rank}\n              // startAdornment=\"Rank:\"\n              inputProps={{ min: 1, max: maxRank, sx: { textAlign: \"center\" } }}\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }} />\n          </CustomNumberInputButtonGroupWrapper>\n          <Button disabled={rank === 1} onClick={() => setRank(1)} >\n            <KeyboardDoubleArrowUp />\n          </Button>\n          <Button disabled={rank === 1} onClick={() => setRank(rank - 1)}  >\n            <KeyboardArrowUp />\n          </Button>\n          <Button disabled={rank === maxRank} onClick={() => setRank(rank + 1)}  >\n            <KeyboardArrowDown />\n          </Button>\n          <Button disabled={rank === maxRank} onClick={() => setRank(maxRank)}  >\n            <KeyboardDoubleArrowDown />\n          </Button>\n          <Button color=\"error\" onClick={onRemove}>\n            <Close />\n          </Button>\n        </ButtonGroup>\n      </Box>\n    </Box>\n    <Grid container columns={7} spacing={1}>\n      <Grid item xs={1} >\n        <CharacterCardPico characterKey={characterKey} onClick={onClick} />\n      </Grid>\n      <Grid item xs={1}><WeaponCardPico weaponId={equippedWeapon} /></Grid>\n      {Object.entries(equippedArtifacts).map(([slotKey, aId]) => <Grid item xs={1} key={slotKey} ><ArtifactCardPico slotKey={slotKey} artifactObj={database.arts.get(aId)} /></Grid>)}\n    </Grid>\n\n  </CardLight>\n}\nfunction NewItem({ onAdd, list }: { onAdd: (ck: CharacterKey) => void, list: CharacterKey[] }) {\n  const { t } = useTranslation(\"page_character\")\n  const [show, onOpen, onClose] = useBoolState(false)\n  const filter = useCallback((char?: ICachedCharacter) => {\n    if (!char) return false\n    return !list.includes(char.key)\n  }, [list])\n  return <>\n    <CharacterSelectionModal show={show} onHide={onClose} onSelect={onAdd} filter={filter} />\n    <Button fullWidth sx={{ height: itemSize }} color=\"info\" onClick={onOpen} startIcon={<Add />} >\n      <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.add\">Add character to list</Trans>\n    </Button>\n  </>\n}\n","import { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\nimport { Box, Button } from \"@mui/material\";\nimport { useContext, useMemo } from \"react\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\";\nimport SqBadge from \"../../../../../Components/SqBadge\";\nimport { DatabaseContext } from \"../../../../../Database/Database\";\nimport useBuildSetting from \"../useBuildSetting\";\n\nexport default function UseExcluded({ disabled = false, artsDirty }: { disabled?: boolean, artsDirty: object }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { useExcludedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { database } = useContext(DatabaseContext)\n  const numExcludedArt = useMemo(() => artsDirty && database.arts.values.reduce((a, art) => a + (art.exclude ? 1 : 0), 0), [database, artsDirty])\n  return <Button fullWidth onClick={() => buildSettingDispatch({ useExcludedArts: !useExcludedArts })} disabled={!numExcludedArt || disabled} startIcon={useExcludedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useExcludedArts ? \"success\" : \"secondary\"}>\n    <Box>\n      <span><Trans t={t} i18nKey=\"tabOptimize.useExcluded.title\" count={numExcludedArt}>Use Excluded Artifacts</Trans></span>\n      {useExcludedArts && <SqBadge><Trans t={t} i18nKey=\"tabOptimize.useExcluded.usingNum\" count={numExcludedArt}>Using <strong>{{ count: numExcludedArt }}</strong> excluded artifacts</Trans></SqBadge>}\n    </Box>\n  </Button>\n}\n","import Artifact from \"../../../../Data/Artifacts/Artifact\";\nimport { input } from \"../../../../Formula\";\nimport { computeUIData } from \"../../../../Formula/api\";\nimport { formulaString } from \"../../../../Formula/debug\";\nimport { Data, NumNode } from \"../../../../Formula/type\";\nimport { constant, setReadNodeKeys } from \"../../../../Formula/utils\";\nimport { allMainStatKeys, allSubstatKeys, ICachedArtifact } from \"../../../../Types/artifact\";\nimport { deepClone, objectKeyMap, objectMap } from \"../../../../Util/Util\";\nimport type { ArtifactBuildData, ArtifactsBySlot, DynStat } from \"./common\";\n\nconst dynamic = setReadNodeKeys(deepClone({ dyn: { ...input.art, ...input.artSet } }))\nexport const dynamicData = {\n  art: objectKeyMap([...allMainStatKeys, ...allSubstatKeys], key => dynamic.dyn[key]),\n  artSet: objectMap(input.artSet, (_, key) => dynamic.dyn[key]),\n}\n\nexport function compactArtifacts(arts: ICachedArtifact[], mainStatAssumptionLevel: number, allowPartial: boolean): ArtifactsBySlot {\n  const result: ArtifactsBySlot = {\n    base: {},\n    values: { flower: [], plume: [], goblet: [], circlet: [], sands: [] }\n  }\n  const keys = new Set<string>()\n\n  for (const art of arts) {\n    const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level))\n\n    const data: ArtifactBuildData = {\n      id: art.id, set: art.setKey,\n      values: {\n        [art.setKey]: 1,\n        [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\n        ...Object.fromEntries(art.substats.map(substat =>\n          [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\n      },\n    }\n    delete data.values[\"\"]\n    result.values[art.slotKey].push(data)\n    Object.keys(data.values).forEach(x => keys.add(x))\n  }\n  result.base = objectKeyMap([...keys], _ => 0)\n  if (allowPartial)\n    for (const value of Object.values(result.values))\n      value.push({ id: \"\", values: {} })\n  return result\n}\n\nexport function debugCompute(nodes: NumNode[], base: DynStat, arts: ArtifactBuildData[]) {\n  const stats = { ...base }\n  for (const art of arts) {\n    for (const [key, value] of Object.entries(art.values)) {\n      stats[key] = (stats[key] ?? 0) + value\n    }\n  }\n  const data = { dyn: Object.fromEntries(Object.entries(stats).map(([key, value]) => [key, constant(value)])) } as Data\n  const uiData = computeUIData([data])\n  return {\n    base, arts, stats,\n    data, uiData,\n    nodes: nodes.map(formulaString),\n    results: nodes.map(node => uiData.get(node)),\n  }\n}\n","import { ArtSetExclusion } from \"../../../../Database/Data/BuildsettingData\"\nimport { fillBuffer, reducePolynomial } from \"../../../../Formula/addedUtils\"\nimport { ExpandedPolynomial, expandPoly, toNumNode } from \"../../../../Formula/expandPoly\"\nimport { LinearForm, minMaxWeightVec, toLinearUpperBound } from \"../../../../Formula/linearUpperBound\"\nimport { precompute } from \"../../../../Formula/optimization\"\nimport { NumNode } from \"../../../../Formula/type\"\nimport { allArtifactSets, allSlotKeys, ArtifactSetKey, SlotKey } from \"../../../../Types/consts\"\nimport { objectKeyMap, objectKeyValueMap, range } from \"../../../../Util/Util\"\nimport { ArtifactBuildDataVecDense, ArtifactsBySlot, ArtifactsBySlotVec, DynStat, filterArtsVec2, RequestFilter } from \"./common\"\n\nexport type UnionFilter = {\n  uType: true\n  filters: StrictDict<SlotKey, { kind: \"id\", ids: Set<string> }>[]\n} | (RequestFilter & { uType: false })\n\nexport type RequestFilter2 = {\n  // filter: StrictDict<SlotKey, { kind: \"id\", ids: Set<string> }>,\n  filterVec: StrictDict<SlotKey, number[]>,  // dict of list of indices (for some particular ArtifactsBySetVec)\n  lower: number[],  // length `k` list of lower bound stats\n  upper: number[],  // length `k` list of upper bound stats\n  minw: number[],   // length `l` list of minimum upper bound estimates\n  maxw: number[],   // length `l` list of maximum upper bound weights\n}\nexport type UnionFilter2 = RequestFilter2[]\nexport type ArtSetExclusionFull = Dict<Exclude<ArtifactSetKey, \"PrayersForDestiny\" | \"PrayersForIllumination\" | \"PrayersForWisdom\" | \"PrayersToSpringtime\"> | \"uniqueKey\", number[]>\n// export type SubProblem = SubProblemNC | SubProblemWC\nexport type SubProblem = SubProblemWC\nexport type SubProblemNC = {\n  cache: false,\n  optimizationTarget: ExpandedPolynomial,\n  constraints: { value: ExpandedPolynomial, min: number }[],\n  artSetExclusion: ArtSetExclusionFull,\n\n  filters: UnionFilter2,\n  depth: number,\n}\nexport type SubProblemWC = {\n  cache: true,\n  optimizationTarget: ExpandedPolynomial,\n  constraints: { value: ExpandedPolynomial, min: number }[],\n  artSetExclusion: ArtSetExclusionFull,\n\n  filters: UnionFilter2,\n  lin: LinearForm[],\n  // cachedCompute: CachedCompute,\n  depth: number,\n}\nexport type CachedCompute = {\n  maxEst: number[],\n  lin: LinearForm[],\n  lower: DynStat,\n  upper: DynStat\n}\n\nexport function countBuildsU(f: UnionFilter2): number {\n  return f.reduce((tot, { filterVec }) => tot + allSlotKeys.reduce((_count, slot) => _count * filterVec[slot].length, 1), 0)\n}\n\nexport function unionFilterUpperLower(f: UnionFilter2) {\n  const lower = [...f[0].lower]\n  const upper = [...f[0].upper]\n  const minw = [...f[0].minw]\n  const maxw = [...f[0].maxw]\n\n  for (let i = 1; i < f.length; i++) {\n    for (let j = 0; j < lower.length; j++) {\n      lower[j] = Math.min(lower[j], f[i].lower[j])\n      upper[j] = Math.max(upper[j], f[i].upper[j])\n    }\n    for (let j = 0; j < minw.length; j++) {\n      minw[j] = Math.min(minw[j], f[i].minw[j])\n      maxw[j] = Math.max(maxw[j], f[i].maxw[j])\n    }\n  }\n\n  return { lower, upper, minw, maxw }\n}\n\nexport function applyLinearForm(arts: ArtifactsBySlotVec, lin: LinearForm[]) {\n  const wixs: number[][] = []\n  const ws: number[][] = []\n  const baseC: number[] = []\n  lin.forEach(li => {\n    const ixs0: number[] = []\n    const w0: number[] = []\n    Object.entries(li.w).forEach(([k, w]) => {\n      ixs0.push(arts.keys.indexOf(k))\n      w0.push(w)\n    })\n    wixs.push(ixs0)\n    ws.push(w0)\n\n    baseC.push(ixs0.reduce((accum, ix, i) => accum + arts.base[ix] * w0[i], li.c))\n  })\n\n  arts.baseBuffer = baseC\n  allSlotKeys.forEach(slotKey => arts.values[slotKey].forEach(art =>\n    art.buffer = wixs.map((ixsi, i) => ixsi.reduce((accum, ix, j) => accum + art.values[ix] * ws[i][j], 0))\n  ))\n}\n\nexport function reduceSubProblem(arts: ArtifactsBySlotVec, threshold: number, subp: SubProblem): SubProblemWC | undefined {\n  const { optimizationTarget, constraints, artSetExclusion, depth } = subp\n  let { filters } = subp\n  let nodes = [...constraints.map(({ value }) => value), optimizationTarget]\n  const mins = constraints.map(({ min }) => min)\n\n  // 0. Check for never-feasible constraints\n  filters = filters.filter(({ maxw }) => {\n    if (mins.some((min, j) => maxw[j] < min)) return false\n    if (maxw[mins.length] < threshold) return false\n    return true\n  })\n  if (filters.length === 0) return undefined\n\n  // 0b. Calculate stat bounding box\n  const { lower, upper } = unionFilterUpperLower(filters)\n  const statsMin: DynStat = Object.fromEntries(arts.keys.map((k, i) => ([k, lower[i]])))\n  const statsMax: DynStat = Object.fromEntries(arts.keys.map((k, i) => ([k, upper[i]])))\n\n  nodes = reducePolynomial(nodes, statsMin, statsMax)\n\n  // 1. Check for always-feasible constraints.\n  const [compute, mapping, buffer] = precompute(constraints.map(({ value }) => toNumNode(value)), n => n.path[1])\n  fillBuffer(statsMin, mapping, buffer)\n  const result = compute()\n  const active = mins.map((m, i) => m > result[i])\n\n  const newOptTarget = nodes.pop()!\n  const newConstraints = nodes.map((value, i) => ({ value, min: mins[i] })).filter((_, i) => active[i])\n  const newMins = newConstraints.map(({ min }) => min)\n\n  // 2. Check for never-active and always-active ArtSetExcl constraints.\n  const newArtExcl = {} as ArtSetExclusionFull\n  for (const [setKey, exclude] of Object.entries(artSetExclusion)) {\n    if (setKey === 'uniqueKey') {\n      // TODO: Check and exclude rainbow bullshit.\n      newArtExcl[setKey] = exclude\n      const feasibleKeys = allArtifactSets.filter(setKey => statsMax[setKey] > 0)\n      let feasible4sets = 0\n      let feasible2sets = 0\n      feasibleKeys.forEach(k => {\n        let allowedCnts = range(statsMin[k], statsMax[k])\n        if (artSetExclusion[k])\n          allowedCnts = allowedCnts.filter(cnt => !artSetExclusion[k].includes(cnt))\n\n        if (allowedCnts.includes(4) || allowedCnts.includes(5)) feasible4sets++\n        if (allowedCnts.includes(2) || allowedCnts.includes(3)) feasible2sets++\n      })\n\n      if (exclude.includes(5) && feasible4sets === 0) {\n        if (feasible2sets === 0) return; // No feasible 4sets or 2sets along with rainbow5 excluded is never satisfiable\n        if (exclude.includes(3) && feasible2sets < 2) return; // No 4sets, rainbow5 excluded, rainbow3 excluded means we need at least 2 2sets\n      }\n      continue\n    }\n    const reducedExcl = exclude.filter(n => statsMin[setKey] <= n && n <= statsMax[setKey])        // Cut away never-active\n    if (reducedExcl.includes(statsMin[setKey]) && reducedExcl.includes(statsMax[setKey])) return;  // Always active.\n    if (reducedExcl.length > 0) newArtExcl[setKey] = reducedExcl\n  }\n\n  // 3. Estimate Upper Bounds and re-check for never-feasible constraints\n  let f = [...newConstraints.map(({ value }) => value), newOptTarget]\n  const lin = f.map(fi => toLinearUpperBound(fi, statsMin, statsMax))\n  applyLinearForm(arts, lin)\n  const newFilters = filters\n    .map(filter => {\n      const { filterVec, lower, upper } = filter\n      const a = filterArtsVec2(arts, filter.filterVec)  // CANDIDATE for making this more efficient\n      const minww = [...a.baseBuffer]\n      const maxww = [...a.baseBuffer]\n      allSlotKeys.forEach(slotKey => {\n        const { minw, maxw } = slotUpperLowerVecW(a.values[slotKey])\n        for (let j = 0; j < minww.length; j++) {\n          minww[j] += minw[j]\n          maxww[j] += maxw[j]\n        }\n      })\n      return {\n        filterVec, lower, upper,\n        minw: minww, maxw: maxww,\n      }\n    })\n    .filter(({ maxw }) => {\n      if (newMins.some((min, j) => maxw[j] < min)) return false\n      if (maxw[mins.length] < threshold) return false\n      return true\n    })\n\n  return {\n    cache: true,\n    optimizationTarget: newOptTarget,\n    constraints: newConstraints,\n    artSetExclusion: newArtExcl,\n\n    depth, lin, filters: newFilters\n  }\n}\n\nexport function toArtifactBySlotVec(arts: ArtifactsBySlot): ArtifactsBySlotVec {\n  const allKeys = new Set(Object.keys(arts.base))\n  Object.values(arts.values).forEach(slotArts => {\n    slotArts.forEach(art => {\n      if (art.set) allKeys.add(art.set)\n      Object.keys(art.values).forEach(k => allKeys.add(k))\n    })\n  })\n\n  const allKeysList = [...allKeys]\n  const keys = [...allKeysList.filter(k => !(allArtifactSets as readonly string[]).includes(k)), ...allKeysList.filter(k => (allArtifactSets as readonly string[]).includes(k))]\n\n  return {\n    keys, baseBuffer: [],\n    base: keys.map(k => arts.base[k] ?? 0),\n    values: {\n      flower: arts.values.flower.map(({ id, set, values }) => ({ id, set, values: keys.map(k => values[k] ?? (k === set ? 1 : 0)), buffer: [] })),\n      plume: arts.values.plume.map(({ id, set, values }) => ({ id, set, values: keys.map(k => values[k] ?? (k === set ? 1 : 0)), buffer: [] })),\n      sands: arts.values.sands.map(({ id, set, values }) => ({ id, set, values: keys.map(k => values[k] ?? (k === set ? 1 : 0)), buffer: [] })),\n      goblet: arts.values.goblet.map(({ id, set, values }) => ({ id, set, values: keys.map(k => values[k] ?? (k === set ? 1 : 0)), buffer: [] })),\n      circlet: arts.values.circlet.map(({ id, set, values }) => ({ id, set, values: keys.map(k => values[k] ?? (k === set ? 1 : 0)), buffer: [] })),\n    }\n  }\n}\n\ntype ProblemSetup = {\n  optimizationTargetNode: NumNode,\n  nodes: NumNode[],\n  minimum: number[],\n  artSetExclusion: ArtSetExclusion\n}\nexport function problemSetup(arts: ArtifactsBySlotVec, { optimizationTargetNode, nodes, minimum, artSetExclusion }: ProblemSetup): SubProblemWC {\n  const artSetExclFull = objectKeyValueMap(Object.entries(artSetExclusion), ([setKey, v]) => {\n    if (setKey === 'rainbow') return ['uniqueKey', v.map(v => v + 1)]\n    return [setKey, v.flatMap(v => (v === 2) ? [2, 3] : [4, 5])]\n  })\n\n  const constraintsEP = nodes\n    .map((value, i) => ({ value: expandPoly(value), min: minimum[i] }))\n    .filter(x => x.min > -Infinity)\n  const opttargetEP = expandPoly(optimizationTargetNode)\n\n  const { lower, upper } = statsUpperLowerVec(arts)\n  const statsMin = Object.fromEntries(arts.keys.map((k, i) => [k, lower[i]]))\n  const statsMax = Object.fromEntries(arts.keys.map((k, i) => [k, upper[i]]))\n  let f = [...constraintsEP.map(({ value }) => value), opttargetEP]\n  const lin = f.map(fi => toLinearUpperBound(fi, statsMin, statsMax))\n  const minMaxEst = lin.map(li => minMaxWeightVec(arts, li))\n\n  console.log('-----------------------------------------------------------------------')\n  console.log('lin', lin)\n  console.log('-----------------------------------------------------------------------')\n\n  const filterVec = objectKeyMap(allSlotKeys, slotKey => {\n    return arts.values[slotKey].map((v, i) => i)\n  })\n\n  const initialProblem: SubProblemWC = {\n    cache: true,\n    optimizationTarget: opttargetEP,\n    constraints: constraintsEP,\n    artSetExclusion: artSetExclFull,\n\n    filters: [{\n      filterVec, lower, upper,\n      maxw: minMaxEst.map(({ maxw }) => maxw),\n      minw: minMaxEst.map(({ minw }) => minw),\n    }],\n    depth: 0,\n    lin,\n  }\n  const initialReducedProblem = reduceSubProblem(arts, -Infinity, initialProblem)\n  console.log(initialReducedProblem)\n  if (initialReducedProblem === undefined)\n    return initialProblem\n  return initialReducedProblem\n}\n\nexport function slotUpperLowerVec(arts: ArtifactBuildDataVecDense[]) {\n  const lower = [...arts[0].values]\n  const upper = [...arts[0].values]\n  const minw = [...arts[0].buffer]\n  const maxw = [...arts[0].buffer]\n  for (let i = 1; i < arts.length; i++) {\n    for (let j = 0; j < lower.length; j++) {\n      lower[j] = Math.min(lower[j], arts[i].values[j])\n      upper[j] = Math.max(upper[j], arts[i].values[j])\n    }\n    for (let j = 0; j < minw.length; j++) {\n      minw[j] = Math.min(minw[j], arts[i].buffer[j])\n      maxw[j] = Math.max(maxw[j], arts[i].buffer[j])\n    }\n  }\n  return { lower, upper, minw, maxw }\n}\nexport function slotUpperLowerVecW(arts: ArtifactBuildDataVecDense[]) {\n  const minw = [...arts[0].buffer]\n  const maxw = [...arts[0].buffer]\n  for (let i = 1; i < arts.length; i++) {\n    for (let j = 0; j < minw.length; j++) {\n      minw[j] = Math.min(minw[j], arts[i].buffer[j])\n      maxw[j] = Math.max(maxw[j], arts[i].buffer[j])\n    }\n  }\n  return { minw, maxw }\n}\nexport function statsUpperLowerVec(a: ArtifactsBySlotVec) {\n  const lower = [...a.base]\n  const upper = [...a.base]\n  const minw = [...a.baseBuffer]\n  const maxw = [...a.baseBuffer]\n  Object.values(a.values).forEach(slotArts => {\n    const slotUL = slotUpperLowerVec(slotArts)\n    for (let i = 0; i < lower.length; i++) {\n      lower[i] += slotUL.lower[i]\n      upper[i] += slotUL.upper[i]\n    }\n    for (let i = 0; i < minw.length; i++) {\n      minw[i] += slotUL.minw[i]\n      maxw[i] += slotUL.maxw[i]\n    }\n  })\n  return { lower, upper, minw, maxw }\n}\nexport function statsUpperLowerVecW(a: ArtifactsBySlotVec) {\n  const minw = [...a.baseBuffer]\n  const maxw = [...a.baseBuffer]\n  Object.values(a.values).forEach(slotArts => {\n    const slotUL = slotUpperLowerVecW(slotArts)\n    for (let i = 0; i < minw.length; i++) {\n      minw[i] += slotUL.minw[i]\n      maxw[i] += slotUL.maxw[i]\n    }\n  })\n  return { minw, maxw }\n}\n","import { Box, CardContent, Typography } from \"@mui/material\"\nimport { useCallback, useContext, useMemo } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport CardLight from \"../../../../../Components/Card/CardLight\"\nimport InfoTooltip from \"../../../../../Components/InfoTooltip\"\nimport StatEditorList from \"../../../../../Components/StatEditorList\"\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\"\nimport { DataContext } from \"../../../../../Context/DataContext\"\nimport { input } from \"../../../../../Formula\"\nimport { StatKey } from \"../../../../../KeyMap\"\nimport { ElementKey, WeaponTypeKey } from \"../../../../../Types/consts\"\nimport useBuildSetting from \"../useBuildSetting\"\n\nexport default function StatFilterCard({ disabled = false }: { disabled?: boolean }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const { buildSetting: { statFilters }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const setStatFilters = useCallback((statFilters: Dict<StatKey, number>) => buildSettingDispatch({ statFilters }), [buildSettingDispatch],)\n\n  const statKeys = useMemo(() => {\n    const statKeys: StatKey[] = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\n    if (data.get(input.weaponType).value as WeaponTypeKey !== \"catalyst\") statKeys.push(\"physical_dmg_\")\n    const charEle = data.get(input.charEle).value as ElementKey\n    statKeys.push(`${charEle}_dmg_`)\n    return statKeys\n  }, [data])\n\n\n  return <Box>\n    <CardLight>\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\n        <Typography>{t`tabOptimize.constraintFilter.title`}</Typography>\n        <InfoTooltip title={<Typography>{t`tabOptimize.constraintFilter.tooltip`}</Typography>} />\n      </CardContent>\n    </CardLight>\n    <Box display=\"flex\" flexDirection=\"column\" gap={0.5}>\n      <StatEditorList statKeys={statKeys} statFilters={statFilters} setStatFilters={setStatFilters} disabled={disabled} />\n    </Box>\n  </Box>\n}\n","import { faCalculator } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { CheckBox, CheckBoxOutlineBlank, Close } from '@mui/icons-material';\nimport { Alert, Box, Button, ButtonGroup, CardContent, Divider, Grid, Link, MenuItem, Skeleton, ToggleButton, Typography, Pagination } from '@mui/material';\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link as RouterLink } from 'react-router-dom';\n// eslint-disable-next-line\nimport Worker from \"worker-loader!./BackgroundWorker\";\nimport { CharacterContext } from '../../../../Context/CharacterContext';\nimport ArtifactLevelSlider from '../../../../Components/Artifact/ArtifactLevelSlider';\nimport BootstrapTooltip from '../../../../Components/BootstrapTooltip';\nimport CardLight from '../../../../Components/Card/CardLight';\nimport CharacterCard from '../../../../Components/Character/CharacterCard';\nimport DropdownButton from '../../../../Components/DropdownMenu/DropdownButton';\nimport { HitModeToggle, ReactionToggle } from '../../../../Components/HitModeEditor';\nimport SolidToggleButtonGroup from '../../../../Components/SolidToggleButtonGroup';\nimport { DatabaseContext } from '../../../../Database/Database';\nimport { DataContext, dataContextObj } from '../../../../Context/DataContext';\nimport { thresholdExclusions } from '../../../../Formula/addedUtils';\nimport { mergeData, uiDataForTeam } from '../../../../Formula/api';\nimport { uiInput as input } from '../../../../Formula/index';\nimport { optimize } from '../../../../Formula/optimization';\nimport { elimLinDepStats, thresholdToConstBranchForm } from '../../../../Formula/optimize2';\nimport { NumNode } from '../../../../Formula/type';\nimport { UIData } from '../../../../Formula/uiData';\nimport { initGlobalSettings } from '../../../../stateInit';\nimport KeyMap from '../../../../KeyMap';\nimport useCharacterReducer from '../../../../ReactHooks/useCharacterReducer';\nimport useCharSelectionCallback from '../../../../ReactHooks/useCharSelectionCallback';\nimport useDBState from '../../../../ReactHooks/useDBState';\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\nimport useTeamData, { getTeamData } from '../../../../ReactHooks/useTeamData';\nimport { ICachedArtifact } from '../../../../Types/artifact';\nimport { CharacterKey } from '../../../../Types/consts';\nimport { objectKeyValueMap, objPathValue, range } from '../../../../Util/Util';\nimport { FinalizeResult, Setup, WorkerCommand, WorkerResult } from './BackgroundWorker';\nimport { maxBuildsToShowList } from './Build';\nimport useBuildSetting from './useBuildSetting';\nimport { Build, mergeBuilds, mergePlot, pruneAll } from './common';\nimport ArtifactSetConfig from './Components/ArtifactSetConfig';\nimport AssumeFullLevelToggle from './Components/AssumeFullLevelToggle';\nimport BonusStatsCard from './Components/BonusStatsCard';\nimport BuildAlert, { BuildStatus } from './Components/BuildAlert';\nimport BuildDisplayItem from './Components/BuildDisplayItem';\nimport ChartCard, { ChartData } from './Components/ChartCard';\nimport MainStatSelectionCard from './Components/MainStatSelectionCard';\nimport OptimizationTargetSelector from './Components/OptimizationTargetSelector';\nimport UseEquipped from './Components/UseEquipped';\nimport UseExcluded from './Components/UseExcluded';\nimport { defThreads, useOptimizeDBState } from './DBState';\nimport { compactArtifacts, dynamicData } from './foreground';\nimport { OptimizationTargetContext } from '../../../../Context/OptimizationTargetContext';\nimport { countBuildsU, problemSetup, SubProblem, toArtifactBySlotVec } from './subproblemUtil';\nimport CardDark from '../../../../Components/Card/CardDark';\nimport StatFilterCard from './Components/StatFilterCard';\n\nexport default function TabBuild() {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey, compareData } } = useContext(CharacterContext)\n  const [{ tcMode }] = useDBState(\"GlobalSettings\", initGlobalSettings)\n  const { database } = useContext(DatabaseContext)\n\n  const [buildStatus, setBuildStatus] = useState({ type: \"inactive\", tested: 0, failed: 0, skipped: 0, total: 0 } as BuildStatus)\n  const generatingBuilds = buildStatus.type !== \"inactive\"\n\n  const [chartData, setchartData] = useState(undefined as ChartData | undefined)\n\n  const [artsDirty, setArtsDirty] = useForceUpdate()\n\n  const [{ equipmentPriority, threads = defThreads }, setOptimizeDBState] = useOptimizeDBState()\n  const maxWorkers = threads > defThreads ? defThreads : threads\n  const setMaxWorkers = useCallback(threads => setOptimizeDBState({ threads }), [setOptimizeDBState],)\n\n  const characterDispatch = useCharacterReducer(characterKey)\n  const onClickTeammate = useCharSelectionCallback()\n\n  const noArtifact = useMemo(() => !database.arts.values.length, [database])\n\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { plotBase, optimizationTarget, mainStatAssumptionLevel, allowPartial, builds, buildDate, maxBuildsToShow, levelLow, levelHigh } = buildSetting\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\n  const buildsArts = useMemo(() => builds.map(build => build.map(i => database.arts.get(i)!)), [builds, database])\n  const numBuilds = buildsArts.length\n\n  const [currentPageIndex, setCurrentPageIndex] = useState(0)\n  const { numPages } = useMemo(() => {\n    return { numPages: Math.ceil(numBuilds / maxArtsToShowPerPage) }\n  }, [numBuilds])\n  const setPageIdx = useCallback((e, value: number) => {\n    setCurrentPageIndex(value - 1)\n  }, [setCurrentPageIndex])\n\n  //register changes in artifact database\n  useEffect(() =>\n    database.arts.followAny(setArtsDirty),\n    [setArtsDirty, database])\n\n  // Provides a function to cancel the work\n  const cancelToken = useRef(() => { })\n  //terminate worker when component unmounts\n  useEffect(() => () => cancelToken.current(), [])\n  const generateBuilds = useCallback(async () => {\n    const { artSetExclusion, plotBase, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, allowPartial, maxBuildsToShow, levelLow, levelHigh } = buildSetting\n    if (!characterKey || !optimizationTarget) return\n\n    let cantTakeList: CharacterKey[] = []\n    if (useEquippedArts) {\n      const index = equipmentPriority.indexOf(characterKey)\n      if (index < 0) cantTakeList = [...equipmentPriority]\n      else cantTakeList = equipmentPriority.slice(0, index)\n    }\n    const filteredArts = database.arts.values.filter(art => {\n      if (art.level < levelLow) return false\n      if (art.level > levelHigh) return false\n      const mainStats = mainStatKeys[art.slotKey]\n      if (mainStats?.length && !mainStats.includes(art.mainStatKey)) return false\n\n      // If its equipped on the selected character, bypass the check\n      if (art.location === characterKey) return true\n\n      if (art.exclude && !useExcludedArts) return false\n      if (art.location && !useEquippedArts) return false\n      if (art.location && useEquippedArts && cantTakeList.includes(art.location)) return false\n      return true\n    })\n    const split = compactArtifacts(filteredArts, mainStatAssumptionLevel, allowPartial)\n\n    const teamData = await getTeamData(database, characterKey, mainStatAssumptionLevel, [])\n    if (!teamData) return\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\n    if (!workerData) return\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\n    let optimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\n    if (!optimizationTargetNode) return\n    const targetNode = optimizationTargetNode\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters).map(([key, value]) => {\n      if (key.endsWith(\"_\")) value = value / 100 // TODO: Conversion\n      return { value: input.total[key], minimum: value }\n    }).filter(x => x.value && x.minimum > -Infinity)\n\n    setchartData(undefined)\n\n    const cancelled = new Promise<void>(r => cancelToken.current = r)\n\n    let nodes = [...valueFilter.map(x => x.value), optimizationTargetNode], arts = split!\n    // const setPerms = filterFeasiblePerm(artSetPerm(artSetExclusion, Object.values(split.values).flatMap(x => x.map(x => x.set!))), split)\n\n    const minimum = [...valueFilter.map(x => x.minimum), -Infinity]\n    const status: Omit<BuildStatus, \"type\"> = { tested: 0, failed: 0, skipped: 0, total: NaN, startTime: performance.now() }\n    if (plotBase) {\n      nodes.push(input.total[plotBase])\n      minimum.push(-Infinity)\n    }\n\n    nodes = optimize(nodes, workerData, ({ path: [p] }) => p !== \"dyn\");\n    ({ nodes, arts } = pruneAll(nodes, minimum, arts, maxBuildsToShow, artSetExclusion, {\n      reaffine: true, pruneArtRange: true, pruneNodeRange: true, pruneOrder: true\n    }))\n    // Can be further folded after pruning\n    nodes = optimize(nodes, workerData, ({ path: [p] }) => p !== \"dyn\");\n    nodes = thresholdExclusions(nodes, artSetExclusion);\n    nodes = thresholdToConstBranchForm(nodes);\n    ({ a: arts, nodes } = elimLinDepStats(arts, nodes));\n    nodes = optimize(nodes, {}, _ => false)\n\n    const plotBaseNode = plotBase ? nodes.pop() : undefined\n    optimizationTargetNode = nodes.pop()!\n\n    const artSetExclFull = objectKeyValueMap(Object.entries(artSetExclusion), ([setKey, v]) => {\n      if (setKey === 'rainbow') return ['uniqueKey', v.map(v => v + 1)]\n      return [setKey, v.flatMap(v => (v === 2) ? [2, 3] : [4, 5])]\n    })\n    console.log({ artSetExclFull })\n    const constraints = nodes\n      .map((value, i) => ({ value, min: minimum[i] }))\n      .filter(x => x.min > -Infinity)\n    const artsVec = toArtifactBySlotVec(arts)\n    const initialProblem = problemSetup(artsVec, { optimizationTargetNode, nodes, minimum, artSetExclusion })\n\n    const masterInfo = { id: -1, ready: true }\n    const maxSplitIters = 5\n    const minFilterCount = 2_000 // Don't split for single worker\n    // const maxRequestFilterInFlight = maxWorkers * 4\n    const maxRequestFilterInFlight = 1\n    const workQueue: SubProblem[] = [initialProblem]\n    const idleWorkers = new Set<number>()  // Currently idle workers\n    const busyWorkerIDs = new Set<number>()  // Workers with pending work in SplitWorker()\n    const workers: Worker[] = []\n\n    const wrap = { buildValues: Array(maxBuildsToShow).fill(0).map(_ => -Infinity) }\n\n    function fetchContinueWork(): WorkerCommand {\n      return { command: \"split\", minCount: minFilterCount, maxIter: maxSplitIters, threshold: wrap.buildValues[maxBuildsToShow - 1] }\n    }\n    function fetchWork(): WorkerCommand | undefined {\n      const subproblem = workQueue.shift()\n      if (!subproblem) return undefined\n      let numBuild = countBuildsU(subproblem.filters)\n      // let numBuild = countBuilds(filterArts(arts, subproblem.filter))\n\n      if (numBuild <= minFilterCount) return { command: 'iterate', threshold: wrap.buildValues[maxBuildsToShow - 1], subproblem }\n      return { command: 'split', threshold: wrap.buildValues[maxBuildsToShow - 1], minCount: minFilterCount, maxIter: maxSplitIters, subproblem }\n    }\n    function requestShareWork(sender: number): WorkerCommand {\n      return { command: 'share', sender }\n    }\n\n    status.total = Object.values(arts.values).reduce((prod, arts) => prod * arts.length, 1)\n    const finalizedList: Promise<FinalizeResult>[] = []\n    for (let i = 0; i < maxWorkers; i++) {\n      const worker = new Worker()\n      workers.push(worker)\n\n      const setup: Setup = {\n        command: \"setup\",\n        id: i, arts, artsVec,\n        optimizationTarget: optimizationTargetNode,\n        artSetExclusion: artSetExclusion,\n        plotBase: plotBaseNode,\n        maxBuilds: maxBuildsToShow,\n        filters: constraints\n      }\n      worker.postMessage(setup, undefined)\n      // if (i === 0) {\n      //   const countCommand: WorkerCommand = { command: \"count\", exclusion: artSetExclusion, arts: [arts, prepruneArts] }\n      //   worker.postMessage(countCommand, undefined)\n      // }\n      let finalize: (_: FinalizeResult) => void\n      const finalized = new Promise<FinalizeResult>(r => finalize = r)\n      worker.onmessage = async ({ data }: { data: { id: number } & WorkerResult }) => {\n        switch (data.command) {\n          case \"interim\":\n            status.tested += data.tested\n            status.failed += data.failed\n            status.skipped += data.skipped\n            if (data.buildValues) {\n              wrap.buildValues.push(...data.buildValues)\n              wrap.buildValues.sort((a, b) => b - a).splice(maxBuildsToShow)\n            }\n            return\n          case \"split\":\n            workQueue.push(...data.subproblems)\n            if (data.ready && data.id === masterInfo.id) masterInfo.ready = true\n            if (data.ready) {\n              busyWorkerIDs.delete(data.id)\n            }\n            else busyWorkerIDs.add(data.id)\n            idleWorkers.add(data.id)\n            break\n          case \"iterate\":\n            idleWorkers.add(data.id)\n            break\n          case \"finalize\":\n            worker.terminate()\n            finalize(data);\n            return\n          case \"share\":\n            if (data.subproblem) {\n              const splitCommand = { command: 'split', threshold: wrap.buildValues[maxBuildsToShow - 1], minCount: minFilterCount, maxIter: maxSplitIters, subproblem: data.subproblem }\n              workers[data.sender].postMessage(splitCommand)\n              busyWorkerIDs.add(data.sender)\n            }\n            else idleWorkers.add(data.sender)\n            break\n          case \"count\":\n            const [pruned, prepruned] = data.counts\n            status.total = prepruned\n            status.skipped += prepruned - pruned\n            return\n          default: console.log(\"DEBUG\", data)\n        }\n\n        const toLoop = [...idleWorkers]\n        for (const id of toLoop) {\n          const worker = workers[id]\n          let work: WorkerCommand | undefined\n\n          if (workQueue.length >= maxRequestFilterInFlight) work = fetchWork()\n          else if (busyWorkerIDs.has(id)) work = fetchContinueWork()\n          if (!work) work = fetchWork()\n          if (masterInfo.id < 0) {\n            masterInfo.id = id\n            masterInfo.ready = false\n          }\n\n          if (work) {\n            idleWorkers.delete(id)\n            worker.postMessage(work)\n          }\n          else if (!masterInfo.ready) {\n            idleWorkers.delete(id)\n            workers[masterInfo.id].postMessage(requestShareWork(id))\n          }\n        }\n\n        if (busyWorkerIDs.size === 0 && idleWorkers.size === maxWorkers) {\n          workers.forEach(worker => worker.postMessage({ command: 'finalize' }))\n        }\n      }\n\n      cancelled.then(() => worker.terminate())\n      finalizedList.push(finalized)\n    }\n\n    const buildTimer = setInterval(() => setBuildStatus({ type: \"active\", ...status }), 100)\n    const results = await Promise.any([Promise.all(finalizedList), cancelled])\n    clearInterval(buildTimer)\n    cancelToken.current = () => { }\n\n    if (!results) {\n      status.tested = 0\n      status.failed = 0\n      status.skipped = 0\n      status.total = 0\n    } else {\n      if (plotBase) {\n        const plotData = mergePlot(results.map(x => x.plotData!))\n        const plotBaseNode = input.total[plotBase] as NumNode\n        let data = Object.values(plotData)\n        if (KeyMap.unit(targetNode.info?.key) === \"%\")\n          data = data.map(({ value, plot }) => ({ value: value * 100, plot })) as Build[]\n        if (KeyMap.unit(plotBaseNode!.info?.key) === \"%\")\n          data = data.map(({ value, plot }) => ({ value, plot: (plot ?? 0) * 100 })) as Build[]\n        setchartData({\n          valueNode: targetNode,\n          plotNode: plotBaseNode,\n          data\n        })\n      }\n      const builds = mergeBuilds(results.map(x => x.builds), maxBuildsToShow)\n      if (process.env.NODE_ENV === \"development\") console.log(\"Build Result\", builds)\n      buildSettingDispatch({ builds: builds.map(build => build.artifactIds), buildDate: Date.now() })\n      setCurrentPageIndex(0)\n    }\n    setBuildStatus({ ...status, type: \"inactive\", finishTime: performance.now() })\n  }, [characterKey, database, buildSettingDispatch, maxWorkers, buildSetting, equipmentPriority, setCurrentPageIndex])\n\n  const characterName = characterSheet?.name ?? \"Character Name\"\n\n  const setPlotBase = useCallback(plotBase => {\n    buildSettingDispatch({ plotBase })\n    setchartData(undefined)\n  }, [buildSettingDispatch])\n  const dataContext: dataContextObj | undefined = useMemo(() => {\n    return data && teamData && { data, teamData }\n  }, [data, teamData])\n\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"> Opps! It looks like you haven't added any artifacts to GO yet! You should go to the <Link component={RouterLink} to=\"/artifact\">Artifacts</Link> page and add some!</Alert>}\n    {/* Build Generator Editor */}\n    {dataContext && <DataContext.Provider value={dataContext}>\n\n      <Grid container spacing={1} >\n        {/* 1*/}\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\n          {/* character card */}\n          <Box><CharacterCard characterKey={characterKey} onClickTeammate={onClickTeammate} /></Box>\n        </Grid>\n\n        {/* 2 */}\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\n          <CardLight>\n            <CardContent  >\n              <Typography gutterBottom>Main Stat</Typography>\n              <BootstrapTooltip placement=\"top\" title={<Typography><strong>Level Assumption</strong> changes mainstat value to be at least a specific level. Does not change substats.</Typography>}>\n                <Box>\n                  <AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={mainStatAssumptionLevel => buildSettingDispatch({ mainStatAssumptionLevel })} disabled={generatingBuilds} />\n                </Box>\n              </BootstrapTooltip>\n            </CardContent>\n            {/* main stat selector */}\n            <MainStatSelectionCard disabled={generatingBuilds} />\n          </CardLight>\n          <BonusStatsCard />\n        </Grid>\n\n        {/* 3 */}\n        <Grid item xs={12} sm={6} lg={6} display=\"flex\" flexDirection=\"column\" gap={1}>\n          <ArtifactSetConfig disabled={generatingBuilds} />\n\n          {/* use excluded */}\n          <UseExcluded disabled={generatingBuilds} artsDirty={artsDirty} />\n\n          {/* use equipped */}\n          <UseEquipped disabled={generatingBuilds} />\n\n          <Button fullWidth startIcon={allowPartial ? <CheckBox /> : <CheckBoxOutlineBlank />} color={allowPartial ? \"success\" : \"secondary\"} onClick={() => buildSettingDispatch({ allowPartial: !allowPartial })}>{t`tabOptimize.allowPartial`}</Button>\n          { /* Level Filter */}\n          <CardLight>\n            <CardContent sx={{ py: 1 }}>\n              Artifact Level Filter\n            </CardContent>\n            <ArtifactLevelSlider levelLow={levelLow} levelHigh={levelHigh}\n              setLow={levelLow => buildSettingDispatch({ levelLow })}\n              setHigh={levelHigh => buildSettingDispatch({ levelHigh })}\n              setBoth={(levelLow, levelHigh) => buildSettingDispatch({ levelLow, levelHigh })}\n              disabled={generatingBuilds}\n            />\n          </CardLight>\n\n          {/*Minimum Final Stat Filter */}\n          <StatFilterCard disabled={generatingBuilds} />\n\n        </Grid>\n      </Grid>\n      {/* Footer */}\n      <Grid container spacing={1}>\n        <Grid item flexGrow={1} >\n          <ButtonGroup>\n            <Button\n              disabled={!characterKey || generatingBuilds || !optimizationTarget || !objPathValue(data?.getDisplay(), optimizationTarget)}\n              color={characterKey ? \"success\" : \"warning\"}\n              onClick={generateBuilds}\n              startIcon={<FontAwesomeIcon icon={faCalculator} />}\n            >Generate Builds</Button>\n            <DropdownButton disabled={generatingBuilds || !characterKey}\n              title={<span><b>{maxBuildsToShow}</b> {maxBuildsToShow === 1 ? \"Build\" : \"Builds\"}</span>}>\n              <MenuItem>\n                <Typography variant=\"caption\" color=\"info.main\">\n                  Decreasing the number of generated build will decrease build calculation time for large number of builds.\n                </Typography>\n              </MenuItem>\n              <Divider />\n              {maxBuildsToShowList.map(v => <MenuItem key={v}\n                onClick={() => buildSettingDispatch({ maxBuildsToShow: v })}>{v} {v === 1 ? \"Build\" : \"Builds\"}</MenuItem>)}\n            </DropdownButton>\n            <DropdownButton disabled={generatingBuilds || !characterKey}\n              title={<span><b>{maxWorkers}</b> {maxWorkers === 1 ? \"Thread\" : \"Threads\"}</span>}>\n              <MenuItem>\n                <Typography variant=\"caption\" color=\"info.main\">\n                  Increasing the number of threads will speed up build time, but will use more CPU power.\n                </Typography>\n              </MenuItem>\n              <Divider />\n              {range(1, defThreads).reverse().map(v => <MenuItem key={v}\n                onClick={() => setMaxWorkers(v)}>{v} {v === 1 ? \"Thread\" : \"Threads\"}</MenuItem>)}\n            </DropdownButton>\n            <Button\n              disabled={!generatingBuilds}\n              color=\"error\"\n              onClick={() => cancelToken.current()}\n              startIcon={<Close />}\n            >Cancel</Button>\n          </ButtonGroup>\n        </Grid>\n        <Grid item>\n          <span>Optimization Target: </span>\n          {<OptimizationTargetSelector\n            optimizationTarget={optimizationTarget}\n            setTarget={target => buildSettingDispatch({ optimizationTarget: target })}\n            disabled={!!generatingBuilds}\n          />}\n        </Grid>\n      </Grid>\n\n      {!!characterKey && <BuildAlert {...{ status: buildStatus, characterName, maxBuildsToShow }} />}\n      {tcMode && <Box >\n        <ChartCard disabled={generatingBuilds} chartData={chartData} plotBase={plotBase} setPlotBase={setPlotBase} />\n      </Box>}\n      <CardLight>\n        <CardContent>\n          <Box display=\"flex\" alignItems=\"center\" gap={1} mb={1} >\n            <Typography sx={{ flexGrow: 1 }}>\n              {builds ? <span>Showing <strong>{builds.length}</strong> Builds generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\n                : <span>Select a character to generate builds.</span>}\n            </Typography>\n            <Button disabled={!builds.length} color=\"error\" onClick={() => buildSettingDispatch({ builds: [], buildDate: 0 })} >Clear Builds</Button>\n          </Box>\n          <Grid container display=\"flex\" spacing={1}>\n            <Grid item><HitModeToggle size=\"small\" /></Grid>\n            <Grid item><ReactionToggle size=\"small\" /></Grid>\n            <Grid item flexGrow={1} />\n            <Grid item><SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\n              <ToggleButton value={false} disabled={!compareData}>\n                <small>Show New artifact Stats</small>\n              </ToggleButton>\n              <ToggleButton value={true} disabled={compareData}>\n                <small>Compare against equipped artifacts</small>\n              </ToggleButton>\n            </SolidToggleButtonGroup></Grid>\n          </Grid>\n        </CardContent>\n      </CardLight>\n\n      {numPages > 1 && <PageBrowser numPages={numPages} pageIdx={currentPageIndex} setPageIdex={setPageIdx} />}\n      <OptimizationTargetContext.Provider value={optimizationTarget}>\n        <BuildList buildsArts={buildsArts} characterKey={characterKey} data={data} compareData={compareData} disabled={!!generatingBuilds} pageIdx={currentPageIndex} />\n      </OptimizationTargetContext.Provider>\n      {numPages > 1 && <PageBrowser numPages={numPages} pageIdx={currentPageIndex} setPageIdex={setPageIdx} />}\n    </DataContext.Provider>}\n  </Box>\n}\n\nconst maxArtsToShowPerPage = 5\nfunction BuildList({ buildsArts, characterKey, data, compareData, disabled, pageIdx }: {\n  buildsArts: ICachedArtifact[][],\n  characterKey?: \"\" | CharacterKey,\n  data?: UIData,\n  compareData: boolean,\n  disabled: boolean,\n  pageIdx: number,\n}) {\n  // Memoize the build list because calculating/rendering the build list is actually very expensive, which will cause longer optimization times.\n  const list = useMemo(() => <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\n    {buildsArts?.slice(maxArtsToShowPerPage * pageIdx, maxArtsToShowPerPage * (pageIdx + 1))\n      .map((build, index) => characterKey && data && <DataContextWrapper\n        key={index + build.join()}\n        characterKey={characterKey}\n        build={build}\n        oldData={data}\n      >\n        <BuildDisplayItem index={maxArtsToShowPerPage * pageIdx + index} compareBuild={compareData} disabled={disabled} />\n      </DataContextWrapper>\n      )}\n  </Suspense>, [buildsArts, characterKey, data, compareData, disabled, pageIdx])\n  return list\n}\n\ntype Prop = {\n  children: React.ReactNode\n  characterKey: CharacterKey,\n  build: ICachedArtifact[],\n  oldData: UIData,\n}\nfunction DataContextWrapper({ children, characterKey, build, oldData }: Prop) {\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build)\n  const providerValue = useMemo(() => teamData && ({ data: teamData[characterKey]!.target, teamData, oldData }), [teamData, oldData, characterKey])\n  if (!providerValue) return null\n  return <DataContext.Provider value={providerValue}>\n    {children}\n  </DataContext.Provider>\n}\n\nfunction PageBrowser({ numPages, pageIdx, setPageIdex }: {\n  numPages: number,\n  pageIdx: number,\n  setPageIdex: (e: any, n: number) => void\n}) {\n  return <CardDark ><CardContent>\n    <Grid container>\n      <Grid item flexGrow={1}>\n        <Pagination count={numPages} page={pageIdx + 1} onChange={setPageIdex} />\n      </Grid>\n      <Grid item>\n        page {pageIdx + 1} / {numPages}\n        {/* <ShowingArt numShowing={artifactsToShow.length} total={artifactUpgradeOpts?.arts.length} /> */}\n      </Grid>\n    </Grid>\n  </CardContent></CardDark>\n}\n","import { faEdit, faSave } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Favorite, FavoriteBorder } from \"@mui/icons-material\";\nimport { Badge, Box, Button, CardActionArea, CardContent, Divider, Grid, IconButton, Typography } from \"@mui/material\";\nimport React, { useContext, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useNavigate } from \"react-router-dom\";\nimport Assets from \"../../../Assets/Assets\";\nimport ArtifactCardNano from \"../../../Components/Artifact/ArtifactCardNano\";\nimport CardLight from \"../../../Components/Card/CardLight\";\nimport ColorText from \"../../../Components/ColoredText\";\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\nimport ImgIcon from \"../../../Components/Image/ImgIcon\";\nimport { Stars } from \"../../../Components/StarDisplay\";\nimport StatIcon from \"../../../Components/StatIcon\";\nimport WeaponCardNano from \"../../../Components/Weapon/WeaponCardNano\";\nimport CharacterSheet, { TalentSheetElementKey } from \"../../../Data/Characters/CharacterSheet\";\nimport { DataContext } from \"../../../Context/DataContext\";\nimport { uiInput as input } from \"../../../Formula\";\nimport { ReadNode } from \"../../../Formula/type\";\nimport KeyMap, { valueString } from \"../../../KeyMap\";\nimport { amplifyingReactions, transformativeReactions } from \"../../../KeyMap/StatConstants\";\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\nimport { allElementsWithPhy, allSlotKeys, ElementKey } from \"../../../Types/consts\";\nimport { range } from \"../../../Util/Util\";\nimport CharacterCardPico from \"../../../Components/Character/CharacterCardPico\";\nimport StatInput from \"../../../Components/StatInput\";\nimport { CharacterContext } from \"../../../Context/CharacterContext\";\nimport useDBState from \"../../../ReactHooks/useDBState\";\nimport { initCharMeta } from \"../../../stateInit\";\n\nexport default function TabOverview() {\n  const { characterSheet, character: { key: characterKey, equippedWeapon, team } } = useContext(CharacterContext)\n  const { data, } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(characterKey)\n  const navigate = useNavigate()\n  const { t } = useTranslation(\"page_character\")\n  const charEle = data.get(input.charEle).value as ElementKey\n  const weaponTypeKey = characterSheet.weaponTypeKey\n  const level = data.get(input.lvl).value\n  const ascension = data.get(input.asc).value\n  const constellation = data.get(input.constellation).value\n  const tlvl = {\n    auto: data.get(input.total.auto).value,\n    skill: data.get(input.total.skill).value,\n    burst: data.get(input.total.burst).value,\n  }\n  const tBoost = {\n    auto: data.get(input.bonus.auto).value,\n    skill: data.get(input.bonus.skill).value,\n    burst: data.get(input.bonus.burst).value,\n  }\n  const [{ favorite }, setCharMeta] = useDBState(`charMeta_${characterKey}`, initCharMeta)\n  return <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\n    <Grid item xs={8} sm={5} md={4} lg={2.5}  >\n      {/* Image card with star and name and level */}\n      <CardLight >\n        <Box src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\n        <CardContent>\n          <Typography variant=\"h5\" >\n            {characterSheet.name}&nbsp;\n            <ImgIcon sx={{ pr: 0.5 }} src={Assets.weaponTypes?.[weaponTypeKey]} />\n            {StatIcon[charEle]}\n            <IconButton sx={{ p: 0.5, mt: -0.5 }} onClick={() => setCharMeta({ favorite: !favorite })}>\n              {favorite ? <Favorite /> : <FavoriteBorder />}\n            </IconButton>\n          </Typography>\n          <Typography variant=\"h6\"><Stars stars={characterSheet.rarity} colored /></Typography>\n          <Typography variant=\"h5\">Lvl. {CharacterSheet.getLevelString(level, ascension)}</Typography>\n          <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"talent\")}>\n            <Grid container spacing={1} mt={-1}>\n              {([\"auto\", \"skill\", \"burst\"] as TalentSheetElementKey[]).map(tKey =>\n                <Grid item xs={4} key={tKey}>\n                  <Badge badgeContent={tlvl[tKey]} color={tBoost[tKey] ? \"info\" : \"secondary\"}\n                    overlap=\"circular\"\n                    anchorOrigin={{\n                      vertical: 'bottom',\n                      horizontal: 'right',\n                    }}\n                    sx={{\n                      width: \"100%\",\n                      height: \"100%\",\n                      \"& > .MuiBadge-badge\": {\n                        fontSize: \"1.25em\",\n                        padding: \".25em .4em\",\n                        borderRadius: \".5em\",\n                        lineHeight: 1,\n                        height: \"1.25em\"\n                      }\n                    }}>\n                    <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey, charEle)?.img} width=\"100%\" height=\"auto\" />\n                  </Badge>\n                </Grid>)}\n            </Grid>\n          </CardActionArea>\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\n          <Grid container spacing={1}>\n            {range(1, 6).map(i =>\n              <Grid item xs={4} key={i}>\n                <CardActionArea onClick={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}>\n                  <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i}` as TalentSheetElementKey, charEle)?.img}\n                    sx={{\n                      ...(constellation >= i ? {} : { filter: \"brightness(50%)\" })\n                    }}\n                    width=\"100%\" height=\"auto\" />\n                </CardActionArea>\n              </Grid>)}\n          </Grid>\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{t(\"teammates\")}</Typography>\n          <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"teambuffs\")}>\n            <Grid container columns={3} spacing={1}>\n              {range(0, 2).map(i => <Grid key={i} item xs={1} height=\"100%\"><CharacterCardPico characterKey={team[i]} index={i} /></Grid>)}\n            </Grid>\n          </CardActionArea>\n        </CardContent>\n      </CardLight>\n    </Grid>\n    <Grid item xs={12} sm={7} md={8} lg={9.5} sx={{\n      display: \"flex\", flexDirection: \"column\", gap: 1\n    }} >\n      <Grid container spacing={1} columns={{ xs: 2, sm: 2, md: 3, lg: 4, xl: 6 }}>\n        <Grid item xs={1}>\n          <WeaponCardNano weaponId={equippedWeapon} BGComponent={CardLight} onClick={() => navigate(\"equip\")} />\n        </Grid>\n        {allSlotKeys.map(slotKey =>\n          <Grid item key={slotKey} xs={1} >\n            <ArtifactCardNano artifactId={data.get(input.art[slotKey].id).value} slotKey={slotKey} BGComponent={CardLight} onClick={() => navigate(\"equip\")} />\n          </Grid>)}\n      </Grid>\n      <MainStatsCards />\n    </Grid>\n  </Grid >\n}\nconst EDIT = \"Edit Stats\"\nconst EXIT = \"EXIT\"\n\nconst mainBaseKeys = [\"atk\", \"hp\", \"def\"] as const\nconst mainSubKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"] as const\nconst mainReadNodes = [...mainBaseKeys, ...mainSubKeys].map(k => input.total[k])\nconst mainEditKeys = [\"atk_\", \"atk\", \"hp_\", \"hp\", \"def_\", \"def\", ...mainSubKeys] as const\n\nconst otherStatReadNodes = [\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_dmg_`]),\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_res_`]),\n  ...([\"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\"] as const).map(x => input.total[x])\n]\nconst otherStatKeys = otherStatReadNodes.map(x => x.info!.key!)\n\nconst miscStatReadNodes = [\n  input.total.all_dmg_,\n  ...allElementsWithPhy.map(x => input.total[`${x}_enemyRes_`]),\n  input.total.normal_dmg_, input.total.normal_critRate_,\n  input.total.charged_dmg_, input.total.charged_critRate_,\n  input.total.plunging_dmg_, input.total.plunging_critRate_,\n  input.total.skill_dmg_, input.total.skill_critRate_,\n  input.total.burst_dmg_, input.total.burst_critRate_,\n  ...Object.keys(transformativeReactions).map(x => input.total[`${x}_dmg_`]),\n  ...Object.keys(amplifyingReactions).map(x => input.total[`${x}_dmg_`]),\n  ...([\"moveSPD_\", \"atkSPD_\", \"weakspotDMG_\"] as const).map(x => input.total[x]),\n  input.total.dmgRed_\n]\nconst miscStatkeys = miscStatReadNodes.map(x => x.info!.key!)\n\nconst statBreakpoint = {\n  xs: 12, sm: 12, md: 6, lg: 4,\n} as const\n\nfunction StatDisplayContent({ nodes, statBreakpoint, extra }: { nodes: ReadNode<number>[], statBreakpoint: object, extra?: Displayable }) {\n  const { data, oldData } = useContext(DataContext)\n  return <Grid container columnSpacing={{ xs: 2, lg: 3 }} rowSpacing={1}>\n    {nodes.map(rn => <Grid item key={rn.info?.key} {...statBreakpoint} >\n      {<NodeFieldDisplay node={data.get(rn)} oldValue={oldData?.get(rn)?.value} />}\n    </Grid>)}\n    {extra}\n  </Grid>\n}\n\nfunction MainStatsCards() {\n  const { character: { bonusStats }, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const specialNode = data.get(input.special)\n\n  return <>\n    <StatDisplayCard\n      title=\"Main Stats\"\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={mainReadNodes}\n        extra={specialNode && <Grid item {...statBreakpoint} display=\"flex\" flexDirection=\"row\" justifyContent=\"space-between\">\n          <span><b>Special:</b> <ColorText color={specialNode.info.variant}>{specialNode.info.key && StatIcon[specialNode.info.key]} {specialNode.info.key && KeyMap.get(specialNode.info.key)}</ColorText></span>\n          <span >{valueString(specialNode.value, specialNode.unit)}</span>\n        </Grid>}\n      />}\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\n        {mainEditKeys.map(statKey => {\n          const statName = KeyMap.get(statKey)\n          return <Grid item xs={12} lg={6} key={statKey}>\n            <StatInput\n              name={<span>{StatIcon[statKey]} {statName}</span>}\n              placeholder={KeyMap.getStr(statKey)}\n              value={bonusStats[statKey] ?? 0}\n              percent={KeyMap.unit(statKey) === \"%\"}\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\n            />\n          </Grid>\n        })}\n      </Grid>}\n    />\n    <StatDisplayCard\n      title=\"Other Stats\"\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={otherStatReadNodes} />}\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\n        {otherStatKeys.map(statKey => {\n          const statName = KeyMap.get(statKey)\n          return <Grid item xs={12} lg={6} key={statKey}>\n            <StatInput\n              name={<span>{StatIcon[statKey]} {statName}</span>}\n              placeholder={KeyMap.getStr(statKey)}\n              value={bonusStats[statKey] ?? 0}\n              percent={KeyMap.unit(statKey) === \"%\"}\n              defaultValue={undefined}\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\n            />\n          </Grid>\n        })}\n      </Grid>}\n    />\n    <StatDisplayCard\n      title=\"Misc Stats\"\n      content={<StatDisplayContent statBreakpoint={{\n        xs: 12, sm: 12, md: 6,\n      }} nodes={miscStatReadNodes} />}\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\n        {miscStatkeys.map(statKey => {\n          const statName = KeyMap.get(statKey)\n          return <Grid item xs={12} lg={6} key={statKey}>\n            <StatInput\n              name={<span>{StatIcon[statKey]} {statName}</span>}\n              placeholder={KeyMap.getStr(statKey)}\n              value={bonusStats[statKey] ?? 0}\n              percent={KeyMap.unit(statKey) === \"%\"}\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\n            />\n          </Grid>\n        })}\n      </Grid>}\n    />\n  </>\n}\nfunction StatDisplayCard({ title, content, editContent }) {\n  const [edit, setedit] = useState(false)\n  return <CardLight>\n    <CardContent sx={{ py: 1 }}>\n      <Box display=\"flex\" justifyContent=\"space-between\">\n        <Typography variant=\"subtitle1\">{title}</Typography>\n        <Button size=\"small\" color={edit ? \"error\" : \"info\"} onClick={() => setedit(!edit)} >\n          <span><FontAwesomeIcon icon={edit ? faSave : faEdit} /> {edit ? EXIT : EDIT}</span>\n        </Button>\n      </Box>\n    </CardContent>\n    <Divider />\n    <CardContent>\n      {edit ? editContent : content}\n    </CardContent>\n  </CardLight>\n}\n","import { Box, CardActionArea, CardContent, Grid, MenuItem, Typography, useMediaQuery } from \"@mui/material\";\nimport { useTheme } from \"@mui/system\";\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { CharacterContext } from \"../../../Context/CharacterContext\";\nimport CardDark from \"../../../Components/Card/CardDark\";\nimport CardLight from \"../../../Components/Card/CardLight\";\nimport ConditionalWrapper from \"../../../Components/ConditionalWrapper\";\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\nimport DropdownButton from \"../../../Components/DropdownMenu/DropdownButton\";\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\nimport { TalentSheetElementKey } from \"../../../Data/Characters/CharacterSheet\";\nimport { DataContext } from '../../../Context/DataContext';\nimport { uiInput as input } from \"../../../Formula\";\nimport { NumNode } from \"../../../Formula/type\";\nimport { NodeDisplay } from '../../../Formula/uiData';\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\nimport { ElementKey } from \"../../../Types/consts\";\nimport { DocumentSection } from \"../../../Types/sheet\";\nimport { range } from \"../../../Util/Util\";\n\nconst talentSpacing = {\n  xs: 12,\n  sm: 6,\n  md: 4\n}\n\nexport default function CharacterTalentPane() {\n  const { character, characterSheet } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(character.key)\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]] as [TalentSheetElementKey, string][]\n  const passivesList: [tKey: TalentSheetElementKey, tText: string, asc: number][] = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\n  const charEle = data.get(input.charEle).value as ElementKey | undefined\n  const ascension = data.get(input.asc).value\n  const constellation = data.get(input.constellation).value\n\n  const theme = useTheme();\n  const grlg = useMediaQuery(theme.breakpoints.up('lg'));\n  const constellationCards = useMemo(() => range(1, 6).map(i =>\n    <SkillDisplayCard\n      talentKey={`constellation${i}` as TalentSheetElementKey}\n      subtitle={`Constellation Lv. ${i}`}\n      onClickTitle={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}\n    />), [constellation, characterDispatch])\n  return <>\n    <ReactionDisplay />\n    <Grid container spacing={1}>\n      {/* constellations for 4column */}\n      {grlg && <Grid item xs={12} md={12} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\n        <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\n        {constellationCards.map((c, i) => <Box key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} >{c}</Box>)}\n      </Grid>}\n      <Grid item xs={12} md={12} lg={9} container spacing={1} >\n        {/* auto, skill, burst */}\n        {skillBurstList.map(([tKey, tText]) =>\n          <Grid item key={tKey} {...talentSpacing} >\n            <SkillDisplayCard\n              talentKey={tKey}\n              subtitle={tText}\n            />\n          </Grid>)}\n        {!!characterSheet.getTalentOfKey(\"sprint\", charEle) && <Grid item {...talentSpacing} >\n          <SkillDisplayCard\n            talentKey=\"sprint\"\n            subtitle=\"Alternative Sprint\"\n          />\n        </Grid>}\n        {!!characterSheet.getTalentOfKey(\"passive\", charEle) && <Grid item {...talentSpacing} >\n          <SkillDisplayCard\n            talentKey=\"passive\"\n            subtitle=\"Passive\"\n          />\n        </Grid>}\n        {/* passives */}\n        {passivesList.map(([tKey, tText, asc]) => {\n          let enabled = ascension >= asc\n          if (!characterSheet.getTalentOfKey(tKey, charEle)) return null\n          return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} {...talentSpacing} >\n            <SkillDisplayCard\n              talentKey={tKey}\n              subtitle={tText}\n            />\n          </Grid>\n        })}\n      </Grid>\n      {/* constellations for < 4 columns */}\n      {!grlg && <Grid item xs={12} md={12} lg={3} container spacing={1} >\n        <Grid item xs={12}>\n          <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\n        </Grid>\n        {constellationCards.map((c, i) => <Grid item key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} {...talentSpacing} >{c}</Grid>)}\n      </Grid>}\n    </Grid>\n  </>\n}\nfunction ReactionDisplay() {\n  const { data } = useContext(DataContext)\n  const reaction = data.getDisplay().reaction as { [key: string]: NodeDisplay }\n  return <CardLight sx={{ mb: 1 }}>\n    <CardContent>\n      <Grid container spacing={1}>\n        {Object.entries(reaction).map(([key, node]) => {\n          return <Grid item key={key}>\n            <CardDark><CardContent sx={{ p: 1, \"&:last-child\": { pb: 1 } }}>\n              <NodeFieldDisplay node={node} />\n            </CardContent></CardDark>\n          </Grid>\n        })}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\n\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\ntype SkillDisplayCardProps = {\n  talentKey: TalentSheetElementKey,\n  subtitle: string,\n  onClickTitle?: (any) => any\n}\nfunction SkillDisplayCard({ talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\n  const { character: { talent }, characterSheet, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n\n  const actionWrapeprFunc = useCallback(\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\n    [onClickTitle],\n  )\n\n  const setTalentLevel = useCallback((tKey: TalentSheetElementKey, newTalentLevelKey: number) =>\n    characterDispatch({ talent: { ...talent, [tKey]: newTalentLevelKey } }), [talent, characterDispatch])\n\n  let header: Displayable | null = null\n\n  if (talentKey in talent) {\n    const levelBoost = data.get(input.bonus[talentKey] as NumNode).value\n    const level = data.get(input.total[talentKey]).value\n    const asc = data.get(input.asc).value\n\n    header = <DropdownButton fullWidth title={`Talent Lv. ${level}`} color={levelBoost ? \"info\" : \"primary\"} sx={{ borderRadius: 0 }}>\n      {range(1, talentLimits[asc]).map(i =>\n        <MenuItem key={i} selected={talent[talentKey] === (i)} disabled={talent[talentKey] === (i)} onClick={() => setTalentLevel(talentKey, i)}>Talent Lv. {i + levelBoost}</MenuItem>)}\n    </DropdownButton>\n  }\n  const talentSheet = characterSheet.getTalentOfKey(talentKey, data.get(input.charEle).value as ElementKey | undefined)\n\n  // Hide header if the header matches the current talent\n  const hideHeader = (section: DocumentSection): boolean => {\n    let headerAction = section.header?.action\n    if (headerAction && (typeof headerAction !== \"string\")) {\n      const key: string = headerAction.props.children.props.key18\n      return key.includes(talentKey)\n    }\n    return false\n  }\n\n  return <CardLight sx={{ height: \"100%\" }}>\n    {header}\n    <CardContent>\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\n          <Grid item>\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\n          </Grid>\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\n          </Grid>\n        </Grid>\n      </ConditionalWrapper>\n      {/* Display document sections */}\n      {talentSheet?.sections ? <DocumentDisplay sections={talentSheet.sections} hideDesc hideHeader={hideHeader} /> : null}\n    </CardContent>\n  </CardLight>\n}\n","import { PersonAdd } from \"@mui/icons-material\";\nimport { CardContent, CardHeader, Divider, Grid, Typography } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport React, { useContext, useMemo } from 'react';\nimport CardLight from \"../../../Components/Card/CardLight\";\nimport CharacterCard from \"../../../Components/Character/CharacterCard\";\nimport CharacterAutocomplete from \"../../../Components/Character/CharacterAutocomplete\";\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\nimport InfoTooltip from \"../../../Components/InfoTooltip\";\nimport { ArtifactSheet } from \"../../../Data/Artifacts/ArtifactSheet\";\nimport { resonanceSheets } from \"../../../Data/Resonance\";\nimport { DataContext, dataContextObj } from \"../../../Context/DataContext\";\nimport { CharacterContext, CharacterContextObj } from \"../../../Context/CharacterContext\";\nimport { uiInput as input } from \"../../../Formula\";\nimport { NodeDisplay } from \"../../../Formula/uiData\";\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\nimport useCharSelectionCallback from \"../../../ReactHooks/useCharSelectionCallback\";\nimport usePromise from \"../../../ReactHooks/usePromise\";\nimport { ElementKey } from \"../../../Types/consts\";\nimport { objPathValue, range } from \"../../../Util/Util\";\nimport { useTranslation } from \"react-i18next\";\n\nexport default function TabTeambuffs() {\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} alignItems=\"stretch\">\n    <Grid container spacing={1}>\n      <Grid item xs={12} md={6} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n        <TeamBuffDisplay />\n        <ResonanceDisplay />\n      </Grid>\n      {range(0, 2).map(i => <Grid item xs={12} md={6} lg={3} key={i}>\n        <TeammateDisplay index={i} />\n      </Grid>)}\n    </Grid>\n  </Box>\n}\nexport function TeamBuffDisplay() {\n  const { data, oldData } = useContext(DataContext)\n  const teamBuffs = data.getTeamBuff()\n  const nodes: Array<[string[], NodeDisplay<number>]> = []\n  Object.entries(teamBuffs.total ?? {}).forEach(([key, node]) =>\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"total\", key], node]))\n  Object.entries(teamBuffs.premod ?? {}).forEach(([key, node]) =>\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"premod\", key], node]))\n  Object.entries(teamBuffs.enemy ?? {}).forEach(([key, node]) =>\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"enemy\", key], node]))\n  if (!nodes.length) return null\n  return <CardLight>\n    <CardContent>\n      Team Buffs\n    </CardContent>\n    <Divider />\n    <CardContent>\n      <Grid container>\n        {nodes.map(([path, n], i) => n && <Grid item xs={12} key={n.info.key} >\n          <NodeFieldDisplay node={n} oldValue={objPathValue(oldData?.getTeamBuff(), path)?.value} />\n        </Grid>)}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\nfunction ResonanceDisplay() {\n  const { data } = useContext(DataContext)\n  return <>\n    {resonanceSheets.map((res, i) => {\n      const icon = <InfoTooltip title={<Typography>{res.desc}</Typography>} />\n      const title = <span>{res.name} {icon}</span>\n      return <CardLight key={i} sx={{ opacity: res.canShow(data) ? 1 : 0.5, }}>\n        <CardHeader title={title} action={res.icon} titleTypographyProps={{ variant: \"subtitle2\" }} />\n        {res.canShow(data) && <Divider />}\n        {res.canShow(data) && <CardContent>\n          <DocumentDisplay sections={res.sections} teamBuffOnly hideDesc />\n        </CardContent>}\n      </CardLight>\n    })}\n  </>\n}\nfunction TeammateDisplay({ index }: { index: number }) {\n  const { teamData } = useContext(DataContext)\n  const { t } = useTranslation(\"page_character\")\n  const { character: active, characterDispatch: activeCharacterDispatch } = useContext(CharacterContext)\n  const activeCharacterKey = active.key\n  const characterKey = active.team[index]\n  const characterDispatch = useCharacterReducer(characterKey)\n  const onClickHandler = useCharSelectionCallback()\n\n  const dataBundle = teamData[characterKey]\n  const teammateCharacterContext: CharacterContextObj | undefined = useMemo(() => dataBundle && {\n    character: dataBundle.character,\n    characterSheet: dataBundle.characterSheet,\n    characterDispatch\n  }, [dataBundle, characterDispatch])\n  const teamMateDataContext: dataContextObj | undefined = useMemo(() => dataBundle && {\n    data: dataBundle.target,\n    teamData: teamData,\n  }, [dataBundle, teamData])\n  return <CardLight>\n    <CardContent>\n      <CharacterAutocomplete fullWidth value={characterKey}\n        onChange={charKey => activeCharacterDispatch({ type: \"team\", index, charKey })}\n        disable={ck => ck === activeCharacterKey || (ck !== \"\" && active.team.includes(ck))}\n        labelText={t(\"teammate\", { count: index + 1 })}\n        defaultText={t(\"none\")}\n        defaultIcon={<PersonAdd />}\n        showDefault\n      />\n    </CardContent>\n    {teammateCharacterContext && <CharacterContext.Provider value={teammateCharacterContext}>\n      {teamMateDataContext && <DataContext.Provider value={teamMateDataContext}>\n        <CharacterCard characterKey={characterKey}\n          onClickHeader={onClickHandler}\n          artifactChildren={<CharArtifactCondDisplay />}\n          weaponChildren={<CharWeaponCondDisplay />}\n          characterChildren={<CharTalentCondDisplay />}\n          isTeammateCard\n        />\n      </DataContext.Provider>}\n    </CharacterContext.Provider>}\n  </CardLight>\n\n}\nfunction CharArtifactCondDisplay() {\n  const { data, } = useContext(DataContext)\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const sections = useMemo(() => artifactSheets &&\n    Object.entries(ArtifactSheet.setEffects(artifactSheets, data))\n      .flatMap(([setKey, setNums]) =>\n        setNums.flatMap(sn => artifactSheets[setKey]!.setEffectDocument(sn)!))\n    , [artifactSheets, data])\n  if (!sections) return null\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\n}\nfunction CharWeaponCondDisplay() {\n  const { character: { key: charKey } } = useContext(CharacterContext)\n  const { teamData } = useContext(DataContext)\n  const weaponSheet = teamData[charKey]!.weaponSheet\n  if (!weaponSheet.document) return null\n  return <DocumentDisplay sections={weaponSheet.document} teamBuffOnly={true} />\n}\nfunction CharTalentCondDisplay() {\n  const { character: { key: charKey } } = useContext(CharacterContext)\n  const { data, teamData } = useContext(DataContext)\n  const characterSheet = teamData[charKey]!.characterSheet\n  const talent = characterSheet.getTalent(data.get(input.charEle).value as ElementKey)!\n  const sections = Object.values(talent.sheets).flatMap(sts => sts.sections)\n  if (!sections) return null\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\n}\n","import { assertUnreachable } from \"../Util/Util\"\nimport { forEachNodes } from \"./internal\"\nimport { constant, sum, prod, cmp } from \"./utils\"\nimport { NumNode, ReadNode } from \"./type\"\nimport { precompute } from \"./optimization\"\nimport { fillBuffer } from \"./addedUtils\"\nimport { DynStat } from \"../PageCharacter/CharacterDisplay/Tabs/TabOptimize/common\"\n\nexport function zero_deriv(funct: NumNode, binding: (readNode: ReadNode<number>) => string, diff: string): boolean {\n  let ret = true\n  forEachNodes([funct], _ => { }, f => {\n    const { operation } = f\n    switch (operation) {\n      case \"read\":\n        if (f.type !== \"number\" || (f.accu && f.accu !== \"add\"))\n          throw new Error(`Unsupported [${operation}] node in zero_deriv`)\n        if (binding(f) === diff) ret = false\n    }\n  })\n  return ret\n}\n\nexport function ddx(f: NumNode, binding: (readNode: ReadNode<number>) => string, diff: string): NumNode {\n  const { operation } = f\n  switch (operation) {\n    case \"read\":\n      if (f.type !== \"number\" || (f.accu && f.accu !== \"add\"))\n        throw new Error(`Unsupported [${operation}] node in d/dx`)\n      const name = binding(f)\n      if (name === diff) return constant(1)\n      return constant(0)\n    case \"const\": return constant(0)\n    case \"res\":\n      if (!zero_deriv(f, binding, diff)) throw new Error(`[${operation}] node takes only constant inputs. ${f}`)\n      return constant(0)\n\n    case \"add\": return sum(...f.operands.map(fi => ddx(fi, binding, diff)))\n    case \"mul\":\n      let ops = f.operands.map((fi, i) => prod(ddx(fi, binding, diff), ...f.operands.filter((v, ix) => ix !== i)))\n      return sum(...ops)\n    case \"sum_frac\":\n      const a = f.operands[0]\n      const da = ddx(a, binding, diff)\n      const b = sum(...f.operands.slice(1,))\n      const db = ddx(b, binding, diff)\n      const denom = prod(sum(...f.operands), sum(...f.operands))\n      const numerator = sum(prod(b, da), prod(-1, a, db))\n      return { operation: \"sum_frac\", operands: [numerator, prod(numerator, -1), denom] }\n\n    case \"min\": case \"max\":\n      switch (f.operands.length) {\n        case 1: return ddx(f.operands[0], binding, diff)\n        case 2:\n          const [arg1, arg2] = f.operands\n          if (operation === \"min\") return cmp(arg1, arg2, ddx(arg2, binding, diff), ddx(arg1, binding, diff))\n          if (operation === \"max\") return cmp(arg1, arg2, ddx(arg1, binding, diff), ddx(arg2, binding, diff))\n          assertUnreachable(operation)\n          break\n        default:\n          throw new Error(`[${operation}] node operates on only 1 or 2 arguments. ${f}`)\n      }\n\n      break\n    case \"threshold\":\n      const [value, threshold, pass, fail] = f.operands\n      if (!zero_deriv(value, binding, diff) || !zero_deriv(threshold, binding, diff))\n        throw new Error(`[${operation}] node must branch on constant inputs. ${f}`)\n      return cmp(value, threshold, ddx(pass, binding, diff), ddx(fail, binding, diff))\n\n    case \"match\": case \"lookup\": case \"subscript\": case \"data\":\n      throw new Error(`Unsupported [${operation}] node in ddx`)\n    default:\n      assertUnreachable(operation)\n  }\n}\n\nexport function diff_debug() {\n  console.log('Youve reached differentiate!!!')\n\n  // Copied stats & formula from arbitrary build of my HuTao\n  const stats: DynStat = { \"0\": 0.284294, \"1\": 0.9462000033378601, \"2\": 0.1, \"3\": 1.48, \"TenacityOfTheMillelith\": 0, \"hp_\": 0.23249999999999998, \"hp\": 1159, \"ShimenawasReminiscence\": 1, \"atk_\": 0.0933, \"atk\": 110.58, \"EmblemOfSeveredFate\": 0, \"enerRech_\": 0.09709999999999999 }\n  const formula1: NumNode = { \"operation\": \"mul\", \"operands\": [{ \"operation\": \"add\", \"operands\": [{ \"operation\": \"mul\", \"operands\": [{ \"operation\": \"add\", \"operands\": [{ \"operation\": \"mul\", \"operands\": [{ \"operation\": \"add\", \"operands\": [{ \"operation\": \"threshold\", \"operands\": [{ \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"TenacityOfTheMillelith\"], \"accu\": \"add\", \"info\": { \"key\": \"TenacityOfTheMillelith\" }, \"type\": \"number\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 2 }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0.2, \"info\": { \"key\": \"_\" } }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0 }], \"info\": { \"key\": \"hp_\", \"source\": \"TenacityOfTheMillelith\" }, \"emptyOn\": \"l\" }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"hp_\"], \"info\": { \"prefix\": \"art\", \"asConst\": true, \"key\": \"hp_\" }, \"type\": \"number\", \"accu\": \"add\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 1 }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 15552.306844604493 }] }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"hp\"], \"info\": { \"prefix\": \"art\", \"asConst\": true, \"key\": \"hp\" }, \"type\": \"number\", \"accu\": \"add\" }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0.05957 }] }, { \"operation\": \"mul\", \"operands\": [{ \"operation\": \"add\", \"operands\": [{ \"operation\": \"threshold\", \"operands\": [{ \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"ShimenawasReminiscence\"], \"accu\": \"add\", \"info\": { \"key\": \"ShimenawasReminiscence\" }, \"type\": \"number\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 2 }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0.18, \"info\": { \"key\": \"_\" } }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0 }], \"info\": { \"key\": \"atk_\", \"source\": \"ShimenawasReminiscence\" }, \"emptyOn\": \"l\" }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"atk_\"], \"info\": { \"prefix\": \"art\", \"asConst\": true, \"key\": \"atk_\" }, \"type\": \"number\", \"accu\": \"add\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 1 }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 507.727969991803 }] }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"atk\"], \"info\": { \"prefix\": \"art\", \"asConst\": true, \"key\": \"atk\" }, \"type\": \"number\", \"accu\": \"add\" }] }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"3\"], \"type\": \"number\", \"accu\": \"add\" }, { \"operation\": \"add\", \"operands\": [{ \"operation\": \"mul\", \"operands\": [{ \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"0\"], \"type\": \"number\", \"accu\": \"add\" }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"1\"], \"type\": \"number\", \"accu\": \"add\" }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 1 }] }, { \"operation\": \"res\", \"operands\": [{ \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"2\"], \"type\": \"number\", \"accu\": \"add\" }] }, { \"operation\": \"add\", \"operands\": [{ \"operation\": \"mul\", \"operands\": [{ \"operation\": \"sum_frac\", \"operands\": [{ \"operation\": \"add\", \"operands\": [{ \"operation\": \"threshold\", \"operands\": [{ \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"WanderersTroupe\"], \"accu\": \"add\", \"info\": { \"key\": \"WanderersTroupe\" }, \"type\": \"number\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 2 }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 80 }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0 }], \"info\": { \"key\": \"eleMas\", \"source\": \"WanderersTroupe\" }, \"emptyOn\": \"l\" }, { \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"eleMas\"], \"info\": { \"prefix\": \"art\", \"asConst\": true, \"key\": \"eleMas\" }, \"type\": \"number\", \"accu\": \"add\" }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 1400 }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 2.7777777777777777 }] }, { \"operation\": \"threshold\", \"operands\": [{ \"operation\": \"read\", \"operands\": [], \"path\": [\"dyn\", \"CrimsonWitchOfFlames\"], \"accu\": \"add\", \"info\": { \"key\": \"CrimsonWitchOfFlames\" }, \"type\": \"number\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 4 }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0.15, \"info\": { \"key\": \"_\" } }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 0 }], \"info\": { \"key\": \"vaporize_dmg_\", \"variant\": \"vaporize\", \"source\": \"CrimsonWitchOfFlames\" }, \"emptyOn\": \"l\" }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 1 }] }, { \"operation\": \"const\", 'type': 'number', \"operands\": [], \"value\": 1.71495 }] }\n  const formula2 = formula1\n\n  var [compute, mapping, buffer] = precompute([formula2], f => f.path[1])\n  fillBuffer(stats, mapping, buffer)\n  var result = compute()[0]\n\n  // Check validity of calculated derivatives\n  const eps = 1e-5\n  let stat2 = { ...stats }\n  stat2['hp_'] = eps + (stat2['hp_'] ?? 0)\n  fillBuffer(stat2, mapping, buffer)\n  var res2 = compute()[0]\n  var dhp_ = ddx(formula2, f => f.path[1], 'hp_')\n  var [c_dhp_, mapping2, buffer2] = precompute([dhp_], f => f.path[1])\n  Object.entries(stats).forEach(([k, v]) => buffer2[mapping2[k] ?? 0] = v)\n  console.log('diff hp_ (numeric/symbolic)', (res2 - result) / eps, c_dhp_()[0])\n\n  stat2 = { ...stats }\n  stat2['hp'] = eps + (stat2['hp'] ?? 0)\n  fillBuffer(stat2, mapping, buffer)\n  res2 = compute()[0]\n  var dhp = ddx(formula2, f => f.path[1], 'hp')\n  var [c_dhp, mapping3, buffer3] = precompute([dhp], f => f.path[1])\n  Object.entries(stats).forEach(([k, v]) => buffer3[mapping3[k] ?? 0] = v)\n  console.log('diff hp (numeric/symbolic)', (res2 - result) / eps, c_dhp()[0])\n\n  stat2 = { ...stats }\n  stat2['atk_'] = eps + (stat2['atk_'] ?? 0)\n  fillBuffer(stat2, mapping, buffer)\n  res2 = compute()[0]\n  var datk_ = ddx(formula2, f => f.path[1], 'atk_')\n  var [c_datk_, buffer4, mapping4] = precompute([datk_], f => f.path[1])\n  Object.entries(stats).forEach(([k, v]) => buffer4[mapping4[k] ?? 0] = v)\n  console.log('diff atk_ (numeric/symbolic)', (res2 - result) / eps, c_datk_()[0])\n\n  stat2 = { ...stats }\n  stat2['eleMas'] = eps + (stat2['eleMas'] ?? 0)\n  fillBuffer(stat2, mapping, buffer)\n  res2 = compute()[0]\n  var deleMas = ddx(formula2, f => f.path[1], 'eleMas')\n  var [c_deleMas, mapping5, buffer5] = precompute([deleMas], f => f.path[1])\n  Object.entries(stats).forEach(([k, v]) => buffer5[mapping5[k] ?? 0] = v)\n  console.log('diff eleMas (numeric/symbolic)', (res2 - result) / eps, c_deleMas()[0])\n}\n","// https://oeis.org/A008287\n// step 1: a basic LUT with a few steps of Pascal's triangle\nvar quadrinomials = [\n  [1],\n  [1, 1, 1, 1,],\n  [1, 2, 3, 4, 3, 2, 1],\n  [1, 3, 6, 10, 12, 12, 10, 6, 3, 1],\n  [1, 4, 10, 20, 31, 40, 44, 40, 31, 20, 10, 4, 1],\n  [1, 5, 15, 35, 65, 101, 135, 155, 155, 135, 101, 65, 35, 15, 5, 1],\n];\n\n// step 2: a function that builds out the LUT if it needs to.\nexport function quadrinomial(n: number, k: number) {\n  while (n >= quadrinomials.length) {\n    let s = quadrinomials.length;\n\n    let nextRow: number[] = [];\n    for (let i = 0, prev = s - 1; i <= 3 * s; i++) {\n      const a = quadrinomials[prev][i - 3] ?? 0\n      const b = quadrinomials[prev][i - 2] ?? 0\n      const c = quadrinomials[prev][i - 1] ?? 0\n      const d = quadrinomials[prev][i] ?? 0\n\n      nextRow[i] = a + b + c + d\n    }\n    quadrinomials.push(nextRow);\n  }\n  return quadrinomials[n][k] ?? 0;\n}\n\n// https://hewgill.com/picomath/javascript/erf.js.html\n// very good algebraic approximation of erf function. Maximum deviation below 1.5e-7\nexport function erf(x: number) {\n  // constants\n  const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741;\n  const a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;\n\n  // Save the sign of x\n  var sign = 1;\n  if (x < 0) sign = -1;\n  x = Math.abs(x);\n\n  // A&S formula 7.1.26\n  var t = 1.0 / (1.0 + p * x);\n  var y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);\n\n  return sign * y;\n}\n\n// Gaussian probability distribution. mean & variance can be omitted for standard Gaussian.\nexport function gaussPDF(x: number, mu?: number, sig2?: number) {\n  if (mu === undefined) mu = 0\n  if (sig2 === undefined) sig2 = 1\n\n  if (sig2 <= 0) return 0\n  return Math.exp(-(mu - x) * (mu - x) / sig2 / 2) / Math.sqrt(2 * Math.PI * sig2)\n}\n","import { QueryResult } from \"./artifactQuery\"\nimport { SubstatKey, allSubstatKeys } from \"../../../../Types/artifact\"\nimport Artifact from \"../../../../Data/Artifacts/Artifact\"\nimport { range } from \"../../../../Util/Util\"\nimport { quadrinomial } from \"../../../../Util/MathUtil\"\n\n// Cartesian product of arrays\nconst cartesian = (...a: any[][]): any[][] => a.reduce((a, b) => a.flatMap(d => b.map(e => [d, e].flat())));\n\n// Manually cached multinomial distribution.\n// Example: sigma([2, 3, 0, 0], 5)\n//   gives the probability (n1=2, n2=3, n3=0, n4=0) given N=5 total rolls. (uniform distribution is assumed for the four bins)\n// `sigr` and `sig_arr` constitute a near perfect hash of all combinations for N=1 to N=5.\n// This function has undefined behavior for N > 5 and N = 0\nconst sig_arr = [270 / 1024, 80 / 1024, 0, 12 / 256, 8 / 256, 120 / 1024, 0, 60 / 1024, 4 / 256, 60 / 1024, 4 / 256, 30 / 1024, 24 / 256, 160 / 1024, 1 / 64, 1 / 64, 24 / 256, 1 / 64, 12 / 256, 0, 6 / 256, 2 / 16, 6 / 256, 0, 81 / 256, 16 / 256, 0, 27 / 64, 12 / 64, 0, 1 / 16, 1 / 16, 12 / 64, 1 / 16, 6 / 64, 3 / 4, 2 / 4, 243 / 1024, 32 / 1024, 0, 108 / 256, 32 / 256, 0, 9 / 64, 6 / 64, 48 / 256, 0, 24 / 256, 3 / 64, 5 / 1024, 3 / 64, 5 / 1024, 0, 405 / 1024, 80 / 1024, 0, 54 / 256, 90 / 1024, 40 / 1024, 0, 1 / 256, 1 / 256, 40 / 1024, 1 / 256, 20 / 1024, 9 / 16, 4 / 16, 0, 1 / 4, 1 / 4, 0, 1 / 4, 27 / 64, 8 / 64, 0, 6 / 16, 4 / 16, 10 / 1024, 0, 10 / 1024, 2 / 16, 0, 0, 0, 15 / 1024, 10 / 1024, 1 / 1024, 1 / 1024, 0, 1 / 1024]\nconst sigr = [35, 64, 70, 21, 33, 45, 12, 0, 53, 76, 48, 86]\nfunction sigma(ss: number[], N: number) {\n  const ssum = ss.reduce((a, b) => a + b);\n  if ((ss.length > 4) || ssum > N) return 0\n  if ((ss.length === 4) && (ssum !== N)) return 0\n  if (ss.length === 3) ss = [...ss, N - ssum]\n  ss.sort().reverse();\n\n  // t = 12\n  // offset = -14\n  let v = 13 * N + ss.length - 14 + 16 * ss[0]\n  if (ss.length > 1) v += 4 * ss[1]\n  const x = v % 12\n  const y = Math.trunc(v / 12) // integer divide\n\n  return sig_arr[x + sigr[y]]\n}\n\nexport function crawlUpgrades(n: number, fn?: (n1234: number[], p: number) => void) {\n  if (n === 0) {\n    fn!([0, 0, 0, 0], 1)\n    return\n  }\n\n  // Binomial(n+3, 3) branches to crawl.\n  for (let i1 = n; i1 >= 0; i1--) {\n    for (let i2 = n - i1; i2 >= 0; i2--) {\n      for (let i3 = n - i1 - i2; i3 >= 0; i3--) {\n        const i4 = n - i1 - i2 - i3;\n        const p_comb = sigma([i1, i2, i3, i4], n)\n        fn!([i1, i2, i3, i4], p_comb)\n      }\n    }\n  }\n}\n\nexport function allUpgradeValues({ statsBase, rollsLeft, subs, skippableDerivs, fourthsubOpts, evalFn }: QueryResult) {\n  // TODO: Include non-5* artifacts\n  let scale = (key: SubstatKey) => key.endsWith('_') ? Artifact.maxSubstatValues(key, 5) / 1000 : Artifact.maxSubstatValues(key, 5) / 10\n  const base = statsBase\n\n  let results: WeightedPoint[] = []\n  crawlUpgrades(rollsLeft, (ns, p) => {\n    if (fourthsubOpts) ns[3] += 1\n    const vals = ns.map((ni, i) => {\n      if (fourthsubOpts && i === 3) return range(7 * ni, 10 * ni)\n      const sub = subs[i]\n      if (sub && !skippableDerivs[allSubstatKeys.indexOf(sub)]) return range(7 * ni, 10 * ni)\n      return [NaN]\n    })\n\n    const allValues: number[][] = cartesian(...vals)\n    allValues.forEach(upVals => {\n      let stats = { ...base }\n      let p_upVals = 1\n      for (let i = 0; i < 3; i++) {\n        if (isNaN(upVals[i])) continue\n\n        const key = subs[i];\n        const val = upVals[i];\n        const ni = ns[i];\n        stats[key] = (stats[key] ?? 0) + val * scale(key)\n        let p_val = (4 ** -ni) * quadrinomial(ni, val - 7 * ni)\n        p_upVals *= p_val\n      }\n      if (fourthsubOpts !== undefined) {\n        fourthsubOpts.forEach(({ sub, subprob }) => {\n          const stats2 = { ...stats }\n          const key = sub\n          const val = upVals[3]\n          const ni = ns[3]\n          stats2[key] = (stats2[key] ?? 0) + val * scale(key)\n          let p_val = (4 ** -ni) * quadrinomial(ni, val - 7 * ni) * subprob\n          const p_upVals2 = p_upVals * p_val\n          results.push({ v: evalFn(stats2).map(n => n.v), p: p * p_upVals2 })\n        })\n        return\n      }\n      if (!isNaN(upVals[3])) {\n        const key = subs[3];\n        const val = upVals[3];\n        const ni = ns[3];\n        stats[key] = (stats[key] ?? 0) + val * scale(key)\n        let p_val = (4 ** -ni) * quadrinomial(ni, val - 7 * ni)\n        p_upVals *= p_val\n      }\n      results.push({ v: evalFn(stats).map(n => n.v), p: p * p_upVals })\n    })\n  })\n\n  return results\n}\n\ntype WeightedPoint = {\n  v: number[],\n  p: number\n}\n","import { erf } from \"../../../../Util/MathUtil\";\nimport { Module } from \"wasmpack/assembly.js\";\n\n// From a Gaussian mean & variance, get P(x > mu) and E[x | x > mu]\nexport function gaussianPE(mean: number, variance: number, x: number) {\n  if (variance < 1e-5) {\n    if (mean > x) return { p: 1, upAvg: mean - x }\n    return { p: 0, upAvg: 0 }\n  }\n\n  const z = (x - mean) / Math.sqrt(variance)\n  const p = (1 - erf(z / Math.sqrt(2))) / 2\n  if (z > 5) {\n    // Z-score large means p will be very small.\n    // We can use taylor expansion at infinity to evaluate upAvg.\n    const y = 1 / z, y2 = y * y\n    return { p: p, upAvg: Math.sqrt(variance) * y * (1 - 2 * y2 * (1 - y2 * (5 + 37 * y2))) }\n  }\n\n  const phi = Math.exp(-z * z / 2) / Math.sqrt(2 * Math.PI)\n  return { p: p, upAvg: mean - x + Math.sqrt(variance) * phi / p }\n}\n\n// From a multivariate Gaussian mean & variance, get P(x > mu) and E[x0 | x > mu]\nexport function mvnPE_bad(mu: number[], cov: number[][], x: number[]) {\n  // TODO: an implementation without using the independence assumption\n  let ptot = 1\n  let cptot = 1\n  for (let i = 0; i < mu.length; ++i) {\n    if (cov[i][i] < 1e-5) {\n      if (mu[i] < x[i]) return { p: 0, upAvg: 0, cp: 0 }\n      continue;\n    }\n\n    const z = (x[i] - mu[i]) / Math.sqrt(cov[i][i]);\n    const p = (1 - erf(z / Math.sqrt(2))) / 2\n    ptot *= p\n\n    if (i !== 0) cptot *= p\n  }\n\n  // Naive 1st moment of truncated distribution: assume it's relatively stationary w.r.t. the\n  //  constraints. If the constraints greatly affects the moment, then its associated\n  //  conditional probability should also be small. Therefore in conjunction with the summation\n  //  method in `gmmNd()`, the overall approximation should be fairly good, even if the individual\n  //  upAvg terms may be very bad.\n  // Appears to work well in practice.\n  //\n  // More rigorous methods for estimating 1st moment of truncated multivariate distribution exist.\n  // https://www.cesarerobotti.com/wp-content/uploads/2019/04/JCGS-KR.pdf\n  const { upAvg } = gaussianPE(mu[0], cov[0][0], x[0])\n  return { p: ptot, upAvg: upAvg, cp: cptot }\n}\n\nexport function mvnPE_good(mu: number[], cov: number[][], x: number[]) {\n  let mvn: any = new Module.MVNHandle(mu.length);\n  try {\n    x.forEach(xi => mvn.pushX(xi));\n    mu.forEach(mui => mvn.pushMu(mui));\n    cov.forEach(arr => arr.forEach(c => mvn.pushCov(c)));\n\n    mvn.compute()\n    return { p: mvn.p, upAvg: mvn.Eup, cp: mvn.cp }\n  }\n  finally {\n    // HAHAHA explicit memory management in my javascript\n    mvn.delete();\n  }\n}\n\n\nexport function debugMVN() {\n  console.log('FROM debugMVN()')\n  // var mvn = new Module.MVNHandle(1);\n  // mvn.pushX(0);\n  // mvn.pushMu(0);\n  // mvn.pushCov(1);\n\n  // mvn.compute();\n  // console.log('this', mvn.p)\n  // mvn.delete()\n\n  // var mvn2 = new Module.MVNHandle(2);\n  // let mu = [0, 0]\n  // let x = [1, 1]\n  // let cov = [[10, -5], [-5, 20]]\n  // mu.forEach(m => mvn2.pushMu(m))\n  // x.forEach(x => mvn2.pushX(x))\n  // cov.forEach(a => a.forEach(c => mvn2.pushCov(c)))\n  // mvn2.compute()\n  // console.log('that', mvn2.p)\n  // console.log('cp', mvn2.cp)\n  // console.log('eup', mvn2.Eup)\n  // mvn2.delete()\n\n  // var mvn3 = new Module.MVNHandle(4);\n  // let mu3 = [0.30650569, 0.53707501, 0.95858678, 0.80295683]\n  // let x3 = [0, 0, 0, 0]\n  // let cov3 = [\n  //   [0.48907391, 0.02377247, -0.16140441, -0.24788451],\n  //   [0.02377247, 0.40132075, -0.19141678, 0.09189226],\n  //   [-0.16140441, -0.19141678, 0.41230111, -0.03428392],\n  //   [-0.24788451, 0.09189226, -0.03428392, 0.16998822]\n  // ]\n  // mu3.forEach(m => mvn3.pushMu(m))\n  // x3.forEach(x => mvn3.pushX(x))\n  // cov3.forEach(a => a.forEach(c => mvn3.pushCov(c)))\n\n  // mvn3.compute()\n  // console.log('mvn3', mvn3.p, mvn3.cp, mvn3.Eup)\n\n  var mvn4 = new Module.MVNHandle(2);\n  let mu4 = [29437.599765014198, 2597.693806908243]\n  let x4 = [31777.245955648243, 30]\n  let cov4 = [[3025.039702728439, 266.94183507340136], [266.94183507340136, 23.556035726765433]]\n  mu4.forEach(m => mvn4.pushMu(m))\n  x4.forEach(x => mvn4.pushX(x))\n  cov4.forEach(a => a.forEach(c => mvn4.pushCov(c)))\n  mvn4.compute()\n  console.log('mvn4', mvn4.p, mvn4.cp, mvn4.Eup)\n}\n","import { Data, NumNode } from \"../../../../Formula/type\"\nimport { precompute, optimize } from \"../../../../Formula/optimization\"\nimport { ddx, zero_deriv } from \"../../../../Formula/differentiate\"\nimport { DynStat } from '../../../..//PageCharacter/CharacterDisplay/Tabs/TabOptimize/common'\nimport { SubstatKey, allSubstatKeys, ICachedArtifact } from \"../../../../Types/artifact\"\nimport { SlotKey, Rarity, allArtifactSets } from '../../../../Types/consts';\nimport Artifact from \"../../../../Data/Artifacts/Artifact\"\nimport { crawlUpgrades } from \"./artifactUpgradeCrawl\"\nimport { gaussianPE, mvnPE_good } from \"./mvncdf\"\nimport { fillBuffer } from \"../../../../Formula/addedUtils\"\n\ntype GaussianMixture = {\n  gmm: {\n    phi: number,  // Item weight; must sum to 1.\n    cp: number,   // Constraint probability\n    mu: number,\n    sig2: number\n  }[],\n  lower: number,\n  upper: number,\n}\nexport type Query = {\n  formulas: NumNode[],\n  curBuild: QueryBuild,\n\n  thresholds: number[],\n  evalFn: (values: DynStat) => StructuredNumber[],\n  skippableDerivs: boolean[],\n}\nexport type QueryResult = {\n  id: string,\n  rollsLeft: number,\n  subs: SubstatKey[],\n  statsBase: DynStat,\n  evalFn: (values: DynStat) => StructuredNumber[],\n  skippableDerivs: boolean[],\n\n  prob: number,\n  upAvg: number,\n  distr: GaussianMixture,\n  thresholds: number[],\n  fourthsubOpts?: { sub: SubstatKey, subprob: number }[],\n\n  evalMode: 'fast' | 'slow',\n}\ntype StructuredNumber = {\n  v: number,\n  grads: number[],\n}\n\nexport type QueryArtifact = {\n  id: string,\n  level: number,\n  rarity: Rarity,\n  slot: SlotKey,\n  values: DynStat,\n  subs: SubstatKey[]\n}\nexport type QueryBuild = { [key in SlotKey]: QueryArtifact | undefined }\ntype InternalQuery = {\n  rollsLeft: number,\n  subs: SubstatKey[],\n  calc4th: boolean,\n  stats: DynStat,\n  thresholds: number[],\n  objectiveEval: (values: DynStat) => { v: number, ks: number[] }[],\n  scale: (key: SubstatKey) => number,\n}\ntype InternalResult = {\n  prob: number,\n  upAvg: number,\n  distr: GaussianMixture\n}\nexport type UpgradeOptResult = {\n  query: Query,\n  arts: QueryResult[],\n}\n\nfunction toStats(build: QueryBuild): DynStat {\n  let stats: DynStat = {}\n  Object.values(build).forEach(a => {\n    if (a) Object.entries(a.values).forEach(([key, value]) => stats[key] = (stats[key] ?? 0) + value)\n  })\n  return stats\n}\n\nexport function evalArtifact(objective: Query, art: QueryArtifact, slow = false, calc4th = false): QueryResult {\n  let newBuild = { ...objective.curBuild }\n  newBuild[art.slot] = art\n  let newStats = toStats(newBuild)\n  const statsBase = { ...newStats }\n  let scale = (key: SubstatKey) => key.endsWith('_') ? Artifact.maxSubstatValues(key, art.rarity) / 1000 : Artifact.maxSubstatValues(key, art.rarity) / 10\n\n  const rollsLeft = Artifact.rollsRemaining(art.level, art.rarity) - (4 - art.subs.length)\n  if (art.subs.length === 4) calc4th = false\n\n  if (!calc4th) {\n    const iq: InternalQuery = {\n      rollsLeft, subs: art.subs, calc4th,\n      stats: newStats,\n      thresholds: objective.thresholds,\n      objectiveEval: (stats) => objective.evalFn(stats).map(({ v, grads }) => ({ v: v, ks: art.subs.map(key => grads[allSubstatKeys.indexOf(key)] * scale(key)) })),\n      scale,\n    }\n\n    const out = slow ? gmmNd(iq) : fastUB(iq);\n    return {\n      id: art.id,\n      subs: art.subs,\n      rollsLeft: rollsLeft,\n      statsBase: statsBase,\n\n      ...out,\n      evalFn: objective.evalFn,\n      skippableDerivs: objective.skippableDerivs,\n      thresholds: objective.thresholds,\n\n      evalMode: slow ? 'slow' : 'fast',\n    }\n  }\n  else {\n    const msOption = Object.keys(art.values).filter(v => !(art.subs as string[]).includes(v)).filter(v => !(allArtifactSets as readonly string[]).includes(v))\n    if (msOption.length !== 1) throw Error('Failed to extract artifact main stat')\n    const mainStat = msOption[0]\n\n    const subsToConsider = allSubstatKeys.filter(s => !art.subs.includes(s) && s !== mainStat)\n    const results = subsToConsider.map(nxtsub => {\n      const subs = [...art.subs, nxtsub]\n      const iq: InternalQuery = {\n        rollsLeft, subs, calc4th,\n        stats: newStats,\n        thresholds: objective.thresholds,\n        objectiveEval: (stats) => objective.evalFn(stats).map(({ v, grads }) => ({ v, ks: subs.map(key => grads[allSubstatKeys.indexOf(key)] * scale(key)) })),\n        scale,\n      }\n\n      const out = slow ? gmmNd(iq) : fastUB(iq);\n      return { ...out, p2: subProb(nxtsub, [...art.subs, mainStat as SubstatKey]) }\n    })\n\n    const ptot = results.reduce((a, { prob: p, p2 }) => a + p * p2, 0)\n    const upAvgtot = ptot < 1e-6 ? 0 : results.reduce((a, { prob: p, p2, upAvg }) => a + p * p2 * upAvg, 0) / ptot\n    const distrtot = results.reduce((dtot, { p2, distr }) => {\n      dtot.lower = Math.min(dtot.lower, distr.lower)\n      dtot.upper = Math.max(dtot.upper, distr.upper)\n      dtot.gmm.push(...distr.gmm.map(({ phi, cp, mu, sig2 }) => ({ phi: p2 * phi, cp, mu, sig2 })))\n      return dtot\n    }, { gmm: [], lower: Infinity, upper: -Infinity } as GaussianMixture)\n\n    return {\n      id: art.id,\n      subs: art.subs, fourthsubOpts: subsToConsider.map(sub => ({ sub, subprob: subProb(sub, [...art.subs, mainStat as SubstatKey]) })),\n      rollsLeft: rollsLeft,\n      statsBase: statsBase,\n\n      prob: ptot,\n      upAvg: upAvgtot,\n      distr: distrtot,\n      evalFn: objective.evalFn,\n      skippableDerivs: objective.skippableDerivs,\n      thresholds: objective.thresholds,\n\n      evalMode: slow ? 'slow' : 'fast',\n    }\n  }\n}\n\n\n// Estimates an upper bound for summary statistics by approximating each formula/constraint indepenently,\n//   then taking a min() over all the formulas. The approximations use derivatives to construct a linear\n//   approximation of the damage formula, which we can use to treat the substats as a weighted sum of random\n//   variables. Then do some math to get the expected mean & variance of the weighted sum and approximate\n//   the distribution with a Gaussian.\nfunction fastUB({ rollsLeft, subs, stats, thresholds, calc4th, scale, objectiveEval }: InternalQuery): InternalResult {\n  // Evaluate derivatives at center of 4-D upgrade distribution\n  let stats2 = { ...stats }\n  subs.forEach((subKey, i) => {\n    const b = calc4th && (i === 3) ? 1 : 0\n    stats2[subKey] = (stats2[subKey] ?? 0) + 17 / 2 * (rollsLeft / 4 + b) * scale(subKey)\n  })\n\n  const N = rollsLeft\n  const obj = objectiveEval(stats2);\n  let p_min = 1;\n  let upAvgUB = -1;\n  let apxDist: GaussianMixture = { gmm: [], lower: obj[0].v, upper: obj[0].v };\n\n  // Iterate over objectives, aggregate by min() to construct an upper bound.\n  for (let ix = 0; ix < obj.length; ix++) {\n    const { v, ks } = obj[ix];\n    const ksum = ks.reduce((a, b) => a + b)\n    const ksum2 = ks.reduce((a, b) => a + b * b, 0)\n\n    const mean = v\n    const variance = (147 / 8 * ksum2 - 289 / 64 * ksum * ksum) * N + (calc4th ? 5 / 4 * ks[3] * ks[3] : 0)\n\n    const { p, upAvg } = gaussianPE(mean, variance, thresholds[ix])\n    if (ix === 0) {\n      upAvgUB = upAvg\n      apxDist = { gmm: [{ phi: 1, mu: mean, sig2: variance, cp: 1 }], lower: mean - 4 * Math.sqrt(variance), upper: mean + 4 * Math.sqrt(variance) }\n    }\n    p_min = Math.min(p, p_min)\n  }\n\n  return { prob: p_min, upAvg: upAvgUB, distr: apxDist }\n}\n\n// Accurately estimates the summary statistics by approximating each formula/constraint on the scale of a\n//   single roll, and iterating across all combinations of roll outcomes. This approximation works much better\n//   because the linear approximation is more valid on the smaller region. Also the substat upgrade values\n//   are conditionally independent given the number of rolls in each, giving much better justification for the\n//   Gaussian approximation.\n// The splits across roll combinations means `gmmNd` gives an N-dimensional Gaussian mixture model.\nfunction gmmNd({ rollsLeft, stats, subs, thresholds, calc4th, scale, objectiveEval }: InternalQuery): InternalResult {\n  const appx: GaussianMixture = { gmm: [], lower: thresholds[0], upper: thresholds[0] }\n\n  let lpe: { l: number, p: number, upAvg: number, cp: number }[] = []\n  crawlUpgrades(rollsLeft, (ns, p) => {\n    let stat2 = { ...stats }\n    if (calc4th) ns[3] += 1\n    subs.forEach((subKey, i) => {\n      stat2[subKey] = (stat2[subKey] ?? 0) + 17 / 2 * (ns[i]) * scale(subKey)\n    })\n\n    const obj = objectiveEval(stat2);\n    let mu = obj.map(o => o.v)\n    let cov = obj.map(o1 => obj.map(o2 => o1.ks.reduce((pv, cv, k) => pv + o1.ks[k] * o2.ks[k] * ns[k], 0)))\n    const res = mvnPE_good(mu, cov, thresholds)\n    lpe.push({ l: p, ...res })\n\n    // Feels a little bad to discard everything but the first axis, but can change later\n    appx.gmm.push({ phi: p, mu: mu[0], sig2: cov[0][0], cp: res.cp })\n    appx.lower = Math.min(appx.lower, mu[0] - 4 * Math.sqrt(cov[0][0]))\n    appx.upper = Math.max(appx.upper, mu[0] + 4 * Math.sqrt(cov[0][0]))\n  })\n\n  // Aggregate gaussian mixture statistics.\n  let p_ret = 0, upAvg_ret = 0\n  lpe.forEach(({ l, p, upAvg, cp }) => {\n    // It's quite often that `p` becomes 0 here... should I use log likelihoods instead?\n    p_ret += l * p * cp;\n    upAvg_ret += l * p * cp * upAvg;\n  })\n\n  if (p_ret < 1e-10) return { prob: 0, upAvg: 0, distr: appx }\n  upAvg_ret = upAvg_ret / p_ret\n  return { prob: p_ret, upAvg: upAvg_ret, distr: appx }\n}\n\nexport function querySetup(formulas: NumNode[], thresholds: number[], curBuild: QueryBuild, data: Data = {}): Query {\n  let toEval: NumNode[] = []\n  formulas.forEach(f => {\n    toEval.push(f, ...allSubstatKeys.map(sub => ddx(f, fo => fo.path[1], sub)))\n  })\n  // Opt loop a couple times to ensure all constants folded?\n  let evalOpt = optimize(toEval, data, ({ path: [p] }) => p !== \"dyn\")\n  evalOpt = optimize(evalOpt, data, ({ path: [p] }) => p !== \"dyn\")\n  const [evalFn, mapping, buffer] = precompute(evalOpt, f => f.path[1])\n\n  let stats = toStats(curBuild)\n  fillBuffer(stats, mapping, buffer)\n  const dmg0 = evalFn()[0]\n\n  const skippableDerivs = allSubstatKeys.map(sub => formulas.every(f => zero_deriv(f, f => f.path[1], sub)))\n  const structuredEval = (stats: DynStat) => {\n    Object.values(mapping).forEach(k => buffer[k] = 0)  // Need to reset buffer before evaluating\n    fillBuffer(stats, mapping, buffer)\n    const out = evalFn()\n    return formulas.map((_, i) => {\n      const ix = i * (1 + allSubstatKeys.length)\n      return { v: out[ix], grads: allSubstatKeys.map((sub, si) => out[ix + 1 + si]) }\n    })\n  }\n\n  return { formulas: formulas, thresholds: [dmg0, ...thresholds], curBuild: curBuild, evalFn: structuredEval, skippableDerivs: skippableDerivs }\n}\n\nexport function toQueryArtifact(art: ICachedArtifact, fixedLevel?: number) {\n  if (fixedLevel === undefined) fixedLevel = art.level\n  const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, fixedLevel)  // 5* only\n  const buildData = {\n    id: art.id, slot: art.slotKey, level: art.level, rarity: art.rarity,\n    values: {\n      [art.setKey]: 1,\n      [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\n      ...Object.fromEntries(art.substats.map(substat =>\n        [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\n    },\n    subs: art.substats.reduce((sub: SubstatKey[], x) => {\n      if (x.key !== \"\") sub.push(x.key)\n      return sub\n    }, [])\n  }\n  delete buildData.values[\"\"]\n  return buildData\n}\n\nexport function cmpQ(a: QueryResult, b: QueryResult) {\n  if (b.prob > 1e-5 || a.prob > 1e-5) return b.prob * b.upAvg - a.prob * a.upAvg\n\n  const meanA = a.distr.gmm.reduce((pv, { phi, mu }) => pv + phi * mu, 0)\n  const meanB = b.distr.gmm.reduce((pv, { phi, mu }) => pv + phi * mu, 0)\n  return meanB - meanA\n}\n\nconst fWeight: StrictDict<SubstatKey, number> = {\n  hp: 6, atk: 6, def: 6,\n  hp_: 4, atk_: 4, def_: 4, eleMas: 4, enerRech_: 4,\n  critRate_: 3, critDMG_: 3\n}\nconst fWeightTot = Object.values(fWeight).reduce((a, b) => a + b)\nfunction subProb(sub: SubstatKey, excluded: SubstatKey[]) {\n  if (excluded.includes(sub)) return 0\n  const denom = fWeightTot - excluded.reduce((a, b) => a + (fWeight[b] ?? 0), 0)\n  return fWeight[sub] / denom\n}\n","import { Button, CardContent, Grid, Box } from '@mui/material';\nimport React, { useEffect, useState, useContext, useMemo, useCallback } from 'react';\nimport { DatabaseContext } from '../../../../Database/Database';\nimport { DataContext } from '../../../../Context/DataContext';\nimport Assets from '../../../../Assets/Assets';\nimport {\n  Line,\n  Area,\n  ComposedChart,\n  Legend,\n  ReferenceLine,\n  ReferenceDot,\n  ResponsiveContainer,\n  Tooltip,\n  TooltipProps,\n  XAxis,\n  YAxis,\n  Label,\n} from 'recharts';\nimport CardLight from '../../../../Components/Card/CardLight';\nimport { QueryResult } from './artifactQuery';\nimport { allUpgradeValues } from './artifactUpgradeCrawl'\nimport { uiInput as input } from '../../../../Formula';\nimport ArtifactCardPico from '../../../../Components/Artifact/ArtifactCardPico'\nimport { allSlotKeys, SlotKey } from '../../../../Types/consts';\nimport { ICachedArtifact } from '../../../../Types/artifact';\nimport { gaussPDF } from '../../../../Util/MathUtil'\n\ntype Data = {\n  upgradeOpt: QueryResult,\n  showTrue?: boolean,\n  objMin: number,\n  objMax: number,\n  ix?: number,\n}\ntype ChartData = {\n  x: number,\n  est?: number,\n  estCons?: number,\n  exact?: number,\n  exactCons?: number,\n  expInc?: number,\n}\n\n// linspace with non-inclusive endpoint.\nfunction linspace(lower = 0, upper = 1, steps = 50): number[] {\n  var arr: number[] = [];\n  var step = (upper - lower) / steps;\n  for (let i = 0; i < steps; ++i) {\n    arr.push(lower + i * step);\n  }\n  return arr\n}\n\nconst nbins = 50;\nconst plotPoints = 500;\nexport default function UpgradeOptChartCard({ upgradeOpt, objMin, objMax }: Data) {\n  const [calcExacts, setCalcExacts] = useState(false);\n\n  const { database } = useContext(DatabaseContext)\n  const bla = database.arts.get(upgradeOpt.id)\n  if (!bla) {\n    throw new Error(`artifact ${upgradeOpt.id} not found.`)\n  }\n\n  const constrained = (upgradeOpt.thresholds.length > 1)\n\n  const slot = bla.slotKey;\n  const { data } = useContext(DataContext)\n  const artifacts = useMemo(() =>\n    allSlotKeys.map(k => [k, database.arts.get(data.get(input.art[k].id).value ?? \"\")]),\n    [data, database]) as Array<[SlotKey, ICachedArtifact | undefined]>;\n\n  const gauss = (x: number) => upgradeOpt.distr.gmm.reduce(\n    (pv, { phi, mu, sig2 }) => pv + phi * gaussPDF(x, mu, sig2), 0)\n  const gaussConstrained = (x: number) => upgradeOpt.distr.gmm.reduce(\n    (pv, { phi, cp, mu, sig2 }) => pv + cp * phi * gaussPDF(x, mu, sig2), 0)\n  const thresh = upgradeOpt.thresholds;\n  const thr0 = thresh[0];\n  // const perc = (x: number) => 100 * (x - thr0) / thr0;\n  const perc = useCallback((x: number) => 100 * (x - thr0) / thr0, [thr0])\n\n  const miin = objMin\n  const maax = objMax\n\n  let ymax = 0\n  let dataEst: ChartData[] = linspace(miin, maax, plotPoints).map(v => {\n    const est = gauss(v)\n    ymax = Math.max(ymax, est)\n    return { x: perc(v), est: est, estCons: gaussConstrained(v) }\n  })\n  if (ymax === 0) ymax = nbins / (maax - miin)\n\n  // go back and add delta distributions.\n  let deltas: { [key: number]: number } = {}\n  let deltasConstrained: { [key: number]: number } = {}\n  upgradeOpt.distr.gmm.forEach(({ phi, mu, sig2, cp }) => {\n    if (sig2 <= 0) {\n      deltas[mu] = (deltas[mu] ?? 0) + phi\n      deltasConstrained[mu] = (deltasConstrained[mu] ?? 0) + phi * cp\n    }\n  })\n  Object.entries(deltas).forEach(([mu, p]) => dataEst.push({ x: perc(parseFloat(mu)), est: p * nbins / (maax - miin), estCons: deltasConstrained[mu] * nbins / (maax - miin) }))\n\n  dataEst.sort((a, b) => a.x - b.x)\n  let xpercent = (thr0 - miin) / (maax - miin)\n\n  const [trueData, setTrueData] = useState<ChartData[]>([]);\n  const [trueP, setTrueP] = useState(-1);\n  const [trueE, setTrueE] = useState(-1);\n\n  useEffect(() => {\n    // When `calcExacts` is pressed, we may want to sink/swim this artifact to its proper spot.\n    // Or not b/c people only really need a fuzzy ordering anyways.\n    if (!calcExacts) return;\n    const exactData = allUpgradeValues(upgradeOpt)\n    let true_p = 0\n    let true_e = 0\n\n    let bins = new Array(nbins).fill(0)\n    let binsConstrained = new Array(nbins).fill(0)\n    let binstep = (maax - miin) / nbins\n\n    exactData.forEach(({ p, v }) => {\n      let whichBin = Math.min(Math.trunc((v[0] - miin) / binstep), nbins - 1)\n      bins[whichBin] += p\n\n      if (v.every((val, ix) => ix === 0 || val > thresh[ix])) {\n        binsConstrained[whichBin] += p\n        if (v[0] > thr0) {\n          true_p += p\n          true_e += p * (v[0] - thr0)\n        }\n      }\n    })\n    if (true_p > 0) true_e = true_e / true_p\n\n    let dataExact: ChartData[] = bins.map((dens, ix) => ({ x: perc(miin + ix * binstep), exact: dens / binstep, exactCons: binsConstrained[ix] / binstep }))\n    setTrueP(true_p)\n    setTrueE(true_e)\n    setTrueData(dataExact)\n  }, [calcExacts, maax, miin, thr0, thresh, upgradeOpt, perc]);\n\n  if (trueData.length === 0) {\n    let binstep = (maax - miin) / nbins\n    for (let i = 0; i < nbins; i++) {\n      trueData.push({ x: perc(miin + i * binstep), exact: 0, exactCons: 0 })\n    }\n  }\n\n  // if trueP/E have been calculated, otherwise use upgradeOpt's estimate\n  const reportP = (trueP >= 0) ? trueP : upgradeOpt.prob\n  const reportD = (trueE >= 0) ? trueE : upgradeOpt.upAvg\n  let chartData = dataEst.concat(trueData)\n\n  // console.log('repd', reportD, upgradeOpt.upAvg)\n\n  const CustomTooltip = ({ active, payload, label, }: TooltipProps<string, string>) => {\n    if (!active) return null;\n    // I kinda want the [average increase] to only appear when hovering the white dot.\n    return (\n      <div className=\"custom-tooltip\">\n        <p className=\"label\"></p>\n        <p className=\"desc\">prob. upgrade{trueP >= 0 ? '' : ' (est.)'}: {(100 * reportP).toFixed(1)}%</p>\n        <p className=\"desc\">average increase{trueE >= 0 ? '' : ' (est.)'}: {reportD <= 0 ? \"\" : \"+\"}{(100 * reportD / thr0).toFixed(1)}%</p>\n      </div>\n    )\n  };\n\n  return <CardLight>\n    <CardContent>\n      <ResponsiveContainer width=\"100%\" aspect={2.5} key={upgradeOpt.id}>\n        <ComposedChart data={chartData} margin={{ top: 5, right: 30, left: 20, bottom: 20 }}>\n          <XAxis dataKey=\"x\" type=\"number\" domain={['auto', 'auto']} allowDecimals={false} tickFormatter={v => `${v <= 0 ? \"\" : \"+\"}${v}%`} >\n            <Label value='Relative Damage Potential' position='insideBottom' style={{ fill: '#eaebed' }} offset={-10} />\n          </XAxis>\n          <YAxis type=\"number\" domain={[0, ymax]} tick={false} >\n            <Label value='Probability' position='insideLeft' angle={-90} style={{ fill: '#eaebed' }} />\n          </YAxis>\n          <Legend verticalAlign='top' height={36} />\n\n          <defs>\n            <linearGradient id={`splitOpacity${upgradeOpt.id}`} x1=\"0\" y1=\"0\" x2={xpercent} y2=\"0\">\n              <stop offset={1} stopColor='orange' stopOpacity={0} />\n              <stop offset={0} stopColor='orange' stopOpacity={1} />\n            </linearGradient>\n          </defs>\n\n          <Line dataKey=\"dne\" stroke='red' name='Current Damage' />\n          {constrained && !calcExacts && <Area type=\"monotone\" dataKey=\"est\" stroke=\"grey\" dot={false} fill='grey' legendType=\"none\" tooltipType='none' opacity={.5} activeDot={false} />}\n          {constrained && calcExacts && <Area type=\"stepAfter\" dataKey=\"exact\" dot={false} legendType=\"none\" tooltipType='none' opacity={.7} activeDot={false} fill='grey' stroke='grey' />}\n          <Area type=\"monotone\" dataKey=\"estCons\" stroke=\"orange\" dot={false} fill={`url(#splitOpacity${upgradeOpt.id})`} opacity={.5} name={`Estimated Distribution`} activeDot={false} />\n          {calcExacts && <Area type=\"stepAfter\" dataKey=\"exactCons\" dot={false} opacity={.7} name={`Exact${constrained ? ' Constrained' : ''} Distribution (Histogram)`} activeDot={false} />}\n\n          <ReferenceLine x={perc(thr0)} stroke=\"red\" strokeDasharray=\"3 3\" name=\"Current Damage\" />\n          <ReferenceDot x={perc(thr0 + reportD)} y={(gaussConstrained(thr0 + reportD) || ymax) / 2} shape={<circle radius={1} opacity={.5} />} />\n\n          <Tooltip content={<CustomTooltip />} cursor={false} />\n        </ComposedChart>\n      </ResponsiveContainer>\n\n      <Grid direction=\"row\" container spacing={0.75} columns={12}>\n        {artifacts.map(([sk, art]: [SlotKey, ICachedArtifact | undefined]) => {\n          if (sk !== slot)\n            return <Grid item key={`${sk}_${upgradeOpt.id}`} xs={1}><ArtifactCardPico slotKey={sk} artifactObj={art} /></Grid>\n          return <Grid item key={`${sk}_${upgradeOpt.id}`} xs={1}><Button variant='contained' style={{ height: \"100%\", width: '100%' }}\n            onClick={() => setCalcExacts(true)}\n            startIcon={<Box\n              sx={{\n                position: \"absolute\",\n                width: \"70%\", height: \"70%\",\n                left: \"50%\", top: \"50%\",\n                transform: \"translate(-50%, -50%)\",\n                opacity: 0.7,\n              }}\n              component=\"img\"\n              src={Assets.slot[sk]}\n            />}\n            sx={{ minWidth: 0 }} />\n          </Grid>\n        })}\n      </Grid>\n\n      <br />\n      <span>Click above to calculate Exact upgrade distribution</span>\n      <br />\n\n    </CardContent>\n  </CardLight>\n}\n","import { faCalculator } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Alert, Box, Button, CardContent, Grid, Link, Skeleton, Typography, Pagination } from '@mui/material';\nimport { Link as RouterLink } from 'react-router-dom';\nimport CardDark from '../../../../Components/Card/CardDark';\nimport CardLight from '../../../../Components/Card/CardLight';\nimport CharacterCard from '../../../../Components/Character/CharacterCard';\nimport StatFilterCard from '../TabOptimize/Components/StatFilterCard';\nimport ArtifactCard from \"../../../../PageArtifact/ArtifactCard\";\nimport BonusStatsCard from '../TabOptimize/Components/BonusStatsCard';\nimport { HitModeToggle, ReactionToggle } from '../../../../Components/HitModeEditor';\nimport OptimizationTargetSelector from '../TabOptimize/Components/OptimizationTargetSelector';\nimport ArtifactSetConfig from '../TabOptimize/Components/ArtifactSetConfig';\n\nimport React, { Suspense, useCallback, useContext, useMemo, useRef, useState } from 'react';\nimport { Trans } from \"react-i18next\";\nimport { DataContext, dataContextObj } from '../../../../Context/DataContext';\nimport { DatabaseContext } from '../../../../Database/Database';\nimport { optimize } from '../../../../Formula/optimization';\nimport { NumNode } from '../../../../Formula/type';\nimport { uiInput as input } from '../../../../Formula/index';\nimport useCharacterReducer from '../../../../ReactHooks/useCharacterReducer';\nimport useCharSelectionCallback from '../../../../ReactHooks/useCharSelectionCallback';\nimport useTeamData, { getTeamData } from '../../../../ReactHooks/useTeamData';\nimport useBuildSetting from '../TabOptimize/useBuildSetting';\nimport { dynamicData } from '../TabOptimize/foreground';\nimport { allSlotKeys, CharacterKey, SlotKey } from '../../../../Types/consts';\nimport { clamp, objPathValue } from '../../../../Util/Util';\nimport { mergeData, uiDataForTeam } from '../../../../Formula/api';\nimport { querySetup, evalArtifact, toQueryArtifact, cmpQ, QueryArtifact, QueryBuild, UpgradeOptResult } from './artifactQuery'\nimport UpgradeOptChartCard from \"./UpgradeOptChartCard\"\nimport { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\nimport MainStatSelectionCard from '../TabOptimize/Components/MainStatSelectionCard';\nimport { CharacterContext } from '../../../../Context/CharacterContext';\n\n\nexport default function TabUpopt() {\n  const { character, character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n\n  const characterDispatch = useCharacterReducer(characterKey)\n  const onClickTeammate = useCharSelectionCallback()\n\n  const noArtifact = useMemo(() => !database.arts.values.length, [database])\n\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { optimizationTarget } = buildSetting\n  const teamData = useTeamData(characterKey)\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\n\n  const [artifactUpgradeOpts, setArtifactUpgradeOpts] = useState(undefined as UpgradeOptResult | undefined)\n\n  const [show20, setShow20] = useState(true)\n  const [check4th, setCheck4th] = useState(true)\n  const [useMainStatFilter, setUseMainStatFilter] = useState(false)\n\n  // Because upgradeOpt is a two-stage estimation method, we want to expand (slow-estimate) our artifacts lazily as they are needed.\n  // Lazy method means we need to take care to never 'lift' any artifacts past the current page, since that may cause a user to miss artifacts\n  //  that are lifted in the middle of an expansion. Increase lookahead to mitigate this issue.\n  const upgradeOptExpandSink = useCallback(({ query, arts }: UpgradeOptResult, start: number, expandTo: number): UpgradeOptResult => {\n    const lookahead = 5\n    // if (querySaved === undefined) return upOpt\n    const queryArts: QueryArtifact[] = database.arts.values\n      .filter(art => art.rarity === 5)\n      .map(art => toQueryArtifact(art, 20))\n\n    let qaLookup: Dict<string, QueryArtifact> = {};\n    queryArts.forEach(art => qaLookup[art.id] = art)\n\n    const fixedList = arts.slice(0, start)\n    let arr = arts.slice(start)\n\n    let i = 0\n    const end = Math.min(expandTo - start + lookahead, arr.length);\n    do {\n      for (; i < end; i++) {\n        let arti = qaLookup[arr[i].id]\n        if (arti) arr[i] = evalArtifact(query, arti, true, check4th);\n      }\n\n      // sort on only bottom half to prevent lifting\n      arr.sort(cmpQ)\n      for (i = 0; i < end; i++) {\n        if (arr[i].evalMode === 'fast') break\n      }\n    } while (i < end)\n\n    return { query, arts: [...fixedList, ...arr] }\n  }, [database, check4th])\n\n  // Paging logic\n  const [pageIdex, setpageIdex] = useState(0)\n  const invScrollRef = useRef<HTMLDivElement>(null)\n\n  const artifactsToDisplayPerPage = 5;\n  const { artifactsToShow, numPages, currentPageIndex, minObj0, maxObj0 } = useMemo(() => {\n    if (!artifactUpgradeOpts) return { artifactsToShow: [], numPages: 0, toShow: 0, minObj0: 0, maxObj0: 0 }\n    const numPages = Math.ceil(artifactUpgradeOpts.arts.length / artifactsToDisplayPerPage)\n    const currentPageIndex = clamp(pageIdex, 0, numPages - 1)\n    const toShow = artifactUpgradeOpts.arts.slice(currentPageIndex * artifactsToDisplayPerPage, (currentPageIndex + 1) * artifactsToDisplayPerPage)\n    const thr = toShow.length > 0 ? toShow[0].thresholds[0] : 0\n\n    return {\n      artifactsToShow: toShow, numPages, currentPageIndex,\n      minObj0: toShow.reduce((a, b) => Math.min(b.distr.lower, a), thr),\n      maxObj0: toShow.reduce((a, b) => Math.max(b.distr.upper, a), thr)\n    }\n  }, [artifactUpgradeOpts, artifactsToDisplayPerPage, pageIdex])\n\n  const setPage = useCallback(\n    (e, value) => {\n      if (!artifactUpgradeOpts) return\n      invScrollRef.current?.scrollIntoView({ behavior: \"smooth\" })\n      let start = (currentPageIndex + 1) * artifactsToDisplayPerPage\n      let end = value * artifactsToDisplayPerPage\n      let zz = upgradeOptExpandSink(artifactUpgradeOpts, start, end)\n      setArtifactUpgradeOpts(zz)\n      setpageIdex(value - 1);\n    },\n    [setpageIdex, setArtifactUpgradeOpts, invScrollRef, currentPageIndex, artifactsToDisplayPerPage, artifactUpgradeOpts, upgradeOptExpandSink],\n  )\n\n  const generateBuilds = useCallback(async () => {\n    const { statFilters, optimizationTarget, mainStatKeys } = buildSetting\n\n    if (!characterKey || !optimizationTarget) return\n    const teamData = await getTeamData(database, characterKey, 0, [])\n    if (!teamData) return\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\n    if (!workerData) return\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\n    let optimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\n    if (!optimizationTargetNode) return\n    setArtifactUpgradeOpts(undefined)\n    setpageIdex(0)\n\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters).map(([key, value]) => {\n      if (key.endsWith(\"_\")) value = value / 100\n      return { value: input.total[key], minimum: value }\n    }).filter(x => x.value && x.minimum > -Infinity)\n\n    const queryArts: QueryArtifact[] = database.arts.values\n      .filter(art => art.rarity === 5)\n      .filter(art => show20 || art.level !== 20)\n      .filter(art => !useMainStatFilter || !mainStatKeys[art.slotKey]?.length || mainStatKeys[art.slotKey]?.includes(art.mainStatKey))\n      // .filter(art => true)\n      .map(art => toQueryArtifact(art, 20))\n\n    const equippedArts = database.chars.get(characterKey)?.equippedArtifacts ?? {} as StrictDict<SlotKey, string>\n    let curEquip: QueryBuild = Object.assign({}, ...allSlotKeys.map(slotKey => {\n      const art = database.arts.get(equippedArts[slotKey] ?? \"\")\n      if (!art) return { [slotKey]: undefined }\n      return { [slotKey]: toQueryArtifact(art) }\n    }))\n    let qaLookup: Dict<string, QueryArtifact> = {};\n    queryArts.forEach(art => qaLookup[art.id] = art)\n\n    let nodes = [optimizationTargetNode, ...valueFilter.map(x => x.value)]\n    nodes = optimize(nodes, workerData, ({ path: [p] }) => p !== \"dyn\");\n    const query = querySetup(nodes, valueFilter.map(x => x.minimum), curEquip, data);\n    let artUpOpt = queryArts.map(art => evalArtifact(query, art, false, check4th))\n    artUpOpt = artUpOpt.sort((a, b) => b.prob * b.upAvg - a.prob * a.upAvg)\n\n    // Re-sort & slow eval\n    let upOpt = { query: query, arts: artUpOpt }\n    upOpt = upgradeOptExpandSink(upOpt, 0, 5)\n    setArtifactUpgradeOpts(upOpt);\n    console.log('result', upOpt)\n  }, [show20, check4th, useMainStatFilter, characterKey, buildSetting, data, database, setArtifactUpgradeOpts, setpageIdex, upgradeOptExpandSink])\n\n  const dataContext: dataContextObj | undefined = useMemo(() => {\n    return character && data && characterSheet && teamData && {\n      data,\n      characterSheet,\n      character,\n      mainStatAssumptionLevel: 0,\n      teamData,\n      characterDispatch\n    }\n  }, [data, characterSheet, character, teamData, characterDispatch])\n\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"> Opps! It looks like you haven't added any artifacts to GO yet! You should go to the <Link component={RouterLink} to=\"/artifact\">Artifacts</Link> page and add some!</Alert>}\n    {/* Build Generator Editor */}\n    {dataContext && <DataContext.Provider value={dataContext}>\n      <Grid container spacing={1} >\n        {/* 1*/}\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\n          {/* character card */}\n          <Box><CharacterCard characterKey={characterKey} onClickTeammate={onClickTeammate} /></Box>\n          <BonusStatsCard />\n        </Grid>\n\n        {/* 2 */}\n        <Grid item xs={12} sm={6} lg={9} display=\"flex\" flexDirection=\"column\" gap={1}>\n          <Grid container spacing={1}>\n            <Grid item lg={4} display=\"flex\" flexDirection=\"column\" gap={1}>\n              <CardLight>\n                <CardContent>\n                  <span>Optimization Target: </span>\n                  {<OptimizationTargetSelector\n                    optimizationTarget={optimizationTarget}\n                    setTarget={target => buildSettingDispatch({ optimizationTarget: target })}\n                    disabled={false}\n                  />}\n                </CardContent>\n              </CardLight>\n              <CardLight>\n                <CardContent>\n                  <StatFilterCard disabled={false} />\n                </CardContent>\n              </CardLight>\n              {useMainStatFilter && <CardLight>\n                <CardContent>\n                  <MainStatSelectionCard disabled={false} />\n                </CardContent>\n              </CardLight>}\n            </Grid>\n            <Grid item lg={8} display=\"flex\" flexDirection=\"column\" gap={1}>\n              <CardLight>\n                <CardContent>\n                  <ArtifactSetConfig disabled={false} />\n                </CardContent>\n              </CardLight>\n              <CardLight>\n                <CardContent>\n                  <Grid container spacing={1}>\n                    <Grid item><Button startIcon={show20 ? <CheckBox /> : <CheckBoxOutlineBlank />} color={show20 ? 'success' : 'secondary'} onClick={() => setShow20(!show20)}>show lvl 20</Button></Grid>\n                    <Grid item><Button startIcon={check4th ? <CheckBox /> : <CheckBoxOutlineBlank />} color={check4th ? 'success' : 'secondary'} onClick={() => setCheck4th(!check4th)}>compute 4th sub</Button></Grid>\n                    <Grid item><Button startIcon={useMainStatFilter ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useMainStatFilter ? 'success' : 'secondary'} onClick={() => setUseMainStatFilter(!useMainStatFilter)}>filter main stats</Button></Grid>\n                  </Grid>\n                </CardContent>\n              </CardLight>\n            </Grid>\n          </Grid>\n          <Grid container spacing={1}>\n            <Grid item lg={12}>\n              <CardLight>\n                <CardContent>\n                  <Grid container spacing={1}>\n                    <Grid item>\n                      <Button\n                        disabled={!characterKey || !optimizationTarget || !objPathValue(data?.getDisplay(), optimizationTarget)}\n                        color={(characterKey) ? \"success\" : \"warning\"}\n                        onClick={generateBuilds}\n                        startIcon={<FontAwesomeIcon icon={faCalculator} />}\n                      >Calc Upgrade Priority</Button>\n                    </Grid>\n                    <Grid item><HitModeToggle size=\"small\" /></Grid>\n                    <Grid item><ReactionToggle size=\"small\" /></Grid>\n                  </Grid>\n                </CardContent>\n              </CardLight>\n            </Grid>\n\n            {numPages > 1 && <CardDark ><CardContent>\n              <Grid container>\n                <Grid item flexGrow={1}>\n                  <Pagination count={numPages} page={currentPageIndex + 1} onChange={setPage} />\n                </Grid>\n                <Grid item>\n                  <ShowingArt numShowing={artifactsToShow.length} total={artifactUpgradeOpts?.arts.length} />\n                </Grid>\n              </Grid>\n            </CardContent></CardDark>}\n\n            <Grid item lg={12} spacing={1}>\n              <Grid container display=\"flex\" flexDirection=\"column\" gap={1}>\n                {noArtifact && <Alert severity=\"info\" variant=\"filled\">Looks like you haven't added any artifacts yet. If you want, there are <Link color=\"warning.main\" component={RouterLink} to=\"/scanner\">automatic scanners</Link> that can speed up the import process!</Alert>}\n                <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: 600, minHeight: 5000 }} />}>\n                  {/* <Grid item display=\"flex\" flexDirection=\"column\" gap={1}> */}\n                  {artifactsToShow.map(art =>\n                    <Grid container key={art.id + 'asdfsf'} spacing={1}>\n                      <Grid item xs={5} sm={4} md={4} lg={3} xl={3} >\n                        <ArtifactCard artifactId={art.id} editor />\n                      </Grid>\n                      <Grid item xs={7} sm={8} md={8} lg={9} xl={9}>\n                        <UpgradeOptChartCard upgradeOpt={art} objMax={maxObj0} objMin={minObj0} />\n                      </Grid>\n                    </Grid>\n                  )}\n                  {/* </Grid> */}\n                </Suspense>\n              </Grid>\n            </Grid>\n\n            {numPages > 1 && <CardDark ><CardContent>\n              <Grid container>\n                <Grid item flexGrow={1}>\n                  <Pagination count={numPages} page={currentPageIndex + 1} onChange={setPage} />\n                </Grid>\n                <Grid item>\n                  <ShowingArt numShowing={artifactsToShow.length} total={artifactUpgradeOpts?.arts.length} />\n                </Grid>\n              </Grid>\n            </CardContent></CardDark>}\n          </Grid>\n        </Grid>\n      </Grid>\n    </DataContext.Provider>\n    }\n  </Box >\n}\n\nfunction ShowingArt({ numShowing, total }) {\n  return <Typography color=\"text.secondary\">\n    <Trans i18nKey=\"showingNum\" count={numShowing} value={total} >\n      Showing <b>{{ count: numShowing }}</b> out of {{ value: total }} Artifacts\n    </Trans>\n  </Typography>\n}\n","import { Calculate, Checkroom, ExpandMore, FactCheck, Groups, Person } from '@mui/icons-material';\nimport { Accordion, AccordionDetails, AccordionSummary, Box, Button, ButtonGroup, Card, CardContent, CardHeader, Collapse, Divider, Grid, MenuItem, Skeleton, Tab, Tabs, Typography } from '@mui/material';\nimport { Suspense, useCallback, useContext, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link as RouterLink, Navigate, Route, Routes, useMatch, useNavigate, useParams } from 'react-router-dom';\nimport { CharacterContext, CharacterContextObj } from '../../Context/CharacterContext';\nimport CardDark from '../../Components/Card/CardDark';\nimport CardLight from '../../Components/Card/CardLight';\nimport { CharacterSelectionModal } from '../../Components/Character/CharacterSelectionModal';\nimport ThumbSide from '../../Components/Character/ThumbSide';\nimport CloseButton from '../../Components/CloseButton';\nimport ColorText from '../../Components/ColoredText';\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from '../../Components/CustomNumberInput';\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\nimport { EnemyExpandCard } from '../../Components/EnemyEditor';\nimport ExpandButton from '../../Components/ExpandButton';\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../../Components/HitModeEditor';\nimport ImgIcon from '../../Components/Image/ImgIcon';\nimport CharacterSheet from '../../Data/Characters/CharacterSheet';\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from '../../Data/LevelData';\nimport { sgt } from '../../Data/SheetUtil';\nimport { DataContext, dataContextObj, TeamData } from '../../Context/DataContext';\nimport { getDisplayHeader, getDisplaySections } from '../../Formula/DisplayUtil';\nimport { DisplaySub } from '../../Formula/type';\nimport { NodeDisplay } from '../../Formula/uiData';\nimport KeyMap, { valueString } from '../../KeyMap';\nimport useCharacter from '../../ReactHooks/useCharacter';\nimport useCharacterReducer from '../../ReactHooks/useCharacterReducer';\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\nimport usePromise from '../../ReactHooks/usePromise';\nimport useTeamData from '../../ReactHooks/useTeamData';\nimport useTitle from '../../ReactHooks/useTitle';\nimport { allCharacterKeys, CharacterKey } from '../../Types/consts';\nimport { clamp } from '../../Util/Util';\nimport TabEquip from './Tabs/TabEquip';\nimport TabBuild from './Tabs/TabOptimize';\nimport TabOverview from './Tabs/TabOverview';\nimport TabTalent from './Tabs/TabTalent';\nimport TabTeambuffs from './Tabs/TabTeambuffs';\nimport TabUpopt from './Tabs/TabUpgradeOpt';\n\nexport default function CharacterDisplay() {\n  const navigate = useNavigate();\n  const onClose = useCallback(() => navigate(\"/characters\"), [navigate])\n  let { characterKey } = useParams<{ characterKey?: CharacterKey }>();\n  const invalidKey = !allCharacterKeys.includes(characterKey as any ?? \"\")\n  if (invalidKey)\n    return <Navigate to=\"/characters\" />\n\n  return <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\n      {characterKey && <CharacterDisplayCard characterKey={characterKey} onClose={onClose} />}\n    </Suspense>\n  </Box>\n}\n\ntype CharacterDisplayCardProps = {\n  characterKey: CharacterKey,\n  newteamData?: TeamData,\n  mainStatAssumptionLevel?: number,\n  onClose?: (any) => void,\n}\nfunction CharacterDisplayCard({ characterKey, newteamData, mainStatAssumptionLevel = 0, onClose }: CharacterDisplayCardProps) {\n  const character = useCharacter(characterKey)\n  const characterSheet = usePromise(() => CharacterSheet.get(characterKey), [characterKey])\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\n  const { target: charUIData } = teamData?.[characterKey] ?? {}\n  let { params: { tab = \"overview\" } } = useMatch({ path: \"/characters/:charKey/:tab\", end: false }) ?? { params: { tab: \"overview\" } }\n  const { t } = useTranslation()\n  useTitle(`${t(`char_${characterKey}_gen:name`)} - ${t(`page_character:tabs.${tab}`)}`)\n  const characterDispatch = useCharacterReducer(character?.key ?? \"\")\n  const { compareData } = character ?? {}\n\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\n    if (!teamData || !charUIData) return undefined\n    return {\n      data: (newteamData ? newteamData[characterKey]!.target : charUIData),\n      teamData: (newteamData ? newteamData : teamData),\n      oldData: (compareData && newteamData) ? charUIData : undefined,\n    }\n  }, [newteamData, charUIData, teamData, characterKey, compareData])\n\n  const characterContextValue: CharacterContextObj | undefined = useMemo(() => {\n    if (!character || !characterSheet) return undefined\n    return {\n      character,\n      characterSheet,\n      characterDispatch\n    }\n  }, [character, characterSheet, characterDispatch])\n  return <CardDark >\n    {dataContextValue && characterContextValue ? <CharacterContext.Provider value={characterContextValue}><DataContext.Provider value={dataContextValue}>\n      <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n        <Grid container spacing={1}>\n          <Grid item>\n            <CharSelectDropdown />\n          </Grid>\n          <Grid item flexGrow={1} />\n          {!!mainStatAssumptionLevel && <Grid item><Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card></Grid>}\n          {!!onClose && <Grid item>\n            <CloseButton onClick={onClose} />\n          </Grid>}\n        </Grid>\n        <CardLight>\n          <TabNav tab={tab} />\n        </CardLight>\n        <FormulaCalcCard />\n        <EnemyExpandCard />\n        <CharacterPanel />\n        <CardLight>\n          <TabNav tab={tab} />\n        </CardLight>\n      </CardContent>\n    </DataContext.Provider></CharacterContext.Provider> : <Skeleton variant='rectangular' width='100%' height={1000} />}\n  </CardDark>\n}\nfunction CharacterPanel() {\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={500} />}>\n    <Routes>\n      {/* Character Panel */}\n      <Route index element={<TabOverview />} />\n      <Route path=\"/talent\" element={<TabTalent />} />\n      <Route path=\"/equip\" element={<TabEquip />} />\n      <Route path=\"/teambuffs\" element={<TabTeambuffs />} />\n      <Route path=\"/optimize\" element={<TabBuild />} />\n      <Route path=\"/upgradeOpt\" element={<TabUpopt />} />\n    </Routes>\n  </Suspense>\n}\nfunction TabNav({ tab }: { tab: string }) {\n  const { t } = useTranslation(\"page_character\")\n  return <Tabs\n    value={tab}\n    variant=\"scrollable\"\n    allowScrollButtonsMobile\n    sx={{\n      \"& .MuiTab-root:hover\": {\n        transition: \"background-color 0.25s ease\",\n        backgroundColor: \"rgba(255,255,255,0.1)\"\n      },\n    }}\n  >\n    <Tab sx={{ minWidth: \"15%\" }} value=\"overview\" label={t(\"tabs.overview\")} icon={<Person />} component={RouterLink} to=\"\" />\n    <Tab sx={{ minWidth: \"15%\" }} value=\"talent\" label={t(\"tabs.talent\")} icon={<FactCheck />} component={RouterLink} to=\"talent\" />\n    <Tab sx={{ minWidth: \"15%\" }} value=\"equip\" label={t(\"tabs.equip\")} icon={<Checkroom />} component={RouterLink} to=\"equip\" />\n    <Tab sx={{ minWidth: \"15%\" }} value=\"teambuffs\" label={t(\"tabs.teambuffs\")} icon={<Groups />} component={RouterLink} to=\"teambuffs\" />\n    <Tab sx={{ minWidth: \"15%\" }} value=\"optimize\" label={t(\"tabs.optimize\")} icon={<Calculate />} component={RouterLink} to=\"optimize\" />\n    <Tab sx={{ minWidth: \"15%\" }} value=\"upgradeOpt\" label={t(\"tabs.upgradeOpt\")} icon={<Calculate />} component={RouterLink} to=\"upgradeOpt\" />\n  </Tabs>\n}\n\nfunction CharSelectDropdown() {\n  const { t } = useTranslation(\"page_character\")\n  const { character, characterSheet, characterDispatch } = useContext(CharacterContext)\n  const [showModal, setshowModal] = useState(false)\n  const setCharacter = useCharSelectionCallback()\n  const setLevel = useCallback((level) => {\n    level = clamp(level, 1, 90)\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\n    characterDispatch({ level, ascension })\n  }, [characterDispatch])\n  const setAscension = useCallback(() => {\n    if (!character) return\n    const { level = 1, ascension = 0 } = character\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\n    if (ascension === lowerAscension) characterDispatch({ ascension: ascension + 1 })\n    else characterDispatch({ ascension: lowerAscension })\n  }, [characterDispatch, character])\n  const { elementKey = \"anemo\", level = 1, ascension = 0 } = character\n  return <>\n    <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacter} />\n    <Grid container spacing={1}>\n      <Grid item>\n        <Button color=\"info\" onClick={() => setshowModal(true)} startIcon={<ThumbSide src={characterSheet?.thumbImgSide} />} >{characterSheet?.name ?? t(\"selectCharacter\")}</Button>\n      </Grid>\n      <Grid item>\n        <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\n          {characterSheet?.sheet && \"talents\" in characterSheet?.sheet && <DropdownButton title={<strong><ColorText color={elementKey}>{sgt(`element.${elementKey}`)}</ColorText></strong>}>\n            {Object.keys(characterSheet.sheet.talents).map(eleKey =>\n              <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => characterDispatch({ elementKey: eleKey })}>\n                <strong><ColorText color={eleKey}>{sgt(`element.${eleKey}`)}</ColorText></strong></MenuItem>)}\n          </DropdownButton>}\n          <CustomNumberInputButtonGroupWrapper >\n            <CustomNumberInput onChange={setLevel} value={level}\n              startAdornment=\"Lv. \"\n              inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\n              disabled={!characterSheet} />\n          </CustomNumberInputButtonGroupWrapper>\n          <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level) || !characterSheet} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\n          <DropdownButton title={t(\"selectLevel\")} disabled={!characterSheet}>\n            {milestoneLevels.map(([lv, as]) => {\n              const sameLevel = lv === ascensionMaxLevel[as]\n              const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\n              const selected = lv === level && as === ascension\n              return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => characterDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\n            })}\n          </DropdownButton>\n        </ButtonGroup>\n      </Grid>\n    </Grid>\n  </>\n}\n\nfunction FormulaCalcCard() {\n  const { t } = useTranslation(\"page_character\")\n  const [expanded, setexpanded] = useState(false)\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\n  return <CardLight>\n    <CardContent sx={{ display: \"flex\", gap: 1 }}>\n      <Grid container spacing={1}>\n        <Grid item><HitModeToggle size=\"small\" /></Grid>\n        <Grid item><InfusionAuraDropdown /></Grid>\n        <Grid item><ReactionToggle size=\"small\" /></Grid>\n      </Grid>\n      <Box display=\"flex\" gap={1} >\n        <Box>\n          <Typography variant='subtitle2' >{t(\"formulas\")} {\"&\"}</Typography>\n          <Typography variant='subtitle2' >{t(\"calculations\")}</Typography>\n        </Box>\n        <ExpandButton\n          expand={expanded}\n          onClick={toggle}\n          aria-expanded={expanded}\n          aria-label=\"show more\"\n          size=\"small\"\n          sx={{ p: 0 }}\n        >\n          <ExpandMore />\n        </ExpandButton>\n      </Box>\n    </CardContent>\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\n      <CardContent sx={{ pt: 0 }}>\n        <CalculationDisplay />\n      </CardContent>\n    </Collapse>\n  </CardLight>\n}\n\nfunction CalculationDisplay() {\n  const { data } = useContext(DataContext)\n  const sections = getDisplaySections(data)\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\n    <Box sx={{ mr: -1, mb: -1 }}>\n      {sections.map(([key, Nodes]) =>\n        <FormulaCalc key={key} displayNs={Nodes} sectionKey={key} />)}\n    </Box>\n  </Suspense>\n}\nfunction FormulaCalc({ sectionKey, displayNs }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\n  const { data } = useContext(DataContext)\n  const header = usePromise(() => getDisplayHeader(data, sectionKey), [data, sectionKey])\n  if (!header) return null\n  if (Object.entries(displayNs).every(([_, node]) => node.isEmpty)) return null\n  const { title, icon, action } = header\n  return <CardDark sx={{ mb: 1 }}>\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\n    <Divider />\n    <CardContent>\n      {Object.entries(displayNs).map(([key, node]) =>\n        !node.isEmpty && <Accordion sx={{ bgcolor: \"contentLight.main\" }} key={key}>\n          <AccordionSummary expandIcon={<ExpandMore />}>\n            <Typography><ColorText color={node.info.variant}>{KeyMap.get(node.info.key ?? \"\")}</ColorText> <strong>{valueString(node.value, node.unit)}</strong></Typography>\n          </AccordionSummary>\n          <AccordionDetails>\n            {node.formulas.map((subform, i) => <Typography key={i}>{subform}</Typography>)}\n          </AccordionDetails>\n        </Accordion>)}\n    </CardContent>\n  </CardDark>\n}\n","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { BusinessCenter, Lock, LockOpen } from \"@mui/icons-material\"\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, IconButton, Skeleton, Tooltip, Typography } from \"@mui/material\"\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Assets from \"../Assets/Assets\"\nimport CardLight from \"../Components/Card/CardLight\"\nimport CharacterAutocomplete from '../Components/Character/CharacterAutocomplete'\nimport LocationName from \"../Components/Character/LocationName\"\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\nimport ImgIcon from \"../Components/Image/ImgIcon\"\nimport { Stars } from \"../Components/StarDisplay\"\nimport StatIcon from \"../Components/StatIcon\"\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\nimport { DatabaseContext } from \"../Database/Database\"\nimport { uiInput as input } from \"../Formula\"\nimport { computeUIData, dataObjForWeapon } from \"../Formula/api\"\nimport KeyMap, { valueString } from \"../KeyMap\"\nimport usePromise from \"../ReactHooks/usePromise\"\nimport useWeapon from \"../ReactHooks/useWeapon\"\nimport { CharacterKey } from \"../Types/consts\"\n\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean, extraButtons?: JSX.Element }\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false, extraButtons }: WeaponCardProps) {\n  const { t } = useTranslation([\"page_weapon\", \"ui\"]);\n  const { database } = useContext(DatabaseContext)\n  const databaseWeapon = useWeapon(weaponId)\n  const weapon = databaseWeapon\n  const weaponSheet = usePromise(() => weapon?.key ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\n\n  const filter = useCallback(\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\n    [weaponSheet],\n  )\n\n  const wrapperFunc = useCallback(children => <CardActionArea onClick={() => onClick?.(weaponId)} >{children}</CardActionArea>, [onClick, weaponId],)\n  const falseWrapperFunc = useCallback(children => <Box >{children}</Box>, [])\n\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => database.weapons.set(weaponId, { location: charKey }), [database, weaponId],)\n\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n\n  if (!weapon || !weaponSheet || !UIData) return null;\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\n  const weaponTypeKey = UIData.get(input.weapon.type).value!\n  const stats = [input.weapon.main, input.weapon.sub, input.weapon.sub2].map(x => UIData.get(x))\n  const img = weaponSheet.getImg(ascension)\n\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: \"space-between\" }}>\n      <ConditionalWrapper condition={!!onClick} wrapper={wrapperFunc} falseWrapper={falseWrapperFunc}>\n        <Box className={`grad-${weaponSheet.rarity}star`} sx={{ position: \"relative\", pt: 2, px: 2, }}>\n          {!onClick && <IconButton color=\"primary\" onClick={() => database.weapons.set(id, { lock: !lock })} sx={{ position: \"absolute\", right: 0, bottom: 0, zIndex: 2 }}>\n            {lock ? <Lock /> : <LockOpen />}\n          </IconButton>}\n          <Box sx={{ position: \"relative\", zIndex: 1 }}>\n            <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\", gap: 1, mb: 1 }}>\n              <ImgIcon sx={{ fontSize: \"1.5em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />\n              <Typography noWrap sx={{ textAlign: \"center\", backgroundColor: \"rgba(100,100,100,0.35)\", borderRadius: \"1em\", px: 1 }}><strong>{weaponSheet.name}</strong></Typography>\n            </Box>\n            <Typography component=\"span\" variant=\"h5\">Lv. {level}</Typography>\n            <Typography component=\"span\" variant=\"h5\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\n            <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\n            <Typography><Stars stars={weaponSheet.rarity} colored /></Typography>\n          </Box>\n          <Box sx={{ height: \"100%\", position: \"absolute\", right: 0, top: 0 }}>\n            <Box\n              component=\"img\"\n              src={img ?? \"\"}\n              width=\"auto\"\n              height=\"100%\"\n              sx={{ float: \"right\" }}\n            />\n          </Box>\n        </Box>\n        <CardContent>\n          {stats.map(node => {\n            if (!node.info.key) return null\n            const displayVal = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\n            return <Box key={node.info.key} sx={{ display: \"flex\" }}>\n              <Typography flexGrow={1}>{StatIcon[node.info.key!]} {KeyMap.get(node.info.key)}</Typography>\n              <Typography>{displayVal}</Typography>\n            </Box>\n          })}\n        </CardContent>\n      </ConditionalWrapper>\n      <Box sx={{ p: 1, display: \"flex\", gap: 1, justifyContent: \"space-between\", alignItems: \"center\" }}>\n        {canEquip\n          ? <CharacterAutocomplete size=\"small\" sx={{ flexGrow: 1 }} disable={(v: any) => v === \"\"}\n            showDefault defaultIcon={<BusinessCenter />} defaultText={t(\"ui:inventory\")}\n            value={location} onChange={equipOnChar} filter={filter} disableClearable />\n          : <LocationName location={location} />}\n        <ButtonGroup>\n          {!!onEdit && <Tooltip title={<Typography>{t`page_weapon:edit`}</Typography>} placement=\"top\" arrow>\n            <Button color=\"info\" onClick={() => onEdit(id)} >\n              <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\n            </Button>\n          </Tooltip>}\n          {!!onDelete && <Button color=\"error\" onClick={() => onDelete(id)} disabled={!!location || lock} >\n            <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\n          </Button>}\n          {extraButtons}\n        </ButtonGroup>\n      </Box>\n    </CardLight>\n  </Suspense>\n}\n","import { useCallback, useState } from \"react\"\n\nexport default function useBoolState(initial: boolean = false) {\n  const [bool, setBool] = useState(initial)\n  const onTrue = useCallback(() => setBool(true), [setBool],)\n  const onFalse = useCallback(() => setBool(false), [setBool],)\n  return [bool, onTrue, onFalse] as [boolean, () => void, () => void]\n}\n","import { strPadLeft } from \"./Util\"\n\nexport const SECOND_MS = 1000\nexport const MINUTE_MS = 60 * SECOND_MS\nexport const HOUR_MS = 60 * MINUTE_MS\nexport const DAY_MS = 24 * HOUR_MS\n\nexport function msToUnits(ms: number) {\n  let milliseconds = ms % 1000\n  let seconds = Math.floor((ms / 1000) % 60)\n  let minutes = Math.floor((ms / (1000 * 60)) % 60)\n  let hours = Math.floor((ms / (1000 * 60 * 60)))\n  return { hours, minutes, seconds, milliseconds }\n}\nexport function timeString(ms: number) {\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\n  let { hours, minutes, seconds } = msToUnits(ms)\n  let timeText = \"Minutes\"\n  if (hours) timeText = \"Hours\"\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)} ${timeText}`;\n}\nexport function timeStringMs(ms: number) {\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\n  let { hours, minutes, seconds, milliseconds } = msToUnits(ms)\n  let timeText = \"Minutes\"\n  if (hours) timeText = \"Hours\"\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)}.${strPadLeft(milliseconds, '0', 3)} ${timeText}`;\n}\n","import { WeaponKey } from \"../Types/consts\";\nimport { ICachedWeapon } from \"../Types/weapon\";\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\nimport { FilterConfigs, SortConfigs } from \"./SortByFilters\";\nimport i18n from \"../i18n\";\nexport const weaponSortKeys = [\"level\", \"rarity\"]\nexport type WeaponSortKey = typeof weaponSortKeys[number]\n\nexport function weaponSortConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): SortConfigs<WeaponSortKey, ICachedWeapon> {\n  return {\n    level: {\n      getValue: wp => wp.level * wp.ascension ?? 0,\n      tieBreaker: \"rarity\"\n    },\n    rarity: {\n      getValue: wp => weaponSheets?.[wp.key]?.rarity,\n      tieBreaker: \"level\"\n    }\n  }\n}\nexport function weaponFilterConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): FilterConfigs<\"rarity\" | \"weaponType\" | \"name\", ICachedWeapon> {\n  return {\n    rarity: (wp, filter) => filter.includes(weaponSheets?.[wp.key]?.rarity),\n    weaponType: (wp, filter) => filter.includes(weaponSheets?.[wp.key]?.weaponType),\n    // TODO: Add types to this. filter may or may not be an array?\n    name: (wp, filter) => i18n.t(`weaponNames_gen:${wp.key}`).toLowerCase().includes(filter.toLowerCase()),\n  }\n}\n","var Module=typeof Module!==\"undefined\"?Module:{};var objAssign=Object.assign;var moduleOverrides=objAssign({},Module);var arguments_=[];var thisProgram=\"./this.program\";var quit_=(status,toThrow)=>{throw toThrow};var ENVIRONMENT_IS_WEB=typeof window===\"object\";var ENVIRONMENT_IS_WORKER=typeof importScripts===\"function\";var ENVIRONMENT_IS_NODE=typeof process===\"object\"&&typeof process.versions===\"object\"&&typeof process.versions.node===\"string\";var scriptDirectory=\"\";function locateFile(path){if(Module[\"locateFile\"]){return Module[\"locateFile\"](path,scriptDirectory)}return scriptDirectory+path}var read_,readAsync,readBinary,setWindowTitle;function logExceptionOnExit(e){if(e instanceof ExitStatus)return;let toLog=e;err(\"exiting due to exception: \"+toLog)}var fs;var nodePath;var requireNodeFS;if(ENVIRONMENT_IS_NODE){if(ENVIRONMENT_IS_WORKER){scriptDirectory=require(\"path\").dirname(scriptDirectory)+\"/\"}else{scriptDirectory=__dirname+\"/\"}requireNodeFS=(()=>{if(!nodePath){fs=require(\"fs\");nodePath=require(\"path\")}});read_=function shell_read(filename,binary){requireNodeFS();filename=nodePath[\"normalize\"](filename);return fs.readFileSync(filename,binary?null:\"utf8\")};readBinary=(filename=>{var ret=read_(filename,true);if(!ret.buffer){ret=new Uint8Array(ret)}return ret});readAsync=((filename,onload,onerror)=>{requireNodeFS();filename=nodePath[\"normalize\"](filename);fs.readFile(filename,function(err,data){if(err)onerror(err);else onload(data.buffer)})});if(process[\"argv\"].length>1){thisProgram=process[\"argv\"][1].replace(/\\\\/g,\"/\")}arguments_=process[\"argv\"].slice(2);if(typeof module!==\"undefined\"){module[\"exports\"]=Module}process[\"on\"](\"uncaughtException\",function(ex){if(!(ex instanceof ExitStatus)){throw ex}});process[\"on\"](\"unhandledRejection\",function(reason){throw reason});quit_=((status,toThrow)=>{if(keepRuntimeAlive()){process[\"exitCode\"]=status;throw toThrow}logExceptionOnExit(toThrow);process[\"exit\"](status)});Module[\"inspect\"]=function(){return\"[Emscripten Module object]\"}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){if(ENVIRONMENT_IS_WORKER){scriptDirectory=self.location.href}else if(typeof document!==\"undefined\"&&document.currentScript){scriptDirectory=document.currentScript.src}if(scriptDirectory.indexOf(\"blob:\")!==0){scriptDirectory=scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,\"\").lastIndexOf(\"/\")+1)}else{scriptDirectory=\"\"}{read_=(url=>{var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,false);xhr.send(null);return xhr.responseText});if(ENVIRONMENT_IS_WORKER){readBinary=(url=>{var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,false);xhr.responseType=\"arraybuffer\";xhr.send(null);return new Uint8Array(xhr.response)})}readAsync=((url,onload,onerror)=>{var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,true);xhr.responseType=\"arraybuffer\";xhr.onload=(()=>{if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return}onerror()});xhr.onerror=onerror;xhr.send(null)})}setWindowTitle=(title=>document.title=title)}else{}var out=Module[\"print\"]||console.log.bind(console);var err=Module[\"printErr\"]||console.warn.bind(console);objAssign(Module,moduleOverrides);moduleOverrides=null;if(Module[\"arguments\"])arguments_=Module[\"arguments\"];if(Module[\"thisProgram\"])thisProgram=Module[\"thisProgram\"];if(Module[\"quit\"])quit_=Module[\"quit\"];var POINTER_SIZE=4;function warnOnce(text){if(!warnOnce.shown)warnOnce.shown={};if(!warnOnce.shown[text]){warnOnce.shown[text]=1;err(text)}}function convertJsFunctionToWasm(func,sig){if(typeof WebAssembly.Function===\"function\"){var typeNames={\"i\":\"i32\",\"j\":\"i64\",\"f\":\"f32\",\"d\":\"f64\"};var type={parameters:[],results:sig[0]==\"v\"?[]:[typeNames[sig[0]]]};for(var i=1;i<sig.length;++i){type.parameters.push(typeNames[sig[i]])}return new WebAssembly.Function(type,func)}var typeSection=[1,0,1,96];var sigRet=sig.slice(0,1);var sigParam=sig.slice(1);var typeCodes={\"i\":127,\"j\":126,\"f\":125,\"d\":124};typeSection.push(sigParam.length);for(var i=0;i<sigParam.length;++i){typeSection.push(typeCodes[sigParam[i]])}if(sigRet==\"v\"){typeSection.push(0)}else{typeSection=typeSection.concat([1,typeCodes[sigRet]])}typeSection[1]=typeSection.length-2;var bytes=new Uint8Array([0,97,115,109,1,0,0,0].concat(typeSection,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0]));var module=new WebAssembly.Module(bytes);var instance=new WebAssembly.Instance(module,{\"e\":{\"f\":func}});var wrappedFunc=instance.exports[\"f\"];return wrappedFunc}var freeTableIndexes=[];var functionsInTableMap;function getEmptyTableSlot(){if(freeTableIndexes.length){return freeTableIndexes.pop()}try{wasmTable.grow(1)}catch(err){if(!(err instanceof RangeError)){throw err}throw\"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.\"}return wasmTable.length-1}function updateTableMap(offset,count){for(var i=offset;i<offset+count;i++){var item=getWasmTableEntry(i);if(item){functionsInTableMap.set(item,i)}}}var tempRet0=0;var wasmBinary;if(Module[\"wasmBinary\"])wasmBinary=Module[\"wasmBinary\"];var noExitRuntime=Module[\"noExitRuntime\"]||true;if(typeof WebAssembly!==\"object\"){abort(\"no native wasm support detected\")}var wasmMemory;var ABORT=false;var EXITSTATUS;function assert(condition,text){if(!condition){abort(text)}}function getCFunc(ident){var func=Module[\"_\"+ident];return func}function ccall(ident,returnType,argTypes,args,opts){var toC={\"string\":function(str){var ret=0;if(str!==null&&str!==undefined&&str!==0){var len=(str.length<<2)+1;ret=stackAlloc(len);stringToUTF8(str,ret,len)}return ret},\"array\":function(arr){var ret=stackAlloc(arr.length);writeArrayToMemory(arr,ret);return ret}};function convertReturnValue(ret){if(returnType===\"string\")return UTF8ToString(ret);if(returnType===\"boolean\")return Boolean(ret);return ret}var func=getCFunc(ident);var cArgs=[];var stack=0;if(args){for(var i=0;i<args.length;i++){var converter=toC[argTypes[i]];if(converter){if(stack===0)stack=stackSave();cArgs[i]=converter(args[i])}else{cArgs[i]=args[i]}}}var ret=func.apply(null,cArgs);function onDone(ret){if(stack!==0)stackRestore(stack);return convertReturnValue(ret)}ret=onDone(ret);return ret}var ALLOC_STACK=1;var UTF8Decoder=typeof TextDecoder!==\"undefined\"?new TextDecoder(\"utf8\"):undefined;function UTF8ArrayToString(heap,idx,maxBytesToRead){var endIdx=idx+maxBytesToRead;var endPtr=idx;while(heap[endPtr]&&!(endPtr>=endIdx))++endPtr;if(endPtr-idx>16&&heap.subarray&&UTF8Decoder){return UTF8Decoder.decode(heap.subarray(idx,endPtr))}else{var str=\"\";while(idx<endPtr){var u0=heap[idx++];if(!(u0&128)){str+=String.fromCharCode(u0);continue}var u1=heap[idx++]&63;if((u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue}var u2=heap[idx++]&63;if((u0&240)==224){u0=(u0&15)<<12|u1<<6|u2}else{u0=(u0&7)<<18|u1<<12|u2<<6|heap[idx++]&63}if(u0<65536){str+=String.fromCharCode(u0)}else{var ch=u0-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}}}return str}function UTF8ToString(ptr,maxBytesToRead){return ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):\"\"}function stringToUTF8Array(str,heap,outIdx,maxBytesToWrite){if(!(maxBytesToWrite>0))return 0;var startIdx=outIdx;var endIdx=outIdx+maxBytesToWrite-1;for(var i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343){var u1=str.charCodeAt(++i);u=65536+((u&1023)<<10)|u1&1023}if(u<=127){if(outIdx>=endIdx)break;heap[outIdx++]=u}else if(u<=2047){if(outIdx+1>=endIdx)break;heap[outIdx++]=192|u>>6;heap[outIdx++]=128|u&63}else if(u<=65535){if(outIdx+2>=endIdx)break;heap[outIdx++]=224|u>>12;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63}else{if(outIdx+3>=endIdx)break;heap[outIdx++]=240|u>>18;heap[outIdx++]=128|u>>12&63;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63}}heap[outIdx]=0;return outIdx-startIdx}function stringToUTF8(str,outPtr,maxBytesToWrite){return stringToUTF8Array(str,HEAPU8,outPtr,maxBytesToWrite)}function lengthBytesUTF8(str){var len=0;for(var i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343)u=65536+((u&1023)<<10)|str.charCodeAt(++i)&1023;if(u<=127)++len;else if(u<=2047)len+=2;else if(u<=65535)len+=3;else len+=4}return len}var UTF16Decoder=typeof TextDecoder!==\"undefined\"?new TextDecoder(\"utf-16le\"):undefined;function UTF16ToString(ptr,maxBytesToRead){var endPtr=ptr;var idx=endPtr>>1;var maxIdx=idx+maxBytesToRead/2;while(!(idx>=maxIdx)&&HEAPU16[idx])++idx;endPtr=idx<<1;if(endPtr-ptr>32&&UTF16Decoder){return UTF16Decoder.decode(HEAPU8.subarray(ptr,endPtr))}else{var str=\"\";for(var i=0;!(i>=maxBytesToRead/2);++i){var codeUnit=HEAP16[ptr+i*2>>1];if(codeUnit==0)break;str+=String.fromCharCode(codeUnit)}return str}}function stringToUTF16(str,outPtr,maxBytesToWrite){if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647}if(maxBytesToWrite<2)return 0;maxBytesToWrite-=2;var startPtr=outPtr;var numCharsToWrite=maxBytesToWrite<str.length*2?maxBytesToWrite/2:str.length;for(var i=0;i<numCharsToWrite;++i){var codeUnit=str.charCodeAt(i);HEAP16[outPtr>>1]=codeUnit;outPtr+=2}HEAP16[outPtr>>1]=0;return outPtr-startPtr}function lengthBytesUTF16(str){return str.length*2}function UTF32ToString(ptr,maxBytesToRead){var i=0;var str=\"\";while(!(i>=maxBytesToRead/4)){var utf32=HEAP32[ptr+i*4>>2];if(utf32==0)break;++i;if(utf32>=65536){var ch=utf32-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}else{str+=String.fromCharCode(utf32)}}return str}function stringToUTF32(str,outPtr,maxBytesToWrite){if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647}if(maxBytesToWrite<4)return 0;var startPtr=outPtr;var endPtr=startPtr+maxBytesToWrite-4;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343){var trailSurrogate=str.charCodeAt(++i);codeUnit=65536+((codeUnit&1023)<<10)|trailSurrogate&1023}HEAP32[outPtr>>2]=codeUnit;outPtr+=4;if(outPtr+4>endPtr)break}HEAP32[outPtr>>2]=0;return outPtr-startPtr}function lengthBytesUTF32(str){var len=0;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343)++i;len+=4}return len}function writeArrayToMemory(array,buffer){HEAP8.set(array,buffer)}function writeAsciiToMemory(str,buffer,dontAddNull){for(var i=0;i<str.length;++i){HEAP8[buffer++>>0]=str.charCodeAt(i)}if(!dontAddNull)HEAP8[buffer>>0]=0}var buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateGlobalBufferAndViews(buf){buffer=buf;Module[\"HEAP8\"]=HEAP8=new Int8Array(buf);Module[\"HEAP16\"]=HEAP16=new Int16Array(buf);Module[\"HEAP32\"]=HEAP32=new Int32Array(buf);Module[\"HEAPU8\"]=HEAPU8=new Uint8Array(buf);Module[\"HEAPU16\"]=HEAPU16=new Uint16Array(buf);Module[\"HEAPU32\"]=HEAPU32=new Uint32Array(buf);Module[\"HEAPF32\"]=HEAPF32=new Float32Array(buf);Module[\"HEAPF64\"]=HEAPF64=new Float64Array(buf)}var INITIAL_MEMORY=Module[\"INITIAL_MEMORY\"]||16777216;var wasmTable;var __ATPRERUN__=[];var __ATINIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeExited=false;var runtimeKeepaliveCounter=0;function keepRuntimeAlive(){return noExitRuntime||runtimeKeepaliveCounter>0}function preRun(){if(Module[\"preRun\"]){if(typeof Module[\"preRun\"]==\"function\")Module[\"preRun\"]=[Module[\"preRun\"]];while(Module[\"preRun\"].length){addOnPreRun(Module[\"preRun\"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=true;callRuntimeCallbacks(__ATINIT__)}function exitRuntime(){runtimeExited=true}function postRun(){if(Module[\"postRun\"]){if(typeof Module[\"postRun\"]==\"function\")Module[\"postRun\"]=[Module[\"postRun\"]];while(Module[\"postRun\"].length){addOnPostRun(Module[\"postRun\"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(cb){__ATPRERUN__.unshift(cb)}function addOnInit(cb){__ATINIT__.unshift(cb)}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb)}var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;function addRunDependency(id){runDependencies++;if(Module[\"monitorRunDependencies\"]){Module[\"monitorRunDependencies\"](runDependencies)}}function removeRunDependency(id){runDependencies--;if(Module[\"monitorRunDependencies\"]){Module[\"monitorRunDependencies\"](runDependencies)}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback()}}}Module[\"preloadedImages\"]={};Module[\"preloadedAudios\"]={};function abort(what){{if(Module[\"onAbort\"]){Module[\"onAbort\"](what)}}what=\"Aborted(\"+what+\")\";err(what);ABORT=true;EXITSTATUS=1;what+=\". Build with -s ASSERTIONS=1 for more info.\";var e=new WebAssembly.RuntimeError(what);throw e}var dataURIPrefix=\"data:application/octet-stream;base64,\";function isDataURI(filename){return filename.startsWith(dataURIPrefix)}function isFileURI(filename){return filename.startsWith(\"file://\")}var wasmBinaryFile;wasmBinaryFile=\"assembly.wasm\";if(!isDataURI(wasmBinaryFile)){wasmBinaryFile=locateFile(wasmBinaryFile)}function getBinary(file){try{if(file==wasmBinaryFile&&wasmBinary){return new Uint8Array(wasmBinary)}if(readBinary){return readBinary(file)}else{throw\"both async and sync fetching of the wasm failed\"}}catch(err){abort(err)}}function getBinaryPromise(){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch===\"function\"&&!isFileURI(wasmBinaryFile)){return fetch(wasmBinaryFile,{credentials:\"same-origin\"}).then(function(response){if(!response[\"ok\"]){throw\"failed to load wasm binary file at '\"+wasmBinaryFile+\"'\"}return response[\"arrayBuffer\"]()}).catch(function(){return getBinary(wasmBinaryFile)})}else{if(readAsync){return new Promise(function(resolve,reject){readAsync(wasmBinaryFile,function(response){resolve(new Uint8Array(response))},reject)})}}}return Promise.resolve().then(function(){return getBinary(wasmBinaryFile)})}function createWasm(){var info={\"env\":asmLibraryArg,\"wasi_snapshot_preview1\":asmLibraryArg};function receiveInstance(instance,module){var exports=instance.exports;Module[\"asm\"]=exports;wasmMemory=Module[\"asm\"][\"memory\"];updateGlobalBufferAndViews(wasmMemory.buffer);wasmTable=Module[\"asm\"][\"__indirect_function_table\"];addOnInit(Module[\"asm\"][\"__wasm_call_ctors\"]);removeRunDependency(\"wasm-instantiate\")}addRunDependency(\"wasm-instantiate\");function receiveInstantiationResult(result){receiveInstance(result[\"instance\"])}function instantiateArrayBuffer(receiver){return getBinaryPromise().then(function(binary){return WebAssembly.instantiate(binary,info)}).then(function(instance){return instance}).then(receiver,function(reason){err(\"failed to asynchronously prepare wasm: \"+reason);abort(reason)})}function instantiateAsync(){if(!wasmBinary&&typeof WebAssembly.instantiateStreaming===\"function\"&&!isDataURI(wasmBinaryFile)&&!isFileURI(wasmBinaryFile)&&typeof fetch===\"function\"){return fetch(wasmBinaryFile,{credentials:\"same-origin\"}).then(function(response){var result=WebAssembly.instantiateStreaming(response,info);return result.then(receiveInstantiationResult,function(reason){err(\"wasm streaming compile failed: \"+reason);err(\"falling back to ArrayBuffer instantiation\");return instantiateArrayBuffer(receiveInstantiationResult)})})}else{return instantiateArrayBuffer(receiveInstantiationResult)}}if(Module[\"instantiateWasm\"]){try{var exports=Module[\"instantiateWasm\"](info,receiveInstance);return exports}catch(e){err(\"Module.instantiateWasm callback failed with error: \"+e);return false}}instantiateAsync();return{}}var tempDouble;var tempI64;function callRuntimeCallbacks(callbacks){while(callbacks.length>0){var callback=callbacks.shift();if(typeof callback==\"function\"){callback(Module);continue}var func=callback.func;if(typeof func===\"number\"){if(callback.arg===undefined){getWasmTableEntry(func)()}else{getWasmTableEntry(func)(callback.arg)}}else{func(callback.arg===undefined?null:callback.arg)}}}function demangle(func){return func}function demangleAll(text){var regex=/\\b_Z[\\w\\d_]+/g;return text.replace(regex,function(x){var y=demangle(x);return x===y?x:y+\" [\"+x+\"]\"})}var wasmTableMirror=[];function getWasmTableEntry(funcPtr){var func=wasmTableMirror[funcPtr];if(!func){if(funcPtr>=wasmTableMirror.length)wasmTableMirror.length=funcPtr+1;wasmTableMirror[funcPtr]=func=wasmTable.get(funcPtr)}return func}function jsStackTrace(){var error=new Error;if(!error.stack){try{throw new Error}catch(e){error=e}if(!error.stack){return\"(no stack trace available)\"}}return error.stack.toString()}function setWasmTableEntry(idx,func){wasmTable.set(idx,func);wasmTableMirror[idx]=func}function ___cxa_allocate_exception(size){return _malloc(size+16)+16}function ExceptionInfo(excPtr){this.excPtr=excPtr;this.ptr=excPtr-16;this.set_type=function(type){HEAP32[this.ptr+4>>2]=type};this.get_type=function(){return HEAP32[this.ptr+4>>2]};this.set_destructor=function(destructor){HEAP32[this.ptr+8>>2]=destructor};this.get_destructor=function(){return HEAP32[this.ptr+8>>2]};this.set_refcount=function(refcount){HEAP32[this.ptr>>2]=refcount};this.set_caught=function(caught){caught=caught?1:0;HEAP8[this.ptr+12>>0]=caught};this.get_caught=function(){return HEAP8[this.ptr+12>>0]!=0};this.set_rethrown=function(rethrown){rethrown=rethrown?1:0;HEAP8[this.ptr+13>>0]=rethrown};this.get_rethrown=function(){return HEAP8[this.ptr+13>>0]!=0};this.init=function(type,destructor){this.set_type(type);this.set_destructor(destructor);this.set_refcount(0);this.set_caught(false);this.set_rethrown(false)};this.add_ref=function(){var value=HEAP32[this.ptr>>2];HEAP32[this.ptr>>2]=value+1};this.release_ref=function(){var prev=HEAP32[this.ptr>>2];HEAP32[this.ptr>>2]=prev-1;return prev===1}}var exceptionLast=0;var uncaughtExceptionCount=0;function ___cxa_throw(ptr,type,destructor){var info=new ExceptionInfo(ptr);info.init(type,destructor);exceptionLast=ptr;uncaughtExceptionCount++;throw ptr}function __embind_register_bigint(primitiveType,name,size,minRange,maxRange){}function getShiftFromSize(size){switch(size){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(\"Unknown type size: \"+size)}}function embind_init_charCodes(){var codes=new Array(256);for(var i=0;i<256;++i){codes[i]=String.fromCharCode(i)}embind_charCodes=codes}var embind_charCodes=undefined;function readLatin1String(ptr){var ret=\"\";var c=ptr;while(HEAPU8[c]){ret+=embind_charCodes[HEAPU8[c++]]}return ret}var awaitingDependencies={};var registeredTypes={};var typeDependencies={};var char_0=48;var char_9=57;function makeLegalFunctionName(name){if(undefined===name){return\"_unknown\"}name=name.replace(/[^a-zA-Z0-9_]/g,\"$\");var f=name.charCodeAt(0);if(f>=char_0&&f<=char_9){return\"_\"+name}else{return name}}function createNamedFunction(name,body){name=makeLegalFunctionName(name);return new Function(\"body\",\"return function \"+name+\"() {\\n\"+'    \"use strict\";'+\"    return body.apply(this, arguments);\\n\"+\"};\\n\")(body)}function extendError(baseErrorType,errorName){var errorClass=createNamedFunction(errorName,function(message){this.name=errorName;this.message=message;var stack=new Error(message).stack;if(stack!==undefined){this.stack=this.toString()+\"\\n\"+stack.replace(/^Error(:[^\\n]*)?\\n/,\"\")}});errorClass.prototype=Object.create(baseErrorType.prototype);errorClass.prototype.constructor=errorClass;errorClass.prototype.toString=function(){if(this.message===undefined){return this.name}else{return this.name+\": \"+this.message}};return errorClass}var BindingError=undefined;function throwBindingError(message){throw new BindingError(message)}var InternalError=undefined;function throwInternalError(message){throw new InternalError(message)}function whenDependentTypesAreResolved(myTypes,dependentTypes,getTypeConverters){myTypes.forEach(function(type){typeDependencies[type]=dependentTypes});function onComplete(typeConverters){var myTypeConverters=getTypeConverters(typeConverters);if(myTypeConverters.length!==myTypes.length){throwInternalError(\"Mismatched type converter count\")}for(var i=0;i<myTypes.length;++i){registerType(myTypes[i],myTypeConverters[i])}}var typeConverters=new Array(dependentTypes.length);var unregisteredTypes=[];var registered=0;dependentTypes.forEach(function(dt,i){if(registeredTypes.hasOwnProperty(dt)){typeConverters[i]=registeredTypes[dt]}else{unregisteredTypes.push(dt);if(!awaitingDependencies.hasOwnProperty(dt)){awaitingDependencies[dt]=[]}awaitingDependencies[dt].push(function(){typeConverters[i]=registeredTypes[dt];++registered;if(registered===unregisteredTypes.length){onComplete(typeConverters)}})}});if(0===unregisteredTypes.length){onComplete(typeConverters)}}function registerType(rawType,registeredInstance,options={}){if(!(\"argPackAdvance\"in registeredInstance)){throw new TypeError(\"registerType registeredInstance requires argPackAdvance\")}var name=registeredInstance.name;if(!rawType){throwBindingError('type \"'+name+'\" must have a positive integer typeid pointer')}if(registeredTypes.hasOwnProperty(rawType)){if(options.ignoreDuplicateRegistrations){return}else{throwBindingError(\"Cannot register type '\"+name+\"' twice\")}}registeredTypes[rawType]=registeredInstance;delete typeDependencies[rawType];if(awaitingDependencies.hasOwnProperty(rawType)){var callbacks=awaitingDependencies[rawType];delete awaitingDependencies[rawType];callbacks.forEach(function(cb){cb()})}}function __embind_register_bool(rawType,name,size,trueValue,falseValue){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,\"fromWireType\":function(wt){return!!wt},\"toWireType\":function(destructors,o){return o?trueValue:falseValue},\"argPackAdvance\":8,\"readValueFromPointer\":function(pointer){var heap;if(size===1){heap=HEAP8}else if(size===2){heap=HEAP16}else if(size===4){heap=HEAP32}else{throw new TypeError(\"Unknown boolean type size: \"+name)}return this[\"fromWireType\"](heap[pointer>>shift])},destructorFunction:null})}function ClassHandle_isAliasOf(other){if(!(this instanceof ClassHandle)){return false}if(!(other instanceof ClassHandle)){return false}var leftClass=this.$$.ptrType.registeredClass;var left=this.$$.ptr;var rightClass=other.$$.ptrType.registeredClass;var right=other.$$.ptr;while(leftClass.baseClass){left=leftClass.upcast(left);leftClass=leftClass.baseClass}while(rightClass.baseClass){right=rightClass.upcast(right);rightClass=rightClass.baseClass}return leftClass===rightClass&&left===right}function shallowCopyInternalPointer(o){return{count:o.count,deleteScheduled:o.deleteScheduled,preservePointerOnDelete:o.preservePointerOnDelete,ptr:o.ptr,ptrType:o.ptrType,smartPtr:o.smartPtr,smartPtrType:o.smartPtrType}}function throwInstanceAlreadyDeleted(obj){function getInstanceTypeName(handle){return handle.$$.ptrType.registeredClass.name}throwBindingError(getInstanceTypeName(obj)+\" instance already deleted\")}var finalizationGroup=false;function detachFinalizer(handle){}function runDestructor($$){if($$.smartPtr){$$.smartPtrType.rawDestructor($$.smartPtr)}else{$$.ptrType.registeredClass.rawDestructor($$.ptr)}}function releaseClassHandle($$){$$.count.value-=1;var toDelete=0===$$.count.value;if(toDelete){runDestructor($$)}}function attachFinalizer(handle){if(\"undefined\"===typeof FinalizationGroup){attachFinalizer=(handle=>handle);return handle}finalizationGroup=new FinalizationGroup(function(iter){for(var result=iter.next();!result.done;result=iter.next()){var $$=result.value;if(!$$.ptr){console.warn(\"object already deleted: \"+$$.ptr)}else{releaseClassHandle($$)}}});attachFinalizer=(handle=>{finalizationGroup.register(handle,handle.$$,handle.$$);return handle});detachFinalizer=(handle=>{finalizationGroup.unregister(handle.$$)});return attachFinalizer(handle)}function ClassHandle_clone(){if(!this.$$.ptr){throwInstanceAlreadyDeleted(this)}if(this.$$.preservePointerOnDelete){this.$$.count.value+=1;return this}else{var clone=attachFinalizer(Object.create(Object.getPrototypeOf(this),{$$:{value:shallowCopyInternalPointer(this.$$)}}));clone.$$.count.value+=1;clone.$$.deleteScheduled=false;return clone}}function ClassHandle_delete(){if(!this.$$.ptr){throwInstanceAlreadyDeleted(this)}if(this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete){throwBindingError(\"Object already scheduled for deletion\")}detachFinalizer(this);releaseClassHandle(this.$$);if(!this.$$.preservePointerOnDelete){this.$$.smartPtr=undefined;this.$$.ptr=undefined}}function ClassHandle_isDeleted(){return!this.$$.ptr}var delayFunction=undefined;var deletionQueue=[];function flushPendingDeletes(){while(deletionQueue.length){var obj=deletionQueue.pop();obj.$$.deleteScheduled=false;obj[\"delete\"]()}}function ClassHandle_deleteLater(){if(!this.$$.ptr){throwInstanceAlreadyDeleted(this)}if(this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete){throwBindingError(\"Object already scheduled for deletion\")}deletionQueue.push(this);if(deletionQueue.length===1&&delayFunction){delayFunction(flushPendingDeletes)}this.$$.deleteScheduled=true;return this}function init_ClassHandle(){ClassHandle.prototype[\"isAliasOf\"]=ClassHandle_isAliasOf;ClassHandle.prototype[\"clone\"]=ClassHandle_clone;ClassHandle.prototype[\"delete\"]=ClassHandle_delete;ClassHandle.prototype[\"isDeleted\"]=ClassHandle_isDeleted;ClassHandle.prototype[\"deleteLater\"]=ClassHandle_deleteLater}function ClassHandle(){}var registeredPointers={};function ensureOverloadTable(proto,methodName,humanName){if(undefined===proto[methodName].overloadTable){var prevFunc=proto[methodName];proto[methodName]=function(){if(!proto[methodName].overloadTable.hasOwnProperty(arguments.length)){throwBindingError(\"Function '\"+humanName+\"' called with an invalid number of arguments (\"+arguments.length+\") - expects one of (\"+proto[methodName].overloadTable+\")!\")}return proto[methodName].overloadTable[arguments.length].apply(this,arguments)};proto[methodName].overloadTable=[];proto[methodName].overloadTable[prevFunc.argCount]=prevFunc}}function exposePublicSymbol(name,value,numArguments){if(Module.hasOwnProperty(name)){if(undefined===numArguments||undefined!==Module[name].overloadTable&&undefined!==Module[name].overloadTable[numArguments]){throwBindingError(\"Cannot register public name '\"+name+\"' twice\")}ensureOverloadTable(Module,name,name);if(Module.hasOwnProperty(numArguments)){throwBindingError(\"Cannot register multiple overloads of a function with the same number of arguments (\"+numArguments+\")!\")}Module[name].overloadTable[numArguments]=value}else{Module[name]=value;if(undefined!==numArguments){Module[name].numArguments=numArguments}}}function RegisteredClass(name,constructor,instancePrototype,rawDestructor,baseClass,getActualType,upcast,downcast){this.name=name;this.constructor=constructor;this.instancePrototype=instancePrototype;this.rawDestructor=rawDestructor;this.baseClass=baseClass;this.getActualType=getActualType;this.upcast=upcast;this.downcast=downcast;this.pureVirtualFunctions=[]}function upcastPointer(ptr,ptrClass,desiredClass){while(ptrClass!==desiredClass){if(!ptrClass.upcast){throwBindingError(\"Expected null or instance of \"+desiredClass.name+\", got an instance of \"+ptrClass.name)}ptr=ptrClass.upcast(ptr);ptrClass=ptrClass.baseClass}return ptr}function constNoSmartPtrRawPointerToWireType(destructors,handle){if(handle===null){if(this.isReference){throwBindingError(\"null is not a valid \"+this.name)}return 0}if(!handle.$$){throwBindingError('Cannot pass \"'+_embind_repr(handle)+'\" as a '+this.name)}if(!handle.$$.ptr){throwBindingError(\"Cannot pass deleted object as a pointer of type \"+this.name)}var handleClass=handle.$$.ptrType.registeredClass;var ptr=upcastPointer(handle.$$.ptr,handleClass,this.registeredClass);return ptr}function genericPointerToWireType(destructors,handle){var ptr;if(handle===null){if(this.isReference){throwBindingError(\"null is not a valid \"+this.name)}if(this.isSmartPointer){ptr=this.rawConstructor();if(destructors!==null){destructors.push(this.rawDestructor,ptr)}return ptr}else{return 0}}if(!handle.$$){throwBindingError('Cannot pass \"'+_embind_repr(handle)+'\" as a '+this.name)}if(!handle.$$.ptr){throwBindingError(\"Cannot pass deleted object as a pointer of type \"+this.name)}if(!this.isConst&&handle.$$.ptrType.isConst){throwBindingError(\"Cannot convert argument of type \"+(handle.$$.smartPtrType?handle.$$.smartPtrType.name:handle.$$.ptrType.name)+\" to parameter type \"+this.name)}var handleClass=handle.$$.ptrType.registeredClass;ptr=upcastPointer(handle.$$.ptr,handleClass,this.registeredClass);if(this.isSmartPointer){if(undefined===handle.$$.smartPtr){throwBindingError(\"Passing raw pointer to smart pointer is illegal\")}switch(this.sharingPolicy){case 0:if(handle.$$.smartPtrType===this){ptr=handle.$$.smartPtr}else{throwBindingError(\"Cannot convert argument of type \"+(handle.$$.smartPtrType?handle.$$.smartPtrType.name:handle.$$.ptrType.name)+\" to parameter type \"+this.name)}break;case 1:ptr=handle.$$.smartPtr;break;case 2:if(handle.$$.smartPtrType===this){ptr=handle.$$.smartPtr}else{var clonedHandle=handle[\"clone\"]();ptr=this.rawShare(ptr,Emval.toHandle(function(){clonedHandle[\"delete\"]()}));if(destructors!==null){destructors.push(this.rawDestructor,ptr)}}break;default:throwBindingError(\"Unsupporting sharing policy\")}}return ptr}function nonConstNoSmartPtrRawPointerToWireType(destructors,handle){if(handle===null){if(this.isReference){throwBindingError(\"null is not a valid \"+this.name)}return 0}if(!handle.$$){throwBindingError('Cannot pass \"'+_embind_repr(handle)+'\" as a '+this.name)}if(!handle.$$.ptr){throwBindingError(\"Cannot pass deleted object as a pointer of type \"+this.name)}if(handle.$$.ptrType.isConst){throwBindingError(\"Cannot convert argument of type \"+handle.$$.ptrType.name+\" to parameter type \"+this.name)}var handleClass=handle.$$.ptrType.registeredClass;var ptr=upcastPointer(handle.$$.ptr,handleClass,this.registeredClass);return ptr}function simpleReadValueFromPointer(pointer){return this[\"fromWireType\"](HEAPU32[pointer>>2])}function RegisteredPointer_getPointee(ptr){if(this.rawGetPointee){ptr=this.rawGetPointee(ptr)}return ptr}function RegisteredPointer_destructor(ptr){if(this.rawDestructor){this.rawDestructor(ptr)}}function RegisteredPointer_deleteObject(handle){if(handle!==null){handle[\"delete\"]()}}function downcastPointer(ptr,ptrClass,desiredClass){if(ptrClass===desiredClass){return ptr}if(undefined===desiredClass.baseClass){return null}var rv=downcastPointer(ptr,ptrClass,desiredClass.baseClass);if(rv===null){return null}return desiredClass.downcast(rv)}function getInheritedInstanceCount(){return Object.keys(registeredInstances).length}function getLiveInheritedInstances(){var rv=[];for(var k in registeredInstances){if(registeredInstances.hasOwnProperty(k)){rv.push(registeredInstances[k])}}return rv}function setDelayFunction(fn){delayFunction=fn;if(deletionQueue.length&&delayFunction){delayFunction(flushPendingDeletes)}}function init_embind(){Module[\"getInheritedInstanceCount\"]=getInheritedInstanceCount;Module[\"getLiveInheritedInstances\"]=getLiveInheritedInstances;Module[\"flushPendingDeletes\"]=flushPendingDeletes;Module[\"setDelayFunction\"]=setDelayFunction}var registeredInstances={};function getBasestPointer(class_,ptr){if(ptr===undefined){throwBindingError(\"ptr should not be undefined\")}while(class_.baseClass){ptr=class_.upcast(ptr);class_=class_.baseClass}return ptr}function getInheritedInstance(class_,ptr){ptr=getBasestPointer(class_,ptr);return registeredInstances[ptr]}function makeClassHandle(prototype,record){if(!record.ptrType||!record.ptr){throwInternalError(\"makeClassHandle requires ptr and ptrType\")}var hasSmartPtrType=!!record.smartPtrType;var hasSmartPtr=!!record.smartPtr;if(hasSmartPtrType!==hasSmartPtr){throwInternalError(\"Both smartPtrType and smartPtr must be specified\")}record.count={value:1};return attachFinalizer(Object.create(prototype,{$$:{value:record}}))}function RegisteredPointer_fromWireType(ptr){var rawPointer=this.getPointee(ptr);if(!rawPointer){this.destructor(ptr);return null}var registeredInstance=getInheritedInstance(this.registeredClass,rawPointer);if(undefined!==registeredInstance){if(0===registeredInstance.$$.count.value){registeredInstance.$$.ptr=rawPointer;registeredInstance.$$.smartPtr=ptr;return registeredInstance[\"clone\"]()}else{var rv=registeredInstance[\"clone\"]();this.destructor(ptr);return rv}}function makeDefaultHandle(){if(this.isSmartPointer){return makeClassHandle(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:rawPointer,smartPtrType:this,smartPtr:ptr})}else{return makeClassHandle(this.registeredClass.instancePrototype,{ptrType:this,ptr:ptr})}}var actualType=this.registeredClass.getActualType(rawPointer);var registeredPointerRecord=registeredPointers[actualType];if(!registeredPointerRecord){return makeDefaultHandle.call(this)}var toType;if(this.isConst){toType=registeredPointerRecord.constPointerType}else{toType=registeredPointerRecord.pointerType}var dp=downcastPointer(rawPointer,this.registeredClass,toType.registeredClass);if(dp===null){return makeDefaultHandle.call(this)}if(this.isSmartPointer){return makeClassHandle(toType.registeredClass.instancePrototype,{ptrType:toType,ptr:dp,smartPtrType:this,smartPtr:ptr})}else{return makeClassHandle(toType.registeredClass.instancePrototype,{ptrType:toType,ptr:dp})}}function init_RegisteredPointer(){RegisteredPointer.prototype.getPointee=RegisteredPointer_getPointee;RegisteredPointer.prototype.destructor=RegisteredPointer_destructor;RegisteredPointer.prototype[\"argPackAdvance\"]=8;RegisteredPointer.prototype[\"readValueFromPointer\"]=simpleReadValueFromPointer;RegisteredPointer.prototype[\"deleteObject\"]=RegisteredPointer_deleteObject;RegisteredPointer.prototype[\"fromWireType\"]=RegisteredPointer_fromWireType}function RegisteredPointer(name,registeredClass,isReference,isConst,isSmartPointer,pointeeType,sharingPolicy,rawGetPointee,rawConstructor,rawShare,rawDestructor){this.name=name;this.registeredClass=registeredClass;this.isReference=isReference;this.isConst=isConst;this.isSmartPointer=isSmartPointer;this.pointeeType=pointeeType;this.sharingPolicy=sharingPolicy;this.rawGetPointee=rawGetPointee;this.rawConstructor=rawConstructor;this.rawShare=rawShare;this.rawDestructor=rawDestructor;if(!isSmartPointer&&registeredClass.baseClass===undefined){if(isConst){this[\"toWireType\"]=constNoSmartPtrRawPointerToWireType;this.destructorFunction=null}else{this[\"toWireType\"]=nonConstNoSmartPtrRawPointerToWireType;this.destructorFunction=null}}else{this[\"toWireType\"]=genericPointerToWireType}}function replacePublicSymbol(name,value,numArguments){if(!Module.hasOwnProperty(name)){throwInternalError(\"Replacing nonexistant public symbol\")}if(undefined!==Module[name].overloadTable&&undefined!==numArguments){Module[name].overloadTable[numArguments]=value}else{Module[name]=value;Module[name].argCount=numArguments}}function dynCallLegacy(sig,ptr,args){var f=Module[\"dynCall_\"+sig];return args&&args.length?f.apply(null,[ptr].concat(args)):f.call(null,ptr)}function dynCall(sig,ptr,args){if(sig.includes(\"j\")){return dynCallLegacy(sig,ptr,args)}return getWasmTableEntry(ptr).apply(null,args)}function getDynCaller(sig,ptr){var argCache=[];return function(){argCache.length=arguments.length;for(var i=0;i<arguments.length;i++){argCache[i]=arguments[i]}return dynCall(sig,ptr,argCache)}}function embind__requireFunction(signature,rawFunction){signature=readLatin1String(signature);function makeDynCaller(){if(signature.includes(\"j\")){return getDynCaller(signature,rawFunction)}return getWasmTableEntry(rawFunction)}var fp=makeDynCaller();if(typeof fp!==\"function\"){throwBindingError(\"unknown function pointer with signature \"+signature+\": \"+rawFunction)}return fp}var UnboundTypeError=undefined;function getTypeName(type){var ptr=___getTypeName(type);var rv=readLatin1String(ptr);_free(ptr);return rv}function throwUnboundTypeError(message,types){var unboundTypes=[];var seen={};function visit(type){if(seen[type]){return}if(registeredTypes[type]){return}if(typeDependencies[type]){typeDependencies[type].forEach(visit);return}unboundTypes.push(type);seen[type]=true}types.forEach(visit);throw new UnboundTypeError(message+\": \"+unboundTypes.map(getTypeName).join([\", \"]))}function __embind_register_class(rawType,rawPointerType,rawConstPointerType,baseClassRawType,getActualTypeSignature,getActualType,upcastSignature,upcast,downcastSignature,downcast,name,destructorSignature,rawDestructor){name=readLatin1String(name);getActualType=embind__requireFunction(getActualTypeSignature,getActualType);if(upcast){upcast=embind__requireFunction(upcastSignature,upcast)}if(downcast){downcast=embind__requireFunction(downcastSignature,downcast)}rawDestructor=embind__requireFunction(destructorSignature,rawDestructor);var legalFunctionName=makeLegalFunctionName(name);exposePublicSymbol(legalFunctionName,function(){throwUnboundTypeError(\"Cannot construct \"+name+\" due to unbound types\",[baseClassRawType])});whenDependentTypesAreResolved([rawType,rawPointerType,rawConstPointerType],baseClassRawType?[baseClassRawType]:[],function(base){base=base[0];var baseClass;var basePrototype;if(baseClassRawType){baseClass=base.registeredClass;basePrototype=baseClass.instancePrototype}else{basePrototype=ClassHandle.prototype}var constructor=createNamedFunction(legalFunctionName,function(){if(Object.getPrototypeOf(this)!==instancePrototype){throw new BindingError(\"Use 'new' to construct \"+name)}if(undefined===registeredClass.constructor_body){throw new BindingError(name+\" has no accessible constructor\")}var body=registeredClass.constructor_body[arguments.length];if(undefined===body){throw new BindingError(\"Tried to invoke ctor of \"+name+\" with invalid number of parameters (\"+arguments.length+\") - expected (\"+Object.keys(registeredClass.constructor_body).toString()+\") parameters instead!\")}return body.apply(this,arguments)});var instancePrototype=Object.create(basePrototype,{constructor:{value:constructor}});constructor.prototype=instancePrototype;var registeredClass=new RegisteredClass(name,constructor,instancePrototype,rawDestructor,baseClass,getActualType,upcast,downcast);var referenceConverter=new RegisteredPointer(name,registeredClass,true,false,false);var pointerConverter=new RegisteredPointer(name+\"*\",registeredClass,false,false,false);var constPointerConverter=new RegisteredPointer(name+\" const*\",registeredClass,false,true,false);registeredPointers[rawType]={pointerType:pointerConverter,constPointerType:constPointerConverter};replacePublicSymbol(legalFunctionName,constructor);return[referenceConverter,pointerConverter,constPointerConverter]})}function heap32VectorToArray(count,firstElement){var array=[];for(var i=0;i<count;i++){array.push(HEAP32[(firstElement>>2)+i])}return array}function runDestructors(destructors){while(destructors.length){var ptr=destructors.pop();var del=destructors.pop();del(ptr)}}function __embind_register_class_constructor(rawClassType,argCount,rawArgTypesAddr,invokerSignature,invoker,rawConstructor){assert(argCount>0);var rawArgTypes=heap32VectorToArray(argCount,rawArgTypesAddr);invoker=embind__requireFunction(invokerSignature,invoker);whenDependentTypesAreResolved([],[rawClassType],function(classType){classType=classType[0];var humanName=\"constructor \"+classType.name;if(undefined===classType.registeredClass.constructor_body){classType.registeredClass.constructor_body=[]}if(undefined!==classType.registeredClass.constructor_body[argCount-1]){throw new BindingError(\"Cannot register multiple constructors with identical number of parameters (\"+(argCount-1)+\") for class '\"+classType.name+\"'! Overload resolution is currently only performed using the parameter count, not actual type info!\")}classType.registeredClass.constructor_body[argCount-1]=(()=>{throwUnboundTypeError(\"Cannot construct \"+classType.name+\" due to unbound types\",rawArgTypes)});whenDependentTypesAreResolved([],rawArgTypes,function(argTypes){argTypes.splice(1,0,null);classType.registeredClass.constructor_body[argCount-1]=craftInvokerFunction(humanName,argTypes,null,invoker,rawConstructor);return[]});return[]})}function new_(constructor,argumentList){if(!(constructor instanceof Function)){throw new TypeError(\"new_ called with constructor type \"+typeof constructor+\" which is not a function\")}var dummy=createNamedFunction(constructor.name||\"unknownFunctionName\",function(){});dummy.prototype=constructor.prototype;var obj=new dummy;var r=constructor.apply(obj,argumentList);return r instanceof Object?r:obj}function craftInvokerFunction(humanName,argTypes,classType,cppInvokerFunc,cppTargetFunc){var argCount=argTypes.length;if(argCount<2){throwBindingError(\"argTypes array size mismatch! Must at least get return value and 'this' types!\")}var isClassMethodFunc=argTypes[1]!==null&&classType!==null;var needsDestructorStack=false;for(var i=1;i<argTypes.length;++i){if(argTypes[i]!==null&&argTypes[i].destructorFunction===undefined){needsDestructorStack=true;break}}var returns=argTypes[0].name!==\"void\";var argsList=\"\";var argsListWired=\"\";for(var i=0;i<argCount-2;++i){argsList+=(i!==0?\", \":\"\")+\"arg\"+i;argsListWired+=(i!==0?\", \":\"\")+\"arg\"+i+\"Wired\"}var invokerFnBody=\"return function \"+makeLegalFunctionName(humanName)+\"(\"+argsList+\") {\\n\"+\"if (arguments.length !== \"+(argCount-2)+\") {\\n\"+\"throwBindingError('function \"+humanName+\" called with ' + arguments.length + ' arguments, expected \"+(argCount-2)+\" args!');\\n\"+\"}\\n\";if(needsDestructorStack){invokerFnBody+=\"var destructors = [];\\n\"}var dtorStack=needsDestructorStack?\"destructors\":\"null\";var args1=[\"throwBindingError\",\"invoker\",\"fn\",\"runDestructors\",\"retType\",\"classParam\"];var args2=[throwBindingError,cppInvokerFunc,cppTargetFunc,runDestructors,argTypes[0],argTypes[1]];if(isClassMethodFunc){invokerFnBody+=\"var thisWired = classParam.toWireType(\"+dtorStack+\", this);\\n\"}for(var i=0;i<argCount-2;++i){invokerFnBody+=\"var arg\"+i+\"Wired = argType\"+i+\".toWireType(\"+dtorStack+\", arg\"+i+\"); // \"+argTypes[i+2].name+\"\\n\";args1.push(\"argType\"+i);args2.push(argTypes[i+2])}if(isClassMethodFunc){argsListWired=\"thisWired\"+(argsListWired.length>0?\", \":\"\")+argsListWired}invokerFnBody+=(returns?\"var rv = \":\"\")+\"invoker(fn\"+(argsListWired.length>0?\", \":\"\")+argsListWired+\");\\n\";if(needsDestructorStack){invokerFnBody+=\"runDestructors(destructors);\\n\"}else{for(var i=isClassMethodFunc?1:2;i<argTypes.length;++i){var paramName=i===1?\"thisWired\":\"arg\"+(i-2)+\"Wired\";if(argTypes[i].destructorFunction!==null){invokerFnBody+=paramName+\"_dtor(\"+paramName+\"); // \"+argTypes[i].name+\"\\n\";args1.push(paramName+\"_dtor\");args2.push(argTypes[i].destructorFunction)}}}if(returns){invokerFnBody+=\"var ret = retType.fromWireType(rv);\\n\"+\"return ret;\\n\"}else{}invokerFnBody+=\"}\\n\";args1.push(invokerFnBody);var invokerFunction=new_(Function,args1).apply(null,args2);return invokerFunction}function __embind_register_class_function(rawClassType,methodName,argCount,rawArgTypesAddr,invokerSignature,rawInvoker,context,isPureVirtual){var rawArgTypes=heap32VectorToArray(argCount,rawArgTypesAddr);methodName=readLatin1String(methodName);rawInvoker=embind__requireFunction(invokerSignature,rawInvoker);whenDependentTypesAreResolved([],[rawClassType],function(classType){classType=classType[0];var humanName=classType.name+\".\"+methodName;if(methodName.startsWith(\"@@\")){methodName=Symbol[methodName.substring(2)]}if(isPureVirtual){classType.registeredClass.pureVirtualFunctions.push(methodName)}function unboundTypesHandler(){throwUnboundTypeError(\"Cannot call \"+humanName+\" due to unbound types\",rawArgTypes)}var proto=classType.registeredClass.instancePrototype;var method=proto[methodName];if(undefined===method||undefined===method.overloadTable&&method.className!==classType.name&&method.argCount===argCount-2){unboundTypesHandler.argCount=argCount-2;unboundTypesHandler.className=classType.name;proto[methodName]=unboundTypesHandler}else{ensureOverloadTable(proto,methodName,humanName);proto[methodName].overloadTable[argCount-2]=unboundTypesHandler}whenDependentTypesAreResolved([],rawArgTypes,function(argTypes){var memberFunction=craftInvokerFunction(humanName,argTypes,classType,rawInvoker,context);if(undefined===proto[methodName].overloadTable){memberFunction.argCount=argCount-2;proto[methodName]=memberFunction}else{proto[methodName].overloadTable[argCount-2]=memberFunction}return[]});return[]})}function validateThis(this_,classType,humanName){if(!(this_ instanceof Object)){throwBindingError(humanName+' with invalid \"this\": '+this_)}if(!(this_ instanceof classType.registeredClass.constructor)){throwBindingError(humanName+' incompatible with \"this\" of type '+this_.constructor.name)}if(!this_.$$.ptr){throwBindingError(\"cannot call emscripten binding method \"+humanName+\" on deleted object\")}return upcastPointer(this_.$$.ptr,this_.$$.ptrType.registeredClass,classType.registeredClass)}function __embind_register_class_property(classType,fieldName,getterReturnType,getterSignature,getter,getterContext,setterArgumentType,setterSignature,setter,setterContext){fieldName=readLatin1String(fieldName);getter=embind__requireFunction(getterSignature,getter);whenDependentTypesAreResolved([],[classType],function(classType){classType=classType[0];var humanName=classType.name+\".\"+fieldName;var desc={get:function(){throwUnboundTypeError(\"Cannot access \"+humanName+\" due to unbound types\",[getterReturnType,setterArgumentType])},enumerable:true,configurable:true};if(setter){desc.set=(()=>{throwUnboundTypeError(\"Cannot access \"+humanName+\" due to unbound types\",[getterReturnType,setterArgumentType])})}else{desc.set=(v=>{throwBindingError(humanName+\" is a read-only property\")})}Object.defineProperty(classType.registeredClass.instancePrototype,fieldName,desc);whenDependentTypesAreResolved([],setter?[getterReturnType,setterArgumentType]:[getterReturnType],function(types){var getterReturnType=types[0];var desc={get:function(){var ptr=validateThis(this,classType,humanName+\" getter\");return getterReturnType[\"fromWireType\"](getter(getterContext,ptr))},enumerable:true};if(setter){setter=embind__requireFunction(setterSignature,setter);var setterArgumentType=types[1];desc.set=function(v){var ptr=validateThis(this,classType,humanName+\" setter\");var destructors=[];setter(setterContext,ptr,setterArgumentType[\"toWireType\"](destructors,v));runDestructors(destructors)}}Object.defineProperty(classType.registeredClass.instancePrototype,fieldName,desc);return[]});return[]})}var emval_free_list=[];var emval_handle_array=[{},{value:undefined},{value:null},{value:true},{value:false}];function __emval_decref(handle){if(handle>4&&0===--emval_handle_array[handle].refcount){emval_handle_array[handle]=undefined;emval_free_list.push(handle)}}function count_emval_handles(){var count=0;for(var i=5;i<emval_handle_array.length;++i){if(emval_handle_array[i]!==undefined){++count}}return count}function get_first_emval(){for(var i=5;i<emval_handle_array.length;++i){if(emval_handle_array[i]!==undefined){return emval_handle_array[i]}}return null}function init_emval(){Module[\"count_emval_handles\"]=count_emval_handles;Module[\"get_first_emval\"]=get_first_emval}var Emval={toValue:function(handle){if(!handle){throwBindingError(\"Cannot use deleted val. handle = \"+handle)}return emval_handle_array[handle].value},toHandle:function(value){switch(value){case undefined:{return 1}case null:{return 2}case true:{return 3}case false:{return 4}default:{var handle=emval_free_list.length?emval_free_list.pop():emval_handle_array.length;emval_handle_array[handle]={refcount:1,value:value};return handle}}}};function __embind_register_emval(rawType,name){name=readLatin1String(name);registerType(rawType,{name:name,\"fromWireType\":function(handle){var rv=Emval.toValue(handle);__emval_decref(handle);return rv},\"toWireType\":function(destructors,value){return Emval.toHandle(value)},\"argPackAdvance\":8,\"readValueFromPointer\":simpleReadValueFromPointer,destructorFunction:null})}function _embind_repr(v){if(v===null){return\"null\"}var t=typeof v;if(t===\"object\"||t===\"array\"||t===\"function\"){return v.toString()}else{return\"\"+v}}function floatReadValueFromPointer(name,shift){switch(shift){case 2:return function(pointer){return this[\"fromWireType\"](HEAPF32[pointer>>2])};case 3:return function(pointer){return this[\"fromWireType\"](HEAPF64[pointer>>3])};default:throw new TypeError(\"Unknown float type: \"+name)}}function __embind_register_float(rawType,name,size){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,\"fromWireType\":function(value){return value},\"toWireType\":function(destructors,value){return value},\"argPackAdvance\":8,\"readValueFromPointer\":floatReadValueFromPointer(name,shift),destructorFunction:null})}function integerReadValueFromPointer(name,shift,signed){switch(shift){case 0:return signed?function readS8FromPointer(pointer){return HEAP8[pointer]}:function readU8FromPointer(pointer){return HEAPU8[pointer]};case 1:return signed?function readS16FromPointer(pointer){return HEAP16[pointer>>1]}:function readU16FromPointer(pointer){return HEAPU16[pointer>>1]};case 2:return signed?function readS32FromPointer(pointer){return HEAP32[pointer>>2]}:function readU32FromPointer(pointer){return HEAPU32[pointer>>2]};default:throw new TypeError(\"Unknown integer type: \"+name)}}function __embind_register_integer(primitiveType,name,size,minRange,maxRange){name=readLatin1String(name);if(maxRange===-1){maxRange=4294967295}var shift=getShiftFromSize(size);var fromWireType=value=>value;if(minRange===0){var bitshift=32-8*size;fromWireType=(value=>value<<bitshift>>>bitshift)}var isUnsignedType=name.includes(\"unsigned\");var checkAssertions=(value,toTypeName)=>{};var toWireType;if(isUnsignedType){toWireType=function(destructors,value){checkAssertions(value,this.name);return value>>>0}}else{toWireType=function(destructors,value){checkAssertions(value,this.name);return value}}registerType(primitiveType,{name:name,\"fromWireType\":fromWireType,\"toWireType\":toWireType,\"argPackAdvance\":8,\"readValueFromPointer\":integerReadValueFromPointer(name,shift,minRange!==0),destructorFunction:null})}function __embind_register_memory_view(rawType,dataTypeIndex,name){var typeMapping=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];var TA=typeMapping[dataTypeIndex];function decodeMemoryView(handle){handle=handle>>2;var heap=HEAPU32;var size=heap[handle];var data=heap[handle+1];return new TA(buffer,data,size)}name=readLatin1String(name);registerType(rawType,{name:name,\"fromWireType\":decodeMemoryView,\"argPackAdvance\":8,\"readValueFromPointer\":decodeMemoryView},{ignoreDuplicateRegistrations:true})}function __embind_register_std_string(rawType,name){name=readLatin1String(name);var stdStringIsUTF8=name===\"std::string\";registerType(rawType,{name:name,\"fromWireType\":function(value){var length=HEAPU32[value>>2];var str;if(stdStringIsUTF8){var decodeStartPtr=value+4;for(var i=0;i<=length;++i){var currentBytePtr=value+4+i;if(i==length||HEAPU8[currentBytePtr]==0){var maxRead=currentBytePtr-decodeStartPtr;var stringSegment=UTF8ToString(decodeStartPtr,maxRead);if(str===undefined){str=stringSegment}else{str+=String.fromCharCode(0);str+=stringSegment}decodeStartPtr=currentBytePtr+1}}}else{var a=new Array(length);for(var i=0;i<length;++i){a[i]=String.fromCharCode(HEAPU8[value+4+i])}str=a.join(\"\")}_free(value);return str},\"toWireType\":function(destructors,value){if(value instanceof ArrayBuffer){value=new Uint8Array(value)}var getLength;var valueIsOfTypeString=typeof value===\"string\";if(!(valueIsOfTypeString||value instanceof Uint8Array||value instanceof Uint8ClampedArray||value instanceof Int8Array)){throwBindingError(\"Cannot pass non-string to std::string\")}if(stdStringIsUTF8&&valueIsOfTypeString){getLength=(()=>lengthBytesUTF8(value))}else{getLength=(()=>value.length)}var length=getLength();var ptr=_malloc(4+length+1);HEAPU32[ptr>>2]=length;if(stdStringIsUTF8&&valueIsOfTypeString){stringToUTF8(value,ptr+4,length+1)}else{if(valueIsOfTypeString){for(var i=0;i<length;++i){var charCode=value.charCodeAt(i);if(charCode>255){_free(ptr);throwBindingError(\"String has UTF-16 code units that do not fit in 8 bits\")}HEAPU8[ptr+4+i]=charCode}}else{for(var i=0;i<length;++i){HEAPU8[ptr+4+i]=value[i]}}}if(destructors!==null){destructors.push(_free,ptr)}return ptr},\"argPackAdvance\":8,\"readValueFromPointer\":simpleReadValueFromPointer,destructorFunction:function(ptr){_free(ptr)}})}function __embind_register_std_wstring(rawType,charSize,name){name=readLatin1String(name);var decodeString,encodeString,getHeap,lengthBytesUTF,shift;if(charSize===2){decodeString=UTF16ToString;encodeString=stringToUTF16;lengthBytesUTF=lengthBytesUTF16;getHeap=(()=>HEAPU16);shift=1}else if(charSize===4){decodeString=UTF32ToString;encodeString=stringToUTF32;lengthBytesUTF=lengthBytesUTF32;getHeap=(()=>HEAPU32);shift=2}registerType(rawType,{name:name,\"fromWireType\":function(value){var length=HEAPU32[value>>2];var HEAP=getHeap();var str;var decodeStartPtr=value+4;for(var i=0;i<=length;++i){var currentBytePtr=value+4+i*charSize;if(i==length||HEAP[currentBytePtr>>shift]==0){var maxReadBytes=currentBytePtr-decodeStartPtr;var stringSegment=decodeString(decodeStartPtr,maxReadBytes);if(str===undefined){str=stringSegment}else{str+=String.fromCharCode(0);str+=stringSegment}decodeStartPtr=currentBytePtr+charSize}}_free(value);return str},\"toWireType\":function(destructors,value){if(!(typeof value===\"string\")){throwBindingError(\"Cannot pass non-string to C++ string type \"+name)}var length=lengthBytesUTF(value);var ptr=_malloc(4+length+charSize);HEAPU32[ptr>>2]=length>>shift;encodeString(value,ptr+4,length+charSize);if(destructors!==null){destructors.push(_free,ptr)}return ptr},\"argPackAdvance\":8,\"readValueFromPointer\":simpleReadValueFromPointer,destructorFunction:function(ptr){_free(ptr)}})}function __embind_register_void(rawType,name){name=readLatin1String(name);registerType(rawType,{isVoid:true,name:name,\"argPackAdvance\":0,\"fromWireType\":function(){return undefined},\"toWireType\":function(destructors,o){return undefined}})}function _abort(){abort(\"\")}function _emscripten_memcpy_big(dest,src,num){HEAPU8.copyWithin(dest,src,src+num)}function abortOnCannotGrowMemory(requestedSize){abort(\"OOM\")}function _emscripten_resize_heap(requestedSize){var oldSize=HEAPU8.length;requestedSize=requestedSize>>>0;abortOnCannotGrowMemory(requestedSize)}embind_init_charCodes();BindingError=Module[\"BindingError\"]=extendError(Error,\"BindingError\");InternalError=Module[\"InternalError\"]=extendError(Error,\"InternalError\");init_ClassHandle();init_RegisteredPointer();init_embind();UnboundTypeError=Module[\"UnboundTypeError\"]=extendError(Error,\"UnboundTypeError\");init_emval();var ASSERTIONS=false;var asmLibraryArg={\"__cxa_allocate_exception\":___cxa_allocate_exception,\"__cxa_throw\":___cxa_throw,\"_embind_register_bigint\":__embind_register_bigint,\"_embind_register_bool\":__embind_register_bool,\"_embind_register_class\":__embind_register_class,\"_embind_register_class_constructor\":__embind_register_class_constructor,\"_embind_register_class_function\":__embind_register_class_function,\"_embind_register_class_property\":__embind_register_class_property,\"_embind_register_emval\":__embind_register_emval,\"_embind_register_float\":__embind_register_float,\"_embind_register_integer\":__embind_register_integer,\"_embind_register_memory_view\":__embind_register_memory_view,\"_embind_register_std_string\":__embind_register_std_string,\"_embind_register_std_wstring\":__embind_register_std_wstring,\"_embind_register_void\":__embind_register_void,\"abort\":_abort,\"emscripten_memcpy_big\":_emscripten_memcpy_big,\"emscripten_resize_heap\":_emscripten_resize_heap};var asm=createWasm();var ___wasm_call_ctors=Module[\"___wasm_call_ctors\"]=function(){return(___wasm_call_ctors=Module[\"___wasm_call_ctors\"]=Module[\"asm\"][\"__wasm_call_ctors\"]).apply(null,arguments)};var _malloc=Module[\"_malloc\"]=function(){return(_malloc=Module[\"_malloc\"]=Module[\"asm\"][\"malloc\"]).apply(null,arguments)};var _free=Module[\"_free\"]=function(){return(_free=Module[\"_free\"]=Module[\"asm\"][\"free\"]).apply(null,arguments)};var ___getTypeName=Module[\"___getTypeName\"]=function(){return(___getTypeName=Module[\"___getTypeName\"]=Module[\"asm\"][\"__getTypeName\"]).apply(null,arguments)};var ___embind_register_native_and_builtin_types=Module[\"___embind_register_native_and_builtin_types\"]=function(){return(___embind_register_native_and_builtin_types=Module[\"___embind_register_native_and_builtin_types\"]=Module[\"asm\"][\"__embind_register_native_and_builtin_types\"]).apply(null,arguments)};var ___errno_location=Module[\"___errno_location\"]=function(){return(___errno_location=Module[\"___errno_location\"]=Module[\"asm\"][\"__errno_location\"]).apply(null,arguments)};var stackSave=Module[\"stackSave\"]=function(){return(stackSave=Module[\"stackSave\"]=Module[\"asm\"][\"stackSave\"]).apply(null,arguments)};var stackRestore=Module[\"stackRestore\"]=function(){return(stackRestore=Module[\"stackRestore\"]=Module[\"asm\"][\"stackRestore\"]).apply(null,arguments)};var stackAlloc=Module[\"stackAlloc\"]=function(){return(stackAlloc=Module[\"stackAlloc\"]=Module[\"asm\"][\"stackAlloc\"]).apply(null,arguments)};var calledRun;function ExitStatus(status){this.name=\"ExitStatus\";this.message=\"Program terminated with exit(\"+status+\")\";this.status=status}dependenciesFulfilled=function runCaller(){if(!calledRun)run();if(!calledRun)dependenciesFulfilled=runCaller};function run(args){args=args||arguments_;if(runDependencies>0){return}preRun();if(runDependencies>0){return}function doRun(){if(calledRun)return;calledRun=true;Module[\"calledRun\"]=true;if(ABORT)return;initRuntime();if(Module[\"onRuntimeInitialized\"])Module[\"onRuntimeInitialized\"]();postRun()}if(Module[\"setStatus\"]){Module[\"setStatus\"](\"Running...\");setTimeout(function(){setTimeout(function(){Module[\"setStatus\"](\"\")},1);doRun()},1)}else{doRun()}}Module[\"run\"]=run;function procExit(code){EXITSTATUS=code;if(!keepRuntimeAlive()){if(Module[\"onExit\"])Module[\"onExit\"](code);ABORT=true}quit_(code,new ExitStatus(code))}if(Module[\"preInit\"]){if(typeof Module[\"preInit\"]==\"function\")Module[\"preInit\"]=[Module[\"preInit\"]];while(Module[\"preInit\"].length>0){Module[\"preInit\"].pop()()}}run();\nexport {Module};\n"],"names":["ArtifactLevelSlider","levelLow","levelHigh","setLow","setHigh","setBoth","dark","disabled","showLevelText","useState","sliderLow","setsliderLow","sliderHigh","setsliderHigh","setSlider","useCallback","e","value","TypeError","l","h","useEffect","sx","width","display","alignItems","bgcolor","onChange","val","clamp","px","pl","undefined","inputProps","textAlign","startAdornment","flexGrow","mx","getAriaLabel","onChangeCommitted","valueLabelDisplay","min","max","step","marks","ConditionalSelector","conditional","Object","keys","states","length","SimpleConditionalSelector","ExclusiveConditionalSelector","MultipleConditionalSelector","useContext","CharacterContext","character","characterDispatch","data","DataContext","setConditional","v","conditionalValues","deepClone","layeredAssignment","path","deletePropPath","conditionalValue","get","entries","stateKey","badge","getStateBadge","name","condName","getCondName","Button","fullWidth","size","borderRadius","color","onClick","startIcon","CheckBox","CheckBoxOutlineBlank","state","SqBadge","DropdownButton","title","MenuItem","selected","Divider","map","st","ButtonGroup","orientation","disableElevation","isSelected","isElement","disp","stateName","badgeColor","badgeText","props","children","ml","key","key18","ns","values","Translate","useBadge","ConditionalDisplay","fields","hideHeader","hideDesc","condVal","flatMap","CardDark","evalIfFunc","HeaderDisplay","header","CardContent","p","pb","DocumentDisplay","sections","teamBuffOnly","sectionDisplays","s","i","canShow","teamBuff","SectionDisplay","section","filter","Box","flexDirection","gap","FieldsSectionDisplay","TextSectionDisplay","hideDivider","text","icon","action","description","displayTitle","InfoTooltip","Typography","CardHeader","avatar","titleTypographyProps","variant","DisabledButton","styled","theme","backgroundColor","palette","primary","secondary","TextButton","charCurves","objectMap","_charCurves","commonBasic","objectKeyMap","input","infusionNode","stringPrio","inferredHitEle","lookup","sword","claymore","polearm","catalyst","getTalentType","move","customDmgNode","base","additional","mergeData","hit","constant","ele","customShieldNode","shieldNode","prod","sum","one","customHealNode","healInc","healNode","dmgNode","lvlMultiplier","talentType","subscript","percent","flat","shieldNodeTalent","baseMultiplier","talentIndex","shieldElement","element","infoMut","healNodeTalent","dataObjForCharacterSheet","region","gen","curve","lvlCurve","basic","foundSpecial","charKey","weaponType","weaponTypeKey","premod","charEle","tally","reaction","reactions","physical_dmg_","stat","list","curves","push","ascensions","some","x","NaN","result","prefix","asConst","endsWith","info","slice","Error","special","allMainStatKeys","inferInfoMut","crystallizeMulti1","crystallizeElemas","frac","crystallizeHit","transMulti1","transMulti2","trans","transformativeReactions","multi","variants","swirl","anemo","electroSwirl","electro","pyroSwirl","pyro","cryoSwirl","cryo","hydroSwirl","hydro","shattered","geo","crystallize","fromEntries","absorbableEle","overloaded","electrocharged","superconduct","FlexButtonGroup","StatInput","placeholder","defaultValue","onValueChange","onReset","restProps","whiteSpace","CustomNumberInput","flexBasis","float","endAdornment","Replay","expand","other","IconButton","transform","marginLeft","transition","transitions","create","duration","shortest","EnemyExpandCard","expanded","setexpanded","toggle","eLvlNode","eDefRed","eDefIgn","CardLight","Grid","container","item","spacing","Chip","label","KeyMap","allElementsWithPhy","EnemyResText","valueString","unit","ExpandMore","Collapse","in","timeout","unmountOnExit","pt","EnemyEditor","node","content","isFinite","uncoloredEleIcons","bsProps","xs","md","enemyOverride","eLvl","enemyLevel","enemyDefIgn_","enemyDefRed_","height","component","href","target","rel","t","contentLight","main","type","statKey","eleKey","elementImmunity","Number","MAX_VALUE","Infinity","faCheckSquare","faSquare","className","infusionVals","InfusionAuraDropdown","characterSheet","infusionAura","isMelee","sqBadgeStyle","fontSize","reactionModeText","pyro_vaporize","pyro_melt","hydro_vaporize","cryo_melt","ReactionToggle","useTranslation","reactionMode","charEleKey","infusion","includes","SolidToggleButtonGroup","exclusive","baseColor","_","ToggleButton","allReactionModes","rm","split","HitModeToggle","hitMode","allHitModes","hm","errHeader","talentMap","normal","charged","plunging","skill","burst","passive","passive1","passive2","passive3","range","getDisplayHeader","sectionKey","namespace","ArtifactSheet","sheet","defIconSrc","WeaponSheet","asc","getImg","cKey","cEle","CharacterSheet","talentKey","talent","getTalentOfKey","actionText","img","getDisplaySections","getDisplay","nodes","every","isEmpty","weapon","startsWith","artifact","rest","k","SetEffectDisplay","setKey","setNumKey","conditionalsOnly","usePromise","document","setEffectDocument","OptimizationTargetContext","createContext","StatDisplayComponent","mr","mb","Masonry","columns","sm","xl","Nodes","Section","displayNs","optimizationTarget","oldData","displayNsReads","useMemo","n","nodeKey","customRead","ImgIcon","m","src","FieldDisplay","oldValue","ListItem","emphasize","JSON","stringify","useBuildSetting","characterKey","database","DatabaseContext","buildSettings","buildSetting","setBuildSetting","follow","buildSettingDispatch","set","ArtifactCardNano","artifactId","pSlotKey","slotKey","mainStatAssumptionLevel","showLocation","BGComponent","art","useArtifact","actionWrapperFunc","CardActionArea","useTheme","justifyContent","Assets","opacity","rarity","level","mainStatKey","substats","location","mainStatLevel","Math","mainStatUnit","levelVariant","floor","alpha","ConditionalWrapper","condition","wrapper","position","ArtifactSetSlotTooltip","slotIcons","maxHeight","maxWidth","pointerEvents","LocationIcon","overflow","bottom","zIndex","BootstrapTooltip","placement","disableInteractive","StatIcon","cacheValueString","Artifact","SubstatDisplay","numRolls","rolls","rollColor","alignContent","thumbImgSide","marginTop","BusinessCenter","WeaponCardNano","weaponId","useWeapon","weaponSheet","UIData","computeUIData","dataObjForWeapon","Skeleton","refinement","WeaponNameTooltip","ascension","hasRefinement","WeaponStat","BuildDisplayItem","index","compareBuild","extraButtons","equippedArtifacts","dataContext","artifactSheets","newOld","setNewOld","close","equipBuild","window","confirm","newBuild","allSlotKeys","id","chars","equipArtifacts","weapons","statProviderContext","dataContext_","artNanos","oldId","newId","currentlyEquipped","setToSlots","Suspense","fallback","CompareArtifactModal","onClose","flexWrap","sort","slotarr1","slotarr","artifactSlotIcon","lg","onEquip","arts","ModalWrapper","open","containerProps","minWidth","ArtifactCard","canExclude","canEquip","ChevronRight","CompareBuildButton","artId","useBoolState","show","onShow","onHide","build","newArt","artmap","slot","teamData","useTeamData","dataProviderValue","Close","Tooltip","arrow","Difference","numToShowMap","ArtifactFilterDisplay","lazy","ArtifactSwapModal","onChangeId","clickHandler","filterOptionReducer","slotKeys","useReducer","initialFilterOption","filterOption","filterOptionDispatch","useForceUpdate","dbDirty","forceUpdate","followAny","brPt","useMediaQueryUp","filterConfigs","artifactFilterConfigs","artIdList","filterFunc","filterFunction","py","CloseButton","disableSlotFilter","mt","rarityHandler","handleMultiSelect","allRarities","WeaponSwapModal","weaponSheets","weaponFilterConfigs","sortConfigs","weaponSortConfigs","setRarity","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","weaponIdList","sortFunction","star","stars","TextField","autoFocus","InputProps","WeaponCard","WeaponEditor","equippedWeapon","setweaponId","showWeapon","hideWeapon","grxl","useMediaQuery","breakpoints","up","weaponDoc","useDBState","initCharMeta","rvFilter","deferredRvFilter","deferredRvSet","Set","footer","LargeWeaponSwapButton","ArtifactSectionCard","onEdit","WeaponSwapButton","effFilter","ArtifactSwapButton","editor","ArtSwapCard","onOpen","minHeight","SwapHoriz","hasEquipped","unequipArts","forEach","aid","setEffects","setCharMeta","setRVFilter","deferredrvFilter","reduce","a","artid","currentEfficiency","maxEfficiency","allSubstatKeys","currentEfficiency_","maxEfficiency_","rvField","PercentBadge","valid","rvmField","borderBottomRightRadius","borderBottomLeftRadius","Settings","SubstatToggle","selectedKeys","field","setNumKeyArr","Worker_fn","Worker","makeid","disallowed","characters","charactersLength","charAt","random","readKey","operation","operands","accu","isShallow","f","deleteKey","flower","plume","sands","goblet","circlet","collapseAffine","allKeys","addedRegisters","distributeProd","branch","bval","ge","lt","cmp","foldProd","source","console","log","ni","newID","coeff","sumKeys","newNodes","mapFormulas","fMops","toFold","orig","todistrib","mapped","pop","fAops","goodboyes","nofold","tofold","tot","instKeys","resolveStack","shift","has","getV","stats","add","unusedKeys","forEachNodes","delete","elimLinDepStats","statsMin","statsMax","sets","j","slotUpperLower","smin","smax","sk","statsUpperLower","lower","upper","fixedStats","f2","foldSum","branchVal","out","allOperations","reduceFormula","allStats","slotArts","rows","cols","mat","dyn","record","Array","fill","selectedPivots","c","pivot","r","abs","ri","depOn","w","replaceWith","thresholdToConstBranchForm","br2","bv2","ge2","lt2","left","right","countSlotUsage","b","allArtifactSets","con","sumM","monomials","prodM","cartesian","monos","ret","nxt","terms","constantM","readM","tag","foldLikeTerms","mono","mon","termsA","termsB","ai","splice","expandPoly","inheritTags","varMap","tagMap","varTags","hsh","hashNode","z","cmpNode","next","newTag","stat2tag","sop","toSOP","slotsLeft","sCount","slotUsage","filterProductPossible","pivotInplace","A","Aij","findPiv1","minloc","findPiv2","minMax","precompute","compute","mapping","buffer","fillBuffer","minval","toLinearUpperBound","toPureRead","mon1","op","flippedResOp","flipOps","resf","d","intercept","slope","handleResArg","rop","cop","thresh","minVal","maxVal","em","denom","minEM","maxEM","loc","sqrt","below","nodesToMap","t2","nt","lins","err","bounds","nVar","boundScale","scaleProd","soln","cons","coords","objective","Ab","tableau","Ai","cj","ijTrack","ij","targ","side","ncol","backtrack","solveLP","wi","lub","lin","constVal","pv","thresholdExclusions","excl","exc","pruneAll","minimum","numTop","exclusion","forced","should","deps","pruneNodeRange","reaffine","pruneOrder","pruneArtRange","count","newArts","forceRename","affineNodes","topLevelAffine","visit","isAffine","_op","dynKeys","nonConst","assertUnreachable","current","nextDynKey","affine","affineMap","Map","reaffineArt","constantFold","offsets","baseValue","progress","noRainbow","rainbow","noSwitchIn","noSwitchOut","newList","greaterEqual","greater","baseRange","wrap","artRanges","computeArtRange","otherArtRanges","addArtRange","read","newRange","computeNodeRange","nodeRange","operandRanges","threshold","pass","fail","newOperands","op1","op2","ranges","reads","_f","computeMinMax","minMaxes","mergeBuilds","builds","maxNum","mergePlot","plots","scale","round","plot","kind","ArtifactSetConfig","artSetExclusion","setOpen","artSetKeyList","reverse","artSlotCount","allowRainbow2","allowRainbow4","allow2","allow4","exclude2","exclude4","artifactCondCount","fakeDataContextObj","currentContext","artSet","resetArtConds","tconditional","setAllExclusion","setnum","exclude","artSetExclusion_","faChartLine","faBan","Trans","i18nKey","AllSetAllowExcludeCard","setNum","numAllow","numExclude","gutterBottom","num","endIcon","ArtifactSetCard","slotCount","large","setExclusionSet","slots","set4CondNums","doc","paddingTop","parseInt","levels","AssumeFullLevelToggle","setmainStatAssumptionLevel","lvl","BonusStatsCard","bonusStats","bonusStatsKeys","Monospace","fontFamily","BorderLinearProgress","LinearProgress","BuildAlert","status","tested","skipped","failed","total","startTime","finishTime","characterName","hasTotal","generatingBuilds","unskipped","testedString","toLocaleString","unskippedString","skippedText","durationString","timeStringMs","performance","now","subtitle","Alert","severity","toFixed","ChartCard","chartData","plotBase","setPlotBase","showDownload","setshowDownload","showMin","setshowMin","statKeys","displayData","downloadData","increasingX","y","minimumData","point","last","allData","sKey","Info","Download","DataDisplay","Chart","plotNode","valueNode","TextArea","resize","readOnly","selectionStart","selectionEnd","plotBaseUnit","valueUnit","ResponsiveContainer","ComposedChart","CartesianGrid","strokeDasharray","XAxis","dataKey","domain","tick","tickFormatter","YAxis","allowDecimals","ZAxis","Legend","Scatter","line","lineType","isAnimationActive","Line","stroke","connectNulls","strokeWidth","artifactsSlotsToSelectMainStats","MainStatSelectionCard","mainStatKeys","numSel","cursor","OptimizationTargetSelector","setTarget","setTargetHandler","TargetDisplayText","SelectorSection","MenuList","TargetSelectorMenuItem","NoTarget","displayHeader","objPathValue","style","textOverflow","defThreads","navigator","hardwareConcurrency","initialTabOptimizeDBState","equipmentPriority","threads","useOptimizeDBState","UseEquipped","useEquippedArts","tempEquipmentPriority","setOptimizeDBState","ck","setPrio","setPrioRank","fromIndex","toIndex","arr","removePrio","addPrio","resetPrio","numAbove","indexOf","numUseEquippedChar","numUnlisted","SelectItem","rank","maxRank","setRank","onRemove","NewItem","onAdd","flexShrink","useCharacter","useCharSelectionCallback","KeyboardDoubleArrowUp","KeyboardArrowUp","KeyboardArrowDown","KeyboardDoubleArrowDown","CharacterCardPico","WeaponCardPico","aId","ArtifactCardPico","artifactObj","char","CharacterSelectionModal","onSelect","Add","UseExcluded","artsDirty","useExcludedArts","numExcludedArt","dynamic","setReadNodeKeys","dynamicData","compactArtifacts","allowPartial","mainStatVal","substat","accurateValue","reduceSubProblem","subp","constraints","depth","filters","mins","maxw","minw","unionFilterUpperLower","tagNodePairs","reducedNodes","tagsToKill","newTerms","reducePolynomial","toNumNode","active","newOptTarget","newConstraints","newMins","newArtExcl","feasibleKeys","feasible4sets","feasible2sets","allowedCnts","cnt","reducedExcl","fi","wixs","ws","baseC","li","ixs0","w0","accum","ix","baseBuffer","ixsi","applyLinearForm","newFilters","filterVec","filterIxs","slotVals","filterArtsVec2","minww","maxww","slotUpperLowerVecW","cache","toArtifactBySlotVec","allKeysList","problemSetup","optimizationTargetNode","artSetExclFull","objectKeyValueMap","constraintsEP","opttargetEP","slotUL","slotUpperLowerVec","statsUpperLowerVec","minMaxEst","ixs","ww","baseVal","wtot","minMaxWeightVec","initialProblem","initialReducedProblem","StatFilterCard","statFilters","setStatFilters","StatEditorList","TabBuild","compareData","initGlobalSettings","tcMode","buildStatus","setBuildStatus","setchartData","setArtsDirty","maxWorkers","setMaxWorkers","useCharacterReducer","onClickTeammate","noArtifact","buildDate","maxBuildsToShow","buildsArts","numBuilds","currentPageIndex","setCurrentPageIndex","numPages","ceil","maxArtsToShowPerPage","setPageIdx","cancelToken","useRef","generateBuilds","fetchContinueWork","fetchWork","requestShareWork","sender","command","subproblem","workQueue","numBuild","_count","minFilterCount","buildValues","minCount","maxIter","maxSplitIters","cantTakeList","filteredArts","mainStats","getTeamData","workerData","uiDataForTeam","assign","targetNode","valueFilter","cancelled","Promise","optimize","plotBaseNode","artsVec","masterInfo","ready","idleWorkers","busyWorkerIDs","workers","finalizedList","worker","setup","maxBuilds","postMessage","finalize","finalized","onmessage","subproblems","terminate","splitCommand","counts","pruned","prepruned","toLoop","work","then","buildTimer","setInterval","any","all","results","clearInterval","plotData","artifactIds","Date","Link","RouterLink","to","CharacterCard","faCalculator","maxBuildsToShowList","PageBrowser","pageIdx","setPageIdex","Provider","BuildList","DataContextWrapper","join","providerValue","Pagination","page","TabOverview","team","navigate","useNavigate","constellation","tlvl","auto","tBoost","favorite","cardImg","pr","Favorite","FavoriteBorder","colored","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","lineHeight","constellationName","MainStatsCards","mainSubKeys","mainReadNodes","mainEditKeys","otherStatReadNodes","otherStatKeys","miscStatReadNodes","amplifyingReactions","miscStatkeys","statBreakpoint","StatDisplayContent","extra","columnSpacing","rowSpacing","rn","specialNode","StatDisplayCard","editContent","statName","edit","setedit","faSave","faEdit","talentSpacing","CharacterTalentPane","grlg","constellationCards","SkillDisplayCard","onClickTitle","ReactionDisplay","tText","enabled","talentLimits","actionWrapeprFunc","setTalentLevel","newTalentLevelKey","levelBoost","talentSheet","headerAction","TabTeambuffs","TeamBuffDisplay","ResonanceDisplay","TeammateDisplay","teamBuffs","getTeamBuff","enemy","resonanceSheets","res","desc","activeCharacterDispatch","activeCharacterKey","onClickHandler","dataBundle","teammateCharacterContext","teamMateDataContext","CharacterAutocomplete","disable","labelText","defaultText","defaultIcon","PersonAdd","showDefault","onClickHeader","artifactChildren","CharArtifactCondDisplay","weaponChildren","CharWeaponCondDisplay","characterChildren","CharTalentCondDisplay","isTeammateCard","sn","getTalent","sheets","sts","zero_deriv","funct","binding","diff","ddx","ops","da","db","numerator","arg1","arg2","quadrinomials","quadrinomial","nextRow","prev","gaussPDF","mu","sig2","exp","PI","sig_arr","sigr","sigma","ss","N","ssum","trunc","crawlUpgrades","fn","i1","i2","i3","i4","allUpgradeValues","statsBase","rollsLeft","subs","skippableDerivs","fourthsubOpts","evalFn","vals","sub","upVals","p_upVals","isNaN","p_val","subprob","stats2","p_upVals2","gaussianPE","mean","variance","upAvg","sign","erf","y2","phi","toStats","evalArtifact","slow","calc4th","curBuild","newStats","msOption","mainStat","subsToConsider","nxtsub","iq","thresholds","objectiveEval","grads","ks","gmmNd","fastUB","p2","subProb","ptot","prob","upAvgtot","distrtot","dtot","distr","gmm","cp","evalMode","subKey","obj","p_min","upAvgUB","apxDist","ksum","appx","lpe","stat2","o","cov","o1","o2","cv","mvn","Module","xi","pushX","mui","pushMu","pushCov","Eup","mvnPE_good","p_ret","upAvg_ret","querySetup","formulas","toEval","fo","evalOpt","dmg0","structuredEval","si","toQueryArtifact","fixedLevel","buildData","cmpQ","meanA","fWeight","hp","atk","def","hp_","atk_","def_","eleMas","enerRech_","critRate_","critDMG_","fWeightTot","excluded","nbins","UpgradeOptChartCard","upgradeOpt","objMin","objMax","calcExacts","setCalcExacts","bla","constrained","artifacts","gaussConstrained","thr0","perc","miin","maax","ymax","dataEst","steps","linspace","est","estCons","deltas","deltasConstrained","parseFloat","xpercent","trueData","setTrueData","trueP","setTrueP","trueE","setTrueE","exactData","true_p","true_e","bins","binsConstrained","binstep","whichBin","dataExact","dens","exact","exactCons","reportP","reportD","concat","CustomTooltip","payload","aspect","margin","top","Label","offset","angle","verticalAlign","x1","y1","x2","stopColor","stopOpacity","Area","dot","legendType","tooltipType","activeDot","ReferenceLine","ReferenceDot","shape","radius","direction","TabUpopt","artifactUpgradeOpts","setArtifactUpgradeOpts","show20","setShow20","check4th","setCheck4th","useMainStatFilter","setUseMainStatFilter","upgradeOptExpandSink","start","expandTo","query","queryArts","qaLookup","fixedList","end","arti","pageIdex","setpageIdex","invScrollRef","artifactsToShow","toShow","minObj0","maxObj0","thr","setPage","scrollIntoView","behavior","zz","equippedArts","curEquip","artUpOpt","upOpt","ShowingArt","numShowing","CharacterDisplay","useParams","allCharacterKeys","my","CharacterDisplayCard","newteamData","charUIData","useMatch","params","tab","useTitle","dataContextValue","characterContextValue","CharSelectDropdown","Card","warning","TabNav","FormulaCalcCard","CharacterPanel","Tabs","allowScrollButtonsMobile","Tab","Person","FactCheck","Checkroom","Groups","Calculate","showModal","setshowModal","setCharacter","setLevel","ascensionMaxLevel","ascenML","setAscension","lowerAscension","elementKey","ThumbSide","contentDark","sgt","talents","ambiguousLevel","milestoneLevels","lv","as","lvlstr","CalculationDisplay","FormulaCalc","Accordion","AccordionSummary","expandIcon","AccordionDetails","subform","onDelete","cs","wrapperFunc","falseWrapperFunc","equipOnChar","lock","falseWrapper","noWrap","displayVal","disableClearable","faTrashAlt","initial","bool","setBool","onTrue","onFalse","SECOND_MS","MINUTE_MS","HOUR_MS","DAY_MS","msToUnits","ms","milliseconds","seconds","minutes","hours","timeString","timeText","strPadLeft","weaponSortKeys","getValue","wp","tieBreaker","i18n","toLowerCase","read_","readAsync","readBinary","fs","nodePath","requireNodeFS","objAssign","moduleOverrides","arguments_","ENVIRONMENT_IS_WEB","ENVIRONMENT_IS_WORKER","importScripts","ENVIRONMENT_IS_NODE","process","versions","scriptDirectory","require","__dirname","filename","binary","readFileSync","Uint8Array","onload","onerror","readFile","replace","module","ex","ExitStatus","reason","toThrow","keepRuntimeAlive","self","currentScript","substr","lastIndexOf","url","xhr","XMLHttpRequest","send","responseText","responseType","response","bind","warn","wasmBinary","wasmMemory","noExitRuntime","WebAssembly","abort","ABORT","UTF8Decoder","TextDecoder","UTF8ToString","ptr","maxBytesToRead","heap","idx","endIdx","endPtr","subarray","decode","str","u0","u1","u2","String","fromCharCode","ch","UTF8ArrayToString","HEAPU8","stringToUTF8","outPtr","maxBytesToWrite","outIdx","startIdx","u","charCodeAt","stringToUTF8Array","HEAP8","HEAP16","HEAPU16","HEAP32","HEAPU32","HEAPF32","HEAPF64","UTF16Decoder","UTF16ToString","maxIdx","codeUnit","stringToUTF16","startPtr","numCharsToWrite","lengthBytesUTF16","UTF32ToString","utf32","stringToUTF32","lengthBytesUTF32","len","wasmTable","__ATPRERUN__","__ATINIT__","__ATPOSTRUN__","runtimeKeepaliveCounter","runDependencies","runDependencyWatcher","dependenciesFulfilled","what","RuntimeError","wasmBinaryFile","isDataURI","isFileURI","getBinary","file","callRuntimeCallbacks","callbacks","callback","func","arg","getWasmTableEntry","wasmTableMirror","funcPtr","ExceptionInfo","excPtr","this","set_type","get_type","set_destructor","destructor","get_destructor","set_refcount","refcount","set_caught","caught","get_caught","set_rethrown","rethrown","get_rethrown","init","add_ref","release_ref","getShiftFromSize","embind_charCodes","readLatin1String","awaitingDependencies","registeredTypes","typeDependencies","makeLegalFunctionName","createNamedFunction","body","Function","extendError","baseErrorType","errorName","errorClass","message","stack","toString","prototype","constructor","BindingError","throwBindingError","InternalError","throwInternalError","whenDependentTypesAreResolved","myTypes","dependentTypes","getTypeConverters","onComplete","typeConverters","myTypeConverters","registerType","unregisteredTypes","registered","dt","hasOwnProperty","rawType","registeredInstance","options","ignoreDuplicateRegistrations","cb","ClassHandle_isAliasOf","ClassHandle","leftClass","$$","ptrType","registeredClass","rightClass","baseClass","upcast","throwInstanceAlreadyDeleted","finalizationGroup","detachFinalizer","handle","releaseClassHandle","smartPtr","smartPtrType","rawDestructor","runDestructor","attachFinalizer","FinalizationGroup","iter","done","register","unregister","ClassHandle_clone","preservePointerOnDelete","clone","getPrototypeOf","deleteScheduled","ClassHandle_delete","ClassHandle_isDeleted","delayFunction","deletionQueue","flushPendingDeletes","ClassHandle_deleteLater","registeredPointers","ensureOverloadTable","proto","methodName","humanName","overloadTable","prevFunc","arguments","apply","argCount","RegisteredClass","instancePrototype","getActualType","downcast","pureVirtualFunctions","upcastPointer","ptrClass","desiredClass","constNoSmartPtrRawPointerToWireType","destructors","isReference","_embind_repr","handleClass","genericPointerToWireType","isSmartPointer","rawConstructor","isConst","sharingPolicy","clonedHandle","rawShare","Emval","toHandle","nonConstNoSmartPtrRawPointerToWireType","simpleReadValueFromPointer","pointer","RegisteredPointer_getPointee","rawGetPointee","RegisteredPointer_destructor","RegisteredPointer_deleteObject","downcastPointer","rv","getInheritedInstanceCount","registeredInstances","getLiveInheritedInstances","setDelayFunction","getInheritedInstance","class_","getBasestPointer","makeClassHandle","RegisteredPointer_fromWireType","rawPointer","getPointee","makeDefaultHandle","pointeeType","toType","actualType","registeredPointerRecord","call","constPointerType","pointerType","dp","RegisteredPointer","destructorFunction","dynCall","sig","args","dynCallLegacy","embind__requireFunction","signature","rawFunction","fp","argCache","getDynCaller","UnboundTypeError","getTypeName","___getTypeName","_free","throwUnboundTypeError","types","unboundTypes","seen","heap32VectorToArray","firstElement","array","runDestructors","del","craftInvokerFunction","argTypes","classType","cppInvokerFunc","cppTargetFunc","isClassMethodFunc","needsDestructorStack","returns","argsList","argsListWired","invokerFnBody","dtorStack","args1","args2","paramName","argumentList","dummy","new_","validateThis","this_","emval_free_list","emval_handle_array","count_emval_handles","get_first_emval","toValue","floatReadValueFromPointer","integerReadValueFromPointer","signed","codes","embind_init_charCodes","calledRun","asmLibraryArg","_malloc","primitiveType","minRange","maxRange","trueValue","falseValue","wt","rawPointerType","rawConstPointerType","baseClassRawType","getActualTypeSignature","upcastSignature","downcastSignature","destructorSignature","legalFunctionName","numArguments","exposePublicSymbol","basePrototype","constructor_body","referenceConverter","pointerConverter","constPointerConverter","replacePublicSymbol","rawClassType","rawArgTypesAddr","invokerSignature","invoker","rawArgTypes","rawInvoker","context","isPureVirtual","unboundTypesHandler","Symbol","substring","method","memberFunction","fieldName","getterReturnType","getterSignature","getter","getterContext","setterArgumentType","setterSignature","setter","setterContext","enumerable","configurable","defineProperty","__emval_decref","fromWireType","bitshift","isUnsignedType","dataTypeIndex","TA","Int8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","decodeMemoryView","stdStringIsUTF8","decodeStartPtr","currentBytePtr","stringSegment","getLength","ArrayBuffer","valueIsOfTypeString","Uint8ClampedArray","lengthBytesUTF8","charCode","charSize","decodeString","encodeString","getHeap","lengthBytesUTF","HEAP","isVoid","dest","copyWithin","requestedSize","receiveInstance","instance","buf","exports","unshift","removeRunDependency","receiveInstantiationResult","instantiateArrayBuffer","receiver","fetch","credentials","catch","resolve","reject","getBinaryPromise","instantiate","instantiateStreaming","createWasm","run","doRun","postRun","preRun","setTimeout","runCaller"],"sourceRoot":""}