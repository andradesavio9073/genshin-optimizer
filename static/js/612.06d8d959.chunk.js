"use strict";(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[612],{99612:function(e,t,n){n.r(t),n.d(t,{default:function(){return at}});var r,a,i,o,s=n(74165),c=n(4942),u=n(15861),l=n(93433),d=n(29439),h=n(53174),p=n(54483),f=n(68870),v=n(94070),x=n(23060),m=n(39504),g=n(20890),Z=n(94721),j=n(61889),y=n(2199),b=n(24518),w=n(57246),k=n(47047),C=n(72791),S=n(43504),M=n(3992),A=n(71310),D=n(1413),_=n(30168),E=n(45987),K=n(63204),P=n(49670),O=n(14361),T=n(23786),I=n(57064),V=n(52791),W=n(22020),q=n(947),F=n(56928),L=n(42320),U=n(50921),B=n(46956),z=n(33890),G=n(2380),N=n(80184),R=["value","onChange","unSelectText","unSelectIcon","inventory","noUnselect","filter"];function H(e){var t,n=e.value,s=e.onChange,c=e.unSelectText,u=e.unSelectIcon,l=e.inventory,d=void 0!==l&&l,h=e.noUnselect,p=void 0!==h&&h,f=e.filter,v=void 0===f?function(){return!0}:f,x=(0,E.Z)(e,R),m=(0,W.$)("ui").t,j=(0,C.useContext)(F.t).database,y=(0,L.Z)(q.Z.getAll,[]),b=(0,L.Z)(q.Z.get(n),[n]),w=(0,C.useMemo)((function(){return y&&(0,U.zU)(j,y)}),[j,y]),k=j._getCharKeys().filter((function(e){return(null===y||void 0===y?void 0:y[e])&&v(y[e],e)})).sort();return(0,N.jsxs)(z.Z,(0,D.Z)((0,D.Z)({},x),{},{title:null!==(t=null===b||void 0===b?void 0:b.name)&&void 0!==t?t:d?m(r||(r=(0,_.Z)(["inventory"]))):null!==c&&void 0!==c?c:m(a||(a=(0,_.Z)(["unselect"]))),color:n?"success":"primary",startIcon:null!==b&&void 0!==b&&b.thumbImg?(0,N.jsx)(G.Z,{src:b.thumbImgSide}):d?(0,N.jsx)(K.Z,{}):null!==u&&void 0!==u?u:(0,N.jsx)(P.Z,{}),children:[!p&&(d?(0,N.jsxs)(T.Z,{onClick:function(){return s("")},selected:""===n,disabled:""===n,children:[(0,N.jsx)(I.Z,{children:(0,N.jsx)(K.Z,{})}),(0,N.jsx)(g.Z,{variant:"inherit",noWrap:!0,children:m(i||(i=(0,_.Z)(["inventory"])))})]}):(0,N.jsxs)(T.Z,{onClick:function(){return s("")},selected:""===n,disabled:""===n,children:[(0,N.jsx)(I.Z,{children:(0,N.jsx)(P.Z,{})}),(0,N.jsx)(g.Z,{variant:"inherit",noWrap:!0,children:m(o||(o=(0,_.Z)(["unselect"])))})]})),!p&&(0,N.jsx)(Z.Z,{},"div"),!!y&&$(y,k,s,n,w)]}))}function $(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0;if(!a)return[];var i=t.filter((0,B.C)({name:"",element:"",weaponType:"",favorite:"yes"},a)).map((function(t){return(0,N.jsx)(Q,{characterSheets:e,characterKey:t,selectedCharacterKey:r,onChange:n,favorite:!0},t)})),o=t.filter((0,B.C)({name:"",element:"",weaponType:"",favorite:"no"},a)).map((function(t){return(0,N.jsx)(Q,{characterSheets:e,characterKey:t,selectedCharacterKey:r,onChange:n,favorite:!1},t)}));return i.concat(o)}function Q(e){var t,n,r=e.characterSheets,a=e.characterKey,i=e.selectedCharacterKey,o=void 0===i?"":i,s=e.onChange,c=e.favorite;return(0,N.jsxs)(T.Z,{onClick:function(){return s(a)},selected:o===a,disabled:o===a,children:[(0,N.jsx)(I.Z,{children:(0,N.jsx)(G.Z,{src:null===(t=r[a])||void 0===t?void 0:t.thumbImgSide})}),(0,N.jsx)(C.Suspense,{fallback:(0,N.jsx)(k.Z,{variant:"text",width:100}),children:(0,N.jsx)(g.Z,{variant:"inherit",noWrap:!0,children:null===(n=r[a])||void 0===n?void 0:n.name})}),c&&(0,N.jsx)(V.Z,{display:"flex",flexGrow:1}),c&&(0,N.jsx)(O.Z,{sx:{ml:1,mr:-.5}})]},a)}var Y=n(14525),X=n(2693),J=n(73036),ee=n(26138),te=n(69292),ne=n(20323),re=n(30865),ae=n(13434),ie=n(50920),oe=n(53561),se=n(17278),ce=n(47639),ue=n(9274),le=n(24351),de=n(60393),he=n(72814),pe=n(58003),fe=n(64737),ve=n(78661);function xe(e,t,n){var r=!0;return(0,fe.aD)([e],(function(e){}),(function(e){var a=e.operation;if("read"===a){if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported [".concat(a,"] node in zero_deriv"));t(e)===n&&(r=!1)}})),r}function me(e,t,n){var r=e.operation;switch(r){case"read":if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported [".concat(r,"] node in d/dx"));return t(e)===n?(0,ve.a9)(1):(0,ve.a9)(0);case"const":return(0,ve.a9)(0);case"res":if(!xe(e,t,n))throw new Error("[".concat(r,"] node takes only constant inputs. ").concat(e));return(0,ve.a9)(0);case"add":return ve.Sm.apply(void 0,(0,l.Z)(e.operands.map((function(e){return me(e,t,n)}))));case"mul":var a=e.operands.map((function(r,a){return ve.WV.apply(void 0,[me(r,t,n)].concat((0,l.Z)(e.operands.filter((function(e,t){return t!==a})))))}));return ve.Sm.apply(void 0,(0,l.Z)(a));case"sum_frac":var i=e.operands[0],o=me(i,t,n),s=ve.Sm.apply(void 0,(0,l.Z)(e.operands.slice(1))),c=me(s,t,n),u=(0,ve.WV)(ve.Sm.apply(void 0,(0,l.Z)(e.operands)),ve.Sm.apply(void 0,(0,l.Z)(e.operands))),h=(0,ve.Sm)((0,ve.WV)(s,o),(0,ve.WV)(-1,i,c));return{operation:"sum_frac",operands:[h,(0,ve.WV)(h,-1),u]};case"min":case"max":switch(e.operands.length){case 1:return me(e.operands[0],t,n);case 2:var p=(0,d.Z)(e.operands,2),f=p[0],v=p[1];if("min"===r)return(0,ve.ER)(f,v,me(v,t,n),me(f,t,n));if("max"===r)return(0,ve.ER)(f,v,me(f,t,n),me(v,t,n));(0,de.UT)(r);break;default:throw new Error("[".concat(r,"] node operates on only 1 or 2 arguments. ").concat(e))}break;case"threshold":var x=(0,d.Z)(e.operands,4),m=x[0],g=x[1],Z=x[2],j=x[3];if(!xe(m,t,n)||!xe(g,t,n))throw new Error("[".concat(r,"] node must branch on constant inputs. ").concat(e));return(0,ve.ER)(m,g,me(Z,t,n),me(j,t,n));case"match":case"lookup":case"subscript":case"data":throw new Error("Unsupported [".concat(r,"] node in ddx"));default:(0,de.UT)(r)}}var ge=n(50765),Ze=n(19272),je=[[1],[1,1,1,1],[1,2,3,4,3,2,1],[1,3,6,10,12,12,10,6,3,1],[1,4,10,20,31,40,44,40,31,20,10,4,1],[1,5,15,35,65,101,135,155,155,135,101,65,35,15,5,1]];function ye(e,t){for(var n;e>=je.length;){for(var r=je.length,a=[],i=0,o=r-1;i<=3*r;i++){var s,c,u,l,d=null!==(s=je[o][i-3])&&void 0!==s?s:0,h=null!==(c=je[o][i-2])&&void 0!==c?c:0,p=null!==(u=je[o][i-1])&&void 0!==u?u:0,f=null!==(l=je[o][i])&&void 0!==l?l:0;a[i]=d+h+p+f}je.push(a)}return null!==(n=je[e][t])&&void 0!==n?n:0}function be(e){var t=1;e<0&&(t=-1);var n=1/(1+.3275911*(e=Math.abs(e)));return t*(1-((((1.061405429*n-1.453152027)*n+1.421413741)*n-.284496736)*n+.254829592)*n*Math.exp(-e*e))}function we(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),n<=0?0:Math.exp(-(t-e)*(t-e)/n/2)/Math.sqrt(2*Math.PI*n)}var ke=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return e.flatMap((function(e){return t.map((function(t){return[e,t].flat()}))}))}))},Ce=[270/1024,80/1024,0,12/256,8/256,120/1024,0,60/1024,4/256,60/1024,4/256,30/1024,24/256,.15625,1/64,1/64,24/256,1/64,12/256,0,6/256,2/16,6/256,0,81/256,.0625,0,27/64,12/64,0,1/16,1/16,12/64,1/16,6/64,3/4,.5,243/1024,.03125,0,108/256,.125,0,9/64,6/64,.1875,0,24/256,3/64,5/1024,3/64,5/1024,0,405/1024,80/1024,0,54/256,90/1024,40/1024,0,1/256,1/256,40/1024,1/256,20/1024,9/16,.25,0,1/4,1/4,0,1/4,27/64,8/64,0,6/16,.25,10/1024,0,10/1024,2/16,0,0,0,15/1024,10/1024,1/1024,1/1024,0,1/1024],Se=[35,64,70,21,33,45,12,0,53,76,48,86];function Me(e,t){var n=e.reduce((function(e,t){return e+t}));if(e.length>4||n>t)return 0;if(4===e.length&&n!==t)return 0;3===e.length&&(e=[].concat((0,l.Z)(e),[t-n])),e.sort().reverse();var r=13*t+e.length-14+16*e[0];e.length>1&&(r+=4*e[1]);var a=r%12,i=Math.trunc(r/12);return Ce[a+Se[i]]}function Ae(e,t){if(0!==e)for(var n=e;n>=0;n--)for(var r=e-n;r>=0;r--)for(var a=e-n-r;a>=0;a--){var i=e-n-r-a;t([n,r,a,i],Me([n,r,a,i],e))}else t([0,0,0,0],1)}function De(e){var t=function(e){return e.endsWith("_")?Ze.Z.maxSubstatValues(e,5)/1e3:Ze.Z.maxSubstatValues(e,5)/10},n=e.statsBase,r=[];return Ae(e.rollsLeft,(function(a,i){var o=a.map((function(t,n){var r=e.subs[n];return r&&!e.skippableDerivs[ge._.indexOf(r)]?(0,de.w6)(7*t,10*t):[NaN]}));ke.apply(void 0,(0,l.Z)(o)).forEach((function(o){for(var s=(0,D.Z)({},n),c=1,u=0;u<4;u++){var l;if(!isNaN(o[u])){var d=e.subs[u],h=o[u],p=a[u];s[d]=(null!==(l=s[d])&&void 0!==l?l:0)+h*t(d),c*=Math.pow(4,-p)*ye(p,h-7*p)}}r.push({v:e.evalFn(s).map((function(e){return e.v})),p:i*c})}))})),r}function _e(e,t,n){if(t<1e-5)return e>n?{p:1,upAvg:e-n}:{p:0,upAvg:0};var r=(n-e)/Math.sqrt(t),a=(1-be(r/Math.sqrt(2)))/2;if(r>5){var i=1/r,o=i*i;return{p:a,upAvg:Math.sqrt(t)*i*(1-2*o*(1-o*(5+37*o)))}}var s=Math.exp(-r*r/2)/Math.sqrt(2*Math.PI);return{p:a,upAvg:e-n+Math.sqrt(t)*s/a}}function Ee(e){var t={};return Object.values(e).forEach((function(e){e&&Object.entries(e.values).forEach((function(e){var n,r=(0,d.Z)(e,2),a=r[0],i=r[1];return t[a]=(null!==(n=t[a])&&void 0!==n?n:0)+i}))})),t}function Ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,D.Z)({},e.curBuild);r[t.slot]=t;var a=Ee(r),i=(0,D.Z)({},a),o=function(e){return e.endsWith("_")?Ze.Z.maxSubstatValues(e,t.rarity)/1e3:Ze.Z.maxSubstatValues(e,t.rarity)/10},s=Ze.Z.rollsRemaining(t.level,t.rarity)-(4-t.subs.length),c={rollsLeft:s,subs:t.subs,stats:a,thresholds:e.thresholds,objectiveEval:function(n){return e.evalFn(n).map((function(e){var n=e.v,r=e.grads;return{v:n,ks:t.subs.map((function(e){return r[ge._.indexOf(e)]*o(e)}))}}))},scale:o},u=n?Oe(c):Pe(c);return{id:t.id,subs:t.subs,rollsLeft:s,statsBase:i,prob:u.p,upAvg:u.upAvg,distr:u.appxDist,evalFn:e.evalFn,skippableDerivs:e.skippableDerivs,thresholds:e.thresholds,evalMode:n?"slow":"fast"}}function Pe(e){var t=e.rollsLeft,n=e.subs,r=e.stats,a=e.scale,i=e.objectiveEval,o=e.thresholds,s=(0,D.Z)({},r);n.forEach((function(e){var n;s[e]=(null!==(n=s[e])&&void 0!==n?n:0)+17/8*t*a(e)}));for(var c=t,u=i(s),l=1,d=-1,h={gmm:[],lower:u[0].v,upper:u[0].v},p=0;p<u.length;p++){var f=u[p],v=f.v,x=f.ks,m=x.reduce((function(e,t){return e+t})),g=v,Z=(147/8*x.reduce((function(e,t){return e+t*t}),0)-289/64*m*m)*c,j=_e(g,Z,o[p]),y=j.p,b=j.upAvg;0===p&&(d=b,h={gmm:[{phi:1,mu:g,sig2:Z,cp:1}],lower:g-4*Math.sqrt(Z),upper:g+4*Math.sqrt(Z)}),l=Math.min(y,l)}return{p:l,upAvg:d,appxDist:h}}function Oe(e){var t=e.rollsLeft,n=e.stats,r=e.subs,a=e.thresholds,i=e.scale,o=e.objectiveEval,s={gmm:[],lower:a[0],upper:a[0]},c=[];Ae(t,(function(e,t){var u=(0,D.Z)({},n);r.forEach((function(t,n){var r;u[t]=(null!==(r=u[t])&&void 0!==r?r:0)+8.5*e[n]*i(t)}));var l=o(u),d=l.map((function(e){return e.v})),h=l.map((function(t){return l.map((function(n){return t.ks.reduce((function(r,a,i){return r+t.ks[i]*n.ks[i]*e[i]}),0)}))})),p=function(e,t,n){for(var r=1,a=1,i=0;i<e.length;++i)if(t[i][i]<1e-5){if(e[i]<n[i])return{p:0,upAvg:0,cp:0}}else{var o=(1-be((n[i]-e[i])/Math.sqrt(t[i][i])/Math.sqrt(2)))/2;r*=o,0!==i&&(a*=o)}return{p:r,upAvg:_e(e[0],t[0][0],n[0]).upAvg,cp:a}}(d,h,a);c.push((0,D.Z)({l:t},p)),s.gmm.push({phi:t,mu:d[0],sig2:h[0][0],cp:p.cp}),s.lower=Math.min(s.lower,d[0]-4*Math.sqrt(h[0][0])),s.upper=Math.max(s.upper,d[0]+4*Math.sqrt(h[0][0]))}));var u=0,l=0;return c.forEach((function(e){var t=e.l,n=e.p,r=e.upAvg,a=e.cp;u+=t*n*a,l+=t*n*a*r})),u<1e-10?{p:0,upAvg:0,appxDist:s}:{p:u,upAvg:l/=u,appxDist:s}}function Te(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=[];e.forEach((function(e){a.push.apply(a,[e].concat((0,l.Z)(ge._.map((function(t){return me(e,(function(e){return e.path[1]}),t)})))))}));var i=(0,te.tL)(a,r,(function(e){return"dyn"!==(0,d.Z)(e.path,1)[0]}));i=(0,te.tL)(i,r,(function(e){return"dyn"!==(0,d.Z)(e.path,1)[0]}));var o=(0,te.I3)(i,(function(e){return e.path[1]})),s=Ee(n),c=o(s)[0],u=ge._.map((function(t){return e.every((function(e){return xe(e,(function(e){return e.path[1]}),t)}))})),h=function(t){var n=o(t);return e.map((function(e,t){var r=t*(1+ge._.length);return{v:n[r],grads:ge._.map((function(e,t){return n[r+1+t]}))}}))};return{formulas:e,thresholds:[c].concat((0,l.Z)(t)),curBuild:n,evalFn:h,skippableDerivs:u}}function Ie(e,t){var n;void 0===t&&(t=e.level);var r=Ze.Z.mainStatValue(e.mainStatKey,e.rarity,t),a={id:e.id,slot:e.slotKey,level:e.level,rarity:e.rarity,values:(0,D.Z)((n={},(0,c.Z)(n,e.setKey,1),(0,c.Z)(n,e.mainStatKey,e.mainStatKey.endsWith("_")?r/100:r),n),Object.fromEntries(e.substats.map((function(e){return[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]})))),subs:e.substats.reduce((function(e,t){return""!==t.key&&e.push(t.key),e}),[])};return delete a.values[""],a}function Ve(e,t){if(t.prob>1e-5||e.prob>1e-5)return t.prob*t.upAvg-e.prob*e.upAvg;var n=e.distr.gmm.reduce((function(e,t){return e+t.phi*t.mu}),0);return t.distr.gmm.reduce((function(e,t){return e+t.phi*t.mu}),0)-n}var We=n(72838),qe=n(76899),Fe=n(2191),Le=n(19913),Ue=n(39783),Be=n(90466),ze=n(17684),Ge=n(12891),Ne=n(27281),Re=n(62066),He=n(18602),$e=n(94783),Qe=n(48004),Ye=n(35667),Xe=n(52991);var Je=50;function et(e){var t=e.upgradeOpt,n=e.objMin,r=e.objMax,a=(0,C.useState)(!1),i=(0,d.Z)(a,2),o=i[0],s=i[1],c=(0,C.useContext)(F.t).database,u=c._getArt(t.id);if(!u)throw new Error("artifact ".concat(t.id," not found."));var l=t.thresholds.length>1,h=u.slotKey,p=(0,C.useContext)(X.R).data,v=(0,C.useMemo)((function(){return le.eV.map((function(e){var t;return[e,c._getArt(null!==(t=p.get(ee.ri.art[e].id).value)&&void 0!==t?t:"")]}))}),[p,c]),x=function(e){return t.distr.gmm.reduce((function(t,n){var r=n.phi,a=n.cp,i=n.mu,o=n.sig2;return t+a*r*we(e,i,o)}),0)},g=t.thresholds,Z=g[0],y=function(e){return 100*(e-Z)/Z},w=n,k=r,S=0,M=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,n=[],r=((arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)-e)/t,a=0;a<t;++a)n.push(e+a*r);return n}(w,k,500).map((function(e){var n,r=(n=e,t.distr.gmm.reduce((function(e,t){var r=t.phi,a=t.mu,i=t.sig2;return e+r*we(n,a,i)}),0));return S=Math.max(S,r),{x:y(e),est:r,estCons:x(e)}}));0===S&&(S=Je/(k-w));var D={},_={};t.distr.gmm.forEach((function(e){var t,n,r=e.phi,a=e.mu,i=e.sig2,o=e.cp;i<=0&&(D[a]=(null!==(t=D[a])&&void 0!==t?t:0)+r,_[a]=(null!==(n=_[a])&&void 0!==n?n:0)+r*o)})),Object.entries(D).forEach((function(e){var t=(0,d.Z)(e,2),n=t[0],r=t[1];return M.push({x:y(parseFloat(n)),est:r*Je/(k-w),estCons:_[n]*Je/(k-w)})})),M.sort((function(e,t){return e.x-t.x}));var E=(Z-w)/(k-w),K=(0,C.useState)([]),P=(0,d.Z)(K,2),O=P[0],T=P[1],I=(0,C.useState)(-1),V=(0,d.Z)(I,2),W=V[0],q=V[1],L=(0,C.useState)(-1),U=(0,d.Z)(L,2),B=U[0],z=U[1];if((0,C.useEffect)((function(){if(o){var e=De(t),n=0,r=0,a=new Array(Je).fill(0),i=new Array(Je).fill(0),s=(k-w)/Je;e.forEach((function(e){var t=e.p,o=e.v,c=Math.min(Math.trunc((o[0]-w)/s),49);a[c]+=t,o.every((function(e,t){return 0===t||e>g[t]}))&&(i[c]+=t,o[0]>Z&&(n+=t,r+=t*(o[0]-Z)))})),n>0&&(r/=n);var c=a.map((function(e,t){return{x:y(w+t*s),exact:e/s,exactCons:i[t]/s}}));q(n),z(r),T(c)}}),[o,k,w,Z,g,t]),0===O.length)for(var G=(k-w)/Je,R=0;R<Je;R++)O.push({x:y(w+R*G),exact:0,exactCons:0});var H=W>=0?W:t.prob,$=B>=0?B:t.upAvg,Q=M.concat(O),Y=function(e){var t=e.active;e.payload,e.label;return t?(0,N.jsxs)("div",{className:"custom-tooltip",children:[(0,N.jsx)("p",{className:"label"}),(0,N.jsxs)("p",{className:"desc",children:["prob. upgrade",W>=0?"":" (est.)",": ",(100*H).toFixed(1),"%"]}),(0,N.jsxs)("p",{className:"desc",children:["average increase",B>=0?"":" (est.)",": ",$<=0?"":"+",(100*$/Z).toFixed(1),"%"]})]}):null};return(0,N.jsx)(A.Z,{children:(0,N.jsxs)(m.Z,{children:[(0,N.jsx)(Le.h,{height:"99%",aspect:3,children:(0,N.jsxs)(Ue.c,{data:Q,margin:{top:5,right:30,left:20,bottom:20},children:[(0,N.jsx)(Be.K,{dataKey:"x",type:"number",domain:["auto","auto"],allowDecimals:!1,tickFormatter:function(e){return"".concat(e<=0?"":"+").concat(e,"%")},children:(0,N.jsx)(ze._,{value:"Relative Damage Potential",position:"insideBottom",style:{fill:"#eaebed"},offset:-10})}),(0,N.jsx)(Ge.B,{type:"number",domain:[0,S],tick:!1,children:(0,N.jsx)(ze._,{value:"Probability",position:"insideLeft",angle:-90,style:{fill:"#eaebed"}})}),(0,N.jsx)(Ne.D,{verticalAlign:"top",height:36}),(0,N.jsx)("defs",{children:(0,N.jsxs)("linearGradient",{id:"splitOpacity".concat(t.id),x1:"0",y1:"0",x2:E,y2:"0",children:[(0,N.jsx)("stop",{offset:1,stopColor:"orange",stopOpacity:0}),(0,N.jsx)("stop",{offset:0,stopColor:"orange",stopOpacity:1})]})}),(0,N.jsx)(Re.x,{dataKey:"dne",stroke:"red",name:"Current Damage"}),l&&!o&&(0,N.jsx)(He.u,{type:"monotone",dataKey:"est",stroke:"grey",dot:!1,fill:"grey",legendType:"none",tooltipType:"none",opacity:.5,activeDot:!1}),l&&o&&(0,N.jsx)(He.u,{type:"stepAfter",dataKey:"exact",dot:!1,legendType:"none",tooltipType:"none",opacity:.7,activeDot:!1,fill:"grey",stroke:"grey"}),(0,N.jsx)(He.u,{type:"monotone",dataKey:"estCons",stroke:"orange",dot:!1,fill:"url(#splitOpacity".concat(t.id,")"),opacity:.5,name:"Estimated Distribution",activeDot:!1}),o&&(0,N.jsx)(He.u,{type:"stepAfter",dataKey:"exactCons",dot:!1,opacity:.7,name:"Exact".concat(l?" Constrained":""," Distribution (Histogram)"),activeDot:!1}),(0,N.jsx)($e.d,{x:y(Z),stroke:"red",strokeDasharray:"3 3",name:"Current Damage"}),(0,N.jsx)(Qe.q,{x:y(Z+$),y:(x(Z+$)||S)/2,shape:(0,N.jsx)("circle",{radius:1,opacity:.5})}),(0,N.jsx)(Ye.u,{content:(0,N.jsx)(Y,{}),cursor:!1})]})},t.id),(0,N.jsx)(j.ZP,{direction:"row",container:!0,spacing:.75,columns:12,children:v.map((function(e){var n=(0,d.Z)(e,2),r=n[0],a=n[1];return r!==h?(0,N.jsx)(j.ZP,{item:!0,xs:1,children:(0,N.jsx)(Xe.Z,{slotKey:r,artifactObj:a})},"".concat(r,"_").concat(t.id)):(0,N.jsx)(j.ZP,{item:!0,xs:1,children:(0,N.jsx)(b.Z,{variant:"contained",style:{height:"100%",width:"100%"},onClick:function(){return s(!0)},startIcon:(0,N.jsx)(f.Z,{sx:{position:"absolute",width:"70%",height:"70%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",opacity:.7},component:"img",src:Fe.Z.slot[r]}),sx:{minWidth:0}})},"".concat(r,"_").concat(t.id))}))}),(0,N.jsx)("br",{}),(0,N.jsx)("span",{children:"Click above to calculate Exact upgrade distribution"}),(0,N.jsx)("br",{})]})})}var tt=n(32490),nt=n(66382);function rt(){return{characterKey:""}}function at(){var e,t,n,r=(0,se.Z)("GlobalSettings",ne.c),a=((0,d.Z)(r,1)[0].tcMode,(0,C.useContext)(F.t).database),i=(0,se.Z)("BuildDisplay",rt),o=(0,d.Z)(i,2),D=o[0].characterKey,_=o[1],E=(0,C.useCallback)((function(e){e&&a._getChar(e)?_({characterKey:e}):_({characterKey:""})}),[_,a]),K=(0,oe.Z)(),P=(0,ie.Z)(D),O=(0,ae.Z)(D),T=null!==(e=null===O||void 0===O?void 0:O.buildSettings)&&void 0!==e?e:(0,ue.$)(),I=T.plotBase,V=T.setFilters,q=T.statFilters,L=T.optimizationTarget,U=T.mainStatAssumptionLevel,B=T.maxBuildsToShow,z=(0,ce.Z)(D,U),G=null!==(t=null===z||void 0===z?void 0:z[D])&&void 0!==t?t:{},R=G.characterSheet,$=G.target,Q=(0,C.useMemo)((function(){return!a._getCharKeys().length}),[a]),fe=(0,C.useMemo)((function(){return!a._getArts().length}),[a]),ve=(0,C.useCallback)((function(e){return P&&P({buildSettings:(0,ue.C)(T,e)})}),[P,T]),xe=(0,C.useState)(0),me=(0,d.Z)(xe,2),ge=me[0],Ze=me[1],je=(0,C.useRef)(null),ye=(0,W.$)(["artifact","ui"]).t,be=(0,C.useState)([]),we=(0,d.Z)(be,2),ke=we[0],Ce=we[1],Se=(0,C.useState)(void 0),Me=(0,d.Z)(Se,2),Ae=Me[0],De=Me[1],_e=Ae,Ee=(0,C.useMemo)((function(){var e=Math.ceil(ke.length/5),t=(0,de.uZ)(ge,0,e-1),n=ke.slice(5*t,5*(t+1)),r=n.length>0?n[0].thresholds[0]:0;return{artifactsToShow:n,numPages:e,currentPageIndex:t,minObj0:n.reduce((function(e,t){return Math.min(t.distr.lower,e)}),r),maxObj0:n.reduce((function(e,t){return Math.max(t.distr.upper,e)}),r)}}),[ke,5,ge]),Pe=Ee.artifactsToShow,Oe=Ee.numPages,qe=Ee.currentPageIndex,Fe=Ee.minObj0,Le=Ee.maxObj0,Ue=(0,C.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";D!==e&&E(e)}),[E,D]),Be=(0,C.useCallback)((function(e,t,n){if(void 0===_e)return e;var r=a._getArts().filter((function(e){return 5===e.rarity})).map((function(e){return Ie(e,20)})),i={};r.forEach((function(e){return i[e.id]=e}));var o=e.slice(0,t),s=e.slice(t),c=0,u=Math.min(n-t+5,s.length);do{for(;c<u;c++){var d=i[s[c].id];d&&(s[c]=Ke(_e,d,!0))}for(s.sort(Ve),c=0;c<u&&"fast"!==s[c].evalMode;c++);}while(c<u);return[].concat((0,l.Z)(o),(0,l.Z)(s))}),[a,_e]),ze=(0,C.useCallback)((function(e,t){var n;null===(n=je.current)||void 0===n||n.scrollIntoView({behavior:"smooth"});var r=Be(ke,5*(qe+1),5*t);Ce(r),Ze(t-1)}),[Ze,Ce,je,qe,5,ke,Be]),Ge=(0,C.useCallback)((0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,i,o,u,h,p,f,v,x,m,g,Z,j;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D&&L){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,ce.V)(a,D,U,[]);case 4:if(o=e.sent){e.next=7;break}return e.abrupt("return");case 7:if(u=null===(t=(0,J.Qo)(o.teamData,D)[D])||void 0===t?void 0:t.target.data[0]){e.next=10;break}return e.abrupt("return");case 10:if(Object.assign(u,(0,J.b3)([u,pe.mQ])),h=(0,de.Hm)(null!==(n=u.display)&&void 0!==n?n:{},L)){e.next=14;break}return e.abrupt("return");case 14:p=Object.entries(q).map((function(e){var t=(0,d.Z)(e,2),n=t[0],r=t[1];return n.endsWith("_")&&(r/=100),{value:ee.ri.total[n],minimum:r}})).filter((function(e){return e.value&&e.minimum>-1/0})),f=a._getArts().filter((function(e){return 5===e.rarity})).map((function(e){return Ie(e,20)})),v=null!==(r=null===(i=a._getChar(D))||void 0===i?void 0:i.equippedArtifacts)&&void 0!==r?r:{},x=Object.assign.apply(Object,[{}].concat((0,l.Z)(le.eV.map((function(e){var t,n=a._getArt(null!==(t=v[e])&&void 0!==t?t:"");return n?(0,c.Z)({},e,Ie(n)):(0,c.Z)({},e,void 0)}))))),m={},f.forEach((function(e){return m[e.id]=e})),console.log(x,ee.ri),console.log(a._getChar(D)),g=[h].concat((0,l.Z)(p.map((function(e){return e.value})))),g=(0,te.tL)(g,u,(function(e){return"dyn"!==(0,d.Z)(e.path,1)[0]})),Z=Te(g,p.map((function(e){return e.minimum})),x,$),j=(j=f.map((function(e){return Ke(Z,e,!1)}))).sort((function(e,t){return t.prob*t.upAvg-e.prob*e.upAvg})),_e=Z,j=Be(j,0,5),Ce(j),De(Z);case 31:case"end":return e.stop()}}),e)}))),[D,a,U,B,L,I,ve,V,q]),Ne=(n=null===R||void 0===R?void 0:R.name,(0,C.useMemo)((function(){return $&&R&&O&&z&&{data:$,characterSheet:R,character:O,mainStatAssumptionLevel:U,teamData:z,characterDispatch:P}}),[$,R,O,z,P,U]));return(0,N.jsxs)(f.Z,{display:"flex",flexDirection:"column",gap:1,sx:{my:1},children:[Q&&(0,N.jsxs)(v.Z,{severity:"error",variant:"filled",children:[" Opps! It looks like you haven't added a character to GO yet! You should go to the ",(0,N.jsx)(x.Z,{component:S.rU,to:"/character",children:"Characters"})," page and add some!"]}),fe&&(0,N.jsxs)(v.Z,{severity:"warning",variant:"filled",children:[" Opps! It looks like you haven't added any artifacts to GO yet! You should go to the ",(0,N.jsx)(x.Z,{component:S.rU,to:"/artifact",children:"Artifacts"})," page and add some!"]}),!Ne&&(0,N.jsxs)(M.Z,{children:[(0,N.jsx)(m.Z,{sx:{py:1},children:(0,N.jsx)(g.Z,{variant:"h6",children:"Build Generator"})}),(0,N.jsx)(Z.Z,{}),(0,N.jsx)(m.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,N.jsx)(A.Z,{children:(0,N.jsx)(m.Z,{children:(0,N.jsx)(H,{fullWidth:!0,value:D,onChange:Ue})})})})]}),Ne&&(0,N.jsx)(X.R.Provider,{value:Ne,children:(0,N.jsxs)(M.Z,{children:[(0,N.jsx)(m.Z,{sx:{py:1},children:(0,N.jsx)(g.Z,{variant:"h6",children:"Build Generator"})}),(0,N.jsx)(Z.Z,{}),(0,N.jsx)(m.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,N.jsxs)(j.ZP,{container:!0,spacing:1,children:[(0,N.jsxs)(j.ZP,{item:!0,xs:12,md:4,lg:3,display:"flex",flexDirection:"column",gap:1,style:{position:"sticky"},children:[(0,N.jsx)(A.Z,{children:(0,N.jsx)(m.Z,{children:(0,N.jsx)(H,{fullWidth:!0,value:D,onChange:Ue})})}),(0,N.jsx)(f.Z,{children:(0,N.jsx)(re.Z,{characterKey:D,onClick:K})})]}),(0,N.jsxs)(j.ZP,{item:!0,xs:12,md:8,lg:9,display:"flex",flexDirection:"column",gap:1,children:[(0,N.jsxs)(j.ZP,{container:!0,spacing:1,children:[(0,N.jsx)(j.ZP,{item:!0,lg:8,children:(0,N.jsx)(A.Z,{children:(0,N.jsxs)(m.Z,{children:[(0,N.jsx)("span",{children:"Optimization Target: "}),(0,N.jsx)(he.Z,{optimizationTarget:L,setTarget:function(e){return ve({optimizationTarget:e})},disabled:!1}),(0,N.jsx)("br",{}),(0,N.jsx)(tt.Hn,{size:"small"}),(0,N.jsx)("br",{}),(0,N.jsx)(tt.oX,{size:"small"})]})})}),(0,N.jsxs)(j.ZP,{item:!0,lg:4,children:[(0,N.jsx)(Y.Z,{statFilters:q,setStatFilters:function(e){return ve({statFilters:e})},disabled:!1}),(0,N.jsx)(nt.Z,{disabled:!1})]})]}),(0,N.jsx)(y.Z,{children:(0,N.jsx)(b.Z,{disabled:!D||!L||!(0,de.Hm)(null===$||void 0===$?void 0:$.getDisplay(),L),color:D?"success":"warning",onClick:Ge,startIcon:(0,N.jsx)(p.G,{icon:h.lTt}),children:"Calc Upgrade Priority"})}),Oe>1&&(0,N.jsx)(M.Z,{children:(0,N.jsx)(m.Z,{children:(0,N.jsxs)(j.ZP,{container:!0,children:[(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,N.jsx)(w.Z,{count:Oe,page:qe+1,onChange:ze})}),(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(it,{numShowing:Pe.length,total:ke.length,t:ye})})]})})}),(0,N.jsxs)(f.Z,{display:"flex",flexDirection:"column",gap:1,my:1,children:[fe&&(0,N.jsxs)(v.Z,{severity:"info",variant:"filled",children:["Looks like you haven't added any artifacts yet. If you want, there are ",(0,N.jsx)(x.Z,{color:"warning.main",component:S.rU,to:"/scanner",children:"automatic scanners"})," that can speed up the import process!"]}),(0,N.jsx)(C.Suspense,{fallback:(0,N.jsx)(k.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:Pe.map((function(e){return(0,N.jsxs)(j.ZP,{container:!0,gap:1,wrap:"nowrap",children:[(0,N.jsx)(j.ZP,{item:!0,xs:5,sm:4,md:4,lg:3,xl:3,children:(0,N.jsx)(We.Z,{artifactId:e.id,editor:!0})}),(0,N.jsx)(j.ZP,{item:!0,xs:7,sm:8,md:8,lg:9,xl:9,children:(0,N.jsx)(et,{upgradeOpt:e,objMax:Le,objMin:Fe})})]},e.id+"asdfsf")}))}),Oe>1&&(0,N.jsx)(M.Z,{children:(0,N.jsx)(m.Z,{children:(0,N.jsxs)(j.ZP,{container:!0,children:[(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,N.jsx)(w.Z,{count:Oe,page:qe+1,onChange:ze})}),(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(it,{numShowing:Pe.length,total:ke.length,t:ye})})]})})})]})]})]})})]})})]})}function it(e){var t=e.numShowing,n=e.total,r=e.t;return(0,N.jsx)(g.Z,{color:"text.secondary",children:(0,N.jsxs)(qe.c,{t:r,i18nKey:"showingNum",count:t,value:n,children:["Showing ",(0,N.jsx)("b",{children:{count:t}})," out of ",{value:n}," Artifacts"]})})}}}]);
//# sourceMappingURL=612.06d8d959.chunk.js.map