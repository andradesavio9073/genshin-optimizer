(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[800],{70867:function(e,t,n){"use strict";n.d(t,{mY:function(){return W},N5:function(){return R},Y4:function(){return V},mW:function(){return $}});var r=n(29439),i=n(1413),a=n(45987),s=n(13967),o=n(94198),c=n(58165),l=n(81918),u=n(90493),d=n(64554),f=n(79834),h=n(72791),p=n(22020),x=n(31148),v=n(72828),m=n(79406),j=n(42320),Z=n(50765),g=n(24351),y=n(91702),b=n(23786),w=n(57064),C=n(49900),k=n(80184);function S(e){var t=e.value,n=e.image,r=void 0===n?"":n,a=e.text,s=e.theme,o=e.isSelected,c=e.addlElement,l=e.props;return(0,k.jsxs)(b.Z,(0,i.Z)((0,i.Z)({value:t},l),{},{children:[(0,k.jsx)(w.Z,{children:r}),(0,k.jsx)(C.Z,{primaryTypographyProps:{style:{fontWeight:o?s.typography.fontWeightMedium:s.typography.fontWeightRegular}},children:a}),c&&c]}),t)}var P=n(68244),E=n(10157),_=n(75545),A=["allArtifactKeysWithGrouper","selectedArtifactKeys","setArtifactKeys","getName","getImage","label"],K=["artSetKeys","setArtSetKeys"],O=["mainStatKeys","setMainStatKeys"],T=["substatKeys","setSubstatKeys"],D=["allArtifactKeysWithGrouper","selectedArtifactKey","setArtifactKey","getName","getImage","label","disable","showDefault","defaultText","defaultIcon"],M=["artSetKey","setArtSetKey","label"];function I(e){var t=e.allArtifactKeysWithGrouper,n=e.selectedArtifactKeys,r=e.setArtifactKeys,u=e.getName,d=e.getImage,f=e.label,p=(0,a.Z)(e,A),x=(0,s.Z)(),v=(0,h.useMemo)((function(){return t.map((function(e){var t=e.key,n=e.grouper;return{key:t,label:u(t),grouper:n}}))}),[t,u]);return(0,k.jsx)(o.Z,(0,i.Z)({autoHighlight:!0,multiple:!0,disableCloseOnSelect:!0,options:v,value:n.map((function(e){return{key:e,label:u(e)}})),onChange:function(e,t){r(t.map((function(e){return e.key})))},getOptionLabel:function(e){return e.label},isOptionEqualToValue:function(e,t){return e.key===t.key},renderInput:function(e){return(0,k.jsx)(c.Z,(0,i.Z)((0,i.Z)({},e),{},{label:f,variant:"filled",InputLabelProps:{style:{color:x.palette.text.primary}},color:n.length?"success":"primary",type:"search"}))},renderOption:function(e,t){return(0,k.jsx)(S,{value:t.key,image:(0,k.jsx)(y.Z,{color:m.ZP.getVariant(t.key),children:d(t.key)}),text:(0,k.jsx)(y.Z,{color:m.ZP.getVariant(t.key),children:t.label}),theme:x,isSelected:n.includes(t.key),props:e},t.key)},renderTags:function(e,t){return e.map((function(e,n){var r=g.Kj.find((function(t){return e.key==="".concat(t,"_dmg_")})),a=r||void 0;return(0,h.createElement)(l.Z,(0,i.Z)((0,i.Z)({},t({index:n})),{},{key:e.key,icon:d(e.key),label:e.label,color:a}))}))}},p))}function R(e){var t=e.artSetKeys,n=e.setArtSetKeys,s=(0,a.Z)(e,K),o=(0,j.Z)((function(){return x.y.getAll}),[]),c=(0,p.$)(["artifact","artifactNames_gen"]).t;if(!o)return null;var l=Object.entries(x.y.setKeysByRarities(o)).flatMap((function(e){var t=(0,r.Z)(e,2),n=t[0];return t[1].map((function(e){return{key:e,grouper:+n}}))})).sort(L);return(0,k.jsx)(I,(0,i.Z)({allArtifactKeysWithGrouper:l,selectedArtifactKeys:t,setArtifactKeys:n,getName:function(e){return c("artifactNames_gen:".concat(e))},getImage:function(e){return o(e).defIcon},label:c("artifact:autocompleteLabels.sets"),groupBy:function(e){var t,n;return null!==(t=null===(n=e.grouper)||void 0===n?void 0:n.toString())&&void 0!==t?t:""},renderGroup:function(e){return e.group&&(0,k.jsxs)(u.Z,{component:d.Z,children:[(0,k.jsxs)(f.Z,{sx:{top:"-1em"},children:[e.group," ",(0,k.jsx)(E.q,{stars:+e.group})]},"".concat(e.group,"Header")),e.children]},e.group)}},s))}function W(e){var t=e.mainStatKeys,n=e.setMainStatKeys,r=(0,a.Z)(e,O),s=(0,p.$)("artifact").t;return(0,k.jsx)(I,(0,i.Z)({allArtifactKeysWithGrouper:Z.r.map((function(e){return{key:e}})),selectedArtifactKeys:t,setArtifactKeys:n,getName:function(e){return m.ZP.getArtStr(e)},getImage:function(e){return _.Z[e]},label:s("autocompleteLabels.mainStats")},r))}function $(e){var t=e.substatKeys,n=e.setSubstatKeys,r=(0,a.Z)(e,T),s=(0,p.$)("artifact").t;return(0,k.jsx)(I,(0,i.Z)({allArtifactKeysWithGrouper:Z._.map((function(e){return{key:e}})),selectedArtifactKeys:t,setArtifactKeys:n,getName:function(e){return m.ZP.getArtStr(e)},getImage:function(e){return _.Z[e]},label:s("autocompleteLabels.substats")},r))}function N(e){var t=e.allArtifactKeysWithGrouper,n=e.selectedArtifactKey,r=e.setArtifactKey,c=e.getName,l=e.getImage,u=e.label,d=e.disable,f=void 0===d?function(){return!1}:d,p=e.showDefault,x=void 0!==p&&p,v=e.defaultText,m=void 0===v?"":v,j=(e.defaultIcon,(0,a.Z)(e,D)),Z=(0,s.Z)(),g=(0,h.useMemo)((function(){return(x?[{key:"",label:m}]:[]).concat(t.map((function(e){var t=e.key,n=e.grouper;return{key:t,label:c(t),grouper:n}})))}),[t,c,m,x]);return(0,k.jsx)(o.Z,(0,i.Z)({autoHighlight:!0,options:g,clearIcon:n?void 0:"",value:{key:n,label:c(n)},onChange:function(e,t,n){return("change"!==e.type||"clear"!==n)&&r(t?t.key:"")},getOptionLabel:function(e){return e.label?e.label:m},isOptionEqualToValue:function(e,t){return e.key===t.key},getOptionDisabled:function(e){return f(e.key)},renderInput:function(e){return(0,k.jsx)(P.Z,(0,i.Z)((0,i.Z)({},e),{},{label:u,startAdornment:l(n),hasValue:!!n}))},renderOption:function(e,t){return(0,k.jsx)(S,{value:t.key,image:l(t.key),text:t.label,theme:Z,isSelected:n===t.key,props:e},t.key)}},j))}function V(e){var t=e.artSetKey,n=e.setArtSetKey,s=e.label,o=void 0===s?"":s,c=(0,a.Z)(e,M),l=(0,j.Z)((function(){return x.y.getAll}),[]),h=(0,p.$)(["artifact","artifactNames_gen"]).t;if(o=o||h("artifact:autocompleteLabels.set"),!l)return null;var v=Object.entries(x.y.setKeysByRarities(l)).flatMap((function(e){var t=(0,r.Z)(e,2),n=t[0];return t[1].map((function(e){return{key:e,grouper:+n}}))})).sort(L);return(0,k.jsx)(N,(0,i.Z)({allArtifactKeysWithGrouper:v,selectedArtifactKey:t,setArtifactKey:n,getName:function(e){return e&&h("artifactNames_gen:".concat(e))},getImage:function(e){return e?l(e).defIcon:(0,k.jsx)(k.Fragment,{})},label:o,groupBy:function(e){var t,n;return null!==(t=null===(n=e.grouper)||void 0===n?void 0:n.toString())&&void 0!==t?t:""},renderGroup:function(e){return e.group&&(0,k.jsxs)(u.Z,{component:d.Z,children:[(0,k.jsxs)(f.Z,{sx:{top:"-1em"},children:[e.group," ",(0,k.jsx)(E.q,{stars:+e.group})]},"".concat(e.group,"Header")),e.children]},e.group)}},c))}function L(e,t){if(e.grouper>t.grouper)return-1;if(e.grouper<t.grouper)return 1;var n=v.Z.t("artifactNames_gen:".concat(e.key)),r=v.Z.t("artifactNames_gen:".concat(t.key));return n<r?-1:n>r?1:0}},21977:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(29439),i=n(57621),a=n(10889),s=n(72791),o=n(60393),c=n(10600),l=n(80184);function u(e){var t=e.levelLow,n=e.levelHigh,u=e.setLow,d=e.setHigh,f=e.setBoth,h=e.dark,p=void 0!==h&&h,x=e.disabled,v=void 0!==x&&x,m=e.showLevelText,j=void 0!==m&&m,Z=(0,s.useState)(t),g=(0,r.Z)(Z,2),y=g[0],b=g[1],w=(0,s.useState)(n),C=(0,r.Z)(w,2),k=C[0],S=C[1],P=(0,s.useCallback)((function(e,t){if("number"==typeof t)throw new TypeError;var n=(0,r.Z)(t,2),i=n[0],a=n[1];b(i),S(a)}),[b,S]);return(0,s.useEffect)((function(){return b(t)}),[b,t]),(0,s.useEffect)((function(){return S(n)}),[S,n]),(0,l.jsxs)(i.Z,{sx:{width:"100%",display:"flex",alignItems:"center",bgcolor:p?"contentDark.main":"contentLight.main"},children:[(0,l.jsx)(c.ZP,{value:y,onChange:function(e){return u((0,o.uZ)(e,0,n))},sx:{px:1,pl:j?2:void 0,width:j?100:50},inputProps:{sx:{textAlign:j?"right":"center"}},startAdornment:j?"Level: ":void 0,disabled:v}),(0,l.jsx)(a.ZP,{sx:{width:100,flexGrow:1,mx:2},getAriaLabel:function(){return"Arifact Level Range"},value:[y,k],onChange:P,onChangeCommitted:function(e,t){return f(t[0],t[1])},valueLabelDisplay:"auto",min:0,max:20,step:1,marks:!0,disabled:v}),(0,l.jsx)(c.ZP,{value:k,onChange:function(e){return d((0,o.uZ)(e,t,20))},sx:{px:1,width:50},inputProps:{sx:{textAlign:"center"}},disabled:v})]})}},18726:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(64554),i=n(20890),a=n(80184);function s(e){var t=e.avatar,n=e.title,s=e.action;return(0,a.jsxs)(r.Z,{display:"flex",gap:1,p:2,alignItems:"center",children:[t,(0,a.jsx)(i.Z,{variant:"subtitle1",sx:{flexGrow:1},children:n}),s&&(0,a.jsx)(i.Z,{variant:"caption",children:s})]})}},37503:function(e,t,n){"use strict";n.d(t,{X:function(){return R},Z:function(){return T}});var r=n(64554),i=n(20890),a=n(94721),s=n(72791),o=n(13746),c=n(60393),l=n(3992),u=n(18726),d=n(39504),f=n(88034),h=n(29439),p=n(72247),x=n(9912),v=n(24518),m=n(23786),j=n(2199),Z=n(97714),g=n(33890),y=n(25617),b=n(66624),w=n(80184);function C(e){var t=e.conditional,n=e.disabled,r=void 0!==n&&n;return 1===Object.keys(t.states).length&&"path"in t?(0,w.jsx)(k,{conditional:t,disabled:r}):"path"in t?(0,w.jsx)(S,{conditional:t,disabled:r}):(0,w.jsx)(P,{conditional:t,disabled:r})}function k(e){var t=e.conditional,n=e.disabled,r=(0,s.useContext)(Z.K),i=r.character,a=r.characterDispatch,l=(0,s.useContext)(o.R).data,u=(0,s.useCallback)((function(e){var n=(0,c.I8)(i.conditional);e?(0,c.SR)(n,t.path,e):(0,c.uH)(n,t.path),a({conditional:n})}),[t,i,a]),d=l.get(t.value).value,f=(0,h.Z)(Object.entries(t.states)[0],2),m=f[0],j=_(f[1].name),g=A(t.name);return(0,w.jsxs)(v.Z,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:d?"success":"primary",onClick:function(){return u(d?void 0:m)},disabled:n,startIcon:d?(0,w.jsx)(p.Z,{}):(0,w.jsx)(x.Z,{}),children:[g," ",j]})}function S(e){var t=e.conditional,n=e.disabled,r=(0,s.useContext)(Z.K),i=r.character,l=r.characterDispatch,u=(0,s.useContext)(o.R).data,d=(0,s.useCallback)((function(e){var n=(0,c.I8)(i.conditional);e?(0,c.SR)(n,t.path,e):(0,c.uH)(n,t.path),l({conditional:n})}),[t,i,l]),f=u.get(t.value).value,p=f?t.states[f]:void 0,x=p?_(p.name):(0,w.jsx)(y.Z,{color:"secondary",children:"Not Active"}),v=A(t.name);return(0,w.jsxs)(g.Z,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:f?"success":"primary",title:(0,w.jsxs)("span",{children:[v," ",x]}),disabled:n,children:[(0,w.jsx)(m.Z,{onClick:function(){return d()},selected:!p,disabled:!p,children:(0,w.jsx)("span",{children:"Not Active"})}),(0,w.jsx)(a.Z,{}),Object.entries(t.states).map((function(e){var t=(0,h.Z)(e,2),n=t[0],r=t[1];return(0,w.jsx)(m.Z,{onClick:function(){return d(n)},selected:f===n,disabled:f===n,children:r.name},n)}))]})}function P(e){var t=e.conditional,n=e.disabled,r=(0,s.useContext)(Z.K),i=r.character,a=r.characterDispatch,l=(0,s.useContext)(o.R).data,u=(0,s.useCallback)((function(e,t){var n=(0,c.I8)(i.conditional);t?(0,c.SR)(n,e,t):(0,c.uH)(n,e),a({conditional:n})}),[i,a]);return(0,w.jsx)(j.Z,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(t.states).map((function(e){var t=(0,h.Z)(e,2),r=t[0],i=t[1],a=l.get(i.value).value,s=a===r;return(0,w.jsx)(v.Z,{color:s?"success":"primary",disabled:n,fullWidth:!0,onClick:function(){return u(i.path,a?void 0:r)},size:"small",startIcon:s?(0,w.jsx)(p.Z,{}):(0,w.jsx)(x.Z,{}),sx:{borderRadius:0},children:A(i.name)},r)}))})}function E(e){return"string"!==typeof e}function _(e){if(!e)return"";var t="primary",n=e;return e&&E(e)&&e.props.color&&(t=e.props.color,n=(0,w.jsx)("span",{children:e.props.children})),(0,w.jsx)(y.Z,{sx:{ml:.5},color:t,children:n})}function A(e){if(E(e)){var t=e.props.key18,n=e.props.ns,r=e.props.values;return(0,w.jsx)(b.v,{ns:n,key18:t,values:r,useBadge:!0})}return e}function K(e){var t,n=e.conditional,r=e.hideHeader,i=void 0!==r&&r,a=e.hideDesc,u=void 0!==a&&a,h=(0,s.useContext)(o.R).data;if("path"in n){var p,x=h.get(n.value).value;t=x&&(null===(p=n.states[x])||void 0===p?void 0:p.fields)}else t=Object.values(n.states).flatMap((function(e){return h.get(e.value).value?e.fields:[]}));return(0,w.jsxs)(l.Z,{children:[!(0,c.mY)(i,n)&&(0,w.jsx)(R,{header:n.header,hideDesc:u}),(0,w.jsx)(d.Z,{sx:{p:0,"&:last-child":{pb:0}},children:(0,w.jsx)(C,{conditional:n})}),t&&(0,w.jsx)(f.ZP,{fields:t})]})}var O=n(55221);function T(e){var t=e.sections,n=e.teamBuffOnly,i=e.hideDesc,a=void 0!==i&&i,c=e.hideHeader,l=void 0!==c&&c,u=(0,s.useContext)(o.R).data;if(!t.length)return null;var d=t.map((function(e,t){return e.canShow&&!u.get(e.canShow).value||n&&!e.teamBuff?null:(0,w.jsx)(D,{section:e,hideDesc:a,hideHeader:l},t)})).filter((function(e){return e}));return d.length?(0,w.jsx)(r.Z,{display:"flex",flexDirection:"column",gap:1,children:d}):null}function D(e){var t=e.section,n=e.hideDesc,r=void 0!==n&&n,i=e.hideHeader,a=void 0!==i&&i;return"fields"in t?(0,w.jsx)(M,{section:t,hideDesc:r,hideHeader:a}):"states"in t?(0,w.jsx)(K,{conditional:t,hideDesc:r,hideHeader:a}):(0,w.jsx)(I,{section:t})}function M(e){var t=e.section,n=e.hideDesc,r=e.hideHeader;return(0,w.jsxs)(l.Z,{children:[!(0,c.mY)(r,t)&&t.header&&(0,w.jsx)(R,{header:t.header,hideDesc:n,hideDivider:0===t.fields.length}),(0,w.jsx)(f.ZP,{fields:t.fields})]})}function I(e){var t=e.section,n=(0,s.useContext)(o.R).data;return(0,w.jsx)("div",{children:(0,c.mY)(t.text,n)})}function R(e){var t=e.header,n=e.hideDesc,r=e.hideDivider,l=(0,s.useContext)(o.R).data,d=t.icon,f=t.title,h=t.action;d=(0,c.mY)(d,l);var p=!n&&(0,c.mY)(t.description,l),x=n?f:(0,w.jsxs)("span",{children:[f," ",(0,w.jsx)(O.Z,{title:(0,w.jsx)(i.Z,{children:p})})]});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{avatar:d,title:x,action:h}),!r&&(0,w.jsx)(a.Z,{})]})}},29371:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(29439),i=n(93433),a=n(2199),s=n(24518),o=n(23786),c=n(72791),l=n(22020),u=n(2139),d=n(60393),f=n(10600),h=n(33890),p=n(80184);function x(e){var t=e.level,n=e.ascension,x=e.setBoth,v=e.useLow,m=void 0!==v&&v,j=(0,l.$)("ui").t,Z=m?u.sU:u.SJ,g=(0,c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e=(0,d.uZ)(e,1,m?u.d8:u.Qq);var t=Z.findIndex((function(t){return e<=t}));x({level:e,ascension:t})}),[x,Z,m]),y=(0,c.useCallback)((function(){var e=Z.findIndex((function(e){return 90!==t&&t===e}));x(n===e?{ascension:n+1}:{ascension:e})}),[x,Z,n,t]);return(0,p.jsxs)(a.Z,{sx:{bgcolor:function(e){return e.palette.contentDark.main}},children:[(0,p.jsx)(f.CC,{children:(0,p.jsx)(f.ZP,{onChange:g,value:t,startAdornment:"Lv. ",inputProps:{min:1,max:90,sx:{textAlign:"center",width:"3em"}},sx:{height:"100%",pl:2}})}),(0,p.jsx)(s.Z,{sx:{pl:1,whiteSpace:"nowrap"},disabled:!(m?u.nB:u.ek)(t),onClick:y,children:(0,p.jsxs)("strong",{children:["/ ",u.SJ[n]]})}),(0,p.jsx)(h.Z,{title:j("selectlevel"),sx:{flexGrow:1},children:(0,i.Z)(m?u.vF:u.D4).map((function(e){var i=(0,r.Z)(e,2),a=i[0],s=i[1],c=a===t&&s===n;return(0,p.jsx)(o.Z,{selected:c,disabled:c,onClick:function(){return x({level:a,ascension:s})},children:a===Z[s]?"Lv. ".concat(a):"Lv. ".concat(a,"/").concat(Z[s])},"".concat(a,"/").concat(s))}))})]})}},6805:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(23786),i=n(22020),a=n(24351),s=n(33890),o=n(80184);function c(e){var t=e.refinement,n=e.setRefinement,c=(0,i.$)("ui").t;return(0,o.jsx)(s.Z,{title:c("refinement",{value:t}),children:a.a.map((function(e){return(0,o.jsx)(r.Z,{onClick:function(){return n(e)},selected:t===e,disabled:t===e,children:c("refinement",{value:e})},e)}))})}},92443:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(1413),i=n(45987),a=n(66934),s=n(24518),o=n(80184),c=["children","disabled"],l=(0,a.ZP)(s.Z)((function(e){var t=e.theme;return{"&.Mui-disabled":{backgroundColor:t.palette.primary.dark,color:t.palette.text.secondary}}}));function u(e){var t=e.children,n=(e.disabled,(0,i.Z)(e,c));return(0,o.jsx)(l,(0,r.Z)((0,r.Z)({},n),{},{disabled:!0,children:t}))}},84803:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(29439),i=n(24518),a=n(72791),s=n(22020),o=n(2380),c=n(97714),l=n(566),u=n(80184),d=a.lazy((function(){return Promise.all([n.e(65),n.e(564),n.e(621)]).then(n.bind(n,4332))}));function f(){var e,t=(0,s.$)("page_character").t,n=(0,a.useContext)(c.K).characterSheet,f=(0,a.useState)(!1),h=(0,r.Z)(f,2),p=h[0],x=h[1],v=(0,l.Z)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.Suspense,{fallback:!1,children:(0,u.jsx)(d,{show:p,onHide:function(){return x(!1)},onSelect:v})}),(0,u.jsx)(i.Z,{color:"info",onClick:function(){return x(!0)},startIcon:(0,u.jsx)(o.Z,{src:null===n||void 0===n?void 0:n.thumbImgSide}),children:null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:t("selectCharacter")})]})}},73800:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ro}});var r=n(30168),i=n(29439),a=n(63833),s=n(45781),o=n(35893),c=n(10284),l=n(66630),u=n(31289),d=n(68575),f=n(64554),h=n(47047),p=n(39504),x=n(25228),v=n(43896),m=n(24518),j=n(72791),Z=n(22020),g=n(43504),y=n(16871),b=n(3992),w=n(71310),C=n(68198),k=n(32490),S=n(29371),P=n(25617),E=n(97714),_=n(13746),A=n(60705),K=(0,j.createContext)({}),O=n(947),T=n(66101),D=n(24711),M=n(13434),I=n(50920),R=n(12761),W=n(42320),$=n(47639),N=n(72056),V=n(24351),L=n(40663),F=n(84803),B=n(37355),z=n(9585),G=n(94721),q=n(89673),H=n(55818),U=n(20890),J=n(3721),Y=n(63210),X=n(18726),Q=n(91702),ee=n(55942),te=n(9321),ne=n(8430),re=n(18327),ie=n(80184);function ae(){var e=(0,j.useContext)(A.M).modalOpen,t=(0,j.useContext)(A.M).setFormulaData,n=(0,j.useCallback)((function(){return null===t||void 0===t?void 0:t(void 0,void 0)}),[t]);return(0,ie.jsx)(te.Z,{open:!!e,onClose:n,children:(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(z.Z,{title:"Formulas & Calculations",action:(0,ie.jsx)(C.Z,{onClick:n})}),(0,ie.jsx)(p.Z,{sx:{pt:0},children:(0,ie.jsx)(se,{})})]})})}function se(){var e=(0,j.useContext)(_.R).data,t=(0,j.useContext)(A.M).data,n=(0,ne.U)(null!==t&&void 0!==t?t:e);return(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:1e3}),children:(0,ie.jsx)(f.Z,{sx:{mr:-1,mb:-1},children:n.map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(oe,{displayNs:r,sectionKey:n},n)}))})})}function oe(e){var t=e.sectionKey,n=e.displayNs,r=(0,j.useContext)(_.R).data,a=(0,j.useContext)(T.t).database,s=(0,j.useContext)(A.M).data,o=(0,W.Z)((function(){return(0,ne.f)(null!==s&&void 0!==s?s:r,t,a)}),[s,r,t]);if(!o)return null;if(Object.entries(n).every((function(e){var t=(0,i.Z)(e,2);t[0];return t[1].isEmpty})))return null;var c=o.title,l=o.icon,u=o.action;return(0,ie.jsxs)(w.Z,{sx:{mb:1},children:[(0,ie.jsx)(X.Z,{avatar:l&&(0,ie.jsx)(ee.Z,{size:2,sx:{m:-1},src:l}),title:c,action:u&&(0,ie.jsx)(P.Z,{children:u})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsx)(p.Z,{children:Object.entries(n).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return!r.isEmpty&&(0,ie.jsx)(ce,{node:r},n)}))})]})}function ce(e){var t=e.node,n=(0,j.useContext)(A.M).node,r=(0,j.useState)(!1),a=(0,i.Z)(r,2),s=a[0],o=a[1],c=(0,j.useCallback)((function(e,t){return o(t)}),[]),l=(0,j.useRef)();return(0,j.useEffect)((function(){t===n&&setTimeout((function(){var e,t;return null===l||void 0===l||null===(e=l.current)||void 0===e||null===(t=e.scrollIntoView)||void 0===t?void 0:t.call(e,{behavior:"smooth"})}),300)}),[l,t,n]),(0,ie.jsxs)(q.Z,{sx:{bgcolor:"contentDark.main"},expanded:t===n||s,onChange:c,ref:l,children:[(0,ie.jsxs)(H.Z,{expandIcon:(0,ie.jsx)(B.Z,{}),children:[(0,ie.jsxs)(U.Z,{children:[(0,ie.jsx)(Q.Z,{color:t.info.variant,children:t.info.name})," ",(0,ie.jsx)("strong",{children:(0,re.p)(t)})]}),V.jU.includes(t.info.variant)&&(0,ie.jsx)(f.Z,{sx:{display:"inline-block",ml:"auto",mr:2},children:(0,ie.jsx)(Y.Z,{reaction:t.info.variant,trigger:t.info.subVariant})})]}),(0,ie.jsx)(J.Z,{children:t.formulas.map((function(e,t){return(0,ie.jsx)(U.Z,{component:"div",children:e},t)}))})]})}var le,ue=n(93433),de=n(53767),fe=n(61889),he=n(15021),pe=n(1413),xe=n(49670),ve=n(72247),me=n(9912),je=n(81918),Ze=n(56125),ge=n(27235),ye=n(79406),be=n(45987),we=n(66934),Ce=n(13400),ke=["expand"],Se=(0,we.ZP)((function(e){e.expand;var t=(0,be.Z)(e,ke);return(0,ie.jsx)(Ce.Z,(0,pe.Z)({},t))}))((function(e){var t=e.theme;return{transform:e.expand?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}})),Pe=n(75545),Ee=n(2199),_e=n(10600),Ae=n(92443),Ke=["name","children","value","placeholder","defaultValue","onValueChange","percent","disabled","onReset"],Oe=(0,we.ZP)(Ee.Z)({display:"flex"});function Te(e){var t=e.name,n=e.children,r=e.value,i=e.placeholder,a=e.defaultValue,s=void 0===a?0:a,o=e.onValueChange,c=e.percent,l=void 0!==c&&c,u=e.disabled,d=void 0!==u&&u,f=e.onReset,h=(0,be.Z)(e,Ke);return(0,ie.jsxs)(Oe,(0,pe.Z)((0,pe.Z)({},h),{},{children:[n,(0,ie.jsx)(Ae.Z,{sx:{px:1},children:t}),(0,ie.jsx)(_e.CC,{sx:{flexBasis:"10em",flexGrow:1},children:(0,ie.jsx)(_e.ZP,{sx:{px:1},inputProps:{sx:{textAlign:"right"}},float:l,placeholder:i,value:r,onChange:o,disabled:d,endAdornment:l?"%":void 0})}),(0,ie.jsx)(m.Z,{sx:{flexShrink:2},size:"small",color:"error",onClick:function(){return f?f():o(s)},disabled:d||r===s,children:(0,ie.jsx)(xe.Z,{})})]}))}function De(){var e=(0,Z.$)("ui").t,t=(0,j.useContext)(E.K).characterDispatch,n=(0,j.useContext)(_.R).data,a=(0,j.useState)(!1),s=(0,i.Z)(a,2),o=s[0],c=s[1],l=(0,j.useCallback)((function(){return c(!o)}),[c,o]),u=n.get(ge.ri.enemy.level),d=n.get(ge.ri.enemy.defRed),h=n.get(ge.ri.enemy.defIgn),x=(0,j.useCallback)((function(){return t({enemyOverride:{}})}),[t]);return(0,ie.jsxs)(w.Z,{children:[(0,ie.jsxs)(p.Z,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[(0,ie.jsx)(je.Z,{size:"small",color:"success",label:(0,ie.jsxs)("span",{children:[u.info.name," ",(0,ie.jsx)("strong",{children:u.value})]})}),V.Kj.map((function(e){return(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(Me,{element:e})},e)})),(0,ie.jsxs)(U.Z,{children:["DEF Red. ",(0,re.p)(d)]}),(0,ie.jsxs)(U.Z,{children:["DEF Ignore ",(0,re.p)(h)]}),(0,ie.jsxs)(f.Z,{flexGrow:1,display:"flex",justifyContent:"flex-end",gap:1,children:[(0,ie.jsx)(m.Z,{size:"small",color:"error",onClick:x,startIcon:(0,ie.jsx)(xe.Z,{}),children:e(le||(le=(0,r.Z)(["reset"])))}),(0,ie.jsx)(Se,{expand:o,onClick:l,"aria-expanded":o,"aria-label":"show more",size:"small",sx:{marginLeft:0},children:(0,ie.jsx)(B.Z,{})})]})]}),(0,ie.jsx)(Ze.Z,{in:o,timeout:"auto",unmountOnExit:!0,children:(0,ie.jsx)(p.Z,{sx:{pt:0},children:(0,ie.jsx)(Ie,{})})})]})}function Me(e){var t=e.element,n=(0,j.useContext)(_.R).data.get(ge.ri.enemy["".concat(t,"_res_")]),r=!isFinite(n.value)?(0,ie.jsxs)("span",{children:[Pe.Z[t]," \u221e"]}):(0,ie.jsxs)("span",{children:[Pe.Z[t]," ",(0,ie.jsx)("strong",{children:(0,re.p)(n)})]});return(0,ie.jsx)(Q.Z,{color:t,children:r})}function Ie(e){var t,n,r,i=e.bsProps,a=void 0===i?{xs:12,md:6}:i,s=(0,j.useContext)(E.K),o=s.character.enemyOverride,c=s.characterDispatch,l=(0,j.useContext)(_.R).data,u=null!==(t=o.enemyLevel)&&void 0!==t?t:l.get(ge.ri.lvl).value,d=null!==(n=o.enemyDefIgn_)&&void 0!==n?n:0,f=null!==(r=o.enemyDefRed_)&&void 0!==r?r:0;return(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},a),{},{children:(0,ie.jsx)(m.Z,{fullWidth:!0,sx:{height:"100%"},size:"small",component:"a",color:"warning",href:"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances",target:"_blank",rel:"noreferrer",children:"To get the specific resistance values of enemies, please visit the wiki."})})),(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},a),{},{children:(0,ie.jsx)(Te,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,ie.jsx)("b",{children:ye.ZP.get("enemyLevel")}),value:u,placeholder:ye.ZP.getStr("enemyLevel"),defaultValue:l.get(ge.ri.lvl).value,onValueChange:function(e){return c({type:"enemyOverride",statKey:"enemyLevel",value:e})},onReset:function(){return c({type:"enemyOverride",statKey:"enemyLevel",value:void 0})}})})),V.Kj.map((function(e){var t="".concat(e,"_enemyRes_"),n=o[t],r=n===Number.MAX_VALUE;return(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},a),{},{children:(0,ie.jsx)(Te,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,ie.jsx)(Q.Z,{color:e,children:(0,ie.jsx)("b",{children:ye.ZP.get(t)})}),value:void 0!==n?r?1/0:n:10,placeholder:r?"\u221e ":ye.ZP.getStr(t),defaultValue:10,onValueChange:function(e){return c({type:"enemyOverride",statKey:t,value:e})},disabled:r,percent:!0,children:(0,ie.jsx)(m.Z,{color:e,onClick:function(){return c({type:"enemyOverride",statKey:t,value:r?10:Number.MAX_VALUE})},startIcon:r?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),children:"Immunity"})})}),e)})),(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},a),{},{children:(0,ie.jsx)(Te,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,ie.jsx)("b",{children:ye.ZP.get("enemyDefIgn_")}),value:d,placeholder:ye.ZP.getStr("enemyDefIgn_"),defaultValue:0,onValueChange:function(e){return c({type:"enemyOverride",statKey:"enemyDefIgn_",value:e})},percent:!0})})),(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},a),{},{children:(0,ie.jsx)(Te,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,ie.jsx)("b",{children:ye.ZP.get("enemyDefRed_")}),value:f,placeholder:ye.ZP.getStr("enemyDefRed_"),defaultValue:0,onValueChange:function(e){return c({type:"enemyOverride",statKey:"enemyDefRed_",value:e})},percent:!0})})),(0,ie.jsx)(fe.ZP,{item:!0,xs:12,children:(0,ie.jsx)("small",{children:"Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)"})})]})}var Re,We=n(88034),$e=n(43696),Ne={xs:1,md:2,lg:3};function Ve(e){var t=e.open,n=e.onClose,i=(0,Z.$)("page_character").t;return(0,ie.jsx)(te.Z,{open:t,onClose:n,children:(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(z.Z,{title:i(Re||(Re=(0,r.Z)(["addStats.title"]))),action:(0,ie.jsx)(C.Z,{onClick:n})}),(0,ie.jsx)(p.Z,{sx:{pt:0},children:(0,ie.jsxs)(de.Z,{spacing:1,children:[(0,ie.jsx)(Be,{}),(0,ie.jsx)(De,{}),(0,ie.jsx)(Ye,{})]})})]})})}var Le=(0,ue.Z)(ge.lR),Fe=function(e,t){return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:e},t)};function Be(){var e=(0,j.useContext)(E.K),t=e.character.bonusStats,n=e.characterDispatch,r=(0,j.useCallback)((function(e){return n({bonusStats:e})}),[n]);return(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{sx:{display:"flex"},children:(0,ie.jsx)(fe.ZP,{container:!0,columns:Ne,sx:{pt:1},spacing:1,children:(0,ie.jsx)($e.Z,{statKeys:Le,statFilters:t,setStatFilters:r,wrapperFunc:Fe})})})})}var ze=["eleMas","critRate_","critDMG_","enerRech_","heal_"],Ge=[].concat(["hp","atk","def"],ze).map((function(e){return ge.ri.total[e]})),qe=["atk_","atk","hp_","hp","def_","def"].concat(ze),He=[].concat((0,ue.Z)(ye.hX),(0,ue.Z)(ye.Sx),["stamina","incHeal_","shield_","cdRed_"]),Ue=ge.lR.filter((function(e){return!qe.includes(e)&&!He.includes(e)}));function Je(e){var t=e.nodes,n=e.extra,r=(0,j.useContext)(_.R),i=r.data,a=r.oldData;return(0,ie.jsxs)(We.lD,{children:[t.map((function(e){var t;return(0,ie.jsx)(We.JW,{component:he.ZP,node:i.get(e),oldValue:null===a||void 0===a||null===(t=a.get(e))||void 0===t?void 0:t.value},JSON.stringify(e.info))})),n]})}function Ye(){var e=(0,j.useContext)(E.K).characterSheet,t=(0,j.useContext)(_.R).data,n=t.get(ge.ri.special),r=e.elementKey,i=e.isMelee(),a=(0,j.useMemo)((function(){return He.filter((function(e){return!e.includes(r)&&(i&&e.includes("physical"),!0)})).map((function(e){return ge.ri.total[e]})).filter((function(e){return!!t.get(e).value}))}),[t,r,i]),s=(0,j.useMemo)((function(){return Ue.map((function(e){return ge.ri.total[e]})).filter((function(e){return t.get(e).value}))}),[t]);return(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,columns:Ne,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(Xe,{title:"Main Stats",children:(0,ie.jsx)(Je,{nodes:Ge,extra:n&&(0,ie.jsxs)(he.ZP,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,ie.jsxs)("span",{children:[(0,ie.jsx)("b",{children:"Special:"})," ",(0,ie.jsxs)(Q.Z,{color:n.info.variant,children:[n.info.icon," ",n.info.name]})]}),(0,ie.jsx)("span",{children:(0,re.p)(n)})]})})})}),(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(Xe,{title:"Other Stats",children:(0,ie.jsx)(Je,{nodes:a})})}),!!s.length&&(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(Xe,{title:"Misc Stats",children:(0,ie.jsx)(Je,{nodes:s})})})]})})})}function Xe(e){var t=e.title,n=e.children;return(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(p.Z,{sx:{py:1},children:(0,ie.jsx)(f.Z,{display:"flex",justifyContent:"space-between",children:(0,ie.jsx)(U.Z,{variant:"subtitle1",children:t})})}),n]})}var Qe=n(74165),et=n(37762),tt=n(15861),nt=n(96739),rt=n(59496),it=n(94070),at=n(50533),st=n(23786),ot=n(90388),ct=n(76899),lt=n(21977),ut=n(96106),dt=n(30865),ft=n(33890),ht=n(91839),pt=n(78661),xt=n(69292),vt=n(64737),mt=n(4942),jt=n(60393);function Zt(e,t){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,i=0;i<5;i++){for(var a="",s=0;s<e;s++)a+=n.charAt(Math.floor(Math.random()*r));if(!t||!t.includes(a))return a}throw Error("Too many collisions in `makeid`")}function gt(e){return{operation:"read",operands:[],path:["dyn",e],type:"number",accu:"add"}}function yt(e){return"const"===e.operation||"read"===e.operation||"threshold"===e.operation||"add"===e.operation&&e.operands.every((function(e){return"const"===e.operation||"read"===e.operation||"threshold"===e.operation}))}function bt(e,t){delete e.base[t],e.values.flower.forEach((function(e){return delete e.values[t]})),e.values.plume.forEach((function(e){return delete e.values[t]})),e.values.sands.forEach((function(e){return delete e.values[t]})),e.values.goblet.forEach((function(e){return delete e.values[t]})),e.values.circlet.forEach((function(e){return delete e.values[t]}))}function wt(e,t){var n=Object.keys(e.base),r={};function a(e,t){if(!yt(e))throw Error("`distribute` only works on shallow node type.");if(1===t)return e;switch(e.operation){case"threshold":var s=(0,i.Z)(e.operands,4),o=s[0],c=s[1],l=s[2],u=s[3];if("read"===o.operation)return(0,pt.Lj)(o,c,$t([l,(0,pt.a9)(t)]),$t([u,(0,pt.a9)(t)]),{source:o.path[1]});throw console.log(e),Error("branch is not read...?");case"const":return(0,pt.a9)(t*e.value);case"add":return pt.Sm.apply(void 0,(0,ue.Z)(e.operands.map((function(e){return a(e,t)}))));case"read":var d=Zt(5,[].concat((0,ue.Z)(n),(0,ue.Z)(Object.keys(r))));return r[d]={base:0,coeff:t,sumKeys:[e.path[1]]},gt(d);default:throw Error("Should not reach here...")}}for(var s=(0,vt.uW)(t,(function(e){return e}),(function(e){switch(e.operation){case"mul":var t=e.operands;if(t.some((function(e){return"mul"===e.operation}))){var i=t.filter((function(e){return"mul"===e.operation})).flatMap((function(e){return(0,ue.Z)(e.operands)})),s=t.filter((function(e){return"mul"!==e.operation}));t=[].concat((0,ue.Z)(s),(0,ue.Z)(i))}if(t.every(yt)&&t.some((function(e){return"const"===e.operation}))){var o=t.reduce((function(e,t){return"const"===t.operation?e*t.value:e}),1),c=t.filter((function(e){return"const"!==e.operation}));if(0===c.length)return(0,pt.a9)(o);var l=a(c.pop(),o);return 0===c.length?l:pt.WV.apply(void 0,[l].concat((0,ue.Z)(c)))}return e;case"add":var u=e.operands;if(u.some((function(e){return"add"===e.operation}))){var d=u.filter((function(e){return"add"===e.operation})).flatMap((function(e){return(0,ue.Z)(e.operands)})),f=u.filter((function(e){return"add"!==e.operation}));u=[].concat((0,ue.Z)(f),(0,ue.Z)(d))}if(u.filter((function(e){return"const"===e.operation||"read"===e.operation})).length>1){var h=u.filter((function(e){return"const"!==e.operation&&"read"!==e.operation})),p=u.filter((function(e){return"const"===e.operation||"read"===e.operation})),x=Zt(5,[].concat((0,ue.Z)(n),(0,ue.Z)(Object.keys(r)))),v=p.reduce((function(e,t){return"const"===t.operation?e+t.value:e}),0),m=p.map((function(e){return"read"===e.operation?e.path[1]:void 0})).filter((function(e){return e}));return r[x]={base:v,coeff:1,sumKeys:m},0===h.length?gt(x):pt.Sm.apply(void 0,(0,ue.Z)(h).concat([gt(x)]))}return e;default:return e}})),o=new Set(Object.keys(e.base)),c=Object.entries(r),l=function(){var t=c.shift(),n=(0,i.Z)(t,2),r=n[0],a=n[1],s=a.base,l=a.coeff,u=a.sumKeys;if(!u.every((function(e){return o.has(e)})))return c.push([r,{base:s,coeff:l,sumKeys:u}]),"continue";var d=function(e){return l*u.reduce((function(t,n){return t+e[n]}),0)};e.base[r]=s+d(e.base),e.values.flower.forEach((function(e){return e.values[r]=d(e.values)})),e.values.plume.forEach((function(e){return e.values[r]=d(e.values)})),e.values.sands.forEach((function(e){return e.values[r]=d(e.values)})),e.values.goblet.forEach((function(e){return e.values[r]=d(e.values)})),e.values.circlet.forEach((function(e){return e.values[r]=d(e.values)})),o.add(r)};c.length>0;)l();var u=new Set(o);return(0,vt.aD)(s,(function(e){}),(function(e){"read"===e.operation&&u.delete(e.path[1])})),u.forEach((function(t){return bt(e,t)})),{a:e,nodes:s}}function Ct(e,t){var n=function(e){var t=(0,pe.Z)({},e.base),n=(0,pe.Z)({},e.base);return Object.entries(e.values).forEach((function(e){var r=(0,i.Z)(e,2),a=(r[0],function(e){if(0===e.length)return{statsMin:{},statsMax:{}};var t=Object.keys(e[0].values),n={},r={},a=new Set;t.forEach((function(e){n[e]=1/0,r[e]=-1/0}));for(var s=0;s<e.length;s++){for(var o=0;o<t.length;o++){var c=t[o];n[c]=Math.min(e[s].values[c],n[c]),r[c]=Math.max(e[s].values[c],r[c])}e[s].set&&a.add(e[s].set)}if(a.forEach((function(e){r[e]=1,n[e]=0})),1===a.size){var l=(0,i.Z)(a,1)[0];n[l]=1}return{statsMin:n,statsMax:r}}(r[1])),s=a.statsMin,o=a.statsMax;Object.keys(s).forEach((function(e){var r,i;t[e]=s[e]+(null!==(r=t[e])&&void 0!==r?r:0),n[e]=o[e]+(null!==(i=n[e])&&void 0!==i?i:0)}))})),{statsMin:t,statsMax:n}}(e),r=n.statsMin,a=n.statsMax;t=function(e,t,n){var r=Object.keys(t).filter((function(e){return t[e]===n[e]})),a=(0,vt.uW)(e,(function(e){return e}),(function(e){switch(e.operation){case"add":return Wt(e.operands);case"mul":return $t(e.operands);case"read":return r.includes(e.path[1])?(0,pt.a9)(t[e.path[1]]):e;case"threshold":var a=(0,i.Z)(e.operands,4),s=a[0],o=a[1],c=a[2],l=a[3];if("const"===s.operation&&"const"===o.operation)return s.value>=o.value?c:l;if("read"===s.operation&&"const"===o.operation){if(t[s.path[1]]>=o.value)return c;if(n[s.path[1]]<o.value)return l}return e;case"min":case"max":case"res":case"sum_frac":if(e.operands.every((function(e){return"const"===e.operation}))){var u=xt.aj[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})));return(0,pt.a9)(u)}return e;default:return e}}));return a}(t,r,a);var s=wt(e,t);e=s.a,t=s.nodes;for(var o=Object.keys(e.base),c=[e.base].concat((0,ue.Z)(Object.values(e.values).flatMap((function(e){return e.map((function(e){return e.values}))})))),l=o.length,u=c.length,d=o.map((function(e){return c.map((function(t){return t[e]}))})),f=Array(l).fill(0).map((function(e){return Array(l).fill(0)})),h=0;h<l;h++)f[h][h]=1;for(var p=new Set,x=function(e){for(var t=-1,n=0;n<l;n++)if(!p.has(n)&&Math.abs(d[n][e])>1e-8){t=n;break}if(t<0)return"continue";p.add(t);for(var r=t,i=0;i<l;i++)p.has(i)||Math.abs(d[i][e])>1e-8&&function(){var t=d[i][e]/d[r][e];d[i]=d[i].map((function(e,n){return e-t*d[r][n]})),f[i]=f[i].map((function(e,n){return e-t*f[r][n]}))}();return p.size===l?"break":void 0},v=0;v<u;v++){var m=x(v);if("continue"!==m&&"break"===m)break}if(p.size===l)return{a:e,nodes:t};for(var j=function(n){if(!p.has(n)){var r=f[n].map((function(e,t){return{w:t===n?0:-e,key:o[t]}})).filter((function(e){var t=e.w;return Math.abs(t)>1e-8}));if(r.some((function(e){return e.w<0})))return"continue";var i=Wt(r.map((function(e){var t=e.w,n=e.key;return 1===t?gt(n):(0,pt.WV)(t,gt(n))})));t=(0,vt.uW)(t,(function(e){return e}),(function(e){return"read"===e.operation&&e.path[1]===o[n]?i:e})),bt(e,o[n])}},Z=0;Z<l;Z++)j(Z);return{a:e,nodes:t}}function kt(e){return(0,vt.uW)(e,(function(e){return e}),(function(e){if("threshold"===e.operation){var t=(0,i.Z)(e.operands,4),n=t[0],r=t[1],a=t[2],s=t[3];if("const"===n.operation&&"const"===r.operation)return n.value>=r.value?a:s;if("threshold"===n.operation&&"const"===r.operation){var o=(0,i.Z)(n.operands,4),c=o[0],l=o[1],u=o[2],d=o[3];if("read"===c.operation&&"const"===l.operation&&"const"===u.operation&&"const"===d.operation){var f=u.value>=r.value?a:s,h=d.value>=r.value?a:s;return console.log("non-stacking buff",e,(0,pt.Lj)(c,l,f,h)),(0,pt.Lj)(c,l,f,h)}throw console.log("faulty node:",e),Error("Not Implemented: nested threshold must follow the form [read, const, const, const]")}if("const"!==a.operation||"const"!==s.operation){if("const"===s.operation&&0===s.value)return(0,pt.WV)((0,pt.Lj)(n,r,1,0),a);throw console.log("faulty node:",e),Error("Not Implemented: threshold() node with non-constant `pass` AND non-zero `fail`")}if("read"!==n.operation)throw console.log("faulty node:",e),Error("Not Implemented: threshold() node with non-read `branch`");return e}return e}))}function St(e){if("add"===e.operation)return e.operands.map((function(e){return St(e)})).reduce((function(e,t){return Object.entries(t).forEach((function(t){var n,r=(0,i.Z)(t,2),a=r[0],s=r[1];return e[a]=Math.min(s,null!==(n=e[a])&&void 0!==n?n:0)})),e}),{});if("mul"===e.operation)return e.operands.map((function(e){return St(e)})).reduce((function(e,t){return Object.entries(t).forEach((function(t){var n,r=(0,i.Z)(t,2),a=r[0],s=r[1];return e[a]=Math.max(s,null!==(n=e[a])&&void 0!==n?n:0)})),e}),{});if("threshold"===e.operation){var t=e.operands[0];if("read"===t.operation&&V.q2.includes(t.path[1])){var n=e.operands[1];return(0,mt.Z)({},t.path[1],n.value)}}return{}}function Pt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.flat()}function Et(){return jt.Og.apply(void 0,arguments).map((function(e){return e.reduce((function(e,t){var n;return e.coeff*=t.coeff,(n=e.terms).push.apply(n,(0,ue.Z)(t.terms)),e}),{coeff:1,terms:[]})}))}function _t(e){return[{coeff:e,terms:[]}]}function At(e){return[{coeff:1,terms:[e]}]}function Kt(e){var t=(0,ue.Z)(e);t.forEach((function(e){return e.terms.sort()})),t.sort((function(e,t){var n=e.terms,r=t.terms;if(n.length!==r.length)return n.length-r.length;for(var i=0;i<n.length;i++)if(n[i]!==r[i])return n[i]<r[i]?-1:1;return 0}));for(var n=function(e){var n,r,i=t[e].terms,a=t[e+1].terms;if(i.length!==a.length)return"continue";i.every((function(e,t){return e===a[t]}))&&(t[e].coeff=(null!==(n=t[e].coeff)&&void 0!==n?n:0)+(null!==(r=t[e+1].coeff)&&void 0!==r?r:0),t.splice(e+1,1))},r=t.length-2;r>=0;r--)n(r);return t}function Ot(e,t){var n={},r={},a=null!==t&&void 0!==t?t:[];function s(e){for(var t=(0,pt.PX)(e),i=n[t];void 0!==i;){if((0,pt.NY)(i.n,e))return i.tag;i=i.next}var s=Zt(10,a);return n[t]={n:e,tag:s,next:n[t]},r[s]=e,a.push(s),s}var o={};(0,vt.aD)([e],(function(e){}),(function(e){"read"===e.operation&&(o[e.path[1]]=s(e))}));var c=Kt(function e(t){switch(t.operation){case"add":return Pt.apply(void 0,(0,ue.Z)(t.operands.map(e)));case"mul":return Et.apply(void 0,(0,ue.Z)(t.operands.map(e)));case"const":return _t(t.value);default:return At(s(t))}}(e));return function(e){var t=e.terms,n=e.nodes,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=Object.fromEntries(Object.entries(n).map((function(e){var t=(0,i.Z)(e,2);return[t[0],St(t[1])]})));return{terms:t=t.filter((function(e){var t=e.terms.reduce((function(e,t){return Object.entries(a[t]).forEach((function(t){var n,r=(0,i.Z)(t,2),a=r[0],s=r[1];return e[a]=Math.max(s,null!==(n=e[a])&&void 0!==n?n:0)})),e}),{});return Object.values(t).reduce((function(e,t){return e+t}),0)<=r})),nodes:n}}({terms:c,nodes:r})}function Tt(e,t){for(var n=t.i,r=t.j,i=e[n][r],a=0;a<e.length;a++)if(a!==n)for(var s=0;s<e[0].length;s++)s!==r&&(e[a][s]-=e[n][s]*e[a][r]/i);for(var o=0;o<e.length;o++)o!==n&&(e[o][r]=-e[o][r]/i);for(var c=0;c<e[0].length;c++)c!==r&&(e[n][c]=e[n][c]/i);e[n][r]=1/i}function Dt(e){for(var t=e.length,n=e[0].length,r={i:-1,j:-1,cmp:1/0},i=0;i<n-1;i++)if(!(e[t-1][i]>=0)){for(var a=0;a<t-1;a++)if(e[a][i]>1e-5){var s=e[a][n-1]/e[a][i];s<r.cmp&&(r={i:a,j:i,cmp:s})}if(r.i<0)throw Error("UNBOUNDED FEASIBLE")}if(r.i<0)throw Error("NO PIVOTS (done)");return{i:r.i,j:r.j}}function Mt(e){for(var t=e.length,n=e[0].length,r={i:-1,j:-1,cmp:1/0},i=0;i<t-1;i++)if(!(e[i][n-1]>=0)){for(var a=0;a<n-1;a++)if(e[i][a]<-1e-5){var s=e[i][n-1]/e[i][a];s<r.cmp&&(r={i:i,j:a,cmp:s})}if(r.i<0)throw Error("INFEASIBLE");return{i:r.i,j:r.j}}throw Error("NO PIVOTS (done)")}function It(e,t,n){var r=(0,xt.I3)([e],{},(function(e){return e.path[1]}),1);return[r([{id:"",values:t}])[0],r([{id:"",values:n}])[0]]}function Rt(e,t,n){var r=e.nodes,a=e.terms,s={};Object.entries(r).forEach((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];"read"===r.operation&&(s[r.path[1]]=n)}));function o(e){switch(e.operation){case"const":return _t(e.value);case"read":return At(s[e.path[1]]);case"add":return Pt.apply(void 0,(0,ue.Z)(e.operands.map(o)));case"mul":return Et.apply(void 0,(0,ue.Z)(e.operands.map(o)));case"threshold":var r=(0,i.Z)(e.operands,4),a=r[0],c=r[1],l=r[2],u=r[3];if("read"===a.operation&&"const"===c.operation&&"const"===u.operation&&"const"===l.operation){if(l.value<u.value)throw console.log(e),Error("Not Implemented (threshold must be increasing)");var d=a.path[1];if(t[d]>=c.value)return _t(l.value);if(n[d]<c.value)return _t(u.value);var f=(l.value-u.value)/(c.value-t[d]),h=Et(_t(f),At(s[a.path[1]])),p=u.value-f*t[d];return 0===p?h:Pt(_t(p),h)}throw console.log(e),Error("Not Implemented (threshold must branch between constants)");case"res":var x=function(e,t,n){var r=function e(t){switch(t.operation){case"add":return pt.Sm.apply(void 0,(0,ue.Z)(t.operands.map((function(t){return e(t)}))));case"const":return(0,pt.a9)(-t.value);case"threshold":var n=(0,i.Z)(t.operands,4),r=n[0],a=n[1],s=n[2],o=n[3];if("const"===s.operation&&"const"===o.operation&&s.value<=o.value)return(0,pt.Lj)(r,a,-s.value,-o.value);throw console.log(t),Error("(res neg slope): threshold. Something went wrong.");default:throw console.log(t),Error("(res neg slope) Havent written logic to handle this")}}(e.operands[0]),a=It(r,t,n),s=(0,i.Z)(a,2),o=s[0],c=s[1],l=xt.aj.res,u=[l([-o]),l([-c])],d=u[0],f=u[1];if(c>0&&o>-1.75)return(0,pt.Sm)(1,(0,pt.WV)(.5,r));var h=(c*d-o*f)/(c-o),p=(d-f)/(c-o);return(0,pt.Sm)(h,(0,pt.WV)(p,r))}(e,t,n);return o(x);case"min":case"max":var v=(0,i.Z)(e.operands,2),m=v[0],j=v[1];if("const"!==j.operation){var Z=[j,m];m=Z[0],j=Z[1]}if("min"===e.operation)return o(m);if("const"===j.operation){var g=j.value,y=It(m,t,n),b=(0,i.Z)(y,2),w=b[0],C=b[1];if(w>g)return o(m);if(g>C)return _t(g);var k=(C-g)/(C-w);return Pt(_t(g-k*w),Et(_t(k),o(m)))}throw console.log(e),Error("Not Implemented (max between two non-constants)");case"sum_frac":var S=(0,i.Z)(e.operands,2),P=S[0],E=S[1];if("const"!==E.operation)throw Error("Not Implemented (non-constant sum_frac denominator)");var _=It(P,t,n),A=(0,i.Z)(_,2),K=A[0],O=A[1],T=E.value,D=Math.sqrt((K+T)*(O+T))-T,M=(T+D)*(T+D),I=T/M;return Pt(_t(D*D/M),Et(_t(I),o(P)));default:throw console.log(e),Error("Not Implemented")}}var c=Object.fromEntries(Object.entries(r).filter((function(e){var t=(0,i.Z)(e,2);t[0];return"read"!==t[1].operation})).map((function(e){var t=(0,i.Z)(e,2);return[t[0],o(t[1])]}))),l=a.flatMap((function(e){var t=e.coeff,n=e.terms;return Et.apply(void 0,[_t(t)].concat((0,ue.Z)(n.map((function(e){var t;return null!==(t=c[e])&&void 0!==t?t:At(e)})))))}));l=(l=Kt(l)).map((function(e){var t=e.coeff,n=e.terms;return{coeff:t,terms:n=n.map((function(e){var t=r[e];if(!t||"read"!==t.operation)throw Error("MUST be a read node.");return t.path[1]}))}}));var u=l.map((function(e){var r=e.coeff,i=e.terms;if(0===i.length)return{w:{},c:r,err:0};if(1===i.length)return{w:(0,mt.Z)({},i[0],r),c:0,err:0};var a=function(e){if(0===e.length)return{w:[],c:0,err:0};var t=e.length,n=e.map((function(e){return e.upper})),r=n.reduce((function(e,t){return e*t}),1);e=e.map((function(e){return{lower:e.lower/e.upper,upper:1}}));var i,a=jt.Og.apply(void 0,(0,ue.Z)(e.map((function(e){return[e.lower,e.upper]})))).flatMap((function(e){var t=e.reduce((function(e,t){return e*t}),1);return[[].concat((0,ue.Z)(e.map((function(e){return-e}))),[1,0,-t]),[].concat((0,ue.Z)(e),[-1,-1,t])]})),s=[].concat((0,ue.Z)(e.map((function(e){return 0}))),[0,1]);try{i=function(e,t){var n=t.length+1,r=t[0].length,i=Array(n).fill(0).map((function(e){return Array(r).fill(0)}));t.forEach((function(e,t){return e.forEach((function(e,n){return i[t][n]=e}))})),e.forEach((function(e,t){return i[n-1][t]=e}));for(var a=[];i.some((function(e,t){return t<n-1&&e[r-1]<0}));){var s=Mt(i);a.push(s),Tt(i,s)}for(;i[n-1].some((function(e,t){return t<r-1&&e<0}));){var o=Dt(i);a.push(o),Tt(i,o)}return e.map((function(e,t){return function(e,t,n){var r=1;t.forEach((function(e){var t=e.i,i=e.j;1===r&&i===n?(n=t,r=0):0===r&&t===n&&(n=i,r=1)}));var i=e[0].length;return 0===r?e[n][i-1]:0}(i,a,t)}))}(s,a)}catch(o){throw console.log("ERROR on bounds",e),console.log("Possibly numerical instability issue."),o}return{w:i.slice(0,t).map((function(e,t){return e*r/n[t]})),c:-r*i[t],err:r*i[t+1]}}(i.map((function(e){return{lower:t[e],upper:n[e]}}))),s=a.w,o=a.c,c=a.err;return{w:s.reduce((function(e,t,n){var a;return e[i[n]]=t*r+(null!==(a=e[i[n]])&&void 0!==a?a:0),e}),{}),c:r*o,err:r*c+0}}));return u.reduce((function(e,t){return e.c+=t.c,e.err+=t.err,Object.entries(t.w).forEach((function(t){var n,r=(0,i.Z)(t,2),a=r[0],s=r[1];return e.w[a]=s+(null!==(n=e.w[a])&&void 0!==n?n:0)})),e}),{w:{},c:0,err:0})}function Wt(e){if(1===e.length)return e[0];var t=(e=e.flatMap((function(e){return"add"===e.operation?e.operands:e}))).reduce((function(e,t){return"const"===t.operation?e+t.value:e}),0);return 0===(e=e.filter((function(e){return"const"!==e.operation}))).length?(0,pt.a9)(t):0===t?1===e.length?e[0]:pt.Sm.apply(void 0,(0,ue.Z)(e)):pt.Sm.apply(void 0,(0,ue.Z)(e).concat([(0,pt.a9)(t)]))}function $t(e){if(1===e.length)return e[0];var t=(e=e.flatMap((function(e){return"mul"===e.operation?e.operands:e}))).reduce((function(e,t){return"const"===t.operation?e*t.value:e}),1);return 0===(e=e.filter((function(e){return"const"!==e.operation}))).length?(0,pt.a9)(t):1===t?pt.WV.apply(void 0,(0,ue.Z)(e)):pt.WV.apply(void 0,(0,ue.Z)(e).concat([(0,pt.a9)(t)]))}function Nt(e,t){return e=(0,vt.uW)(e,(function(e){return e}),(function(e){if("threshold"===e.operation){var n=(0,i.Z)(e.operands,4),r=n[0],a=n[1],s=n[2],o=n[3];if("read"===r.operation&&"const"===a.operation){var c=r.path[1];if(void 0!==t[c]){var l=t[c];if(2===a.value&&l.includes(2))return l.includes(4)?o:(0,pt.Lj)(r,4,s,o);if(4===a.value&&l.includes(4))return o}}return e}return e}))}var Vt=(0,j.createContext)(void 0),Lt=n(53960),Ft=n(73036),Bt=n(566),zt=n(68544),Gt=n(70645),qt=n(9138);function Ht(e,t,n,r,i,a){for(var s=a,o={pruneNodeRange:!0},c={pruneNodeRange:!0},l={reaffine:!0},u={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0},d=0;Object.values(s).some((function(e){return e}))&&d++<20;){if(s.pruneOrder){delete s.pruneOrder;var f=Yt(n,r,i);n!==f&&(n=f,s=(0,pe.Z)((0,pe.Z)({},s),o))}if(s.pruneArtRange){delete s.pruneArtRange;var h=Xt(e,n,t);n!==h&&(n=h,s=(0,pe.Z)((0,pe.Z)({},s),c))}if(s.pruneNodeRange){delete s.pruneNodeRange;var p=Qt(e,n);e!==p&&(e=p,s=(0,pe.Z)((0,pe.Z)({},s),l))}if(s.reaffine){delete s.reaffine;var x=Jt(e,n),v=x.nodes,m=x.arts;e===v&&n===m||(e=v,n=m,s=(0,pe.Z)((0,pe.Z)({},s),u))}}return{nodes:e,arts:n}}function Ut(e,t){for(var n={},r=0,a=Object.entries(t);r<a.length;r++){var s=(0,i.Z)(a[r],2),o=s[0],c=s[1];c.includes(4)&&(n[o]=c.includes(2)?1:3)}return(0,vt.uW)(e,(function(e){return e}),(function(e){if("threshold"!==e.operation)return e;var r=(0,i.Z)(e.operands,4),a=r[0],s=r[1],o=r[2],c=r[3];if("read"===a.operation&&"const"===s.operation){var l=a.path[a.path.length-1],u=s.value;if(l in n){if(n[l]<u)return c;if(2===u&&t[l].includes(2))return(0,pt.Lj)(a,4,o,c)}}return e}))}function Jt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new Set,a=new Set;function s(e,t){t?r.add(e):e.operands.forEach((function(e){return r.has(e)&&a.add(e)}))}var o=new Set;if((0,vt.aD)(e,(function(e){}),(function(e){var t=e.operation;switch(t){case"read":o.add(e.path[1]),s(e,!0);break;case"add":s(e,e.operands.every((function(e){return r.has(e)})));break;case"mul":var n=e.operands.filter((function(e){return"const"!==e.operation}));s(e,0===n.length||1===n.length&&r.has(n[0]));break;case"const":s(e,!0);break;case"res":case"threshold":case"sum_frac":case"max":case"min":s(e,!1);break;default:(0,jt.UT)(t)}})),(0,ue.Z)(a).every((function(e){var t=e.operation;return"read"===t||"const"===t}))&&Object.keys(t.base).length===o.size)return{nodes:e,arts:t};var c=-1;function l(){for(;o.has("".concat(++c)););return"".concat(c)}e.forEach((function(e){return r.has(e)&&a.add(e)}));var u=(0,ue.Z)(a).filter((function(e){return"const"!==e.operation})),d=new Map(u.map((function(e){return[e,n||"read"!==e.operation||"dyn"!==e.path[0]?(0,pe.Z)((0,pe.Z)({},(0,pt.UF)(["dyn","".concat(l())])),{},{accu:"add"}):e]})));function f(e){var t=(0,xt.CG)((0,ue.Z)(d.keys()),{dyn:(0,jt.xh)(e,(function(e){return(0,pt.a9)(e)}))},(function(e){return!0}));return Object.fromEntries((0,ue.Z)(d.values()).map((function(e,n){return[e.path[1],t[n].value]})))}for(var h={nodes:e=(0,vt.uW)(e,(function(e){var t;return null!==(t=d.get(e))&&void 0!==t?t:e}),(function(e){return e})),arts:{base:f(t.base),values:(0,jt.O)(V.eV,(function(e){return t.values[e].map((function(e){return{id:e.id,set:e.set,values:f(e.values)}}))}))}},p=Object.entries(f({})),x=0,v=Object.values(h.arts.values);x<v.length;x++){var m,j=v[x],Z=(0,et.Z)(j);try{for(Z.s();!(m=Z.n()).done;){var g,y=m.value.values,b=(0,et.Z)(p);try{for(b.s();!(g=b.n()).done;){var w=(0,i.Z)(g.value,2),C=w[0],k=w[1];y[C]-=k}}catch(S){b.e(S)}finally{b.f()}}}catch(S){Z.e(S)}finally{Z.f()}}return h}function Yt(e,t,n){var r,a=!1,s=!(null!==(r=n.rainbow)&&void 0!==r&&r.length),o=Object.keys(e.base),c=new Set(Object.entries(n).filter((function(e){var t=(0,i.Z)(e,2);t[0];return t[1].length})).map((function(e){return(0,i.Z)(e,1)[0]}))),l=new Set(Object.entries(n).filter((function(e){var t=(0,i.Z)(e,2),n=(t[0],t[1]);return n.includes(2)&&!n.includes(4)})).map((function(e){return(0,i.Z)(e,1)[0]}))),u=(0,jt.O)(V.eV,(function(n){var r=e.values[n],i=r.filter((function(e){var n=0;return r.every((function(r){var i=o.every((function(t){var n,i;return(null!==(n=r.values[t])&&void 0!==n?n:0)>=(null!==(i=e.values[t])&&void 0!==i?i:0)})),a=o.some((function(t){var n,i;return(null!==(n=r.values[t])&&void 0!==n?n:0)>(null!==(i=e.values[t])&&void 0!==i?i:0)})),u=i&&(a||r.id>e.id),d=s&&!c.has(r.set)&&!l.has(e.set)||e.set===r.set;return u&&d&&n++,n<t}))}));return i.length!==r.length&&(a=!0),i}));return a?{base:e.base,values:u}:e}function Xt(e,t,n){for(var r=Object.fromEntries(Object.entries(t.base).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return[n,{min:r,max:r}]}))),a={arts:t},s=function(){var t=(0,jt.O)(V.eV,(function(e){return tn(a.arts.values[e])})),i=(0,jt.O)(V.eV,(function(e){return en(Object.entries(t).map((function(t){return t[0]===e?r:t[1]})).filter((function(e){return e})))})),s=!1,o=(0,jt.O)(V.eV,(function(t){var r=a.arts.values[t].filter((function(r){var a=en([tn([r]),i[t]]),s=nn(e,a);return e.every((function(e,t){var r;return s.get(e).max>=(null!==(r=n[t])&&void 0!==r?r:-1/0)}))}));return r.length!==a.arts.values[t].length&&(s=!0),r}));if(!s)return"break";a.arts={base:a.arts.base,values:o}};;){if("break"===s())break}return a.arts}function Qt(e,t){var n=nn(e,en([Object.fromEntries(Object.entries(t.base).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return[n,{min:r,max:r}]})))].concat((0,ue.Z)(Object.values(t.values).map((function(e){return tn(e)}))))));return(0,vt.uW)(e,(function(e){var t=n.get(e),r=t.min;if(r===t.max)return(0,pt.a9)(r);var a=e.operation,s=e.operands.map((function(e){return n.get(e)}));switch(a){case"threshold":var o=(0,i.Z)(s,4),c=o[0],l=o[1],u=o[2],d=o[3];if(c.min>=l.max)return e.operands[2];if(c.max<l.min)return e.operands[3];if(u.max===u.min&&d.max===d.min&&u.min===d.min&&isFinite(u.min))return(0,pt.a9)(u.max);break;case"min":var f=e.operands.filter((function(e,t){var n=s[t];return s.every((function(e,t){return n.min<=e.max}))}));if(f.length<s.length)return pt.VV.apply(void 0,(0,ue.Z)(f));break;case"max":var h=e.operands.filter((function(e,t){var n=s[t];return s.every((function(e){return n.max>=e.min}))}));if(h.length<s.length)return pt.Fp.apply(void 0,(0,ue.Z)(h))}return e}),(function(e){return e}))}function en(e){var t={};return e.forEach((function(e){Object.entries(e).forEach((function(e){var n=(0,i.Z)(e,2),r=n[0],a=n[1];t[r]?(t[r].min+=a.min,t[r].max+=a.max):t[r]=(0,pe.Z)({},a)}))})),t}function tn(e){var t={};return e.length&&(Object.keys(e[0].values).filter((function(t){return e.every((function(e){return e.values[t]}))})).forEach((function(n){return t[n]={min:e[0].values[n],max:e[0].values[n]}})),e.forEach((function(e){for(var n=e.values,r=0,a=Object.entries(n);r<a.length;r++){var s=(0,i.Z)(a[r],2),o=s[0],c=s[1];t[o]?(t[o].max<c&&(t[o].max=c),t[o].min>c&&(t[o].min=c)):t[o]={min:0,max:c}}}))),t}function nn(e,t){var n=new Map;return(0,vt.aD)(e,(function(e){}),(function(e){var r,a,s=e.operation,o=e.operands.map((function(e){return n.get(e)}));switch(s){case"read":if("dyn"!==e.path[0])throw new Error("Found non-dyn path ".concat(e.path," while computing range"));a=null!==(r=t[e.path[1]])&&void 0!==r?r:{min:0,max:0};break;case"const":a=rn([e.value]);break;case"add":case"min":case"max":a={min:xt.aj[s](o.map((function(e){return e.min}))),max:xt.aj[s](o.map((function(e){return e.max})))};break;case"res":a={min:xt.aj[s]([o[0].max]),max:xt.aj[s]([o[0].min])};break;case"mul":a=o.reduce((function(e,t){return rn([e.min*t.min,e.min*t.max,e.max*t.min,e.max*t.max])}));break;case"threshold":a=o[0].min>=o[1].max?o[2]:o[0].max<o[1].min?o[3]:rn([],[o[2],o[3]]);break;case"sum_frac":var c=(0,i.Z)(o,2),l=c[0],u=c[1],d={min:l.min+u.min,max:l.max+u.max};a=d.min<=0&&d.max>=0?l.min<=0&&l.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:rn([l.min/d.min,l.min/d.max,l.max/d.min,l.max/d.max]);break;default:(0,jt.UT)(s)}n.set(e,a)})),n}function rn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Math.max.apply(Math,(0,ue.Z)(e).concat((0,ue.Z)(t.map((function(e){return e.max}))))),r=Math.min.apply(Math,(0,ue.Z)(e).concat((0,ue.Z)(t.map((function(e){return e.min})))));return{min:r,max:n}}function an(e,t){return e.flatMap((function(e){return e})).sort((function(e,t){return t.value-e.value})).slice(0,t)}function sn(e){for(var t=.01,n=new Set(e.flatMap((function(e){return Object.values(e).map((function(e){return Math.round(e.plot/t)}))})));n.size>1500;)t*=2,n=new Set((0,ue.Z)(n).map((function(e){return Math.round(e/2)})));var r,i={},a=(0,et.Z)(e);try{for(a.s();!(r=a.n()).done;)for(var s=r.value,o=0,c=Object.values(s);o<c.length;o++){var l=c[o],u=Math.round(l.plot/t)*t;(!i[u]||i[u].value<l.value)&&(i[u]=l)}}catch(d){a.e(d)}finally{a.f()}return i}(0,jt.O)(V.eV,(function(e){return{kind:"exclude",sets:new Set}}));var on=n(53174),cn=n(54483),ln=n(16614),un=n(31148),dn=n(37503);function fn(e){var t,n=e.setKey,r=e.setNumKey,i=e.hideHeader,a=void 0!==i&&i,s=e.conditionalsOnly,o=void 0!==s&&s,c=(0,W.Z)((function(){return un.y.get(n)}),[n]);if(!c)return null;var l=o?null===(t=c.setEffectDocument(r))||void 0===t?void 0:t.filter((function(e){return"states"in e})):c.setEffectDocument(r);return(0,ie.jsx)(f.Z,{display:"flex",flexDirection:"column",children:l?(0,ie.jsx)(dn.Z,{sections:l,hideHeader:a}):null})}var hn,pn,xn,vn,mn,jn,Zn,gn,yn,bn,wn,Cn,kn,Sn,Pn,En,_n=n(95614),An=n(55221),Kn=n(10157),On=n(66624);function Tn(e){var t=(0,j.useContext)(T.t).database,n=(0,j.useState)((function(){return t.buildSettings.get(e)})),r=(0,i.Z)(n,2),a=r[0],s=r[1];return(0,j.useEffect)((function(){return s(t.buildSettings.get(e))}),[t,e]),(0,j.useEffect)((function(){return t.buildSettings.follow(e,(function(e,t,n){return"update"===t&&s(n)}))}),[e,s,t]),{buildSetting:a,buildSettingDispatch:(0,j.useCallback)((function(n){return e&&t.buildSettings.set(e,n)}),[e,t])}}function Dn(e){var t,n,a=e.disabled,s=(0,Z.$)(["page_character_optimize","sheet"]).t,o=(0,j.useContext)(_.R),c=(0,j.useContext)(T.t).database,l=(0,j.useContext)(E.K),u=l.character,d=u.key,h=u.conditional,x=l.characterDispatch,v=Tn(d),g=v.buildSetting.artSetExclusion,y=v.buildSettingDispatch,k=(0,j.useState)(!1),S=(0,i.Z)(k,2),A=S[0],K=S[1],O=(0,j.useCallback)((function(){return K(!0)}),[K]),D=(0,j.useCallback)((function(){return K(!1)}),[K]),M=(0,W.Z)((function(){return un.y.getAll}),[]),I=(0,zt.Z)(),R=(0,i.Z)(I,2),$=R[0],N=R[1];(0,j.useEffect)((function(){return c.arts.followAny(N)}),[c,N]);var L=(0,j.useMemo)((function(){return M?Object.entries(un.y.setKeysByRarities(M)).reverse().flatMap((function(e){return(0,i.Z)(e,2)[1]})).filter((function(e){return!e.includes("Prayers")})):[]}),[M]),F=(0,j.useMemo)((function(){var e=(0,jt.O)(L,(function(e){return(0,jt.O)(V.eV,(function(e){return 0}))}));c.arts.values.forEach((function(t){return e[t.setKey]&&e[t.setKey][t.slotKey]++}));var t=(0,ue.Z)(L).sort((function(t,n){return+(Rn(e[t])<2)-+(Rn(e[n])<2)}));return $&&{artKeys:t,artSlotCount:e}}),[$,c,L]),B=F.artKeys,z=F.artSlotCount,q=!(null!==(t=g.rainbow)&&void 0!==t&&t.includes(2)),H=!(null!==(n=g.rainbow)&&void 0!==n&&n.includes(4)),J=(0,j.useMemo)((function(){return{allow2:L.filter((function(e){var t;return!(null!==(t=g[e])&&void 0!==t&&t.includes(2))})).length,allow4:L.filter((function(e){var t;return!(null!==(t=g[e])&&void 0!==t&&t.includes(4))})).length}}),[L,g]),Y=J.allow2,X=J.allow4,ee=L.length-Y,ne=L.length-X,ae=(0,j.useMemo)((function(){return Object.keys(h).filter((function(e){return V.q2.includes(e)&&0!==Object.keys(h[e]).length})).length}),[h]),se=(0,j.useMemo)((function(){return(0,pe.Z)((0,pe.Z)({},o),{},{data:new re.w((0,pe.Z)((0,pe.Z)({},o.data.data[0]),{},{artSet:(0,jt.O)(V.q2,(function(e){return(0,pt.a9)(4)}))}),void 0)})}),[o]),oe=(0,j.useCallback)((function(){var e=Object.fromEntries(Object.entries(h).filter((function(e){var t=(0,i.Z)(e,2),n=t[0];t[1];return!V.q2.includes(n)})));x({conditional:e})}),[h,x]),ce=(0,j.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,jt.I8)(g);L.forEach((function(r){var i;t?n[r]=[].concat((0,ue.Z)(null!==(i=n[r])&&void 0!==i?i:[]),[e]):n[r]&&(n[r]=n[r].filter((function(t){return t!==e})))})),y({artSetExclusion:n})}),[L,g,y]);return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)(w.Z,{sx:{display:"flex"},children:[(0,ie.jsxs)(p.Z,{sx:{flexGrow:1},children:[(0,ie.jsx)(U.Z,{children:(0,ie.jsx)("strong",{children:s(hn||(hn=(0,r.Z)(["artSetConfig.title"])))})}),(0,ie.jsxs)(de.Z,{spacing:1,children:[(0,ie.jsxs)(U.Z,{children:[s(pn||(pn=(0,r.Z)(["artSetConfig.setEffCond"])))," ",(0,ie.jsxs)(P.Z,{color:ae?"success":"secondary",children:[ae," ",s("artSetConfig.enabled")]})]}),(0,ie.jsxs)(U.Z,{children:[s(xn||(xn=(0,r.Z)(["sheet:2set"])))," ",(0,ie.jsxs)(P.Z,{color:"success",children:[Y," ",(0,ie.jsx)(cn.G,{icon:on.Stf,className:"fa-fw"})," ",s("artSetConfig.allowed")]}),!!ee&&" / ",!!ee&&(0,ie.jsxs)(P.Z,{color:"secondary",children:[ee," ",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," ",s("artSetConfig.excluded")]})]}),(0,ie.jsxs)(U.Z,{children:[s(vn||(vn=(0,r.Z)(["sheet:4set"])))," ",(0,ie.jsxs)(P.Z,{color:"success",children:[X," ",(0,ie.jsx)(cn.G,{icon:on.Stf,className:"fa-fw"})," ",s("artSetConfig.allowed")]}),!!ne&&" / ",!!ne&&(0,ie.jsxs)(P.Z,{color:"secondary",children:[ne," ",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," ",s("artSetConfig.excluded")]})]}),(0,ie.jsxs)(U.Z,{children:[s(mn||(mn=(0,r.Z)(["artSetConfig.2rainbow"])))," ",(0,ie.jsxs)(P.Z,{color:q?"success":"secondary",children:[(0,ie.jsx)(cn.G,{icon:q?on.Stf:on.gPx,className:"fa-fw"})," ",q?s("artSetConfig.allowed"):"Excluded"]})]}),(0,ie.jsxs)(U.Z,{children:[s(jn||(jn=(0,r.Z)(["artSetConfig.4rainbow"])))," ",(0,ie.jsxs)(P.Z,{color:H?"success":"secondary",children:[(0,ie.jsx)(cn.G,{icon:H?on.Stf:on.gPx,className:"fa-fw"})," ",H?s("artSetConfig.allowed"):"Excluded"]})]})]})]}),(0,ie.jsx)(m.Z,{onClick:O,disabled:a,color:"info",sx:{borderRadius:0},children:(0,ie.jsx)(ln.Z,{})})]}),M&&(0,ie.jsx)(te.Z,{open:A,onClose:D,children:(0,ie.jsxs)(b.Z,{children:[(0,ie.jsxs)(p.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,ie.jsx)(U.Z,{variant:"h6",children:s(Zn||(Zn=(0,r.Z)(["artSetConfig.title"])))}),(0,ie.jsx)(C.Z,{onClick:D})]}),(0,ie.jsx)(G.Z,{}),(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(w.Z,{sx:{mb:1},children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsxs)(f.Z,{display:"flex",gap:1,children:[(0,ie.jsx)(U.Z,{children:(0,ie.jsx)("strong",{children:s(gn||(gn=(0,r.Z)(["artSetConfig.modal.setCond.title"])))})}),(0,ie.jsx)(U.Z,{sx:{flexGrow:1},children:(0,ie.jsxs)(P.Z,{color:ae?"success":"secondary",children:[ae," ",s("artSetConfig.selected")]})}),(0,ie.jsx)(m.Z,{size:"small",onClick:oe,color:"error",startIcon:(0,ie.jsx)(xe.Z,{}),children:s(yn||(yn=(0,r.Z)(["artSetConfig.modal.setCond.reset"])))})]}),(0,ie.jsx)(U.Z,{children:s(bn||(bn=(0,r.Z)(["artSetConfig.modal.setCond.text"])))})]})}),(0,ie.jsx)(w.Z,{sx:{mb:1},children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(U.Z,{sx:{flexGrow:1},children:(0,ie.jsx)("strong",{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.modal.ArtSetFilter.title",children:["Artifact Sets ",(0,ie.jsxs)(Q.Z,{color:"success",children:["Allowed",(0,ie.jsx)(cn.G,{icon:on.Stf,className:"fa-fw"})]})," / ",(0,ie.jsxs)(Q.Z,{color:"secondary",variant:"light",children:["Excluded",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})]})]})})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.modal.ArtSetFilter.intro",children:["You can allow/exclude which sets you want the builder to consider. In the following examples, ",(0,ie.jsx)("strong",{children:"A"})," is on-set, and ",(0,ie.jsx)("strong",{children:"R"})," is rainbow(off-set)"]})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.modal.ArtSetFilter.2set",children:[(0,ie.jsx)("strong",{children:(0,ie.jsxs)(Q.Z,{color:"secondary",variant:"light",children:["Excluding",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," 2-Set"]})})," would exclude 2-Set builds: ",(0,ie.jsxs)("strong",{children:[(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"AA"}),"RRR"]})," and ",(0,ie.jsxs)("strong",{children:[(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"AAA"}),"RR"]}),"."]})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.modal.ArtSetFilter.4set",children:[(0,ie.jsx)("strong",{children:(0,ie.jsxs)(Q.Z,{color:"secondary",variant:"light",children:["Excluding",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," 4-Set"]})})," would exclude 4-Set builds: ",(0,ie.jsxs)("strong",{children:[(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"AAAA"}),"R"]})," and ",(0,ie.jsx)("strong",{children:(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"AAAAA"})}),"."]})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.modal.ArtSetFilter.2rain",children:[(0,ie.jsx)("strong",{children:(0,ie.jsxs)(Q.Z,{color:"secondary",variant:"light",children:["Excluding",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," 3-Rainbow"]})})," would exclude 2-Set + 3-Rainbow builds: ",(0,ie.jsxs)("strong",{children:["AA",(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"RRR"})]})," and ",(0,ie.jsxs)("strong",{children:["AAA",(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"RR"})]}),"."]})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.modal.ArtSetFilter.4rain",children:[(0,ie.jsx)("strong",{children:(0,ie.jsxs)(Q.Z,{color:"secondary",variant:"light",children:["Excluding",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," 5-Rainbow"]})})," would exclude full 5-Rainbow builds: ",(0,ie.jsx)("strong",{children:(0,ie.jsx)(Q.Z,{color:"secondary",variant:"light",children:"RRRRR"})}),"."]})})]})}),(0,ie.jsxs)(fe.ZP,{container:!0,columns:{xs:2,lg:3},sx:{mb:1},spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(Mn,{setNum:2,numAllow:Y,numExclude:ee,setAllExclusion:ce})}),(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(Mn,{setNum:4,numAllow:X,numExclude:ne,setAllExclusion:ce})}),(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(U.Z,{gutterBottom:!0,children:(0,ie.jsx)("strong",{children:(0,ie.jsxs)(ct.c,{t:s,i18nKey:"artSetConfig.alExRainbow",children:[(0,ie.jsxs)(Q.Z,{color:"success",children:["Allow ",(0,ie.jsx)(cn.G,{icon:on.Stf,className:"fa-fw"})]})," / ",(0,ie.jsxs)(Q.Z,{color:"secondary",variant:"light",children:["Exclude ",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})]})," Rainbow Builds"]})})}),(0,ie.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsx)(m.Z,{fullWidth:!0,onClick:function(){return y({type:"artSetExclusion",setKey:"rainbow",num:2})},color:q?"success":"secondary",startIcon:q?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),endIcon:(0,ie.jsx)(cn.G,{icon:q?on.Stf:on.gPx,className:"fa-fw"}),children:s(wn||(wn=(0,r.Z)(["artSetConfig.2rainbow"])))}),(0,ie.jsx)(m.Z,{fullWidth:!0,onClick:function(){return y({type:"artSetExclusion",setKey:"rainbow",num:4})},color:H?"success":"secondary",startIcon:H?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),endIcon:(0,ie.jsx)(cn.G,{icon:H?on.Stf:on.gPx,className:"fa-fw"}),children:s(Cn||(Cn=(0,r.Z)(["artSetConfig.4rainbow"])))})]})]})})})]}),(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,columns:{xs:2,lg:3},children:B.map((function(e){return(0,ie.jsx)(In,{setKey:e,sheet:M(e),fakeDataContextObj:se,slotCount:z[e]},e)}))})]}),(0,ie.jsx)(G.Z,{}),(0,ie.jsx)(p.Z,{sx:{py:1},children:(0,ie.jsx)(C.Z,{large:!0,onClick:D})})]})})]})}function Mn(e){var t=e.numAllow,n=e.numExclude,r=e.setNum,i=e.setAllExclusion,a=(0,Z.$)(["page_character_optimize","sheet"]).t;return(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsxs)(U.Z,{gutterBottom:!0,children:[(0,ie.jsx)("strong",{children:a("sheet:".concat(r,"set"))})," ",(0,ie.jsxs)(P.Z,{color:"success",children:[t," ",(0,ie.jsx)(cn.G,{icon:on.Stf,className:"fa-fw"})," ",a("artSetConfig.allowed")]}),!!n&&" / ",!!n&&(0,ie.jsxs)(P.Z,{color:"secondary",children:[n," ",(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"})," ",a("artSetConfig.excluded")]})]}),(0,ie.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsx)(m.Z,{fullWidth:!0,disabled:!n,onClick:function(){return i(r,!1)},color:"success",startIcon:(0,ie.jsx)(cn.G,{icon:on.Stf,className:"fa-fw"}),children:a("artSetConfig.allowAll".concat(r,"set"))}),(0,ie.jsx)(m.Z,{fullWidth:!0,disabled:!t,onClick:function(){return i(r,!0)},color:"secondary",startIcon:(0,ie.jsx)(cn.G,{icon:on.gPx,className:"fa-fw"}),children:a("artSetConfig.excludeAll".concat(r,"set"))})]})]})})}function In(e){var t,n,a,s=e.sheet,o=e.setKey,c=e.fakeDataContextObj,l=e.slotCount,u=(0,Z.$)("sheet").t,d=Tn((0,j.useContext)(E.K).character.key),h=d.buildSetting,x=d.buildSettingDispatch,v=null!==(t=null===h||void 0===h||null===(n=h.artSetExclusion)||void 0===n?void 0:n[o])&&void 0!==t?t:[],g=!v.includes(4),y=(0,j.useMemo)((function(){return Rn(l)}),[l]),b=(0,j.useMemo)((function(){return g?Object.keys(s.setEffects).filter((function(e){var t;return null===(t=s.setEffects[e])||void 0===t?void 0:t.document.some((function(e){return"states"in e}))})):[]}),[s.setEffects,g]),C=v.includes(2),k=v.includes(4);return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsxs)(w.Z,{sx:{height:"100%",opacity:y<2?"50%":void 0},children:[(0,ie.jsxs)(f.Z,{className:"grad-".concat(s.rarity[0],"star"),width:"100%",sx:{display:"flex"},children:[(0,ie.jsx)(f.Z,{component:"img",src:s.defIconSrc,sx:{height:100,width:"auto",mx:-1}}),(0,ie.jsxs)(f.Z,{sx:{flexGrow:1,px:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,ie.jsx)(U.Z,{variant:"h6",children:null!==(a=s.name)&&void 0!==a?a:""}),(0,ie.jsxs)(f.Z,{display:"flex",gap:1,children:[(0,ie.jsx)(U.Z,{variant:"subtitle1",children:s.rarity.map((function(e,t){return(0,ie.jsxs)("span",{children:[e," ",(0,ie.jsx)(Kn.q,{stars:1})," ",t<s.rarity.length-1?"/ ":null]},e)}))}),(0,ie.jsx)(An.Z,{title:(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(P.Z,{color:"success",children:u(kn||(kn=(0,r.Z)(["2set"])))})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(On.v,{ns:"artifact_".concat(o,"_gen"),key18:"setEffects.2"})}),(0,ie.jsxs)(f.Z,{paddingTop:2,sx:{opacity:v.includes(4)?.6:1},children:[(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(P.Z,{color:"success",children:u(Sn||(Sn=(0,r.Z)(["4set"])))})}),(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(On.v,{ns:"artifact_".concat(o,"_gen"),key18:"setEffects.4"})})]})]})})]}),(0,ie.jsx)(f.Z,{sx:{display:"flex",gap:1},children:Object.entries(l).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(U.Z,{sx:{flexGrow:1},variant:"subtitle2",children:(0,ie.jsxs)(P.Z,{sx:{width:"100%"},color:r?"primary":"secondary",children:[(0,_n.Ir)(n),r]})},n)}))})]})]}),(0,ie.jsxs)(Ee.Z,{sx:{".MuiButton-root":{borderRadius:0}},fullWidth:!0,children:[(0,ie.jsx)(m.Z,{startIcon:C?(0,ie.jsx)(me.Z,{}):(0,ie.jsx)(ve.Z,{}),onClick:function(){return x({type:"artSetExclusion",setKey:o,num:2})},color:C?"secondary":"success",endIcon:(0,ie.jsx)(cn.G,{icon:C?on.gPx:on.Stf,className:"fa-fw"}),children:u(Pn||(Pn=(0,r.Z)(["2set"])))}),(0,ie.jsx)(m.Z,{startIcon:k?(0,ie.jsx)(me.Z,{}):(0,ie.jsx)(ve.Z,{}),onClick:function(){return x({type:"artSetExclusion",setKey:o,num:4})},color:k?"secondary":"success",endIcon:(0,ie.jsx)(cn.G,{icon:k?on.gPx:on.Stf,className:"fa-fw"}),children:u(En||(En=(0,r.Z)(["4set"])))})]}),!!b.length&&(0,ie.jsx)(_.R.Provider,{value:c,children:(0,ie.jsx)(p.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:b.map((function(e){return(0,ie.jsx)(fn,{setKey:o,setNumKey:parseInt(e),hideHeader:!0,conditionalsOnly:!0},e)}))})})]})},o)}function Rn(e){return Object.values(e).reduce((function(e,t){return e+(t?1:0)}),0)}var Wn=[0,4,8,12,16,20];function $n(e){var t=e.mainStatAssumptionLevel,n=void 0===t?0:t,r=e.setmainStatAssumptionLevel,i=e.disabled,a=(0,Z.$)("page_character_optimize").t;return(0,ie.jsx)(ft.Z,{fullWidth:!0,color:n?"success":"primary",disabled:i,title:n?a("mainStat.assumptionLvl.lvl",{lvl:n}):a("mainStat.assumptionLvl.no"),children:Wn.map((function(e){return(0,ie.jsx)(st.Z,{onClick:function(){return r(e)},children:e?a("mainStat.assumptionLvl.lvl",{lvl:e}):a("mainStat.assumptionLvl.no")},e)}))})}function Nn(){var e=(0,j.useContext)(E.K).character.bonusStats,t=(0,j.useContext)(_.R).data,n=Object.keys(e);if(!n.length)return null;var r=n.map((function(e){return t.get(ge.ri.customBonus[e])}));return(0,ie.jsxs)(w.Z,{children:[(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(U.Z,{children:"Bonus Stats"})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsx)(p.Z,{children:r.map((function(e){return(0,ie.jsx)(We.JW,{node:e},JSON.stringify(e.info))}))})]})}var Vn=n(57482),Ln=n(52771),Fn=(0,we.ZP)("strong")({fontFamily:"monospace"}),Bn=(0,we.ZP)(Vn.Z)((function(e){e.theme;return{height:10,borderRadius:5}}));function zn(e){var t=e.status,n=t.type,r=t.tested,i=(t.failed,t.skipped),a=t.total,s=t.startTime,o=t.finishTime,c=e.characterName,l=isFinite(a),u="inactive"!==n,d=a-i,f=(0,ie.jsx)(Fn,{children:r.toLocaleString()}),h=(0,ie.jsx)(Fn,{children:d.toLocaleString()}),p=!!i&&(0,ie.jsxs)("span",{children:["(",(0,ie.jsx)("b",{children:(0,ie.jsx)(Fn,{children:i.toLocaleString()})})," skipped)"]}),x=(0,ie.jsx)(Fn,{children:(0,Ln.e6)(Math.round((null!==o&&void 0!==o?o:performance.now())-(null!==s&&void 0!==s?s:NaN)))}),v="",m="",j=void 0;if(u)j=100*(i+r)/(i+d),v=(0,ie.jsxs)(U.Z,{children:["Generating and testing ",f,l?(0,ie.jsxs)(ie.Fragment,{children:["/",h]}):void 0," build configurations against the criteria for ",(0,ie.jsx)("b",{children:c}),". ",p]}),m=(0,ie.jsxs)(U.Z,{children:["Time elapsed: ",x]});else{if(!(r+i))return null;j=100,v=(0,ie.jsxs)(U.Z,{children:["Generated and tested ",f," Build configurations against the criteria for ",(0,ie.jsx)("b",{children:c}),". ",p]}),m=(0,ie.jsxs)(U.Z,{children:["Total duration: ",x]})}return(0,ie.jsxs)(it.Z,{severity:"success",variant:"filled",sx:{"& .MuiAlert-message":{flexGrow:1}},children:[v,m,void 0!==j&&(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,alignItems:"center",children:[l&&(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(U.Z,{children:"".concat(j.toFixed(1),"%")})}),(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsx)(Bn,{variant:l?"determinate":"indeterminate",value:j,color:"primary"})})]})]})}var Gn=n(19701),qn=n(98268),Hn=n(63204),Un=n(66647),Jn=n(13967),Yn=n(12065),Xn=n(10658),Qn=n(98620),er=n(63372),tr=n(20005),nr=n(87174),rr=n(64929);function ir(e){var t,n,r=e.artifactId,i=e.slotKey,a=e.mainStatAssumptionLevel,s=void 0===a?0:a,o=e.showLocation,c=void 0!==o&&o,l=e.onClick,u=e.BGComponent,d=void 0===u?b.Z:u,h=(0,er.Z)(r),p=(0,j.useContext)(T.t).database,x=(0,W.Z)((function(){return un.y.get(null===h||void 0===h?void 0:h.setKey)}),[null===h||void 0===h?void 0:h.setKey]),v=(0,j.useCallback)((function(e){return(0,ie.jsx)(Un.Z,{onClick:l,sx:{height:"100%"},children:e})}),[l]),m=(0,Jn.Z)();if(!h)return(0,ie.jsx)(d,{sx:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center"},children:(0,ie.jsx)(f.Z,{component:"img",src:Xn.Z.slot[i],sx:{width:"25%",height:"auto",opacity:.7}})});var Z=h.slotKey,g=h.rarity,y=h.level,w=h.mainStatKey,C=h.substats,k=h.location,S=Math.max(Math.min(s,4*g),y),P=ye.ZP.unit(w),E=V.Kj.find((function(e){return h.mainStatKey.includes(e)})),_=E?(0,Yn.Fq)(m.palette[E].main,.6):(0,Yn.Fq)(m.palette.secondary.main,.6);return(0,ie.jsx)(d,{sx:{height:"100%"},children:(0,ie.jsx)(tr.Z,{condition:!!l,wrapper:v,children:(0,ie.jsxs)(f.Z,{display:"flex",height:"100%",children:[(0,ie.jsxs)(f.Z,{className:"grad-".concat(g,"star"),sx:{position:"relative",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,ie.jsx)(rr.Z,{art:h,children:(0,ie.jsx)(f.Z,{component:"img",src:null!==(t=null===x||void 0===x?void 0:x.slotIcons[Z])&&void 0!==t?t:"",sx:{m:-1,maxHeight:"110%",maxWidth:"110%"}})}),(0,ie.jsxs)(f.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"space-between",pointerEvents:"none"},children:[(0,ie.jsx)(je.Z,{size:"small",label:(0,ie.jsx)("strong",{children:" +".concat(y)}),color:Qn.ZP.levelVariant(y)}),c&&(0,ie.jsx)(je.Z,{size:"small",label:(0,ie.jsx)(sr,{charKey:k&&p.chars.LocationToCharacterKey(k)}),color:"secondary",sx:{overflow:"visible",".MuiChip-label":{overflow:"visible"}}})]}),(0,ie.jsx)(je.Z,{size:"small",sx:{position:"absolute",bottom:0,mb:1,backgroundColor:_},label:(0,ie.jsxs)(U.Z,{sx:{display:"flex",gap:.5,px:1,zIndex:1},children:[(0,ie.jsx)(ut.Z,{placement:"top",title:(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(nr._,{statKey:w})}),disableInteractive:!0,children:(0,ie.jsx)("span",{children:Pe.Z[w]})}),(0,ie.jsxs)(Q.Z,{color:S!==y?"warning":void 0,children:[(0,ye.qs)(null!==(n=Qn.ZP.mainStatValue(w,g,S))&&void 0!==n?n:0,ye.ZP.unit(w)),P]})]})})]}),(0,ie.jsx)(f.Z,{display:"flex",flexDirection:"column",justifyContent:"space-between",sx:{p:1},children:C.map((function(e,t){return(0,ie.jsx)(ar,{stat:e},t+e.key)}))})]})})})}function ar(e){var t,n,r=e.stat;if(!r.value)return null;var i=null!==(t=null===(n=r.rolls)||void 0===n?void 0:n.length)&&void 0!==t?t:0,a="roll".concat((0,jt.uZ)(i,1,6)),s=ye.ZP.unit(r.key);return(0,ie.jsx)(f.Z,{display:"flex",gap:1,alignContent:"center",children:(0,ie.jsxs)(U.Z,{sx:{flexGrow:1,display:"flex",gap:.5},color:i?"".concat(a,".main"):"error.main",component:"span",children:[(0,ie.jsx)(ut.Z,{placement:"top",title:(0,ie.jsx)(U.Z,{children:r.key&&(0,ie.jsx)(nr._,{statKey:r.key})}),disableInteractive:!0,children:(0,ie.jsx)("span",{children:Pe.Z[r.key]})}),(0,ie.jsx)("span",{children:"".concat((0,ye.qs)(r.value,ye.ZP.unit(r.key))).concat(s)})]})})}function sr(e){var t=e.charKey,n=(0,R.Z)().gender,r=(0,W.Z)((function(){return O.Z.get(t,n)}),[t,n]);return r?(0,ie.jsx)(ut.Z,{placement:"right-end",title:(0,ie.jsx)(U.Z,{children:r.name}),children:(0,ie.jsx)(ee.Z,{src:r.thumbImgSide,size:2.5,sx:{marginTop:"-1.5em",marginLeft:"-0.5em"}})}):(0,ie.jsx)(Hn.Z,{})}var or=n(16002);function cr(){var e=(0,j.useContext)(_.R).data,t=(0,j.useMemo)((function(){return(0,ne.U)(e).filter((function(e){var t=(0,i.Z)(e,2)[1];return Object.values(t).some((function(e){return!e.isEmpty}))}))}),[e]);return(0,ie.jsx)(f.Z,{sx:{mr:-1,mb:-1},children:(0,ie.jsx)(or.ZP,{columns:{xs:1,sm:2,md:3,xl:4},spacing:1,children:t.map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(lr,{displayNs:r,sectionKey:n},n)}))})})}function lr(e){var t=e.displayNs,n=e.sectionKey,r=(0,j.useContext)(Vt),a=(0,j.useContext)(_.R),s=a.data,o=a.oldData,c=(0,j.useContext)(T.t).database,l=(0,W.Z)((function(){return(0,ne.f)(s,n,c)}),[s,n]),u=(0,j.useMemo)((function(){return(0,jt.xh)(t,(function(e,t){return(0,pt.UF)(["display",n,t])}))}),[t,n]);if(!l)return(0,ie.jsx)(b.Z,{});var d=l.title,f=l.icon,h=l.action;return(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(X.Z,{avatar:f&&(0,ie.jsx)(ee.Z,{size:2,sx:{m:-1},src:f}),title:d,action:h&&(0,ie.jsx)(P.Z,{children:h})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsx)(We.lD,{sx:{m:0},children:Object.entries(t).map((function(e){var t=(0,i.Z)(e,2),a=t[0],s=t[1];return(0,ie.jsx)(We.JW,{node:s,oldValue:o?o.get(u[a]).value:void 0,component:he.ZP,emphasize:JSON.stringify(r)===JSON.stringify([n,a])},a)}))})]})}var ur=n(66218),dr=n(74480),fr=n(41717);function hr(e){var t=e.weaponId,n=e.showLocation,r=void 0!==n&&n,i=e.onClick,a=e.BGComponent,s=void 0===a?b.Z:a,o=(0,dr.Z)(t),c=(0,W.Z)((function(){return(null===o||void 0===o?void 0:o.key)&&ur.Z.get(o.key)}),[null===o||void 0===o?void 0:o.key]),l=(0,j.useCallback)((function(e){return(0,ie.jsx)(Un.Z,{sx:{height:"100%"},onClick:i,children:e})}),[i]),u=(0,j.useMemo)((function(){return c&&o&&(0,Ft.mP)([c.data,(0,Ft.v0)(o)])}),[c,o]);if(!o||!c||!u)return(0,ie.jsx)(s,{sx:{height:"100%"},children:(0,ie.jsx)(h.Z,{variant:"rectangular",sx:{width:"100%",height:"100%"}})});var d=o.refinement,p=o.location;return(0,ie.jsx)(s,{sx:{height:"100%"},children:(0,ie.jsx)(tr.Z,{condition:!!i,wrapper:l,children:(0,ie.jsxs)(f.Z,{display:"flex",height:"100%",alignItems:"stretch",children:[(0,ie.jsxs)(f.Z,{className:"grad-".concat(c.rarity,"star"),sx:{height:"100%",position:"relative",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[(0,ie.jsx)(fr.Z,{sheet:c,children:(0,ie.jsx)(f.Z,{component:"img",src:c.getImg(o.ascension),sx:{mx:-1,maxHeight:"100%",maxWidth:"100%"}})}),(0,ie.jsxs)(f.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"space-between",pointerEvents:"none"},children:[(0,ie.jsx)(je.Z,{size:"small",label:(0,ie.jsx)("strong",{children:ur.Z.getLevelString(o)}),color:"primary"}),r&&(0,ie.jsx)(je.Z,{size:"small",label:(0,ie.jsx)(xr,{location:p}),color:"secondary",sx:{overflow:"visible",".MuiChip-label":{overflow:"visible"}}})]}),(0,ie.jsx)(f.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:c.hasRefinement&&(0,ie.jsx)(je.Z,{size:"small",color:"info",label:(0,ie.jsxs)("strong",{children:["R",d]})})})]}),(0,ie.jsxs)(f.Z,{display:"flex",flexDirection:"column",sx:{p:1},children:[(0,ie.jsx)(pr,{node:u.get(ge.qH.weapon.main)}),(0,ie.jsx)(pr,{node:u.get(ge.qH.weapon.sub)})]})]})})})}function pr(e){var t=e.node;return t.info.name?(0,ie.jsx)(f.Z,{display:"flex",gap:1,alignContent:"center",children:(0,ie.jsxs)(U.Z,{sx:{flexGrow:1,display:"flex",gap:1},component:"span",children:[(0,ie.jsx)(ut.Z,{placement:"top",title:(0,ie.jsx)(U.Z,{children:t.info.name}),disableInteractive:!0,children:(0,ie.jsx)("span",{children:t.info.icon})}),(0,ie.jsx)("span",{children:(0,re.p)(t)})]})}):null}function xr(e){var t=e.location,n=(0,j.useContext)(T.t).database,r=(0,R.Z)().gender,i=(0,W.Z)((function(){return O.Z.get(t?n.chars.LocationToCharacterKey(t):"",r)}),[t,r]);return i?(0,ie.jsx)(ut.Z,{placement:"right-end",title:(0,ie.jsx)(U.Z,{children:i.name}),children:(0,ie.jsx)(ee.Z,{src:i.thumbImgSide,size:2.5,sx:{marginTop:"-1.5em",marginLeft:"-0.5em"}})}):(0,ie.jsx)(Hn.Z,{})}var vr=n(72838),mr=n(80616);function jr(e){var t=e.artifacts,n=e.currentlyEquipped,r=void 0!==n&&n,a=(0,j.useMemo)((function(){return t.filter((function(e){return e})).reduce((function(e,t){return e[t.setKey]?e[t.setKey].push(t.slotKey):e[t.setKey]=[t.slotKey],e}),{})}),[t]);return(0,ie.jsx)(ie.Fragment,{children:Object.entries(a).sort((function(e,t){var n=(0,i.Z)(e,2),r=(n[0],n[1]),a=(0,i.Z)(t,2);a[0];return a[1].length-r.length})).map((function(e){var t=(0,i.Z)(e,2),n=t[0],a=t[1];return(0,ie.jsx)(Zr,{setKey:n,currentlyEquipped:r,slotarr:a},n)}))})}function Zr(e){var t,n=e.setKey,r=e.currentlyEquipped,i=void 0!==r&&r,a=e.slotarr,s=(0,W.Z)((function(){return un.y.get(n)}),[]);if(!s)return null;var o=a.length,c=Object.keys(s.setEffects).map((function(e){return parseInt(e)})).filter((function(e){return e<=o}));return(0,ie.jsx)(f.Z,{children:(0,ie.jsx)(mr.Z,{artifactSheet:s,numInSet:o,children:(0,ie.jsx)(P.Z,{sx:{height:"100%"},color:i?"success":"primary",children:(0,ie.jsxs)(U.Z,{children:[a.map((function(e){return(0,_n.Ir)(e)}))," ",null!==(t=s.name)&&void 0!==t?t:"",c.map((function(e){return(0,ie.jsx)(P.Z,{sx:{ml:.5},color:"success",children:e},e)}))]})})})})}function gr(e){var t=e.label,n=e.compareBuild,r=e.extraButtonsRight,a=e.extraButtonsLeft,s=e.disabled,o=(0,j.useContext)(E.K).character,c=o.key,l=o.equippedArtifacts,u=Tn(c).buildSetting.mainStatAssumptionLevel,d=(0,j.useContext)(T.t).database,x=(0,j.useContext)(_.R),v=x.data,Z=x.oldData,g=(0,j.useState)(void 0),y=(0,i.Z)(g,2),b=y[0],C=y[1],k=(0,j.useCallback)((function(){return C(void 0)}),[C]),S=(0,j.useCallback)((function(){window.confirm("Do you want to equip this build to this character?")&&(V.eV.forEach((function(e){var t=v.get(ge.ri.art[e].id).value;t&&d.arts.set(t,{location:(0,V.V7)(c)})})),d.weapons.set(v.get(ge.ri.weapon.id).value,{location:(0,V.V7)(c)}))}),[c,v,d]),A=(0,j.useMemo)((function(){var e=(0,pe.Z)({},x);return n||(e.oldData=void 0),e}),[x,n]),K=(0,j.useMemo)((function(){return Object.fromEntries(V.eV.map((function(e){return[e,v.get(ge.ri.art[e].id).value]})))}),[v]),O=(0,j.useMemo)((function(){return K&&Object.values(K).map((function(e){return d.arts.get(e)})).filter((function(e){return e}))}),[K,d.arts]),D=(0,j.useMemo)((function(){return V.eV.map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(ir,{showLocation:!0,slotKey:e,artifactId:K[e],mainStatAssumptionLevel:u,onClick:function(){var t=l[e],n=K[e];C({oldId:t!==n?t:void 0,newId:n})}})},e)}))}),[C,l,u,K]);if(!Z)return null;var M=V.eV.every((function(e){return K[e]===Z.get(ge.ri.art[e].id).value}))&&v.get(ge.ri.weapon.id).value===Z.get(ge.ri.weapon.id).value;return(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:600}),children:[b&&(0,ie.jsx)(yr,{newOld:b,mainStatAssumptionLevel:u,onClose:k}),(0,ie.jsxs)(p.Z,{children:[(0,ie.jsxs)(f.Z,{display:"flex",gap:1,sx:{pb:1},flexWrap:"wrap",children:[void 0!==t&&(0,ie.jsx)(P.Z,{color:"info",children:(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)("strong",{children:[t,M?" (Equipped)":""]})})}),(0,ie.jsx)(jr,{artifacts:O,currentlyEquipped:M}),(0,ie.jsx)(f.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"flex-end"}}),a,(0,ie.jsx)(m.Z,{size:"small",color:"success",onClick:S,disabled:s||M,startIcon:(0,ie.jsx)(Gn.Z,{}),children:"Equip Build"}),r]}),(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,sx:{pb:1},columns:{xs:2,sm:3,md:4,lg:6},children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(hr,{showLocation:!0,weaponId:v.get(ge.ri.weapon.id).value})}),D]}),(0,ie.jsx)(_.R.Provider,{value:A,children:(0,ie.jsx)(cr,{})})]})]})})}function yr(e){var t=e.newOld,n=t.newId,r=t.oldId,i=e.mainStatAssumptionLevel,a=e.onClose,s=(0,j.useContext)(T.t).database,o=(0,j.useContext)(E.K).character.key,c=(0,j.useCallback)((function(){window.confirm("Do you want to equip this artifact to this character?")&&(s.arts.set(n,{location:(0,V.V7)(o)}),a())}),[n,s,o,a]);return(0,ie.jsx)(te.Z,{open:!!n,onClose:a,containerProps:{maxWidth:r?"md":"xs"},children:(0,ie.jsx)(b.Z,{children:(0,ie.jsxs)(p.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"stretch",gap:2,height:"100%"},children:[r&&(0,ie.jsx)(f.Z,{minWidth:320,children:(0,ie.jsx)(vr.Z,{artifactId:r,mainStatAssumptionLevel:i,canExclude:!0,canEquip:!0,editorProps:{disableSet:!0,disableSlot:!0}})}),r&&(0,ie.jsx)(f.Z,{display:"flex",flexGrow:1}),r&&(0,ie.jsx)(f.Z,{display:"flex",alignItems:"center",justifyContent:"center",children:(0,ie.jsx)(m.Z,{onClick:c,sx:{display:"flex"},children:(0,ie.jsx)(qn.Z,{sx:{fontSize:40}})})}),r&&(0,ie.jsx)(f.Z,{display:"flex",flexGrow:1}),(0,ie.jsx)(f.Z,{minWidth:320,children:(0,ie.jsx)(vr.Z,{artifactId:n,mainStatAssumptionLevel:i,canExclude:!0,canEquip:!0,editorProps:{disableSet:!0,disableSlot:!0}})})]})})})}var br=n(72456),wr=n(10889),Cr=n(20601),kr=n(39783),Sr=n(82839),Pr=n(90466),Er=n(17684),_r=n(12891),Ar=n(35667),Kr=n(27281),Or=n(62066),Tr=n(64694);function Dr(e){var t=(0,j.useContext)(T.t).database,n=(0,j.useState)((function(){return t.buildResult.get(e)})),r=(0,i.Z)(n,2),a=r[0],s=r[1];return(0,j.useEffect)((function(){return s(t.buildResult.get(e))}),[t,e]),(0,j.useEffect)((function(){return t.buildResult.follow(e,(function(e,t,n){return"update"===t&&s(n)}))}),[e,s,t]),{buildResult:a,buildResultDispatch:(0,j.useCallback)((function(n){return e&&t.buildResult.set(e,n)}),[e,t])}}var Mr=n(72814);function Ir(e){var t=e.cx,n=e.cy,r=e.payload,i=e.selectedPoint,a=e.radiusSelected,s=void 0===a?6:a,o=e.radiusUnselected,c=void 0===o?3:o,l=e.colorSelected,u=void 0===l?"red":l,d=e.colorUnselected,f=e.shape,h=void 0===f?"circle":f;if(!t||!n||!r)return null;var p=i&&i.x===r.x&&i.y===r.y;return(0,ie.jsx)("g",{className:"custom-dot","data-chart-x":t,"data-chart-y":n,"data-x-value":r.x,"data-y-value":r.y,"data-radius":p?c:s,children:p?(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Rr,{id:"customShapeSelected",shape:h,cx:t,cy:n,r:s/2,fill:u}),(0,ie.jsx)(Rr,{id:"customShapeBorder",shape:h,cx:t,cy:n,r:s,fill:"none",stroke:u})]}):(0,ie.jsx)(Rr,{id:"customShapeUnselected",shape:h,cx:t,cy:n,r:c,fill:d})})}function Rr(e){var t=e.shape,n=e.id,r=e.cx,i=e.cy,a=e.r,s=e.fill,o=e.stroke;switch(t){case"circle":return(0,ie.jsx)("circle",{id:n,cx:r,cy:i,r:a,fill:s,stroke:o});case"square":return(0,ie.jsx)("rect",{id:n,x:r-a,y:i-a,width:2*a,height:2*a,fill:s,stroke:o});case"diamond":return(0,ie.jsx)("polygon",{id:n,points:"".concat(r,",").concat(i+2.5*a," ").concat(r+1.5*a,",").concat(i," ").concat(r,",").concat(i-2.5*a," ").concat(r-1.5*a,",").concat(i),fill:s,stroke:o})}}var Wr=n(49484),$r=n(52991),Nr=["xLabel","xUnit","yLabel","yUnit","selectedPoint","setSelectedPoint","addBuildToList"];function Vr(e){var t=e.xLabel,n=e.xUnit,r=e.yLabel,i=e.yUnit,a=e.selectedPoint,s=e.setSelectedPoint,o=e.addBuildToList,c=(0,be.Z)(e,Nr),l=(0,j.useContext)(T.t).database,u=(0,j.useContext)(_.R).data,d=(0,Z.$)("page_character_optimize").t,f=(0,j.useContext)(K).graphBuilds,x=Dr((0,j.useContext)(E.K).character.key).buildResult.builds,v=(0,j.useMemo)((function(){return![].concat((0,ue.Z)(x),(0,ue.Z)(null!==f&&void 0!==f?f:[])).some((function(e){return e.every((function(e){return null===a||void 0===a?void 0:a.artifactIds.includes(e)}))}))}),[x,f,a]),g=(0,j.useMemo)((function(){return a&&a.artifactIds&&Object.fromEntries(a.artifactIds.map((function(e){var t=l.arts.get(e);return[null===t||void 0===t?void 0:t.slotKey,t]})).filter((function(e){return e})))}),[l.arts,a]),y=(0,j.useCallback)((function(e){e.target.id.includes("customShape")||e.target.id.includes("chartContainer")||s(void 0)}),[s]),w=g&&V.eV.every((function(e){var t;return(null===(t=g[e])||void 0===t?void 0:t.id)===u.get(ge.qH.art[e].id).value}));return c.active&&a?(0,ie.jsx)(Wr.Z,{onClickAway:y,children:(0,ie.jsx)(b.Z,{sx:{minWidth:"400px",maxWidth:"400px"},onClick:function(e){return e.stopPropagation()},children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(de.Z,{gap:1,children:[(0,ie.jsxs)(de.Z,{direction:"row",alignItems:"start",gap:1,children:[(0,ie.jsxs)(de.Z,{spacing:.5,flexGrow:99,children:[w&&(0,ie.jsx)(P.Z,{color:"info",children:(0,ie.jsx)("strong",{children:d("currentlyEquippedBuild")})}),(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{width:300,height:50}),children:(0,ie.jsx)(jr,{artifacts:Object.values(g),currentlyEquipped:w})})]}),(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1}),(0,ie.jsx)(C.Z,{onClick:function(){return s(void 0)}})]}),(0,ie.jsx)(fe.ZP,{container:!0,direction:"row",spacing:.75,columns:5,children:V.eV.map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{width:75,height:75}),children:(0,ie.jsx)($r.Z,{artifactObj:g[e],slotKey:e})})},e)}))}),(0,ie.jsxs)(U.Z,{children:[(0,ie.jsx)("strong",{children:t}),": ",(0,ye.EC)("%"===n?a.x/100:a.x,n)]}),(0,ie.jsxs)(U.Z,{children:[(0,ie.jsx)("strong",{children:r}),": ",(0,ye.EC)("%"===i?a.y/100:a.y,i)]}),(0,ie.jsx)(ut.Z,{title:v?"":d("tcGraph.buildAlreadyInList"),placement:"top",children:(0,ie.jsx)("span",{children:(0,ie.jsx)(m.Z,{sx:{width:"100%"},disabled:!v,color:"info",onClick:function(){return o(a.artifactIds)},children:d("addBuildToList")})})})]})})})}):null}var Lr,Fr,Br,zr,Gr,qr,Hr,Ur=n(15671),Jr=n(43144),Yr=function(){function e(t,n,r){(0,Ur.Z)(this,e),this.x=void 0,this.trueY=void 0,this.artifactIds=void 0,this.min=void 0,this.current=void 0,this.highlighted=void 0,this.x=t,this.trueY=n,this.artifactIds=r}return(0,Jr.Z)(e,[{key:"y",get:function(){return this.trueY||this.current||this.highlighted},set:function(e){this.trueY=e}}]),e}();function Xr(e){var t=e.plotBase,n=e.setPlotBase,a=e.disabled,s=void 0!==a&&a,o=e.showTooltip,c=void 0!==o&&o,l=(0,Z.$)(["page_character_optimize","ui"]).t,u=(0,j.useContext)(_.R).data,d=(0,j.useContext)(K).chartData,f=(0,j.useState)(!1),h=(0,i.Z)(f,2),x=h[0],v=h[1],g=(0,j.useState)(!0),y=(0,i.Z)(g,2),C=y[0],k=y[1],S=(0,j.useContext)(K).graphBuilds,P=(0,j.useContext)(T.t).database,A=Dr((0,j.useContext)(E.K).character.key).buildResult.builds,O=(0,j.useState)(-1/0),D=(0,i.Z)(O,2),M=D[0],I=D[1],R=(0,j.useState)(1/0),W=(0,i.Z)(R,2),$=W[0],N=W[1],L=(0,j.useCallback)((function(e,t){if("number"===typeof t)throw new TypeError;var n=(0,i.Z)(t,2),r=n[0],a=n[1];I(r),N(a)}),[I,N]);(0,j.useEffect)((function(){I(-1/0),N(1/0)}),[d]);var F=(0,j.useMemo)((function(){var e,t;if(!d)return{displayData:null,downloadData:null};var n,r=1/0,i=-1/0,a=(0,jt.Uq)(V.eV,(function(e){var t;return[e,null!==(t=null===u||void 0===u?void 0:u.get(ge.qH.art[e].id).value)&&void 0!==t?t:""]})),s=[].concat((0,ue.Z)(A),(0,ue.Z)(null!==S&&void 0!==S?S:[])).map((function(e){return si(e,P)})),o=d.data.map((function(e){var t=e.value,n=e.plot,o=e.artifactIds;if(void 0===n)return null;n<r&&(r=n),n>i&&(i=n);var c=new Yr(n,t,o),l=si(o,P);return V.eV.every((function(e){return a[e]===l[e]}))?(c.current=t,c.y=void 0,c):(s.some((function(e){return V.eV.every((function(t){return e[t]===l[t]}))}))&&(c.highlighted=t,c.y=void 0),c)})).sort((function(e,t){return e.x-t.x})),c=[],l=(0,et.Z)(o);try{for(l.s();!(n=l.n()).done;){for(var f=n.value,h=void 0;h=c.pop();)if(h.y>f.y){c.push(h);break}c.push(f)}}catch(x){l.e(x)}finally{l.f()}(null===(e=c[0])||void 0===e?void 0:e.x)!==(null===(t=o[0])||void 0===t?void 0:t.x)&&(o[0].min=c[0].y),c.forEach((function(e){e.min=e.y}));var p={minimum:c.map((function(e){return[e.x,e.y]})),allData:o.map((function(e){return[e.x,e.y]}))};return{displayData:o.filter((function(e){return e&&e.x>=M&&e.x<=$})),downloadData:p,sliderMin:r,sliderMax:i}}),[d,A,u,P,S,M,$]),B=F.displayData,z=F.downloadData,q=F.sliderMin,H=F.sliderMax,J=t&&(0,jt.Hm)(null===u||void 0===u?void 0:u.getDisplay(),t),Y=l(t&&(!J||J.isEmpty)?"page_character_optimize:targetSelector.invalidTarget":"page_character_optimize:targetSelector.selectGraphTarget");return(0,ie.jsxs)(w.Z,{children:[(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(U.Z,{children:l(Lr||(Lr=(0,r.Z)(["tcGraph.vs"])))})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(ut.Z,{placement:"top",title:c?l("page_character_optimize:selectTargetFirst"):"",children:(0,ie.jsx)("span",{children:(0,ie.jsx)(Mr.Z,{optimizationTarget:t,setTarget:function(e){return n(e)},defaultText:Y,disabled:s})})})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(ut.Z,{title:t?l("ui:reset"):"",placement:"top",children:(0,ie.jsx)("span",{children:(0,ie.jsx)(m.Z,{color:"error",onClick:function(){return n(void 0)},disabled:!t,children:(0,ie.jsx)(xe.Z,{})})})})}),(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsx)(An.Z,{placement:"top",title:l("page_character_optimize:tcGraph.desc")})}),!!z&&(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(m.Z,{size:"small",startIcon:C?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:C?"success":"secondary",onClick:function(){return k(!C)},children:l(Fr||(Fr=(0,r.Z)(["tcGraph.showStatThr"])))})}),!!z&&(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(m.Z,{size:"small",color:"info",startIcon:(0,ie.jsx)(br.Z,{}),onClick:function(){return v(!x)},children:l(Br||(Br=(0,r.Z)(["tcGraph.downloadData"])))})})]})}),B&&B.length&&(0,ie.jsx)(G.Z,{}),d&&B&&B.length&&(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(Ze.Z,{in:!!z&&x,children:(0,ie.jsx)(b.Z,{sx:{mb:2},children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(U.Z,{children:"Min Data"}),(0,ie.jsx)(ei,{data:null===z||void 0===z?void 0:z.minimum}),(0,ie.jsx)(U.Z,{children:"All Data"}),(0,ie.jsx)(ei,{data:null===z||void 0===z?void 0:z.allData})]})})}),(0,ie.jsx)(ai,{displayData:B,plotNode:d.plotNode,valueNode:d.valueNode,showMin:C}),B.length>1&&(0,ie.jsx)(wr.ZP,{marks:!0,value:[M,$],onChange:L,onChangeCommitted:L,min:q,max:H,step:(H-q)/20,valueLabelDisplay:"auto",valueLabelFormat:function(e){var t,n;return(0,ye.EC)("%"===(null===(t=d.plotNode.info)||void 0===t?void 0:t.unit)?e/100:e,null===(n=d.plotNode.info)||void 0===n?void 0:n.unit)},sx:{ml:"6%",width:"93%"}})]})]})}var Qr=(0,we.ZP)("textarea")({width:"100%",fontFamily:"monospace",resize:"vertical",minHeight:"5em"});function ei(e){var t=e.data;return(0,ie.jsx)(Qr,{readOnly:!0,value:JSON.stringify(t),onClick:function(e){var t=e.target;t.selectionStart=0,t.selectionEnd=t.value.length}})}var ti="#8884d8",ni="cyan",ri="#46a046",ii="#ff7300";function ai(e){var t,n,a,s,o=e.displayData,c=e.plotNode,l=e.valueNode,u=e.showMin,d=(0,j.useContext)(K),f=d.graphBuilds,h=d.setGraphBuilds,p=(0,Z.$)("page_character_optimize").t,x=(0,j.useState)(),v=(0,i.Z)(x,2),m=v[0],g=v[1],y=(0,j.useCallback)((function(e){return h([].concat((0,ue.Z)(null!==f&&void 0!==f?f:[]),[e]))}),[h,f]),b=(0,j.useCallback)((function(e){e&&e.chartX&&e.chartY&&g(function(e,t,n,r){var i=Array.from(document.querySelectorAll(".custom-dot")).reduce((function(n,r){var i=n.dataset,a=i.chartX,s=i.chartY,o=Math.sqrt(Math.pow(e-a,2)+Math.pow(t-s,2)),c=r.dataset,l=c.chartX,u=c.chartY;return o<=Math.sqrt(Math.pow(e-l,2)+Math.pow(t-u,2))?n:r})).dataset;return Math.sqrt(Math.pow(e-i.chartX,2)+Math.pow(t-i.chartY,2))<n?r.find((function(e){return e.x===+i.xValue&&e.y===+i.yValue})):void 0}(e.chartX,e.chartY,20,o))}),[g,o]),w=oi(c,p),C=oi(l,p);return(0,ie.jsx)(Cr.h,{width:"100%",height:600,children:(0,ie.jsxs)(kr.c,{id:"chartContainer",data:o,onClick:b,style:{cursor:"pointer"},children:[(0,ie.jsx)(Sr.q,{strokeDasharray:"3 3"}),(0,ie.jsx)(Pr.K,{dataKey:"x",scale:"linear",unit:null===(t=c.info)||void 0===t?void 0:t.unit,domain:["auto","auto"],tick:{fill:"white"},type:"number",tickFormatter:function(e){return e>1e4?e.toFixed():e.toFixed(1)},label:(0,ie.jsx)(Er._,{fill:"white",dy:10,children:w}),height:50}),(0,ie.jsx)(_r.B,{name:"DMG",domain:["auto","auto"],unit:null===(n=l.info)||void 0===n?void 0:n.unit,allowDecimals:!1,tick:{fill:"white"},type:"number",label:(0,ie.jsx)(Er._,{fill:"white",angle:-90,dx:-40,children:C}),width:100}),(0,ie.jsx)(Ar.u,{content:(0,ie.jsx)(Vr,{xLabel:w,xUnit:null===(a=c.info)||void 0===a?void 0:a.unit,yLabel:C,yUnit:null===(s=l.info)||void 0===s?void 0:s.unit,selectedPoint:m,setSelectedPoint:g,addBuildToList:y}),trigger:"click",wrapperStyle:{pointerEvents:"auto",cursor:"auto"},cursor:!1}),(0,ie.jsx)(Kr.D,{payload:[].concat((0,ue.Z)(u?[{id:"min",value:p(zr||(zr=(0,r.Z)(["tcGraph.statReqThr"]))),type:"line",color:ii}]:[]),[{id:"trueY",value:p(Gr||(Gr=(0,r.Z)(["tcGraph.generatedBuilds"]))),type:"circle",color:ti},{id:"highlighted",value:p(qr||(qr=(0,r.Z)(["tcGraph.highlightedBuilds"]))),type:"square",color:ni},{id:"current",value:p(Hr||(Hr=(0,r.Z)(["tcGraph.currentBuild"]))),type:"diamond",color:ri}])}),u&&(0,ie.jsx)(Or.x,{dataKey:"min",stroke:ii,type:"stepBefore",connectNulls:!0,strokeWidth:2,isAnimationActive:!1,dot:!1,activeDot:!1}),(0,ie.jsx)(Tr.b,{dataKey:"trueY",isAnimationActive:!1,shape:(0,ie.jsx)(Ir,{selectedPoint:m,colorUnselected:ti})}),(0,ie.jsx)(Tr.b,{dataKey:"highlighted",isAnimationActive:!1,shape:(0,ie.jsx)(Ir,{shape:"square",selectedPoint:m,colorUnselected:ni})}),(0,ie.jsx)(Tr.b,{dataKey:"current",isAnimationActive:!1,shape:(0,ie.jsx)(Ir,{shape:"diamond",selectedPoint:m,colorUnselected:ri})})]})})}function si(e,t){var n=Object.fromEntries(e.map((function(e){var n=t.arts.get(e);return n?[n.slotKey,n.id]:[]})));return(0,jt.Uq)(V.eV,(function(e){var t;return[e,null!==(t=n[e])&&void 0!==t?t:""]}))}function oi(e,t){var n,r,i,a,s,o,c;return"string"===typeof(null===(n=e.info)||void 0===n?void 0:n.name)?e.info.name:"".concat(t("".concat(null===(r=e.info)||void 0===r||null===(i=r.name)||void 0===i?void 0:i.props.ns,":").concat(null===(a=e.info)||void 0===a||null===(s=a.name)||void 0===s?void 0:s.props.key18))).concat(null!==(o=e.info)&&void 0!==o&&o.textSuffix?" ".concat(null===(c=e.info)||void 0===c?void 0:c.textSuffix):"")}var ci,li,ui=["sands","goblet","circlet"];function di(e){var t=e.disabled,n=void 0!==t&&t,r=(0,Z.$)("artifact").t,i=Tn((0,j.useContext)(E.K).character.key),a=i.buildSetting.mainStatKeys,s=i.buildSettingDispatch;return(0,ie.jsx)(f.Z,{display:"flex",flexDirection:"column",gap:1,children:ui.map((function(e){var t=a[e].length;return(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)(G.Z,{}),(0,ie.jsxs)(p.Z,{sx:{pt:1},children:[(0,ie.jsxs)(f.Z,{sx:{display:"flex",gap:1,alignItems:"center",pb:1},children:[(0,ie.jsx)(ut.Z,{placement:"top",title:(0,ie.jsx)(U.Z,{children:r("slotName.".concat(e))}),children:(0,ie.jsx)("span",{children:(0,_n.Ir)(e)})}),(0,ie.jsx)(f.Z,{flexGrow:1,children:(0,ie.jsx)(P.Z,{color:"info",children:t?"".concat(t," Selected"):"Any"})}),(0,ie.jsx)(m.Z,{color:"error",size:"small",disabled:!a[e].length||n,sx:{mt:-1,mb:-1},onClick:function(){return s({type:"mainStatKey",slotKey:e})},children:(0,ie.jsx)(xe.Z,{})})]}),(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,children:Qn.ZP.slotMainStats(e).map((function(t,r){var i=V.Kj.find((function(e){return t.includes(e)})),o=a[e].includes(t)?null!==i&&void 0!==i?i:"success":"secondary";return(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,xs:r<3&&"goblet"!==e?4:void 0,children:(0,ie.jsx)(ut.Z,{placement:"top",title:(0,ie.jsx)(U.Z,{children:(0,ie.jsx)("strong",{children:(0,ie.jsx)(nr._,{statKey:t})})}),disableInteractive:!0,children:(0,ie.jsx)(m.Z,{fullWidth:!0,size:"small",color:o,sx:{fontSize:"1.2em",height:"100%",pointerEvents:n?"none":void 0,cursor:n?"none":void 0},onClick:function(){return s({type:"mainStatKey",slotKey:e,mainStatKey:t})},children:Pe.Z[t]})})},t)}))})]})]},e)}))})}function fi(e){var t=e.statFilters,n=e.setStatFilters,r=e.disabled,a=void 0!==r&&r,s=(0,j.useCallback)((function(e,r,i){var a,s=(0,pe.Z)({},t),o=JSON.stringify(r),c=r?(0,ue.Z)(t[o]):void 0,l=JSON.stringify(e),u=(0,ue.Z)(null!==(a=t[l])&&void 0!==a?a:[]);void 0!==i&&c?u.push(c[i]):u.push({value:0,disabled:!1}),s[l]=u,void 0!==i&&c&&(c.splice(i,1),c.length?s[o]=c:delete s[o]),n((0,pe.Z)({},s))}),[n,t]),o=(0,j.useCallback)((function(e,r){var i=(0,pe.Z)({},t),a=JSON.stringify(e),s=(0,ue.Z)(t[a]);s.splice(r,1),s.length?i[a]=s:delete i[a],n((0,pe.Z)({},i))}),[n,t]),c=(0,j.useCallback)((function(e,r,i){var a=(0,pe.Z)({},t),s=JSON.stringify(e),o=(0,ue.Z)(t[s]);o[r]=(0,pe.Z)((0,pe.Z)({},o[r]),{},{value:i}),a[s]=o,n((0,pe.Z)({},a))}),[n,t]),l=(0,j.useCallback)((function(e,r,i){var a=(0,pe.Z)({},t),s=JSON.stringify(e),o=(0,ue.Z)(t[s]);o[r]=(0,pe.Z)((0,pe.Z)({},o[r]),{},{disabled:i}),a[s]=o,n((0,pe.Z)({},a))}),[n,t]);return(0,ie.jsxs)(ie.Fragment,{children:[Object.entries(t).flatMap((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return null===r||void 0===r?void 0:r.map((function(e,t){return(0,ie.jsx)(hi,{path:JSON.parse(n),setting:e,index:t,setTarget:s,delTarget:o,setValue:c,setDisabled:l,disabled:a},n+t)}))})),(0,ie.jsx)(hi,{setTarget:s,delTarget:o,setValue:c,setDisabled:l,disabled:a})]})}function hi(e){var t,n=e.path,r=e.setting,i=e.index,a=e.setTarget,s=e.delTarget,o=e.setValue,c=e.setDisabled,l=e.disabled,u=(0,Z.$)("page_character_optimize").t,d=(0,j.useContext)(_.R).data,f=(0,j.useCallback)((function(e){return n&&void 0!==i&&o(n,i,null!==e&&void 0!==e?e:0)}),[o,n,i]),h={p:1,flexBasis:30,flexGrow:0,flexShrink:0},p=(0,jt.Hm)(d.getDisplay(),null!==n&&void 0!==n?n:[]),x="%"===(null===p||void 0===p||null===(t=p.info)||void 0===t?void 0:t.unit);return(0,ie.jsxs)(Ee.Z,{sx:{"& .MuiButtonGroup-grouped":{minWidth:24},width:"100%"},children:[!!r&&!!n&&void 0!==i&&(0,ie.jsx)(m.Z,{sx:h,color:r.disabled?"secondary":"success",onClick:function(){return c(n,i,!r.disabled)},disabled:l,children:r.disabled?(0,ie.jsx)(me.Z,{}):(0,ie.jsx)(ve.Z,{})}),(0,ie.jsx)(Mr.Z,{showEmptyTargets:!0,optimizationTarget:n,setTarget:function(e){return a(e,n,i)},defaultText:u("targetSelector.selectBuildTarget")}),(0,ie.jsx)(_e.CC,{sx:{flexBasis:150,flexGrow:1},children:(0,ie.jsx)(_e.ZP,{float:!0,disabled:!n||l,value:null===r||void 0===r?void 0:r.value,placeholder:"Stat Value",onChange:f,sx:{px:1},inputProps:{sx:{textAlign:"right"}},endAdornment:x?"%":void 0})}),!!n&&void 0!==i&&(0,ie.jsx)(m.Z,{sx:h,color:"error",onClick:function(){return s(n,i)},disabled:l,children:(0,ie.jsx)(rt.Z,{fontSize:"small"})})]})}function pi(e){var t=e.disabled,n=void 0!==t&&t,i=(0,Z.$)("page_character_optimize").t,a=Tn((0,j.useContext)(E.K).character.key),s=a.buildSetting.statFilters,o=a.buildSettingDispatch,c=(0,j.useCallback)((function(e){return o({statFilters:e})}),[o]);return(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(p.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,ie.jsx)(U.Z,{children:i(ci||(ci=(0,r.Z)(["constraintFilter.title"])))}),(0,ie.jsx)(An.Z,{title:(0,ie.jsx)(U.Z,{children:i(li||(li=(0,r.Z)(["constraintFilter.tooltip"])))})})]})}),(0,ie.jsx)(f.Z,{display:"flex",flexDirection:"column",gap:.5,children:(0,ie.jsx)(fi,{statFilters:s,setStatFilters:c,disabled:n})})]})}var xi,vi=n(89841),mi=n(70558),ji=n(1235),Zi=n(68125),gi=n(68087),yi=n(84684),bi=n(77208),wi=j.lazy((function(){return n.e(381).then(n.bind(n,4332))}));function Ci(e){var t=e.disabled,n=void 0!==t&&t,a=(0,Z.$)("page_character_optimize").t,s=(0,j.useContext)(E.K).character.key,o=Tn(s),c=o.buildSetting.useEquippedArts,l=o.buildSettingDispatch,u=(0,j.useContext)(T.t).database,d=(0,D.Z)(!1),h=(0,i.Z)(d,3),x=h[0],v=h[1],g=h[2],y=(0,j.useState)(u.displayOptimize.get()),k=(0,i.Z)(y,2),S=k[0].equipmentPriority,_=k[1];(0,j.useEffect)((function(){return u.displayOptimize.follow((function(e,t){return _(t)}))}),[u,_]);var A=(0,j.useMemo)((function(){return(0,ue.Z)(new Set(S)).filter((function(e){return u.chars.get(e)}))}),[u,S]),K=(0,j.useCallback)((function(e){return u.displayOptimize.set({equipmentPriority:e})}),[u]),O=(0,j.useCallback)((function(e,t){var n=(0,ue.Z)(A),r=n[e];n.splice(e,1),n.splice(t,0,r),K(n)}),[A,K]),M=(0,j.useCallback)((function(e){var t=(0,ue.Z)(A);t.splice(e,1),K(t)}),[A,K]),I=(0,j.useCallback)((function(e){return K([].concat((0,ue.Z)(A),[e]))}),[A,K]),R=(0,j.useCallback)((function(){return K([])}),[K]),W=(0,j.useMemo)((function(){var e=A.length,t=A.indexOf(s);return t>=0&&(e=t),e}),[s,A]),$=(0,j.useMemo)((function(){return u.chars.keys.length-1-W}),[W,u]),N=(0,j.useMemo)((function(){return u.chars.keys.length-A.length}),[A,u]);return(0,ie.jsxs)(f.Z,{display:"flex",gap:1,children:[(0,ie.jsx)(te.Z,{open:x,onClose:g,containerProps:{maxWidth:"sm"},children:(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsx)(U.Z,{variant:"h6",children:a(xi||(xi=(0,r.Z)(["useEquipped.modal.title"])))})}),(0,ie.jsx)(fe.ZP,{item:!0,sx:{mb:-1},children:(0,ie.jsx)(C.Z,{onClick:g})})]})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(w.Z,{sx:{mb:1},children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(U.Z,{gutterBottom:!0,children:(0,ie.jsx)(ct.c,{t:a,i18nKey:"useEquipped.modal.desc1",children:"When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list."})}),(0,ie.jsx)(U.Z,{gutterBottom:!0,children:(0,ie.jsx)(ct.c,{t:a,i18nKey:"useEquipped.modal.desc2",children:"If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list."})})]})}),(0,ie.jsxs)(f.Z,{display:"flex",flexDirection:"column",gap:2,children:[A.map((function(e,t){return(0,ie.jsx)(Si,{characterKey:e,rank:t+1,maxRank:A.length,setRank:function(e){return e&&O(t,e-1)},onRemove:function(){return M(t)},numAbove:W},e)})),(0,ie.jsxs)(f.Z,{sx:{display:"flex",gap:1},children:[(0,ie.jsx)(Pi,{onAdd:I,list:A}),(0,ie.jsx)(m.Z,{color:"error",onClick:R,startIcon:(0,ie.jsx)(xe.Z,{}),children:(0,ie.jsx)(ct.c,{t:a,i18nKey:"useEquipped.modal.clearList",children:"Clear List"})})]}),!!$&&(0,ie.jsx)(P.Z,{color:"success",children:(0,ie.jsx)(U.Z,{children:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"useEquipped.modal.usingNum",count:N,children:["Using artifacts from ",(0,ie.jsx)("strong",{children:{count:N}})," unlisted characters"]})})})]})]})]})}),(0,ie.jsxs)(Ee.Z,{sx:{display:"flex",width:"100%"},children:[(0,ie.jsx)(m.Z,{sx:{flexGrow:1},onClick:function(){return l({useEquippedArts:!c})},disabled:n,startIcon:c?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:c?"success":"secondary",children:(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)("span",{children:(0,ie.jsx)(ct.c,{t:a,i18nKey:"useEquipped.title",children:"Use Equipped Artifacts"})}),c&&(0,ie.jsx)(P.Z,{children:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"useEquipped.usingNum",count:$,children:["Using from ",(0,ie.jsx)("strong",{children:{count:$}})," characters"]})})]})}),c&&(0,ie.jsx)(m.Z,{sx:{flexShrink:1},color:"info",onClick:v,disabled:n,children:(0,ie.jsx)(ln.Z,{})})]})]})}var ki;function Si(e){var t=e.characterKey,n=e.rank,r=e.maxRank,a=e.setRank,s=e.onRemove,o=e.numAbove,c=(0,Z.$)("page_character_optimize").t,l=(0,j.useContext)(T.t).database,u=(0,M.Z)(t),d=(0,Bt.Z)();if(!u)return null;var h=u.equippedWeapon,p=u.equippedArtifacts;return(0,ie.jsxs)(w.Z,{sx:{p:1},children:[(0,ie.jsxs)(f.Z,{sx:{pb:1,display:"flex",justifyContent:"space-between",gap:1},children:[(0,ie.jsx)(P.Z,{color:"info",children:(0,ie.jsxs)(U.Z,{children:["#",n]})}),(0,ie.jsx)(P.Z,{sx:{flexGrow:1},color:o===n-1?"warning":n-1<o?"error":"success",children:(0,ie.jsx)(U.Z,{children:o===n-1?(0,ie.jsx)(ct.c,{t:c,i18nKey:"useEquipped.modal.status.curr",children:"Current character"}):n-1<o?(0,ie.jsx)(ct.c,{t:c,i18nKey:"useEquipped.modal.status.dont",children:"Don't Use artifacts"}):(0,ie.jsx)(ct.c,{t:c,i18nKey:"useEquipped.modal.status.use",children:"Use artifacts"})})}),(0,ie.jsx)(f.Z,{children:(0,ie.jsxs)(Ee.Z,{sx:{flexGrow:1},size:"small",children:[(0,ie.jsx)(_e.CC,{children:(0,ie.jsx)(_e.ZP,{onChange:a,value:n,inputProps:{min:1,max:r,sx:{textAlign:"center"}},sx:{width:"100%",height:"100%",pl:2}})}),(0,ie.jsx)(m.Z,{disabled:1===n,onClick:function(){return a(1)},children:(0,ie.jsx)(vi.Z,{})}),(0,ie.jsx)(m.Z,{disabled:1===n,onClick:function(){return a(n-1)},children:(0,ie.jsx)(mi.Z,{})}),(0,ie.jsx)(m.Z,{disabled:n===r,onClick:function(){return a(n+1)},children:(0,ie.jsx)(ji.Z,{})}),(0,ie.jsx)(m.Z,{disabled:n===r,onClick:function(){return a(r)},children:(0,ie.jsx)(Zi.Z,{})}),(0,ie.jsx)(m.Z,{color:"error",onClick:s,children:(0,ie.jsx)(nt.Z,{})})]})})]}),(0,ie.jsxs)(fe.ZP,{container:!0,columns:7,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(yi.Z,{characterKey:t,onClick:d})}),(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(bi.Z,{weaponId:h})}),Object.entries(p).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)($r.Z,{slotKey:n,artifactObj:l.arts.get(r)})},n)}))]})]})}function Pi(e){var t=e.onAdd,n=e.list,r=(0,Z.$)("page_character_optimize").t,a=(0,D.Z)(!1),s=(0,i.Z)(a,3),o=s[0],c=s[1],l=s[2],u=(0,j.useCallback)((function(e){return!!e&&!n.includes(e.key)}),[n]);return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(j.Suspense,{fallback:!1,children:(0,ie.jsx)(wi,{show:o,onHide:l,onSelect:t,filter:u})}),(0,ie.jsx)(m.Z,{fullWidth:!0,sx:{height:60},color:"info",onClick:c,startIcon:(0,ie.jsx)(gi.Z,{}),children:(0,ie.jsx)(ct.c,{t:r,i18nKey:"useEquipped.modal.add",children:"Add character to list"})})]})}function Ei(e){var t=e.disabled,n=void 0!==t&&t,r=e.artsDirty,i=(0,Z.$)("page_character_optimize").t,a=(0,j.useContext)(E.K).character.key,s=Tn(a),o=s.buildSetting.useExcludedArts,c=s.buildSettingDispatch,l=(0,j.useContext)(T.t).database,u=(0,j.useMemo)((function(){return r&&l.arts.values.reduce((function(e,t){return e+(t.exclude&&t.location!==a?1:0)}),0)}),[l,r,a]);return(0,ie.jsx)(m.Z,{fullWidth:!0,onClick:function(){return c({useExcludedArts:!o})},disabled:!u||n,startIcon:o?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:o?"success":"secondary",children:(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)("span",{children:(0,ie.jsx)(ct.c,{t:i,i18nKey:"useExcluded.title",count:u,children:"Use Excluded Artifacts"})}),o&&(0,ie.jsx)(P.Z,{children:(0,ie.jsxs)(ct.c,{t:i,i18nKey:"useExcluded.usingNum",count:u,children:["Using ",(0,ie.jsx)("strong",{children:{count:u}})," excluded artifacts"]})})]})})}function _i(){var e=(0,Z.$)("page_character_optimize").t;return(0,ie.jsx)(it.Z,{severity:"error",variant:"filled",onClick:function(){return window.location.reload()},sx:{"& .MuiAlert-message":{flexGrow:1,cursor:"pointer"}},children:e(ki||(ki=(0,r.Z)(["workerLoadFailed"])))})}var Ai,Ki,Oi,Ti,Di,Mi=n(50765),Ii=(0,pt.yY)((0,jt.I8)({dyn:(0,pe.Z)((0,pe.Z)({},ge.qH.art),ge.qH.artSet)})),Ri={art:(0,jt.O)([].concat((0,ue.Z)(Mi.r),(0,ue.Z)(Mi._)),(function(e){return Ii.dyn[e]})),artSet:(0,jt.xh)(ge.qH.artSet,(function(e,t){return Ii.dyn[t]}))};function Wi(e,t,n){var r,i={base:{},values:{flower:[],plume:[],goblet:[],circlet:[],sands:[]}},a=new Set,s=(0,et.Z)(e);try{for(s.s();!(r=s.n()).done;){var o,c=r.value,l=Qn.ZP.mainStatValue(c.mainStatKey,c.rarity,Math.max(Math.min(t,4*c.rarity),c.level)),u={id:c.id,set:c.setKey,values:(0,pe.Z)((o={},(0,mt.Z)(o,c.setKey,1),(0,mt.Z)(o,c.mainStatKey,c.mainStatKey.endsWith("_")?l/100:l),o),Object.fromEntries(c.substats.map((function(e){return[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]}))))};delete u.values[""],i.values[c.slotKey].push(u),Object.keys(u.values).forEach((function(e){return a.add(e)}))}}catch(h){s.e(h)}finally{s.f()}if(i.base=(0,jt.O)((0,ue.Z)(a),(function(e){return 0})),n)for(var d=0,f=Object.values(i.values);d<f.length;d++){f[d].push({id:"",values:{}})}return i}function $i(e,t,n){var r=n.optimizationTarget,a=n.constraints,s=n.artSetExclusion,o=n.depth,c=n.filters,l=[].concat((0,ue.Z)(a.map((function(e){return e.value}))),[r]),u=a.map((function(e){return e.min}));if(0!==(c=c.filter((function(e){var n=e.maxw;return!u.some((function(e,t){return n[t]<e}))&&!(n[u.length]<t)}))).length){var d=function(e){for(var t=(0,ue.Z)(e[0].lower),n=(0,ue.Z)(e[0].upper),r=(0,ue.Z)(e[0].minw),i=(0,ue.Z)(e[0].maxw),a=1;a<e.length;a++){for(var s=0;s<t.length;s++)t[s]=Math.min(t[s],e[a].lower[s]),n[s]=Math.max(n[s],e[a].upper[s]);for(var o=0;o<r.length;o++)r[o]=Math.min(r[o],e[a].minw[o]),i[o]=Math.max(i[o],e[a].maxw[o])}return{lower:t,upper:n,minw:r,maxw:i}}(c),f=d.lower,h=d.upper,p=Object.fromEntries(e.keys.map((function(e,t){return[e,f[t]]}))),x=Object.fromEntries(e.keys.map((function(e,t){return[e,h[t]]})));l=function(e,t,n){var r=Object.keys(t).filter((function(e){return Math.abs(t[e]-n[e])<1e-6}));return e.map((function(e){var a=e.nodes,s=e.terms,o=Object.entries(a),c=(0,vt.uW)(o.map((function(e){var t=(0,i.Z)(e,2);return t[0],t[1]})),(function(e){return e}),(function(e){switch(e.operation){case"read":return r.includes(e.path[1])?(0,pt.a9)(t[e.path[1]]):e;case"threshold":var a=(0,i.Z)(e.operands,4),s=a[0],o=a[1],c=a[2],l=a[3];if("const"===s.operation&&"const"===o.operation)return s.value>=o.value?c:l;if("read"!==s.operation||"const"!==o.operation)throw Error("Branch between non-read and non-const!!!");return t[s.path[1]]>=o.value?c:n[s.path[1]]<o.value?l:e;case"add":return Wt(e.operands);case"mul":return $t(e.operands);case"res":case"sum_frac":if(e.operands.every((function(e){return"const"===e.operation}))){var u=xt.aj[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})));return(0,pt.a9)(u)}return e;case"min":case"max":if(e.operands.every((function(e){return"const"===e.operation}))){var d=xt.aj[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})));return(0,pt.a9)(d)}return e;default:return e}})),l={};c.forEach((function(e,t){if("const"===e.operation){var n=(0,i.Z)(o[t],1)[0];l[n]=e.value}}));var u=s.map((function(e){var t=e.coeff,n=e.terms.filter((function(e){return void 0===l[e]||(t*=l[e],!1)}));return 0===t?{coeff:0,terms:[]}:{coeff:t,terms:n}})),d=Object.fromEntries(c.map((function(e,t){return[o[t][0],e]})));return Object.keys(l).forEach((function(e){return delete d[e]})),{nodes:d,terms:Kt(u)}}))}(l,p,x);for(var v=(0,xt.I3)(a.map((function(e){return function(e){var t=e.nodes,n=e.terms;return pt.Sm.apply(void 0,(0,ue.Z)(n.map((function(e){var n=e.coeff,r=e.terms;return pt.WV.apply(void 0,[n].concat((0,ue.Z)(r.map((function(e){return t[e]})))))}))))}(e.value)})),{},(function(e){return e.path[1]}),1),m=v([{id:"",values:p}]),j=u.map((function(e,t){return e>m[t]})),Z=l.pop(),g=l.map((function(e,t){return{value:e,min:u[t]}})).filter((function(e,t){return j[t]})),y=g.map((function(e){return e.min})),b={},w=function(){var e=(0,i.Z)(k[C],2),t=e[0],n=e[1];if("uniqueKey"===t){b[t]=n;var r=V.q2.filter((function(e){return x[e]>0})),a=0,o=0;if(r.forEach((function(e){var t=(0,jt.w6)(p[e],x[e]);s[e]&&(t=t.filter((function(t){return!s[e].includes(t)}))),(t.includes(4)||t.includes(5))&&a++,(t.includes(2)||t.includes(3))&&o++})),n.includes(5)&&0===a){if(0===o)return{v:void 0};if(n.includes(3)&&o<2)return{v:void 0}}return"continue"}var c=n.filter((function(e){return p[t]<=e&&e<=x[t]}));if(c.includes(p[t])&&c.includes(x[t]))return{v:void 0};c.length>0&&(b[t]=c)},C=0,k=Object.entries(s);C<k.length;C++){var S=w();if("continue"!==S&&"object"===typeof S)return S.v}var P=[].concat((0,ue.Z)(g.map((function(e){return e.value}))),[Z]).map((function(e){return Rt(e,p,x)}));!function(e,t){var n=[],r=[],a=[];t.forEach((function(t){var s=[],o=[];Object.entries(t.w).forEach((function(t){var n=(0,i.Z)(t,2),r=n[0],a=n[1];s.push(e.keys.indexOf(r)),o.push(a)})),n.push(s),r.push(o),a.push(s.reduce((function(t,n,r){return t+e.base[n]*o[r]}),t.c))})),e.baseBuffer=a,V.eV.forEach((function(t){return e.values[t].forEach((function(e){return e.buffer=n.map((function(t,n){return t.reduce((function(t,i,a){return t+e.values[i]*r[n][a]}),0)}))}))}))}(e,P);var E=c.map((function(t){var n=t.filterVec,r=t.lower,i=t.upper,a=function(e,t){return{keys:e.keys,base:e.base,baseBuffer:e.baseBuffer,values:(0,jt.O)(V.eV,(function(n){var r=t[n],i=e.values[n];return r.map((function(e){return i[e]}))}))}}(e,t.filterVec),s=(0,ue.Z)(a.baseBuffer),o=(0,ue.Z)(a.baseBuffer);return V.eV.forEach((function(e){for(var t=Li(a.values[e]),n=t.minw,r=t.maxw,i=0;i<s.length;i++)s[i]+=n[i],o[i]+=r[i]})),{filterVec:n,lower:r,upper:i,minw:s,maxw:o}})).filter((function(e){var n=e.maxw;return!y.some((function(e,t){return n[t]<e}))&&!(n[u.length]<t)}));return{cache:!0,optimizationTarget:Z,constraints:g,artSetExclusion:b,depth:o,lin:P,filters:E}}}function Ni(e){var t=new Set(Object.keys(e.base));Object.values(e.values).forEach((function(e){e.forEach((function(e){e.set&&t.add(e.set),Object.keys(e.values).forEach((function(e){return t.add(e)}))}))}));var n=(0,ue.Z)(t),r=[].concat((0,ue.Z)(n.filter((function(e){return!V.q2.includes(e)}))),(0,ue.Z)(n.filter((function(e){return V.q2.includes(e)}))));return{keys:r,baseBuffer:[],base:r.map((function(t){var n;return null!==(n=e.base[t])&&void 0!==n?n:0})),values:{flower:e.values.flower.map((function(e){var t=e.id,n=e.set,i=e.values;return{id:t,set:n,values:r.map((function(e){var t;return null!==(t=i[e])&&void 0!==t?t:e===n?1:0})),buffer:[]}})),plume:e.values.plume.map((function(e){var t=e.id,n=e.set,i=e.values;return{id:t,set:n,values:r.map((function(e){var t;return null!==(t=i[e])&&void 0!==t?t:e===n?1:0})),buffer:[]}})),sands:e.values.sands.map((function(e){var t=e.id,n=e.set,i=e.values;return{id:t,set:n,values:r.map((function(e){var t;return null!==(t=i[e])&&void 0!==t?t:e===n?1:0})),buffer:[]}})),goblet:e.values.goblet.map((function(e){var t=e.id,n=e.set,i=e.values;return{id:t,set:n,values:r.map((function(e){var t;return null!==(t=i[e])&&void 0!==t?t:e===n?1:0})),buffer:[]}})),circlet:e.values.circlet.map((function(e){var t=e.id,n=e.set,i=e.values;return{id:t,set:n,values:r.map((function(e){var t;return null!==(t=i[e])&&void 0!==t?t:e===n?1:0})),buffer:[]}}))}}}function Vi(e,t){var n=t.optimizationTargetNode,r=t.nodes,a=t.minimum,s=t.artSetExclusion,o=(0,jt.Uq)(Object.entries(s),(function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return"rainbow"===n?["uniqueKey",r.map((function(e){return e+1}))]:[n,r.flatMap((function(e){return 2===e?[2,3]:[4,5]}))]})),c=r.map((function(e,t){return{value:Ot(e),min:a[t]}})).filter((function(e){return e.min>-1/0})),l=Ot(n),u=function(e){var t=(0,ue.Z)(e.base),n=(0,ue.Z)(e.base),r=(0,ue.Z)(e.baseBuffer),i=(0,ue.Z)(e.baseBuffer);return Object.values(e.values).forEach((function(e){for(var a=function(e){for(var t=(0,ue.Z)(e[0].values),n=(0,ue.Z)(e[0].values),r=(0,ue.Z)(e[0].buffer),i=(0,ue.Z)(e[0].buffer),a=1;a<e.length;a++){for(var s=0;s<t.length;s++)t[s]=Math.min(t[s],e[a].values[s]),n[s]=Math.max(n[s],e[a].values[s]);for(var o=0;o<r.length;o++)r[o]=Math.min(r[o],e[a].buffer[o]),i[o]=Math.max(i[o],e[a].buffer[o])}return{lower:t,upper:n,minw:r,maxw:i}}(e),s=0;s<t.length;s++)t[s]+=a.lower[s],n[s]+=a.upper[s];for(var o=0;o<r.length;o++)r[o]+=a.minw[o],i[o]+=a.maxw[o]})),{lower:t,upper:n,minw:r,maxw:i}}(e),d=u.lower,f=u.upper,h=Object.fromEntries(e.keys.map((function(e,t){return[e,d[t]]}))),p=Object.fromEntries(e.keys.map((function(e,t){return[e,f[t]]}))),x=[].concat((0,ue.Z)(c.map((function(e){return e.value}))),[l]).map((function(e){return Rt(e,h,p)})),v=x.map((function(t){return function(e,t){var n=[],r=[];Object.entries(t.w).forEach((function(t){var a=(0,i.Z)(t,2),s=a[0],o=a[1];n.push(e.keys.indexOf(s)),r.push(o)}));var a=n.reduce((function(t,n,i){return t+e.base[n]*r[i]}),t.c),s=Object.values(e.values).reduce((function(e,t){return e+Math.max.apply(Math,(0,ue.Z)(t.map((function(e){return n.reduce((function(t,n,i){return t+e.values[n]*r[i]}),0)}))))}),a);return{minw:Object.values(e.values).reduce((function(e,t){return e+Math.min.apply(Math,(0,ue.Z)(t.map((function(e){return n.reduce((function(t,n,i){return t+e.values[n]*r[i]}),0)}))))}),a),maxw:s}}(e,t)}));console.log("-----------------------------------------------------------------------"),console.log("lin",x),console.log("-----------------------------------------------------------------------");var m={cache:!0,optimizationTarget:l,constraints:c,artSetExclusion:o,filters:[{filterVec:(0,jt.O)(V.eV,(function(t){return e.values[t].map((function(e,t){return t}))})),lower:d,upper:f,maxw:v.map((function(e){return e.maxw})),minw:v.map((function(e){return e.minw}))}],depth:0,lin:x},j=$i(e,-1/0,m);return console.log(j),function(e,t){var n=Object.fromEntries(Object.entries(e.nodes).map((function(e){var n=(0,i.Z)(e,2),r=n[0],a=n[1];return[r,(0,xt.I3)([a],{},(function(e){return e.path[1]}),1)([{id:"",values:t}])[0]]}))),r=e.terms.map((function(e){return e.coeff*e.terms.reduce((function(e,t){return e*n[t]}),1)}));console.log("Value of {poly(x)}: ",r.reduce((function(e,t){return e+t})))}(l,Object.fromEntries(e.keys.map((function(t,n){return[t,e.base[n]]})))),void 0===j?m:j}function Li(e){for(var t=(0,ue.Z)(e[0].buffer),n=(0,ue.Z)(e[0].buffer),r=1;r<e.length;r++)for(var i=0;i<t.length;i++)t[i]=Math.min(t[i],e[r].buffer[i]),n[i]=Math.max(n[i],e[r].buffer[i]);return{minw:t,maxw:n}}function Fi(){var e,t,a=(0,Z.$)("page_character_optimize").t,s=(0,j.useContext)(E.K).character,o=s.key,l=s.compareData,u=(0,j.useContext)(T.t).database,d=(0,j.useContext)(K),h=d.setChartData,x=d.graphBuilds,v=d.setGraphBuilds,y=(0,j.useState)({type:"inactive",tested:0,failed:0,skipped:0,total:0}),b=(0,i.Z)(y,2),C=b[0],S=b[1],P="inactive"!==C.type,A=(0,zt.Z)(),O=(0,i.Z)(A,2),D=O[0],M=O[1],R=(0,j.useState)(u.displayOptimize.get()),W=(0,i.Z)(R,2),N=W[0],L=N.equipmentPriority,F=N.threads,B=void 0===F?Lt.g:F,z=W[1];(0,j.useEffect)((function(){return u.displayOptimize.follow((function(e,t){return z(t)}))}),[u,z]);var q=B>Lt.g?Lt.g:B,H=(0,j.useCallback)((function(e){return u.displayOptimize.set({threads:e})}),[u]),J=(0,I.Z)(o),Y=(0,Bt.Z)();(0,j.useEffect)((function(){S({type:"inactive",tested:0,failed:0,skipped:0,total:0})}),[o]);var X=(0,j.useMemo)((function(){return!u.arts.values.length}),[u]),Q=Tn(o),ee=Q.buildSetting,te=Q.buildSettingDispatch,ne=ee.plotBase,re=ee.optimizationTarget,ae=ee.mainStatAssumptionLevel,se=ee.allowPartial,oe=ee.maxBuildsToShow,ce=ee.levelLow,le=ee.levelHigh,de=Dr(o),he=de.buildResult,xe=he.builds,je=he.buildDate,Ze=de.buildResultDispatch,ge=(0,$.Z)(o,ae),ye=null!==(e=null===ge||void 0===ge?void 0:ge[o])&&void 0!==e?e:{},be=ye.characterSheet,we=ye.target,Ce=re&&(0,jt.Hm)(null===we||void 0===we?void 0:we.getDisplay(),re),ke=["xs","sm"].includes((0,Gt.Z)());(0,j.useEffect)((function(){return u.arts.followAny(M)}),[M,u]);var Se=(0,j.useRef)((function(){}));(0,j.useEffect)((function(){return function(){return Se.current()}}),[]);var Pe=(0,j.useState)(!1),_e=(0,i.Z)(Pe,2),Ae=_e[0],Ke=_e[1],Oe=(0,j.useCallback)((0,tt.Z)((0,Qe.Z)().mark((function e(){var t,r,a,s,c,l,d,f,p,x,v,m,j,Z,g,y,b,w,C,k,P,E,_,A,K,O,T,D,M,I,R,W,N,F,B,z,G,H,U,J,Y,X,Q,te,ne,re,ie,ae,se,oe,ce,le,de,fe,he,xe,ve,me,je,ge;return(0,Qe.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe=function(e){return{command:"share",sender:e}},se=function(){var e=Q.shift();if(e){var t=e.filters.reduce((function(e,t){var n=t.filterVec;return e+V.eV.reduce((function(e,t){return e*n[t].length}),1)}),0);return t<=X?{command:"iterate",threshold:ie.buildValues[j-1].val,subproblem:e}:{command:"split",threshold:ie.buildValues[j-1].val,minCount:X,maxIter:Y,subproblem:e}}},ae=function(){return{command:"split",minCount:X,maxIter:Y,threshold:ie.buildValues[j-1].val}},s=ee.artSetExclusion,c=ee.plotBase,l=ee.statFilters,d=ee.mainStatKeys,f=ee.optimizationTarget,p=ee.mainStatAssumptionLevel,x=ee.useExcludedArts,v=ee.useEquippedArts,m=ee.allowPartial,j=ee.maxBuildsToShow,Z=ee.levelLow,g=ee.levelHigh,o&&f){e.next=6;break}return e.abrupt("return");case 6:return y=new Set,v&&((b=L.indexOf(o))<0?L.forEach((function(e){return y.add((0,V.V7)(e))})):L.slice(0,b).forEach((function(e){return y.add((0,V.V7)(e))}))),w=u.arts.values.filter((function(e){if(e.level<Z)return!1;if(e.level>g)return!1;var t=d[e.slotKey];return!(null!==t&&void 0!==t&&t.length&&!t.includes(e.mainStatKey))&&(e.location===(0,V.V7)(o)||!(e.exclude&&!x)&&(!(e.location&&!v)&&!(e.location&&v&&y.has(e.location))))})),C=Wi(w,p,m),e.next=12,(0,$.V)(u,o,p,[]);case 12:if(k=e.sent){e.next=15;break}return e.abrupt("return");case 15:if(P=null===(t=(0,Ft.Qo)(k.teamData,o)[o])||void 0===t?void 0:t.target.data[0]){e.next=18;break}return e.abrupt("return");case 18:if(Object.assign(P,(0,Ft.b3)([P,Ri])),E=(0,jt.Hm)(null!==(r=P.display)&&void 0!==r?r:{},f)){e.next=22;break}return e.abrupt("return");case 22:for(_=E,A=Object.entries(l).flatMap((function(e){var t=(0,i.Z)(e,2),n=t[0];return t[1].filter((function(e){return!e.disabled})).map((function(e){var t,r,i=(0,jt.Hm)(null!==(t=P.display)&&void 0!==t?t:{},JSON.parse(n));return{value:i,minimum:"%"===(null===(r=i.info)||void 0===r?void 0:r.unit)?e.value/100:e.value}}))})).filter((function(e){return e.value&&e.minimum>-1/0})),h(void 0),K=new Promise((function(e){return Se.current=e})),O=[].concat((0,ue.Z)(A.map((function(e){return e.value}))),[E]),T=C,D=[].concat((0,ue.Z)(A.map((function(e){return e.minimum}))),[-1/0]),M={tested:0,failed:0,skipped:0,total:NaN,startTime:performance.now()},(I=c&&(0,jt.Hm)(null!==(a=P.display)&&void 0!==a?a:{},c))&&(O.push(I),D.push(-1/0)),T,R=Ut(R=(0,xt.tL)(O,P,(function(e){return"dyn"!==(0,i.Z)(e.path,1)[0]})),s),W=Ht(R,D,T,j,s,{reaffine:!0,pruneArtRange:!0,pruneNodeRange:!0,pruneOrder:!0}),R=W.nodes,T=W.arts,R=kt(R=Nt(R=(0,xt.tL)(R,P,(function(e){return"dyn"!==(0,i.Z)(e.path,1)[0]})),s)),N=Ct(T,R),T=N.a,R=N.nodes,R=(0,xt.tL)(R,{},(function(e){return!1})),F=I?R.pop():void 0,B=R.pop(),z=(0,jt.Uq)(Object.entries(s),(function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return"rainbow"===n?["uniqueKey",r.map((function(e){return e+1}))]:[n,r.flatMap((function(e){return 2===e?[2,3]:[4,5]}))]})),console.log({artSetExclFull:z}),G=R.map((function(e,t){return{node:e,min:D[t]}})).filter((function(e){return e.min>-1/0})),H=Ni(T),U=Vi(H,{optimizationTargetNode:B,nodes:R,minimum:D,artSetExclusion:s}),J={id:-1,ready:!0},Y=5,X=2e3,1,Q=[U],te=new Set,ne=new Set,re=[],ie={buildValues:Array(j).fill(0).map((function(e){return{src:"",val:-1/0}}))},M.total=Object.values(T.values).reduce((function(e,t){return e*t.length}),1),ce=[],le=function(e){var t=new Worker(new URL(n.p+n.u(204),n.b));re.push(t),t.addEventListener("error",(function(e){console.error("Failed to load worker"),Ke(!0),Se.current()}));var r={command:"setup",id:e,arts:T,artsVec:H,optimizationTarget:B,artSetExclusion:s,plotBase:F,maxBuilds:j,constraints:G};t.postMessage(r,void 0);var a=void 0,o=new Promise((function(e){return a=e}));t.onmessage=function(){var e=(0,tt.Z)((0,Qe.Z)().mark((function e(n){var r,s,o,c,l,u,d,f,h,p,x,v;return(0,Qe.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.data,Ke(!1),e.t0=r.command,e.next="interim"===e.t0?5:"split"===e.t0?10:"iterate"===e.t0?15:"finalize"===e.t0?17:"share"===e.t0?20:"count"===e.t0?22:26;break;case 5:return M.tested+=r.tested,M.failed+=r.failed,M.skipped+=r.skipped,r.buildValues&&((s=ie.buildValues).push.apply(s,(0,ue.Z)(r.buildValues.map((function(e){return{src:r.source,val:e}})))),ie.buildValues.sort((function(e,t){return t.val-e.val})).splice(j)),e.abrupt("return");case 10:return Q.push.apply(Q,(0,ue.Z)(r.subproblems)),r.ready&&r.id===J.id&&(J.ready=!0),r.ready?ne.delete(r.id):ne.add(r.id),te.add(r.id),e.abrupt("break",27);case 15:return te.add(r.id),e.abrupt("break",27);case 17:return t.terminate(),a(r),e.abrupt("return");case 20:return r.subproblem?(o={command:"split",threshold:ie.buildValues[j-1],minCount:X,maxIter:Y,subproblem:r.subproblem},re[r.sender].postMessage(o),ne.add(r.sender)):te.add(r.sender),e.abrupt("break",27);case 22:return c=(0,i.Z)(r.counts,2),l=c[0],u=c[1],M.total=u,M.skipped+=u-l,e.abrupt("return");case 26:console.log("DEBUG",r);case 27:d=(0,ue.Z)(te),f=(0,et.Z)(d);try{for(f.s();!(h=f.n()).done;)p=h.value,x=re[p],v=void 0,Q.length>=1?v=se():ne.has(p)&&(v=ae()),v||(v=se()),J.id<0&&(J.id=p,J.ready=!1),v?(te.delete(p),x.postMessage(v)):J.ready||(te.delete(p),re[J.id].postMessage(oe(p)))}catch(m){f.e(m)}finally{f.f()}0===ne.size&&te.size===q&&re.forEach((function(e){return e.postMessage({command:"finalize"})}));case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K.then((function(){return t.terminate()})),ce.push(o)},de=0;de<q;de++)le(de);return fe=setInterval((function(){return S((0,pe.Z)({type:"active"},M))}),100),e.next=67,Promise.any([Promise.all(ce),K]);case 67:he=e.sent,clearInterval(fe),Se.current=function(){},he?(I&&(me=sn(he.map((function(e){return e.plotData}))),je=Object.values(me),"%"===(null===(xe=_.info)||void 0===xe?void 0:xe.unit)&&(je=je.map((function(e){return{value:100*e.value,plot:e.plot,artifactIds:e.artifactIds}}))),"%"===(null===(ve=I.info)||void 0===ve?void 0:ve.unit)&&(je=je.map((function(e){var t=e.value,n=e.plot;return{value:t,plot:100*(null!==n&&void 0!==n?n:0),artifactIds:e.artifactIds}}))),h({valueNode:_,plotNode:I,data:je})),ge=an(he.map((function(e){return e.builds})),j),Ze({builds:ge.map((function(e){return e.artifactIds})),buildDate:Date.now()})):(M.tested=0,M.failed=0,M.skipped=0,M.total=0),S((0,pe.Z)((0,pe.Z)({},M),{},{type:"inactive",finishTime:performance.now()}));case 72:case"end":return e.stop()}}),e)}))),[o,u,Ze,q,ee,L,h]),Te=null!==(t=null===be||void 0===be?void 0:be.name)&&void 0!==t?t:"Character Name",De=(0,j.useCallback)((function(e){te({plotBase:e}),h(void 0)}),[te,h]),Me=(0,j.useMemo)((function(){return we&&ge&&{data:we,teamData:ge}}),[we,ge]),Ie=(0,ie.jsx)(Mr.Z,{optimizationTarget:re,setTarget:function(e){return te({optimizationTarget:e})},disabled:!!P}),Re=(0,j.useCallback)((function(e){return(0,ie.jsxs)(ct.c,{t:a,i18nKey:"graphBuildLabel",count:e+1,children:["Graph #",{count:e+1}]})}),[a]),We=(0,j.useCallback)((function(e){return"#".concat(e+1)}),[]);return(0,ie.jsxs)(f.Z,{display:"flex",flexDirection:"column",gap:1,children:[X&&(0,ie.jsx)(it.Z,{severity:"warning",variant:"filled",children:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"noArtis",children:["Oops! It looks like you haven't added any artifacts to GO yet! You should go to the ",(0,ie.jsx)(at.Z,{component:g.rU,to:"/artifacts",children:"Artifacts"})," page and add some!"]})}),Me&&(0,ie.jsxs)(_.R.Provider,{value:Me,children:[(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:(0,ie.jsx)(f.Z,{children:(0,ie.jsx)(dt.Z,{characterKey:o,onClickTeammate:Y})})}),(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsxs)(w.Z,{children:[(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(U.Z,{gutterBottom:!0,children:a(Ai||(Ai=(0,r.Z)(["mainStat.title"])))}),(0,ie.jsx)(ut.Z,{placement:"top",title:(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)(U.Z,{variant:"h6",children:a(Ki||(Ki=(0,r.Z)(["mainStat.levelAssTooltip.title"])))}),(0,ie.jsx)(U.Z,{children:a(Oi||(Oi=(0,r.Z)(["mainStat.levelAssTooltip.desc"])))})]}),children:(0,ie.jsx)(f.Z,{children:(0,ie.jsx)($n,{mainStatAssumptionLevel:ae,setmainStatAssumptionLevel:function(e){return te({mainStatAssumptionLevel:e})},disabled:P})})})]}),(0,ie.jsx)(di,{disabled:P})]}),(0,ie.jsx)(Nn,{})]}),(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,sm:6,lg:6,display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsx)(Dn,{disabled:P}),(0,ie.jsx)(Ei,{disabled:P,artsDirty:D}),(0,ie.jsx)(Ci,{disabled:P}),(0,ie.jsx)(m.Z,{fullWidth:!0,startIcon:se?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:se?"success":"secondary",onClick:function(){return te({allowPartial:!se})},disabled:P,children:a(Ti||(Ti=(0,r.Z)(["allowPartial"])))}),(0,ie.jsxs)(w.Z,{children:[(0,ie.jsx)(p.Z,{children:a(Di||(Di=(0,r.Z)(["levelFilter"])))}),(0,ie.jsx)(lt.Z,{levelLow:ce,levelHigh:le,setLow:function(e){return te({levelLow:e})},setHigh:function(e){return te({levelHigh:e})},setBoth:function(e,t){return te({levelLow:e,levelHigh:t})},disabled:P})]}),(0,ie.jsx)(pi,{disabled:P})]})]}),ke&&Ie,(0,ie.jsxs)(Ee.Z,{children:[!ke&&Ie,(0,ie.jsxs)(ft.Z,{disabled:P||!o,title:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"build",count:oe,children:[{count:oe}," Builds"]}),children:[(0,ie.jsx)(st.Z,{children:(0,ie.jsx)(U.Z,{variant:"caption",color:"info.main",children:a("buildDropdownDesc")})}),(0,ie.jsx)(G.Z,{}),qt.s.map((function(e){return(0,ie.jsx)(st.Z,{onClick:function(){return te({maxBuildsToShow:e})},children:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"build",count:e,children:[{count:e}," Builds"]})},e)}))]}),(0,ie.jsxs)(ft.Z,{disabled:P||!o,sx:{borderRadius:"4px 0px 0px 4px"},title:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"thread",count:q,children:[{count:q}," Threads"]}),children:[(0,ie.jsx)(st.Z,{children:(0,ie.jsx)(U.Z,{variant:"caption",color:"info.main",children:a("threadDropdownDesc")})}),(0,ie.jsx)(G.Z,{}),(0,jt.w6)(1,Lt.g).reverse().map((function(e){return(0,ie.jsx)(st.Z,{onClick:function(){return H(e)},children:(0,ie.jsxs)(ct.c,{t:a,i18nKey:"thread",count:e,children:[{count:e}," Threads"]})},e)}))]}),(0,ie.jsx)(ut.Z,{placement:"top",title:re?"":a("selectTargetFirst"),children:(0,ie.jsx)("span",{children:(0,ie.jsx)(m.Z,{disabled:!o||!re||!Ce||Ce.isEmpty,color:P?"error":"success",onClick:P?function(){return Se.current()}:Oe,startIcon:P?(0,ie.jsx)(nt.Z,{}):(0,ie.jsx)(c.Z,{}),sx:{borderRadius:"0px 4px 4px 0px"},children:a(P?"generateButton.cancel":"generateButton.generateBuilds")})})})]}),Ae&&(0,ie.jsx)(_i,{}),!!o&&(0,ie.jsx)(zn,{status:C,characterName:Te,maxBuildsToShow:oe}),(0,ie.jsx)(f.Z,{children:(0,ie.jsx)(Xr,{disabled:P||!re,plotBase:ne,setPlotBase:De,showTooltip:!re})}),(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsxs)(f.Z,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,ie.jsx)(U.Z,{sx:{flexGrow:1},children:xe?(0,ie.jsxs)("span",{children:["Showing ",(0,ie.jsx)("strong",{children:xe.length+(x?x.length:0)})," build generated for ",Te,". ",!!je&&(0,ie.jsxs)("span",{children:["Build generated on: ",(0,ie.jsx)("strong",{children:new Date(je).toLocaleString()})]})]}):(0,ie.jsx)("span",{children:"Select a character to generate builds."})}),(0,ie.jsx)(m.Z,{disabled:!xe.length,color:"error",onClick:function(){v(void 0),Ze({builds:[],buildDate:0})},children:"Clear Builds"})]}),(0,ie.jsxs)(fe.ZP,{container:!0,display:"flex",spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(k.Hn,{size:"small"})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(k.oX,{size:"small"})}),(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsxs)(ht.Z,{exclusive:!0,value:l,onChange:function(e,t){return J({compareData:t})},size:"small",children:[(0,ie.jsx)(ot.Z,{value:!1,disabled:!l,children:"Show new builds"}),(0,ie.jsx)(ot.Z,{value:!0,disabled:l,children:"Compare vs. equipped"})]})})]})]})}),(0,ie.jsxs)(Vt.Provider,{value:re,children:[x&&(0,ie.jsx)(Bi,{builds:x,characterKey:o,data:we,compareData:l,disabled:!!P,getLabel:Re,setBuilds:v}),(0,ie.jsx)(Bi,{builds:xe,characterKey:o,data:we,compareData:l,disabled:!!P,getLabel:We})]})]})]})}function Bi(e){var t=e.builds,n=e.setBuilds,r=e.characterKey,i=e.data,a=e.compareData,s=e.disabled,o=e.getLabel,c=(0,j.useCallback)((function(e){if(n){var r=(0,ue.Z)(t);r.splice(e,1),n(r)}}),[t,n]);return(0,j.useMemo)((function(){return(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:600}),children:null===t||void 0===t?void 0:t.map((function(e,t){return r&&i&&(0,ie.jsx)(Gi,{characterKey:r,build:e,oldData:i,children:(0,ie.jsx)(zi,{index:t,label:o(t),build:e,compareData:a,disabled:s,deleteBuild:n?c:void 0})},t+e.join())}))})}),[t,r,i,a,s,o,c,n])}function zi(e){var t=e.index,n=e.label,r=e.build,i=e.compareData,a=e.disabled,s=e.deleteBuild,o=(0,Z.$)("page_character_optimize").t,c=(0,y.TH)(),l=(0,y.s0)(),d=(0,j.useCallback)((function(){var e=c.pathname.split("/");e.pop(),l("".concat(e.join("/"),"/theorycraft"),{state:{build:r}})}),[l,r,c.pathname]);return(0,ie.jsx)(gr,{label:n,compareBuild:i,disabled:a,extraButtonsLeft:(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(m.Z,{color:"info",size:"small",startIcon:(0,ie.jsx)(u.Z,{}),onClick:d,children:o("theorycraftButton")}),s&&(0,ie.jsx)(m.Z,{color:"error",size:"small",startIcon:(0,ie.jsx)(rt.Z,{}),onClick:function(){return s(t)},children:o("removeBuildButton")})]})})}function Gi(e){var t=e.children,n=e.characterKey,r=e.build,a=e.oldData,s=(0,j.useContext)(T.t).database,o=Tn(n).buildSetting.mainStatAssumptionLevel,c=(0,zt.Z)(),l=(0,i.Z)(c,2),u=l[0],d=l[1];(0,j.useEffect)((function(){return s.arts.followAny((function(e){return r.includes(e)&&d()}))}),[s,r,d]);var f=(0,j.useMemo)((function(){return u&&r.map((function(e){return s.arts.get(e)}))}),[u,r,s]),h=(0,$.Z)(n,o,f),p=(0,j.useMemo)((function(){return h&&{data:h[n].target,teamData:h,oldData:a}}),[h,a,n]);return p?(0,ie.jsx)(_.R.Provider,{value:p,children:t}):null}var qi,Hi,Ui=n(14361),Ji=n(90690),Yi=n(72910),Xi=n(2139),Qi=n(65106),ea=n(97719),ta=n(95193),na=n(40165),ra=n(15678),ia=n(901),aa=n(90543),sa=n(44824),oa=n(46956),ca=n(99405);function la(e){var t=e.artId,n=e.weaponId,a=(0,Z.$)("page_character").t,s=(0,D.Z)(!1),o=(0,i.Z)(s,3),c=o[0],l=o[1],u=o[2];return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(te.Z,{open:c,onClose:u,containerProps:{maxWidth:"xl"},children:(0,ie.jsx)(ua,{artId:t,weaponId:n,onHide:u})}),(0,ie.jsx)(na.Z,{title:(0,ie.jsx)(U.Z,{children:a(qi||(qi=(0,r.Z)(["tabEquip.compare"])))}),placement:"top",arrow:!0,children:(0,ie.jsx)(m.Z,{color:"info",size:"small",onClick:l,children:(0,ie.jsx)(ca.Z,{})})})]})}function ua(e){var t=e.artId,n=e.weaponId,r=e.onHide,i=(0,j.useContext)(T.t).database,a=(0,j.useContext)(E.K).character,s=a.key,o=a.equippedArtifacts,c=Tn(s).buildSetting.mainStatAssumptionLevel,l=(0,j.useContext)(_.R).data,u=(0,j.useMemo)((function(){var e=i.arts.get(null!==t&&void 0!==t?t:""),n=(0,jt.xh)(o,(function(t,n){return n===(null===e||void 0===e?void 0:e.slotKey)?e:i.arts.get(t)}));return Object.values(n).filter((function(e){return e}))}),[i,o,t]),d=(0,$.Z)(s,c,u,n?i.weapons.get(n):void 0),f=(0,j.useMemo)((function(){return d&&{data:d[s].target,teamData:d,oldData:l}}),[s,d,l]);return(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:600}),children:f&&(0,ie.jsx)(_.R.Provider,{value:f,children:(0,ie.jsx)(gr,{compareBuild:!0,extraButtonsLeft:(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(k.Hn,{size:"small"}),(0,ie.jsx)(k.oX,{size:"small"})]}),extraButtonsRight:(0,ie.jsx)(ie.Fragment,{children:(0,ie.jsx)(m.Z,{size:"small",color:"error",onClick:r,children:(0,ie.jsx)(nt.Z,{})})})})})})}var da={xs:6,sm:6,md:9,lg:12,xl:12},fa=(0,j.lazy)((function(){return n.e(182).then(n.bind(n,37673))}));function ha(e){var t=e.onChangeId,n=e.slotKey,a=e.show,s=e.onClose,o=(0,Z.$)("page_character").t,c=(0,j.useContext)(T.t).database,l=(0,j.useCallback)((function(e){t(e),s()}),[t,s]),u=(0,j.useCallback)((function(e,t){return(0,pe.Z)((0,pe.Z)((0,pe.Z)({},e),t),{},{slotKeys:[n]})}),[n]),d=(0,j.useReducer)(u,(0,pe.Z)((0,pe.Z)({},(0,sa.Af)()),{},{slotKeys:[n]})),x=(0,i.Z)(d,2),v=x[0],m=x[1],g=(0,zt.Z)(),y=(0,i.Z)(g,2),w=y[0],k=y[1];(0,j.useEffect)((function(){return c.arts.followAny(k)}),[c,k]);var S=(0,Gt.Z)(),P=(0,j.useMemo)((function(){return(0,sa.EM)()}),[]),E=(0,j.useMemo)((function(){var e=(0,oa.C)(v,P);return w&&c.arts.values.filter(e).map((function(e){return e.id})).slice(0,da[S])}),[w,c,P,v,S]);return(0,ie.jsx)(te.Z,{open:a,onClose:s,containerProps:{maxWidth:"xl"},children:(0,ie.jsxs)(b.Z,{children:[(0,ie.jsxs)(p.Z,{sx:{py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ie.jsxs)(U.Z,{variant:"h6",children:[n?(0,ie.jsx)(ee.Z,{src:Xn.Z.slot[n]}):null," ",o(Hi||(Hi=(0,r.Z)(["tabEquip.swapArt"])))]}),(0,ie.jsx)(C.Z,{onClick:s})]}),(0,ie.jsx)(G.Z,{}),(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,ie.jsx)(fa,{filterOption:v,filterOptionDispatch:m,disableSlotFilter:!0})}),(0,ie.jsx)(f.Z,{mt:1,children:(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:300}),children:(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:E.map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(vr.Z,{artifactId:e,extraButtons:(0,ie.jsx)(la,{artId:e}),onClick:l})},e)}))})})})]})]})})}var pa,xa,va,ma,ja,Za,ga,ya=n(58165),ba=n(75308),wa=n(66045),Ca=(0,ba.X)((0,ue.Z)(V.wC));function ka(e){var t=e.onChangeId,n=e.weaponTypeKey,a=e.show,s=e.onClose,o=(0,Z.$)(["page_character","page_weapon","weaponNames_gen"]).t,c=(0,j.useContext)(T.t).database,l=(0,j.useCallback)((function(e){t(e),s()}),[t,s]),u=(0,zt.Z)(),d=(0,i.Z)(u,2),h=d[0],x=d[1];(0,j.useEffect)((function(){return c.weapons.followAny(x)}),[x,c]);var v=(0,W.Z)((function(){return ur.Z.getAll}),[]),m=(0,j.useState)([5,4,3]),g=(0,i.Z)(m,2),y=g[0],w=g[1],k=(0,j.useState)(""),S=(0,i.Z)(k,2),P=S[0],E=S[1],_=(0,j.useDeferredValue)(P),A=(0,j.useMemo)((function(){var e,t;return null!==(e=v&&h&&c.weapons.values.filter((0,oa.C)({weaponType:n,rarity:y,name:_},(0,wa.Xg)(v))).sort((0,oa.e)(null!==(t=wa.gd.level)&&void 0!==t?t:[],!1,(0,wa.Sn)(v))).map((function(e){return e.id})))&&void 0!==e?e:[]}),[h,c,v,y,n,_]);return(0,ie.jsx)(te.Z,{open:a,onClose:s,children:(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(p.Z,{sx:{py:1},children:(0,ie.jsxs)(fe.ZP,{container:!0,children:[(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsxs)(U.Z,{variant:"h6",children:[n?(0,ie.jsx)(ee.Z,{src:Xn.Z.weaponTypes[n]}):null," ",o(pa||(pa=(0,r.Z)(["page_character:tabEquip.swapWeapon"])))]})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(C.Z,{onClick:s})})]})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsxs)(p.Z,{children:[(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,mb:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(ht.Z,{sx:{height:"100%"},value:y,size:"small",children:V.wC.map((function(e){return(0,ie.jsx)(ot.Z,{value:e,onClick:function(){return w(Ca(y,e))},children:(0,ie.jsxs)(f.Z,{display:"flex",gap:1,children:[(0,ie.jsx)("strong",{children:e}),(0,ie.jsx)(Kn.q,{stars:1})]})},e)}))})}),(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsx)(ya.Z,{autoFocus:!0,size:"small",value:P,onChange:function(e){return E(e.target.value)},label:o("page_weapon:weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,children:A.map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:6,sm:6,md:4,lg:3,children:(0,ie.jsx)(aa.Z,{weaponId:e,onClick:l,extraButtons:(0,ie.jsx)(la,{weaponId:e})})},e)}))})]})]})})}var Sa=(0,j.lazy)((function(){return n.e(923).then(n.bind(n,74476))}));function Pa(){var e,t=(0,j.useContext)(E.K),n=t.character,r=n.equippedWeapon,a=n.key,s=t.characterSheet,o=Tn(a).buildSetting.mainStatAssumptionLevel,c=(0,j.useContext)(_.R),l=c.teamData,u=c.data,d=null===(e=l[a])||void 0===e?void 0:e.weaponSheet,h=(0,j.useState)(""),x=(0,i.Z)(h,2),v=x[0],m=x[1],Z=(0,j.useCallback)((function(){return m(r)}),[r]),g=(0,j.useCallback)((function(){return m("")}),[]);(0,j.useEffect)((function(){v&&v!==r&&m(r)}),[v,r]);var y=(0,Jn.Z)(),b=(0,ta.Z)(y.breakpoints.up("lg")),C=(0,j.useMemo)((function(){return d&&d.document.length>0&&(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(dn.Z,{sections:d.document})})})}),[d]),k=(0,Qi.Z)(a).rvFilter,S=(0,j.useDeferredValue)(k),P=(0,j.useMemo)((function(){return new Set(S)}),[S]);return(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)(j.Suspense,{fallback:!1,children:(0,ie.jsx)(Sa,{weaponId:v,footer:!0,onClose:g,extraButtons:(0,ie.jsx)(Aa,{weaponTypeKey:s.weaponTypeKey})})}),(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[b&&(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:12,lg:3,xl:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[C&&C,(0,ie.jsx)(Oa,{})]}),(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:12,lg:9,xl:9,container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:12,sm:6,md:4,display:"flex",flexDirection:"column",gap:1,children:(0,ie.jsx)(aa.Z,{weaponId:r,onEdit:Z,canEquip:!0,extraButtons:(0,ie.jsx)(_a,{weaponTypeKey:s.weaponTypeKey})})}),V.eV.map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:12,sm:6,md:4,children:u.get(ge.ri.art[e].id).value?(0,ie.jsx)(vr.Z,{artifactId:u.get(ge.ri.art[e].id).value,mainStatAssumptionLevel:o,effFilter:P,extraButtons:(0,ie.jsx)(Ka,{slotKey:e}),editorProps:{},canExclude:!0,canEquip:!0}):(0,ie.jsx)(Ea,{slotKey:e})},e)}))]}),!b&&(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:12,xl:3,container:!0,spacing:1,children:[C&&(0,ie.jsx)(fe.ZP,{item:!0,xs:12,md:6,lg:4,children:C}),(0,ie.jsx)(fe.ZP,{item:!0,xs:12,md:6,lg:4,sx:{display:"flex",flexDirection:"column",gap:1},children:(0,ie.jsx)(Oa,{})})]})]})]})}function Ea(e){var t=e.slotKey,n=(0,j.useContext)(E.K).character.key,r=(0,j.useContext)(T.t).database,a=(0,D.Z)(),s=(0,i.Z)(a,3),o=s[0],c=s[1],l=s[2];return(0,ie.jsxs)(w.Z,{sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(U.Z,{children:(0,ie.jsx)(_n.ZP,{slotKey:t})})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsxs)(f.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,ie.jsx)(ha,{slotKey:t,show:o,onClose:l,onChangeId:function(e){return r.arts.set(e,{location:(0,V.V7)(n)})}}),(0,ie.jsx)(m.Z,{onClick:c,color:"info",sx:{borderRadius:"1em"},children:(0,ie.jsx)(ea.Z,{sx:{height:100,width:100}})})]})]})}function _a(e){var t=e.weaponTypeKey,n=(0,Z.$)("page_character").t,a=(0,j.useContext)(E.K).character.key,s=(0,j.useContext)(T.t).database,o=(0,D.Z)(),c=(0,i.Z)(o,3),l=c[0],u=c[1],d=c[2];return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(na.Z,{title:(0,ie.jsx)(U.Z,{children:n(xa||(xa=(0,r.Z)(["tabEquip.swapWeapon"])))}),placement:"top",arrow:!0,children:(0,ie.jsx)(m.Z,{color:"info",size:"small",onClick:u,children:(0,ie.jsx)(ea.Z,{})})}),(0,ie.jsx)(ka,{weaponTypeKey:t,onChangeId:function(e){return s.weapons.set(e,{location:(0,V.V7)(a)})},show:l,onClose:d})]})}function Aa(e){var t=e.weaponTypeKey,n=(0,Z.$)("page_character").t,a=(0,j.useContext)(E.K).character.key,s=(0,j.useContext)(T.t).database,o=(0,D.Z)(),c=(0,i.Z)(o,3),l=c[0],u=c[1],d=c[2];return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(m.Z,{color:"info",onClick:u,startIcon:(0,ie.jsx)(ea.Z,{}),children:n(va||(va=(0,r.Z)(["tabEquip.swapWeapon"])))}),(0,ie.jsx)(ka,{weaponTypeKey:t,onChangeId:function(e){return s.weapons.set(e,{location:(0,V.V7)(a)})},show:l,onClose:d})]})}function Ka(e){var t=e.slotKey,n=(0,Z.$)("page_character").t,a=(0,j.useContext)(E.K).character.key,s=(0,j.useContext)(T.t).database,o=(0,D.Z)(),c=(0,i.Z)(o,3),l=c[0],u=c[1],d=c[2];return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(na.Z,{title:(0,ie.jsx)(U.Z,{children:n(ma||(ma=(0,r.Z)(["tabEquip.swapArt"])))}),placement:"top",arrow:!0,children:(0,ie.jsx)(m.Z,{color:"info",size:"small",onClick:u,children:(0,ie.jsx)(ea.Z,{})})}),(0,ie.jsx)(ha,{slotKey:t,show:l,onClose:d,onChangeId:function(e){return s.arts.set(e,{location:(0,V.V7)(a)})}})]})}function Oa(){var e,t=(0,Z.$)(["page_character","artifact"]).t,n=(0,j.useContext)(T.t).database,a=(0,j.useContext)(E.K),s=a.character,o=a.character,c=o.key,l=o.equippedArtifacts,u=(0,j.useContext)(_.R).data,d=(0,W.Z)((function(){return un.y.getAll}),[]),f=(0,j.useMemo)((function(){return!!Object.values(l).filter((function(e){return e})).length}),[l]),h=(0,j.useCallback)((function(){s&&window.confirm("Do you want to move all currently equipped artifacts to inventory?")&&Object.values(l).forEach((function(e){return n.arts.set(e,{location:""})}))}),[s,n,l]),x=(0,j.useMemo)((function(){return d&&un.y.setEffects(d,u)}),[d,u]),v=(0,Qi.Z)(c).rvFilter,g=(0,j.useCallback)((function(e){return n.charMeta.set(c,{rvFilter:e})}),[n,c]),y=(0,D.Z)(),C=(0,i.Z)(y,3),k=C[0],S=C[1],P=C[2],A=(0,j.useDeferredValue)(v),K=(0,j.useMemo)((function(){var e=Object.values(l).reduce((function(e,t){var r=n.arts.get(t);if(r){var i=Qn.ZP.getArtifactEfficiency(r,new Set(A)),a=i.currentEfficiency,s=i.maxEfficiency,o=Qn.ZP.getArtifactEfficiency(r,new Set(Mi._)),c=o.currentEfficiency,l=o.maxEfficiency;e.currentEfficiency=e.currentEfficiency+a,e.maxEfficiency=e.maxEfficiency+s,e.currentEfficiency_=e.currentEfficiency_+c,e.maxEfficiency_=e.maxEfficiency_+l}return e}),{currentEfficiency:0,currentEfficiency_:0,maxEfficiency:0,maxEfficiency_:0}),i=e.currentEfficiency,a=e.currentEfficiency_,s=e.maxEfficiency,o=e.maxEfficiency_;return{rvField:{text:t(ja||(ja=(0,r.Z)(["artifact:editor.curSubEff"]))),value:i-a?(0,ie.jsxs)("span",{children:[(0,ie.jsx)(ia.Z,{value:i,max:4500,valid:!0})," / ",(0,ie.jsx)(ia.Z,{value:a,max:4500,valid:!0})]}):(0,ie.jsx)(ia.Z,{value:i,max:4500,valid:!0})},rvmField:{text:t(Za||(Za=(0,r.Z)(["artifact:editor.maxSubEff"]))),canShow:function(){return!!(a-o)},value:s-o?(0,ie.jsxs)("span",{children:[(0,ie.jsx)(ia.Z,{value:s,max:4500,valid:!0})," / ",(0,ie.jsx)(ia.Z,{value:o,max:4500,valid:!0})]}):(0,ie.jsx)(ia.Z,{value:s,max:4500,valid:!0})}}}),[t,A,l,n]),O=K.rvField,M=K.rvmField;return(0,ie.jsxs)(w.Z,{children:[f&&(0,ie.jsx)(m.Z,{color:"error",onClick:h,fullWidth:!0,sx:{borderBottomRightRadius:0,borderBottomLeftRadius:0},children:t(ga||(ga=(0,r.Z)(["tabEquip.unequipArts"])))}),(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(de.Z,{spacing:1,children:[(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(m.Z,{fullWidth:!0,color:"info",startIcon:(0,ie.jsx)(ln.Z,{}),sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0},onClick:S,children:"RV Filter"}),(0,ie.jsx)(te.Z,{open:k,onClose:P,children:(0,ie.jsx)(b.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(ra.Z,{selectedKeys:v,onChange:g})})})}),(0,ie.jsxs)(We.lD,{children:[(0,ie.jsx)(We.ms,{field:O,component:he.ZP}),(null===M||void 0===M||null===(e=M.canShow)||void 0===e?void 0:e.call(M,u))&&(0,ie.jsx)(We.ms,{field:M,component:he.ZP})]})]}),d&&x&&Object.entries(x).flatMap((function(e){var t=(0,i.Z)(e,2),n=t[0];return t[1].map((function(e){return(0,ie.jsx)(b.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,ie.jsx)(fn,{setKey:n,setNumKey:e},n+e)},n+e)}))}))]})})]})}function Ta(){var e=(0,j.useRef)(),t=(0,j.useCallback)((function(){var t,n;return null===e||void 0===e||null===(t=e.current)||void 0===t||null===(n=t.scrollIntoView)||void 0===n?void 0:n.call(t,{behavior:"smooth"})}),[e]);return(0,ie.jsxs)(de.Z,{spacing:1,children:[(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:8,sm:5,md:4,lg:2.3,children:(0,ie.jsx)(Ma,{})}),(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,sm:7,md:8,lg:9.7,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsx)(Da,{onClick:t}),(0,ie.jsx)(w.Z,{sx:{flexGrow:1,p:1},children:(0,ie.jsx)(cr,{})})]})]}),(0,ie.jsx)(f.Z,{ref:e,children:(0,ie.jsx)(Pa,{})})]})}function Da(e){var t=e.onClick,n=(0,j.useContext)(E.K).character.equippedWeapon,r=(0,j.useContext)(_.R).data;return(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,columns:{xs:2,sm:2,md:3,lg:6,xl:6},children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(hr,{weaponId:n,BGComponent:w.Z,onClick:t})}),V.eV.map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(ir,{artifactId:r.get(ge.ri.art[e].id).value,slotKey:e,BGComponent:w.Z,onClick:t})},e)}))]})}function Ma(){var e,t=(0,j.useContext)(T.t).database,n=(0,j.useContext)(E.K),r=n.characterSheet,i=n.character,a=i.key,s=i.team,o=(0,j.useContext)(_.R).data,c=(0,I.Z)(a),l=(0,y.s0)(),u=o.get(ge.ri.charEle).value,d=r.weaponTypeKey,h=o.get(ge.ri.lvl).value,p=o.get(ge.ri.asc).value,x=o.get(ge.ri.constellation).value,v={auto:o.get(ge.ri.total.auto).value,skill:o.get(ge.ri.total.skill).value,burst:o.get(ge.ri.total.burst).value},m={auto:o.get(ge.ri.bonus.auto).value,skill:o.get(ge.ri.bonus.skill).value,burst:o.get(ge.ri.bonus.burst).value},Z=(0,Qi.Z)(a).favorite;return(0,ie.jsxs)(w.Z,{sx:{height:"100%"},children:[(0,ie.jsxs)(f.Z,{sx:{position:"relative"},children:[(0,ie.jsxs)(f.Z,{sx:{position:"absolute",width:"100%",height:"100%"},children:[(0,ie.jsx)(U.Z,{variant:"h6",sx:{position:"absolute",left:"50%",bottom:0,transform:"translate(-50%, -50%)",opacity:.75},children:(0,ie.jsx)(Kn.q,{stars:r.rarity,colored:!0})}),(0,ie.jsx)(f.Z,{sx:{position:"absolute",left:"50%",bottom:"5%",transform:"translate(-50%, -50%)",opacity:.85,width:"100%",display:"flex",justifyContent:"center",px:1},children:(0,ie.jsx)(je.Z,{color:u,sx:{height:"auto"},label:(0,ie.jsxs)(U.Z,{variant:"h6",sx:{display:"flex",gap:1,alignItems:"center"},children:[Pe.Z[u],(0,ie.jsx)(f.Z,{sx:{whiteSpace:"normal",textAlign:"center"},children:r.name}),(0,ie.jsx)(ee.Z,{src:null===(e=Xn.Z.weaponTypes)||void 0===e?void 0:e[d]})]})})}),(0,ie.jsx)(f.Z,{sx:{position:"absolute",left:0,top:0},children:(0,ie.jsx)(Ce.Z,{sx:{p:1},color:"error",onClick:function(){return t.charMeta.set(a,{favorite:!Z})},children:Z?(0,ie.jsx)(Ui.Z,{}):(0,ie.jsx)(Ji.Z,{})})}),(0,ie.jsx)(U.Z,{sx:{p:1,position:"absolute",right:0,top:0,opacity:.8},children:(0,ie.jsx)(P.Z,{children:(0,Xi.wQ)(h,p)})})]}),(0,ie.jsx)(f.Z,{src:r.cardImg,component:"img",width:"100%",height:"auto"})]}),(0,ie.jsxs)(f.Z,{children:[(0,ie.jsx)(Un.Z,{sx:{p:1},onClick:function(){return l("talent")},children:(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,mt:-1,children:["auto","skill","burst"].map((function(e){var t;return(0,ie.jsx)(fe.ZP,{item:!0,xs:4,children:(0,ie.jsx)(Yi.Z,{badgeContent:v[e],color:m[e]?"info":"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{width:"100%",height:"100%","& > .MuiBadge-badge":{fontSize:"1.25em",padding:".25em .4em",borderRadius:".5em",lineHeight:1,height:"1.25em"}},children:(0,ie.jsx)(f.Z,{component:"img",src:null===(t=r.getTalentOfKey(e))||void 0===t?void 0:t.img,width:"100%",height:"auto"})})},e)}))})}),(0,ie.jsx)(U.Z,{sx:{textAlign:"center",mt:1},variant:"h6",children:r.constellationName}),(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,children:(0,jt.w6)(1,6).map((function(e){var t;return(0,ie.jsx)(fe.ZP,{item:!0,xs:4,children:(0,ie.jsx)(Un.Z,{onClick:function(){return c({constellation:e===x?e-1:e})},children:(0,ie.jsx)(f.Z,{component:"img",src:null===(t=r.getTalentOfKey("constellation".concat(e)))||void 0===t?void 0:t.img,sx:(0,pe.Z)({},x>=e?{}:{filter:"brightness(50%)"}),width:"100%",height:"auto"})})},e)}))}),(0,ie.jsx)(Un.Z,{sx:{p:1},onClick:function(){return l("teambuffs")},children:(0,ie.jsx)(fe.ZP,{container:!0,columns:3,spacing:1,children:(0,jt.w6)(0,2).map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:1,height:"100%",children:(0,ie.jsx)(yi.Z,{characterKey:s[e],index:e})},e)}))})})]})]})}var Ia={xs:12,sm:6,md:4};function Ra(){var e=(0,j.useContext)(E.K),t=e.character,n=e.characterSheet,r=(0,j.useContext)(_.R).data,a=(0,I.Z)(t.key),s=r.get(ge.ri.asc).value,o=r.get(ge.ri.constellation).value,c=(0,Jn.Z)(),l=(0,ta.Z)(c.breakpoints.up("lg")),u=(0,j.useMemo)((function(){return(0,jt.w6)(1,6).map((function(e){return(0,ie.jsx)(Na,{talentKey:"constellation".concat(e),subtitle:"Constellation Lv. ".concat(e),onClickTitle:function(){return a({constellation:e===o?e-1:e})}})}))}),[o,a]);return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Wa,{}),(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[l&&(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(U.Z,{variant:"h6",sx:{textAlign:"center"},children:["Constellation Lv. ",o]})})}),u.map((function(e,t){return(0,ie.jsx)(f.Z,{sx:{opacity:o>=t+1?1:.5},children:e},t)}))]}),(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:[[["auto","Normal/Charged Attack"],["skill","Elemental Skill"],["burst","Elemental Burst"]].map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},Ia),{},{children:(0,ie.jsx)(Na,{talentKey:n,subtitle:r})}),n)})),!!n.getTalentOfKey("sprint")&&(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},Ia),{},{children:(0,ie.jsx)(Na,{talentKey:"sprint",subtitle:"Alternative Sprint"})})),!!n.getTalentOfKey("passive")&&(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0},Ia),{},{children:(0,ie.jsx)(Na,{talentKey:"passive",subtitle:"Passive"})})),[["passive1","Unlocked at Ascension 1",1],["passive2","Unlocked at Ascension 4",4],["passive3","Unlocked by Default",0]].map((function(e){var t=(0,i.Z)(e,3),r=t[0],a=t[1],o=t[2],c=s>=o;return n.getTalentOfKey(r)?(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0,style:{opacity:c?1:.5}},Ia),{},{children:(0,ie.jsx)(Na,{talentKey:r,subtitle:a})}),r):null}))]}),!l&&(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:12,children:(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(U.Z,{variant:"h6",sx:{textAlign:"center"},children:["Constellation Lv. ",o]})})})}),u.map((function(e,t){return(0,ie.jsx)(fe.ZP,(0,pe.Z)((0,pe.Z)({item:!0,sx:{opacity:o>=t+1?1:.5}},Ia),{},{children:e}),t)}))]})]})]})}function Wa(){var e=(0,j.useContext)(_.R).data.getDisplay().reaction;return(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(fe.ZP,{container:!0,spacing:1,children:Object.entries(e).filter((function(e){var t=(0,i.Z)(e,2);t[0];return!t[1].isEmpty})).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(b.Z,{children:(0,ie.jsx)(p.Z,{sx:{p:1,"&:last-child":{pb:1}},children:(0,ie.jsx)(We.JW,{node:r})})})},n)}))})})})}var $a=[1,1,2,4,6,8,10];function Na(e){var t=e.talentKey,n=e.subtitle,r=e.onClickTitle,i=(0,j.useContext)(E.K),a=i.character.talent,s=i.characterSheet,o=i.characterDispatch,c=(0,j.useContext)(_.R).data,l=(0,j.useCallback)((function(e){return(0,ie.jsx)(Un.Z,{onClick:r,children:e})}),[r]),u=(0,j.useCallback)((function(e,t){return o({talent:(0,pe.Z)((0,pe.Z)({},a),{},(0,mt.Z)({},e,t))})}),[a,o]),d=null;if(t in a){var h=c.get(ge.ri.bonus[t]).value,x=c.get(ge.ri.total[t]).value,v=c.get(ge.ri.asc).value;d=(0,ie.jsx)(ft.Z,{fullWidth:!0,title:"Talent Lv. ".concat(x),color:h?"info":"primary",sx:{borderRadius:0},children:(0,jt.w6)(1,$a[v]).map((function(e){return(0,ie.jsxs)(st.Z,{selected:a[t]===e,disabled:a[t]===e,onClick:function(){return u(t,e)},children:["Talent Lv. ",e+h]},e)}))})}var m=s.getTalentOfKey(t);return(0,ie.jsxs)(w.Z,{sx:{height:"100%"},children:[d,(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(tr.Z,{condition:!!r,wrapper:l,children:(0,ie.jsxs)(fe.ZP,{container:!0,sx:{flexWrap:"nowrap"},children:[(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(f.Z,{component:"img",src:null===m||void 0===m?void 0:m.img,sx:{width:60,height:"auto"}})}),(0,ie.jsxs)(fe.ZP,{item:!0,flexGrow:1,sx:{pl:1},children:[(0,ie.jsx)(U.Z,{variant:"h6",children:null===m||void 0===m?void 0:m.name}),(0,ie.jsx)(U.Z,{variant:"subtitle1",children:n})]})]})}),null!==m&&void 0!==m&&m.sections?(0,ie.jsx)(dn.Z,{sections:m.sections,hideDesc:!0,hideHeader:function(e){var n,r=null===(n=e.header)||void 0===n?void 0:n.action;return!(!r||"string"===typeof r)&&r.props.children.props.key18.includes(t)}}):null]})]})}var Va,La,Fa=n(43992),Ba=n(2380),za=n(84082),Ga=n(11741);function qa(){return(0,ie.jsx)(f.Z,{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch",children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,md:6,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsx)(Ha,{}),(0,ie.jsx)(Ua,{})]}),(0,jt.w6)(0,2).map((function(e){return(0,ie.jsx)(fe.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,ie.jsx)(Ja,{index:e})},e)}))]})})}function Ha(){var e,t,n,r=(0,j.useContext)(_.R),a=r.data,s=r.oldData,o=a.getTeamBuff(),c=[];return Object.entries(null!==(e=o.total)&&void 0!==e?e:{}).forEach((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return!r.isEmpty&&0!==r.value&&c.push([["total",n],r])})),Object.entries(null!==(t=o.premod)&&void 0!==t?t:{}).forEach((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return!r.isEmpty&&0!==r.value&&c.push([["premod",n],r])})),Object.entries(null!==(n=o.enemy)&&void 0!==n?n:{}).forEach((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return!r.isEmpty&&"number"===typeof r.value&&0!==r.value&&c.push([["enemy",n],r])})),c.length?(0,ie.jsxs)(w.Z,{children:[(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(U.Z,{children:"Team Buffs"})}),(0,ie.jsx)(G.Z,{}),(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(fe.ZP,{container:!0,children:c.map((function(e){var t,n=(0,i.Z)(e,2),r=n[0],a=n[1];return a&&(0,ie.jsx)(fe.ZP,{item:!0,xs:12,children:(0,ie.jsx)(We.JW,{node:a,oldValue:null===(t=(0,jt.Hm)(null===s||void 0===s?void 0:s.getTeamBuff(),r))||void 0===t?void 0:t.value})},JSON.stringify(a.info))}))})})]}):null}function Ua(){var e=(0,Z.$)("page_character").t,t=(0,j.useContext)(_.R).data,n=(0,j.useContext)(E.K).character.team.reduce((function(e,t){return e+(t?1:0)}),1);return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(z.Z,{title:(0,ie.jsxs)("span",{children:[e("tabTeambuff.team_reso")," ",(0,ie.jsx)("strong",{children:(0,ie.jsxs)(Q.Z,{color:n>=4?"success":"warning",children:["(",n,"/4)"]})})," ",(0,ie.jsx)(An.Z,{title:(0,ie.jsx)(U.Z,{children:e(Va||(Va=(0,r.Z)(["tabTeambuff.resonance_tip"])))})})]}),titleTypographyProps:{variant:"subtitle2"}})}),Ga.J.map((function(e,n){var r=(0,ie.jsx)(An.Z,{title:(0,ie.jsx)(U.Z,{children:e.desc})}),i=(0,ie.jsxs)("span",{children:[e.name," ",r]});return(0,ie.jsxs)(w.Z,{sx:{opacity:e.canShow(t)?1:.5},children:[(0,ie.jsx)(z.Z,{title:i,action:e.icon,titleTypographyProps:{variant:"subtitle2"}}),e.canShow(t)&&(0,ie.jsx)(G.Z,{}),e.canShow(t)&&(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(dn.Z,{sections:e.sections,teamBuffOnly:!0,hideDesc:!0})})]},n)}))]})}function Ja(e){var t=e.index,n=(0,j.useContext)(_.R).teamData,r=(0,Z.$)("page_character").t,i=(0,j.useContext)(E.K),a=i.character,s=i.character.key,o=i.characterDispatch,c=a.team[t],l=(0,j.useMemo)((function(){return[s].concat((0,ue.Z)(a.team)).filter((function(e,n){return n-1!==t}))}),[a.team,s,t]),u=(0,Bt.Z)(),d=(0,j.useCallback)((function(e){return o({type:"team",index:t,charKey:e})}),[t,o]),f=n[c],h=(0,j.useMemo)((function(){var e;return f&&{character:(0,pe.Z)((0,pe.Z)({},f.character),{},{conditional:null!==(e=a.teamConditional[c])&&void 0!==e?e:{}}),characterSheet:f.characterSheet,characterDispatch:function(e){if(c&&"conditional"in e){var t=e.conditional;o({type:"teamConditional",teamMateKey:c,conditional:t})}}}}),[a,c,f,o]),p=(0,j.useMemo)((function(){return f&&{data:f.target,teamData:n}}),[f,n]);return(0,ie.jsxs)(w.Z,{children:[(0,ie.jsx)(es,{characterKey:c,team:l,setChar:d,label:r("teammate",{count:t+1})}),c&&h&&(0,ie.jsx)(E.K.Provider,{value:h,children:p&&(0,ie.jsx)(_.R.Provider,{value:p,children:(0,ie.jsx)(dt.Z,{characterKey:c,onClickHeader:u,artifactChildren:(0,ie.jsx)(E.K.Provider,{value:h,children:(0,ie.jsx)(_.R.Provider,{value:p,children:(0,ie.jsx)(Ya,{})})}),weaponChildren:(0,ie.jsx)(E.K.Provider,{value:h,children:(0,ie.jsx)(_.R.Provider,{value:p,children:(0,ie.jsx)(Xa,{})})}),characterChildren:(0,ie.jsx)(E.K.Provider,{value:h,children:(0,ie.jsx)(_.R.Provider,{value:p,children:(0,ie.jsx)(Qa,{})})}),isTeammateCard:!0})})})]})}function Ya(){var e=(0,j.useContext)(_.R).data,t=(0,W.Z)((function(){return un.y.getAll}),[]),n=(0,j.useMemo)((function(){return t&&Object.entries(un.y.setEffects(t,e)).flatMap((function(e){var n=(0,i.Z)(e,2),r=n[0];return n[1].flatMap((function(e){return t(r).setEffectDocument(e)}))}))}),[t,e]);return n?(0,ie.jsx)(dn.Z,{sections:n,teamBuffOnly:!0}):null}function Xa(){var e=(0,j.useContext)(E.K).character.key,t=(0,j.useContext)(_.R).teamData[e].weaponSheet;return t.document?(0,ie.jsx)(dn.Z,{sections:t.document,teamBuffOnly:!0}):null}function Qa(){var e=(0,j.useContext)(E.K).character.key,t=(0,j.useContext)(_.R).teamData[e].characterSheet,n=Object.values(t.talent).flatMap((function(e){return e.sections}));return n?(0,ie.jsx)(dn.Z,{sections:n,teamBuffOnly:!0}):null}function es(e){var t=e.characterKey,n=e.team,i=e.label,a=e.setChar,s=e.autoCompleteProps,o=void 0===s?{}:s,c=(0,Z.$)(["charNames_gen","page_character","sheet_gen"]).t,l=(0,j.useContext)(T.t).database,u=(0,R.Z)().gender,d=(0,W.Z)((function(){return O.Z.getAll}),[]),f=(0,j.useCallback)((function(e){var t;return e.startsWith("Traveler")?"".concat(c("charNames_gen:".concat((0,V.LP)(e,u)))," (").concat(c("sheet_gen:element.".concat(null===d||void 0===d||null===(t=d(e,u))||void 0===t?void 0:t.elementKey)),")"):c("charNames_gen:".concat(e))}),[d,c,u]),p=(0,j.useCallback)((function(e){var t;return""===e?(0,ie.jsx)(Fa.Z,{}):d?(0,ie.jsx)(Ba.Z,{src:null===(t=d(e,u))||void 0===t?void 0:t.thumbImgSide,sx:{pr:1}}):(0,ie.jsx)(ie.Fragment,{})}),[d,u]),x=(0,j.useCallback)((function(e){return l.charMeta.get(e).favorite}),[l]),v=(0,j.useCallback)((function(e){var r=e.key;return n.filter((function(e){return e&&e!==t})).includes(r)||r.startsWith("Traveler")&&n.some((function(e,t){return e.startsWith("Traveler")}))}),[n,t]),m=(0,j.useMemo)((function(){return[{key:"",label:c(La||(La=(0,r.Z)(["page_character:none"])))}].concat((0,ue.Z)(l.chars.keys.map((function(e){return{key:e,label:f(e),favorite:x(e)}})).sort((function(e,t){return e.favorite&&!t.favorite?-1:!e.favorite&&t.favorite?1:e.label.localeCompare(t.label)}))))}),[c,f,x,l]);return(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"text",width:100}),children:(0,ie.jsx)(za.Z,(0,pe.Z)({size:"small",label:i,options:m,valueKey:t,clearKey:"",onChange:a,getOptionDisabled:v,toImg:p},o))})}var ts,ns=n(49142),rs=n(16649),is=n(33439),as=n(94294),ss=n(70867),os=n(82095),cs=n(6805),ls=n(19391),us=n(11400);var ds=j.lazy((function(){return n.e(409).then(n.bind(n,44361))}));function fs(){var e,t,n=(0,j.useContext)(T.t).database,r=(0,j.useContext)(_.R).data,a=(0,j.useContext)(E.K),s=a.character,o=a.character,c=o.key,l=o.compareData,u=a.characterSheet,d=a.characterDispatch,p=function(e,t){var n=(0,j.useContext)(T.t).database,r=(0,j.useState)((function(){return n.charTCs.getWithInit(e,t)})),a=(0,i.Z)(r,2),s=a[0],o=a[1];return(0,j.useEffect)((function(){return o(n.charTCs.getWithInit(e,t))}),[n,e,t]),(0,j.useEffect)((function(){return e?n.charTCs.follow(e,(function(e,t,n){return"update"===t&&o(n)})):void 0}),[e,o,n]),s}(c,(0,us.mT)(u.weaponTypeKey)),x=(0,j.useCallback)((function(e){return n.charTCs.set(c,e)}),[c,n]),v=(0,j.useCallback)((function(){x((0,ls.O)((0,us.mT)(u.weaponTypeKey)))}),[x,u]),Z=(0,j.useCallback)((function(e){x((0,pe.Z)((0,pe.Z)({},p),{},{weapon:(0,pe.Z)((0,pe.Z)({},p.weapon),e)}))}),[x,p]),g=(0,j.useCallback)((function(e,t){var n=(0,ls.O)(e.key);n.artifact.substats.type=p.artifact.substats.type,n.weapon.level=e.level,n.weapon.ascension=e.ascension,n.weapon.refinement=e.refinement;var r={};t.forEach((function(e){var t;if(e){var i=e.slotKey,a=e.setKey,s=e.substats,o=e.mainStatKey,c=e.level,l=e.rarity;n.artifact.slots[i].level=c,n.artifact.slots[i].statKey=o,n.artifact.slots[i].rarity=l,r[a]=(null!==(t=r[a])&&void 0!==t?t:0)+1,s.forEach((function(e){var t;e.key&&(n.artifact.substats.stats[e.key]=(null!==(t=n.artifact.substats.stats[e.key])&&void 0!==t?t:0)+e.accurateValue)}))}})),n.artifact.sets=Object.fromEntries(Object.entries(r).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return[n,3===r?2:5===r?4:1!==r||n.startsWith("PrayersFor")?r:0]})).filter((function(e){var t=(0,i.Z)(e,2);t[0];return t[1]}))),x(n)}),[p,x]),b=(null!==(e=(0,y.TH)().state)&&void 0!==e?e:{build:void 0}).build;(0,j.useEffect)((function(){if(b){var e=n.weapons.get(s.equippedWeapon);g(e,b.map((function(e){return n.arts.get(e)})))}}),[b,n]);var C=(0,j.useCallback)((function(){var e=n.weapons.get(s.equippedWeapon);g(e,Object.values(s.equippedArtifacts).map((function(e){return n.arts.get(e)})).filter((function(e){return e})))}),[n,s.equippedArtifacts,s.equippedWeapon,g]),k=(0,j.useMemo)((function(){return(0,pe.Z)((0,pe.Z)({},p.weapon),{},{location:"",lock:!1,id:""})}),[p]),S=(0,j.useCallback)((function(e){var t=(0,jt.I8)(p);t.artifact=e,x(t)}),[p,x]),P=(0,j.useCallback)((function(e){var t=(0,jt.I8)(p);t.artifact.substats.type=e,x(t)}),[p,x]),A=(0,j.useCallback)((function(e){var t=(0,jt.I8)(p);t.artifact.substats.stats=e,x(t)}),[p,x]),K=(0,j.useDeferredValue)(p),O=(0,j.useMemo)((function(){var e=(0,pe.Z)({},K.artifact.substats.stats);return Object.values(K.artifact.slots).forEach((function(t){var n,r=t.statKey,i=t.rarity,a=t.level;return e[r]=(null!==(n=e[r])&&void 0!==n?n:0)+Qn.ZP.mainStatValue(r,i,a)})),{art:(0,jt.xh)(e,(function(e,t){return t.endsWith("_")?(0,pt.aQ)(e/100):(0,pt.a9)(e)})),artSet:(0,jt.xh)(K.artifact.sets,(function(e){return(0,pt.a9)(e)}))}}),[K]),D=(0,j.useMemo)((function(){return{id:"",location:"",key:p.weapon.key,level:p.weapon.level,ascension:p.weapon.ascension,refinement:p.weapon.refinement,lock:!1}}),[p]),M=(0,$.Z)(c,0,O,D),I=(null!==(t=null===M||void 0===M?void 0:M[c])&&void 0!==t?t:{}).target,R=(0,j.useMemo)((function(){if(M&&I)return{data:I,teamData:M}}),[I,M]),W=(0,j.useMemo)((function(){if(R)return(0,pe.Z)((0,pe.Z)({},R),{},{oldData:l?r:void 0})}),[R,l,r]);return(0,ie.jsxs)(de.Z,{spacing:1,children:[(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(f.Z,{sx:{display:"flex",gap:1,p:1},children:[(0,ie.jsxs)(f.Z,{sx:{flexGrow:1,display:"flex",gap:1},children:[(0,ie.jsx)(m.Z,{color:"info",onClick:C,startIcon:(0,ie.jsx)(rs.Z,{}),children:"Copy from equipped"}),(0,ie.jsx)(m.Z,{color:"error",onClick:v,startIcon:(0,ie.jsx)(is.Z,{}),children:"Reset"})]}),(0,ie.jsxs)(ht.Z,{exclusive:!0,value:l,onChange:function(e,t){return d({compareData:t})},size:"small",children:[(0,ie.jsx)(ot.Z,{value:!1,disabled:!l,children:"Show TC stats"}),(0,ie.jsx)(ot.Z,{value:!0,disabled:l,children:"Compare vs. equipped"})]})]})}),R?(0,ie.jsx)(_.R.Provider,{value:R,children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,ie.jsxs)(fe.ZP,{item:!0,sx:{flexGrow:-1},children:[(0,ie.jsx)(hs,{weapon:k,setWeapon:Z,weaponTypeKey:u.weaponTypeKey}),(0,ie.jsx)(ps,{artifactData:p.artifact,setArtifactData:S})]}),(0,ie.jsx)(fe.ZP,{item:!0,sx:{flexGrow:1},children:(0,ie.jsx)(js,{substats:p.artifact.substats.stats,setSubstats:A,substatsType:p.artifact.substats.type,setSubstatsType:P,mainStatKeys:Object.values(p.artifact.slots).map((function(e){return e.statKey}))})})]})}):(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:500}),(0,ie.jsx)(w.Z,{sx:{flexGrow:1,p:1},children:W?(0,ie.jsx)(_.R.Provider,{value:W,children:(0,ie.jsx)(cr,{})}):(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:500})})]})}function hs(e){var t=e.weapon,n=e.setWeapon,r=e.weaponTypeKey,a=t.key,s=t.level,o=void 0===s?0:s,c=t.refinement,l=void 0===c?1:c,u=t.ascension,d=void 0===u?0:u,h=(0,W.Z)((function(){return ur.Z.get(a)}),[a]),p=(0,D.Z)(),x=(0,i.Z)(p,3),v=x[0],Z=x[1],g=x[2],y=(0,j.useContext)(_.R).data,C=(0,j.useMemo)((function(){return h&&t&&(0,Ft.mP)([h.data,(0,Ft.v0)(t)])}),[h,t]);return(0,ie.jsxs)(w.Z,{sx:{p:1,mb:1},children:[(0,ie.jsx)(ds,{ascension:d,show:v,onHide:g,onSelect:function(e){return n({key:e})},weaponTypeFilter:r}),(0,ie.jsxs)(f.Z,{display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsxs)(f.Z,{display:"flex",gap:1,children:[h&&(0,ie.jsx)(f.Z,{className:"grad-".concat(h.rarity,"star"),component:"img",src:h.getImg(t.ascension),sx:{flexshrink:1,flexBasis:0,maxWidth:"30%",borderRadius:1}}),(0,ie.jsxs)(de.Z,{spacing:1,flexGrow:1,children:[(0,ie.jsx)(m.Z,{fullWidth:!0,color:"info",sx:{flexGrow:1},onClick:Z,children:(0,ie.jsx)(f.Z,{sx:{maxWidth:"10em"},children:null===h||void 0===h?void 0:h.name})}),(null===h||void 0===h?void 0:h.hasRefinement)&&(0,ie.jsx)(cs.Z,{refinement:l,setRefinement:function(e){return n({refinement:e})}})]})]}),h&&(0,ie.jsx)(S.Z,{level:o,ascension:d,setBoth:n,useLow:!h.hasRefinement}),(0,ie.jsxs)(b.Z,{children:[(0,ie.jsx)(z.Z,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),(0,ie.jsx)(G.Z,{}),C&&(0,ie.jsx)(We.lD,{children:[ge.ri.weapon.main,ge.ri.weapon.sub,ge.ri.weapon.sub2].map((function(e,t){var n=C.get(e);return n.isEmpty||!n.value?null:(0,ie.jsx)(We.JW,{node:n,component:he.ZP},JSON.stringify(n.info))}))})]}),y&&(null===h||void 0===h?void 0:h.document)&&(0,ie.jsx)(dn.Z,{sections:h.document})]})]})}function ps(e){var t=e.artifactData,n=e.setArtifactData,r=(0,j.useCallback)((function(e){return function(r){var i=(0,jt.I8)(t);i.slots[e]=r,n(i)}}),[t,n]),i=(0,j.useCallback)((function(e){var r=(0,jt.I8)(t);r.sets=e,n(r)}),[t,n]);return(0,ie.jsxs)(de.Z,{spacing:1,children:[(0,ie.jsx)(w.Z,{sx:{p:1},children:(0,ie.jsx)(de.Z,{spacing:1,children:V.eV.map((function(e){return(0,ie.jsx)(xs,{slotKey:e,slot:t.slots[e],setSlot:r(e)},e)}))})}),(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,ie.jsx)(vs,{artSet:t.sets,setArtSet:i})})]})}function xs(e){var t,n=e.slotKey,r=e.slot,i=e.setSlot,a=r.level,s=r.statKey,o=r.rarity,c=Qn.ZP.slotMainStats(n),l=(0,j.useCallback)((function(e){i((0,pe.Z)((0,pe.Z)({},r),e))}),[r,i]),u=(0,j.useCallback)((function(e){var t,n=null!==(t=Qn.P4[e])&&void 0!==t?t:0;l(a>n?{rarity:e,level:n}:{rarity:e})}),[a,l]);return(0,ie.jsxs)(f.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,ie.jsx)(os.Z,{icon:_n.xe[n]}),(0,ie.jsx)(b.Z,{sx:{height:"100%",minWidth:"5em",flexGrow:1,display:"flex"},children:1===c.length?(0,ie.jsxs)(f.Z,{p:1,justifyContent:"center",alignItems:"center",width:"100%",display:"flex",gap:1,children:[Pe.Z[c[0]],ye.ZP.getStr(c[0])]}):(0,ie.jsx)(ft.Z,{sx:{px:0},fullWidth:!0,title:(0,ie.jsx)(nr.x,{statKey:s}),color:null!==(t=ye.ZP.getVariant(s))&&void 0!==t?t:"success",children:c.map((function(e){return(0,ie.jsx)(st.Z,{disabled:s===e,onClick:function(){return l({statKey:e})},children:(0,ie.jsx)(nr._,{statKey:e})},e)}))})}),(0,ie.jsx)(ft.Z,{sx:{px:0},title:(0,ie.jsxs)("span",{children:[o," ",(0,ie.jsx)(cn.G,{icon:on.Tab})]}),children:[5,4,3].map((function(e){return(0,ie.jsx)(st.Z,{disabled:o===e,onClick:function(){return u(e)},children:(0,ie.jsxs)("span",{children:[e," ",(0,ie.jsx)(cn.G,{icon:on.Tab})]})},e)}))}),(0,ie.jsx)(_e.ZP,{startAdornment:"+",value:a,color:Qn.ZP.levelVariant(a),onChange:function(e){return void 0!==e&&l({level:e})},sx:{borderRadius:1,pl:1,my:0,height:"100%"},inputProps:{sx:{pl:.5,width:"2em"},max:20,min:0}}),(0,ie.jsx)(b.Z,{sx:{height:"100%",minWidth:"4em"},children:(0,ie.jsx)(f.Z,{p:1,textAlign:"center",children:"".concat((0,ye.qs)(Qn.ZP.mainStatValue(s,o,a),ye.ZP.unit(s))).concat(ye.ZP.unit(s))})})]})}function vs(e){var t=e.artSet,n=e.setArtSet,r=(0,W.Z)((function(){return un.y.getAll}),[]),a=(0,j.useCallback)((function(e){e&&r&&n((0,pe.Z)((0,pe.Z)({},t),{},(0,mt.Z)({},e,parseInt(Object.keys(r(e).setEffects)[0]))))}),[t,n,r]),s=(0,j.useCallback)((function(e){return function(r){return n((0,pe.Z)((0,pe.Z)({},t),{},(0,mt.Z)({},e,r)))}}),[t,n]),o=(0,j.useCallback)((function(e){return function(){t[e];var r=(0,be.Z)(t,[e].map(ns.Z));n((0,pe.Z)({},r))}}),[t,n]),c=5-Object.values(t).reduce((function(e,t){return e+t}),0);return(0,ie.jsxs)(de.Z,{spacing:1,sx:{flexGrow:1},children:[Object.entries(t).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(ms,{setKey:n,value:r,setValue:s(n),deleteValue:o(n),remaining:c},n)})),(0,ie.jsx)(w.Z,{sx:{flexGrow:1},children:(0,ie.jsx)(ss.Y4,{showDefault:!0,disableClearable:!0,size:"small",artSetKey:"",setArtSetKey:a,sx:function(e){return{flexGrow:1,".MuiFilledInput-root":{borderBottomRightRadius:e.shape.borderRadius,borderBottomLeftRadius:e.shape.borderRadius}}},defaultText:"New Artifact Set",disable:function(e){return Object.keys(t).includes(e)||!(null!==r&&void 0!==r&&r(e))||Object.keys(r(e).setEffects).every((function(e){return parseInt(e)>c}))}})})]})}function ms(e){var t=e.setKey,n=e.value,r=e.setValue,i=e.deleteValue,a=e.remaining,s=(0,W.Z)((function(){return un.y.get(t)}),[]),o=(0,j.useMemo)((function(){return n<4||!s?[]:Object.keys(s.setEffects).filter((function(e){var t;return null===(t=s.setEffects[e])||void 0===t?void 0:t.document.some((function(e){return"states"in e}))}))}),[s,n]);return s?(0,ie.jsxs)(w.Z,{children:[(0,ie.jsxs)(f.Z,{display:"flex",children:[(0,ie.jsx)(mr.Z,{artifactSheet:s,numInSet:n,children:(0,ie.jsxs)(f.Z,{flexGrow:1,p:1,display:"flex",gap:1,alignItems:"center",children:[(0,ie.jsx)(ee.Z,{size:2,sx:{m:-1},src:s.defIconSrc}),(0,ie.jsx)(f.Z,{children:s.setName}),(0,ie.jsx)(as.Z,{})]})}),(0,ie.jsxs)(Ee.Z,{children:[(0,ie.jsx)(ft.Z,{size:"small",title:(0,ie.jsxs)(f.Z,{whiteSpace:"nowrap",children:[n,"-set"]}),children:Object.keys(s.setEffects).map((function(e){return parseInt(e)})).map((function(e){return(0,ie.jsxs)(st.Z,{disabled:n===e||e>a+n,onClick:function(){return r(e)},children:[e,"-set"]},e)}))}),(0,ie.jsx)(m.Z,{color:"error",size:"small",onClick:i,children:(0,ie.jsx)(rt.Z,{})})]})]}),!!o.length&&(0,ie.jsx)(de.Z,{spacing:1,sx:{p:1},children:o.map((function(e){return(0,ie.jsx)(fn,{setKey:t,setNumKey:parseInt(e),hideHeader:!0,conditionalsOnly:!0},e)}))})]}):null}function js(e){var t=e.substats,n=e.setSubstats,a=e.substatsType,s=e.setSubstatsType,o=e.mainStatKeys,c=(0,j.useCallback)((function(e){return function(r){return n((0,pe.Z)((0,pe.Z)({},t),{},(0,mt.Z)({},e,r)))}}),[t,n]),l=(0,Z.$)("page_character").t,u=100*Object.entries(t).reduce((function(e,t){var n=(0,i.Z)(t,2),r=n[0];return e+n[1]/Qn.ZP.substatValue(r)}),0),d=Object.entries(t).reduce((function(e,t){var n=(0,i.Z)(t,2),r=n[0];return e+n[1]/Qn.ZP.substatValue(r,void 0,a)}),0);return(0,ie.jsxs)(w.Z,{sx:{p:1,height:"100%"},children:[(0,ie.jsxs)(f.Z,{sx:{mb:1,display:"flex",gap:1},children:[(0,ie.jsx)(ft.Z,{fullWidth:!0,title:l("tabTheorycraft.substatType.".concat(a)),children:V.Q7.map((function(e){return(0,ie.jsx)(st.Z,{disabled:a===e,onClick:function(){return s(e)},children:l("tabTheorycraft.substatType.".concat(e))},e)}))}),(0,ie.jsx)(ut.Z,{title:(0,ie.jsx)(U.Z,{children:l(ts||(ts=(0,r.Z)(["tabTheorycraft.maxTotalRolls"])))}),placement:"top",children:(0,ie.jsxs)(b.Z,{sx:{textAlign:"center",py:.5,px:1,minWidth:"15em",whiteSpace:"nowrap",display:"flex",gap:2,justifyContent:"flex-end",alignItems:"center"},children:[(0,ie.jsxs)(Q.Z,{color:d>45?"warning":void 0,children:["Rolls: ",(0,ie.jsx)("strong",{children:d.toFixed(0)})]}),(0,ie.jsxs)(Q.Z,{color:d>45?"warning":void 0,children:["RV: ",(0,ie.jsxs)("strong",{children:[u.toFixed(1),"%"]})]})]})})]}),(0,ie.jsx)(de.Z,{spacing:1,children:Object.entries(t).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,ie.jsx)(Zs,{statKey:n,value:r,setValue:c(n),substatsType:a,mainStatKeys:o},n)}))})]})}function Zs(e){var t=e.statKey,n=e.value,r=e.setValue,a=e.substatsType,s=e.mainStatKeys,o=(0,Z.$)("page_character").t,c=Qn.ZP.substatValue(t,5,a),l=(0,j.useState)((function(){return n/c})),u=(0,i.Z)(l,2),d=u[0],h=u[1];(0,j.useEffect)((function(){return h(n/c)}),[n,c]);var p=ye.ZP.unit(t),x=d*c,v=d*c/Qn.ZP.substatValue(t)*100,m=s.reduce((function(e,n){return e+(n===t?1:0)}),0),g=6*(5-m),y=d-1e-4>g,w=(0,j.useCallback)((function(e){return r(e*c)}),[r,c]);return(0,ie.jsxs)(de.Z,{spacing:.5,children:[(0,ie.jsxs)(f.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,ie.jsxs)(b.Z,{sx:{p:.5,minWidth:"11em",flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center"},children:[Pe.Z[t],ye.ZP.getStr(t),ye.ZP.unit(t)]}),(0,ie.jsx)(ut.Z,{title:(0,ie.jsx)(U.Z,{children:o(m?"tabTheorycraft.maxRollsMain":"tabTheorycraft.maxRolls",{value:g})}),placement:"top",children:(0,ie.jsx)(b.Z,{sx:{textAlign:"center",p:.5,minWidth:"8em"},children:(0,ie.jsxs)(Q.Z,{color:y?"warning":void 0,children:["RV: ",(0,ie.jsxs)("strong",{children:[v.toFixed(1),"%"]})]})})})]}),(0,ie.jsxs)(f.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,ie.jsx)(_e.ZP,{color:x?"success":"primary",float:"%"===ye.ZP.unit(t),endAdornment:ye.ZP.unit(t)||(0,ie.jsx)(f.Z,{width:"1em",component:"span"}),value:parseFloat(x.toFixed(2)),onChange:function(e){return void 0!==e&&r(e)},sx:{borderRadius:1,px:1,height:"100%",width:"6em"},inputProps:{sx:{textAlign:"right"},min:0}}),(0,ie.jsx)(b.Z,{sx:{px:2,flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center"},children:(0,ie.jsx)(wr.ZP,{size:"small",value:d,max:g,min:0,step:1,marks:!0,onChange:function(e,t){return h(t)},onChangeCommitted:function(e,t){return w(t)}})}),(0,ie.jsx)(_e.ZP,{color:n?y?"warning":"success":"primary",float:!0,startAdornment:(0,ie.jsxs)(f.Z,{sx:{whiteSpace:"nowrap",width:"7em",display:"flex",justifyContent:"space-between"},children:[(0,ie.jsxs)("span",{children:[(0,ye.qs)(c,p),p]}),(0,ie.jsx)("span",{children:"x"})]}),value:parseFloat(d.toFixed(2)),onChange:function(e){return void 0!==e&&r(e*c)},sx:{borderRadius:1,px:1,my:0,height:"100%",width:"7em"},inputProps:{sx:{textAlign:"right",pr:.5},min:0,step:1}})]})]})}var gs=n(57246);function ys(e,t,n){var r=!0;return(0,vt.aD)([e],(function(e){}),(function(e){var i=e.operation;if("read"===i){if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported [".concat(i,"] node in zero_deriv"));t(e)===n&&(r=!1)}})),r}function bs(e,t,n){var r=e.operation;switch(r){case"read":if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported [".concat(r,"] node in d/dx"));return t(e)===n?(0,pt.a9)(1):(0,pt.a9)(0);case"const":return(0,pt.a9)(0);case"res":if(!ys(e,t,n))throw new Error("[".concat(r,"] node takes only constant inputs. ").concat(e));return(0,pt.a9)(0);case"add":return pt.Sm.apply(void 0,(0,ue.Z)(e.operands.map((function(e){return bs(e,t,n)}))));case"mul":var a=e.operands.map((function(r,i){return pt.WV.apply(void 0,[bs(r,t,n)].concat((0,ue.Z)(e.operands.filter((function(e,t){return t!==i})))))}));return pt.Sm.apply(void 0,(0,ue.Z)(a));case"sum_frac":var s=e.operands[0],o=bs(s,t,n),c=pt.Sm.apply(void 0,(0,ue.Z)(e.operands.slice(1))),l=bs(c,t,n),u=(0,pt.WV)(pt.Sm.apply(void 0,(0,ue.Z)(e.operands)),pt.Sm.apply(void 0,(0,ue.Z)(e.operands))),d=(0,pt.Sm)((0,pt.WV)(c,o),(0,pt.WV)(-1,s,l));return(0,pt.F9)(d,(0,pt.Sm)((0,pt.WV)(-1,d),u));case"min":case"max":switch(e.operands.length){case 1:return bs(e.operands[0],t,n);case 2:var f=(0,i.Z)(e.operands,2),h=f[0],p=f[1];if("min"===r)return(0,pt.Lj)(h,p,bs(p,t,n),bs(h,t,n));if("max"===r)return(0,pt.Lj)(h,p,bs(h,t,n),bs(p,t,n));(0,jt.UT)(r);break;default:if("min"===r)return bs((0,pt.VV)(e.operands[0],pt.VV.apply(void 0,(0,ue.Z)(e.operands.slice(1)))),t,n);if("max"===r)return bs((0,pt.VV)(e.operands[0],pt.VV.apply(void 0,(0,ue.Z)(e.operands.slice(1)))),t,n);throw new Error("[".concat(r,"] node operates on only 1 or 2 arguments. ").concat(e))}break;case"threshold":var x=(0,i.Z)(e.operands,4),v=x[0],m=x[1],j=x[2],Z=x[3];if(!ys(v,t,n)||!ys(m,t,n))throw new Error("[".concat(r,"] node must branch on constant inputs. ").concat(e));return(0,pt.Lj)(v,m,bs(j,t,n),bs(Z,t,n));default:(0,jt.UT)(r)}}var ws=[[1],[1,1,1,1],[1,2,3,4,3,2,1],[1,3,6,10,12,12,10,6,3,1],[1,4,10,20,31,40,44,40,31,20,10,4,1],[1,5,15,35,65,101,135,155,155,135,101,65,35,15,5,1]];function Cs(e,t){for(var n;e>=ws.length;){for(var r=ws.length,i=[],a=0,s=r-1;a<=3*r;a++){var o,c,l,u,d=null!==(o=ws[s][a-3])&&void 0!==o?o:0,f=null!==(c=ws[s][a-2])&&void 0!==c?c:0,h=null!==(l=ws[s][a-1])&&void 0!==l?l:0,p=null!==(u=ws[s][a])&&void 0!==u?u:0;i[a]=d+f+h+p}ws.push(i)}return null!==(n=ws[e][t])&&void 0!==n?n:0}function ks(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),n<=0?0:Math.exp(-(t-e)*(t-e)/n/2)/Math.sqrt(2*Math.PI*n)}var Ss=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return e.flatMap((function(e){return t.map((function(t){return[e,t].flat()}))}))}))},Ps=[270/1024,80/1024,0,12/256,8/256,120/1024,0,60/1024,4/256,60/1024,4/256,30/1024,24/256,.15625,1/64,1/64,24/256,1/64,12/256,0,6/256,2/16,6/256,0,81/256,.0625,0,27/64,12/64,0,1/16,1/16,12/64,1/16,6/64,3/4,.5,243/1024,.03125,0,108/256,.125,0,9/64,6/64,.1875,0,24/256,3/64,5/1024,3/64,5/1024,0,405/1024,80/1024,0,54/256,90/1024,40/1024,0,1/256,1/256,40/1024,1/256,20/1024,9/16,.25,0,1/4,1/4,0,1/4,27/64,8/64,0,6/16,.25,10/1024,0,10/1024,2/16,0,0,0,15/1024,10/1024,1/1024,1/1024,0,1/1024],Es=[35,64,70,21,33,45,12,0,53,76,48,86];function _s(e,t){var n=e.reduce((function(e,t){return e+t}));if(e.length>4||n>t)return 0;if(4===e.length&&n!==t)return 0;3===e.length&&(e=[].concat((0,ue.Z)(e),[t-n])),e.sort().reverse();var r=13*t+e.length-14+16*e[0];e.length>1&&(r+=4*e[1]);var i=r%12,a=Math.trunc(r/12);return Ps[i+Es[a]]}function As(e,t){if(0!==e)for(var n=e;n>=0;n--)for(var r=e-n;r>=0;r--)for(var i=e-n-r;i>=0;i--){var a=e-n-r-i;t([n,r,i,a],_s([n,r,i,a],e))}else t([0,0,0,0],1)}function Ks(e){var t=e.statsBase,n=e.rollsLeft,r=e.subs,i=e.skippableDerivs,a=e.fourthsubOpts,s=e.evalFn,o=function(e){return e.endsWith("_")?Qn.ZP.substatValue(e,5)/1e3:Qn.ZP.substatValue(e,5)/10},c=t,l=[];return As(n,(function(e,t){a&&(e[3]+=1);var n=e.map((function(e,t){if(a&&3===t)return(0,jt.w6)(7*e,10*e);var n=r[t];return n&&!i[Mi._.indexOf(n)]?(0,jt.w6)(7*e,10*e):[NaN]}));Ss.apply(void 0,(0,ue.Z)(n)).forEach((function(n){for(var i=(0,pe.Z)({},c),u=1,d=0;d<3;d++){var f;if(!isNaN(n[d])){var h=r[d],p=n[d],x=e[d];i[h]=(null!==(f=i[h])&&void 0!==f?f:0)+p*o(h);var v=Math.pow(4,-x)*Cs(x,p-7*x);u*=v}}if(void 0===a){if(!isNaN(n[3])){var m,j=r[3],Z=n[3],g=e[3];i[j]=(null!==(m=i[j])&&void 0!==m?m:0)+Z*o(j);var y=Math.pow(4,-g)*Cs(g,Z-7*g);u*=y}l.push({v:s(i).map((function(e){return e.v})),p:t*u})}else a.forEach((function(r){var a,c=r.sub,d=r.subprob,f=(0,pe.Z)({},i),h=c,p=n[3],x=e[3];f[h]=(null!==(a=f[h])&&void 0!==a?a:0)+p*o(h);var v=Math.pow(4,-x)*Cs(x,p-7*x)*d,m=u*v;l.push({v:s(f).map((function(e){return e.v})),p:t*m})}))}))})),l}var Os=n(61503);function Ts(e,t,n){if(t<1e-5)return e>n?{p:1,upAvg:e-n}:{p:0,upAvg:0};var r=(n-e)/Math.sqrt(t),i=(1-function(e){var t=1;e<0&&(t=-1);var n=1/(1+.3275911*(e=Math.abs(e)));return t*(1-((((1.061405429*n-1.453152027)*n+1.421413741)*n-.284496736)*n+.254829592)*n*Math.exp(-e*e))}(r/Math.sqrt(2)))/2;if(r>5){var a=1/r,s=a*a;return{p:i,upAvg:Math.sqrt(t)*a*(1-2*s*(1-s*(5+37*s)))}}var o=Math.exp(-r*r/2)/Math.sqrt(2*Math.PI);return{p:i,upAvg:e-n+Math.sqrt(t)*o/i}}function Ds(e){var t={};return Object.values(e).forEach((function(e){e&&Object.entries(e.values).forEach((function(e){var n,r=(0,i.Z)(e,2),a=r[0],s=r[1];return t[a]=(null!==(n=t[a])&&void 0!==n?n:0)+s}))})),t}function Ms(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,pe.Z)({},e.curBuild);i[t.slot]=t;var a=Ds(i),s=(0,pe.Z)({},a),o=function(e){return e.endsWith("_")?Qn.ZP.substatValue(e,t.rarity)/1e3:Qn.ZP.substatValue(e,t.rarity)/10},c=Qn.ZP.rollsRemaining(t.level,t.rarity)-(4-t.subs.length);if(4===t.subs.length&&(r=!1),r){var l=Object.keys(t.values).filter((function(e){return!t.subs.includes(e)})).filter((function(e){return!V.q2.includes(e)}));if(1!==l.length)throw Error("Failed to extract artifact main stat");var u=l[0],d=Mi._.filter((function(e){return!t.subs.includes(e)&&e!==u})),f=d.map((function(i){var s=[].concat((0,ue.Z)(t.subs),[i]),l={rollsLeft:c,subs:s,calc4th:r,stats:a,thresholds:e.thresholds,objectiveEval:function(t){return e.evalFn(t).map((function(e){var t=e.v,n=e.grads;return{v:t,ks:s.map((function(e){return n[Mi._.indexOf(e)]*o(e)}))}}))},scale:o},d=n?Rs(l):Is(l);return(0,pe.Z)((0,pe.Z)({},d),{},{p2:Fs(i,[].concat((0,ue.Z)(t.subs),[u]))})})),h=f.reduce((function(e,t){return e+t.prob*t.p2}),0),p=h<1e-6?0:f.reduce((function(e,t){return e+t.prob*t.p2*t.upAvg}),0)/h,x=f.reduce((function(e,t){var n,r=t.p2,i=t.distr;return e.lower=Math.min(e.lower,i.lower),e.upper=Math.max(e.upper,i.upper),(n=e.gmm).push.apply(n,(0,ue.Z)(i.gmm.map((function(e){var t=e.phi,n=e.cp,i=e.mu,a=e.sig2;return{phi:r*t,cp:n,mu:i,sig2:a}})))),e}),{gmm:[],lower:1/0,upper:-1/0});return{id:t.id,subs:t.subs,fourthsubOpts:d.map((function(e){return{sub:e,subprob:Fs(e,[].concat((0,ue.Z)(t.subs),[u]))}})),rollsLeft:c,statsBase:s,prob:h,upAvg:p,distr:x,evalFn:e.evalFn,skippableDerivs:e.skippableDerivs,thresholds:e.thresholds,evalMode:n?"slow":"fast"}}var v={rollsLeft:c,subs:t.subs,calc4th:r,stats:a,thresholds:e.thresholds,objectiveEval:function(n){return e.evalFn(n).map((function(e){var n=e.v,r=e.grads;return{v:n,ks:t.subs.map((function(e){return r[Mi._.indexOf(e)]*o(e)}))}}))},scale:o},m=n?Rs(v):Is(v);return(0,pe.Z)((0,pe.Z)({id:t.id,subs:t.subs,rollsLeft:c,statsBase:s},m),{},{evalFn:e.evalFn,skippableDerivs:e.skippableDerivs,thresholds:e.thresholds,evalMode:n?"slow":"fast"})}function Is(e){var t=e.rollsLeft,n=e.subs,r=e.stats,i=e.thresholds,a=e.calc4th,s=e.scale,o=e.objectiveEval,c=(0,pe.Z)({},r);n.forEach((function(e,n){var r,i=a&&3===n?1:0;c[e]=(null!==(r=c[e])&&void 0!==r?r:0)+8.5*(t/4+i)*s(e)}));for(var l=t,u=o(c),d=1,f=-1,h={gmm:[],lower:u[0].v,upper:u[0].v},p=0;p<u.length;p++){var x=u[p],v=x.v,m=x.ks,j=m.reduce((function(e,t){return e+t})),Z=v,g=(147/8*m.reduce((function(e,t){return e+t*t}),0)-289/64*j*j)*l+(a?5/4*m[3]*m[3]:0),y=Ts(Z,g,i[p]),b=y.p,w=y.upAvg;0===p&&(f=w,h={gmm:[{phi:1,mu:Z,sig2:g,cp:1}],lower:Z-4*Math.sqrt(g),upper:Z+4*Math.sqrt(g)}),d=Math.min(b,d)}return{prob:d,upAvg:f,distr:h}}function Rs(e){var t=e.rollsLeft,n=e.stats,r=e.subs,i=e.thresholds,a=e.calc4th,s=e.scale,o=e.objectiveEval,c={gmm:[],lower:i[0],upper:i[0]},l=[];As(t,(function(e,t){var u=(0,pe.Z)({},n);a&&(e[3]+=1),r.forEach((function(t,n){var r;u[t]=(null!==(r=u[t])&&void 0!==r?r:0)+8.5*e[n]*s(t)}));var d=o(u),f=d.map((function(e){return e.v})),h=d.map((function(t){return d.map((function(n){return t.ks.reduce((function(r,i,a){return r+t.ks[a]*n.ks[a]*e[a]}),0)}))})),p=function(e,t,n){var r=new Os.Y.MVNHandle(e.length);try{return n.forEach((function(e){return r.pushX(e)})),e.forEach((function(e){return r.pushMu(e)})),t.forEach((function(e){return e.forEach((function(e){return r.pushCov(e)}))})),r.compute(),{p:r.p,upAvg:r.Eup,cp:r.cp}}finally{r.delete()}}(f,h,i);l.push((0,pe.Z)({l:t},p)),c.gmm.push({phi:t,mu:f[0],sig2:h[0][0],cp:p.cp}),c.lower=Math.min(c.lower,f[0]-4*Math.sqrt(h[0][0])),c.upper=Math.max(c.upper,f[0]+4*Math.sqrt(h[0][0]))}));var u=0,d=0;return l.forEach((function(e){var t=e.l,n=e.p,r=e.upAvg,i=e.cp;u+=t*n*i,d+=t*n*i*r})),u<1e-10?{prob:0,upAvg:0,distr:c}:{prob:u,upAvg:d/=u,distr:c}}function Ws(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=[];e.forEach((function(e){a.push.apply(a,[e].concat((0,ue.Z)(Mi._.map((function(t){return bs(e,(function(e){return e.path[1]}),t)})))))}));var s=(0,xt.tL)(a,r,(function(e){return"dyn"!==(0,i.Z)(e.path,1)[0]}));s=(0,xt.tL)(s,r,(function(e){return"dyn"!==(0,i.Z)(e.path,1)[0]}));var o=(0,xt.I3)(s,{},(function(e){return e.path[1]}),1),c=Ds(n),l=o([{id:"",values:c}])[0],u=Mi._.map((function(t){return e.every((function(e){return ys(e,(function(e){return e.path[1]}),t)}))})),d=function(t){var n=o([{id:"",values:t}]);return e.map((function(e,t){var r=t*(1+Mi._.length);return{v:n[r],grads:Mi._.map((function(e,t){return n[r+1+t]}))}}))};return{formulas:e,thresholds:[l].concat((0,ue.Z)(t)),curBuild:n,evalFn:d,skippableDerivs:u}}function $s(e,t){var n;void 0===t&&(t=e.level);var r=Qn.ZP.mainStatValue(e.mainStatKey,e.rarity,t),i={id:e.id,slot:e.slotKey,level:e.level,rarity:e.rarity,values:(0,pe.Z)((n={},(0,mt.Z)(n,e.setKey,1),(0,mt.Z)(n,e.mainStatKey,e.mainStatKey.endsWith("_")?r/100:r),n),Object.fromEntries(e.substats.map((function(e){return[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]})))),subs:e.substats.reduce((function(e,t){return""!==t.key&&e.push(t.key),e}),[])};return delete i.values[""],i}function Ns(e,t){if(t.prob>1e-5||e.prob>1e-5)return t.prob*t.upAvg-e.prob*e.upAvg;var n=e.distr.gmm.reduce((function(e,t){return e+t.phi*t.mu}),0);return t.distr.gmm.reduce((function(e,t){return e+t.phi*t.mu}),0)-n}var Vs={hp:6,atk:6,def:6,hp_:4,atk_:4,def_:4,eleMas:4,enerRech_:4,critRate_:3,critDMG_:3},Ls=Object.values(Vs).reduce((function(e,t){return e+t}));function Fs(e,t){if(t.includes(e))return 0;var n=Ls-t.reduce((function(e,t){var n;return e+(null!==(n=Vs[t])&&void 0!==n?n:0)}),0);return Vs[e]/n}var Bs=n(18602),zs=n(94783),Gs=n(48004);var qs=50;function Hs(e){var t=e.upgradeOpt,n=e.objMin,r=e.objMax,a=(0,j.useState)(!1),s=(0,i.Z)(a,2),o=s[0],c=s[1],l=(0,j.useContext)(T.t).database,u=l.arts.get(t.id);if(!u)throw new Error("artifact ".concat(t.id," not found."));var d=t.thresholds.length>1,h=u.slotKey,x=(0,j.useContext)(_.R).data,v=(0,j.useMemo)((function(){return V.eV.map((function(e){var t;return[e,l.arts.get(null!==(t=x.get(ge.ri.art[e].id).value)&&void 0!==t?t:"")]}))}),[x,l]),Z=function(e){return t.distr.gmm.reduce((function(t,n){var r=n.phi,i=n.cp,a=n.mu,s=n.sig2;return t+i*r*ks(e,a,s)}),0)},g=t.thresholds,y=g[0],b=(0,j.useCallback)((function(e){return 100*(e-y)/y}),[y]),C=n,k=r,S=0,P=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,n=[],r=((arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)-e)/t,i=0;i<t;++i)n.push(e+i*r);return n}(C,k,500).map((function(e){var n,r=(n=e,t.distr.gmm.reduce((function(e,t){var r=t.phi,i=t.mu,a=t.sig2;return e+r*ks(n,i,a)}),0));return S=Math.max(S,r),{x:b(e),est:r,estCons:Z(e)}}));0===S&&(S=qs/(k-C));var E={},A={};t.distr.gmm.forEach((function(e){var t,n,r=e.phi,i=e.mu,a=e.sig2,s=e.cp;a<=0&&(E[i]=(null!==(t=E[i])&&void 0!==t?t:0)+r,A[i]=(null!==(n=A[i])&&void 0!==n?n:0)+r*s)})),Object.entries(E).forEach((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return P.push({x:b(parseFloat(n)),est:r*qs/(k-C),estCons:A[n]*qs/(k-C)})})),P.sort((function(e,t){return e.x-t.x}));var K=(y-C)/(k-C),O=(0,j.useState)([]),D=(0,i.Z)(O,2),M=D[0],I=D[1],R=(0,j.useState)(-1),W=(0,i.Z)(R,2),$=W[0],N=W[1],L=(0,j.useState)(-1),F=(0,i.Z)(L,2),B=F[0],z=F[1];if((0,j.useEffect)((function(){if(o){var e=Ks(t),n=0,r=0,i=new Array(qs).fill(0),a=new Array(qs).fill(0),s=(k-C)/qs;e.forEach((function(e){var t=e.p,o=e.v,c=Math.min(Math.trunc((o[0]-C)/s),49);i[c]+=t,o.every((function(e,t){return 0===t||e>g[t]}))&&(a[c]+=t,o[0]>y&&(n+=t,r+=t*(o[0]-y)))})),n>0&&(r/=n);var c=i.map((function(e,t){return{x:b(C+t*s),exact:e/s,exactCons:a[t]/s}}));N(n),z(r),I(c)}}),[o,k,C,y,g,t,b]),0===M.length)for(var G=(k-C)/qs,q=0;q<qs;q++)M.push({x:b(C+q*G),exact:0,exactCons:0});var H=$>=0?$:t.prob,U=B>=0?B:t.upAvg,J=P.concat(M),Y=function(e){var t=e.active;e.payload,e.label;return t?(0,ie.jsxs)("div",{className:"custom-tooltip",children:[(0,ie.jsx)("p",{className:"label"}),(0,ie.jsxs)("p",{className:"desc",children:["prob. upgrade",$>=0?"":" (est.)",": ",(100*H).toFixed(1),"%"]}),(0,ie.jsxs)("p",{className:"desc",children:["average increase",B>=0?"":" (est.)",": ",U<=0?"":"+",(100*U/y).toFixed(1),"%"]})]}):null};return(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(Cr.h,{width:"100%",aspect:2.5,children:(0,ie.jsxs)(kr.c,{data:J,margin:{top:5,right:30,left:20,bottom:20},children:[(0,ie.jsx)(Pr.K,{dataKey:"x",type:"number",domain:["auto","auto"],allowDecimals:!1,tickFormatter:function(e){return"".concat(e<=0?"":"+").concat(e,"%")},children:(0,ie.jsx)(Er._,{value:"Relative Damage Potential",position:"insideBottom",style:{fill:"#eaebed"},offset:-10})}),(0,ie.jsx)(_r.B,{type:"number",domain:[0,S],tick:!1,children:(0,ie.jsx)(Er._,{value:"Probability",position:"insideLeft",angle:-90,style:{fill:"#eaebed"}})}),(0,ie.jsx)(Kr.D,{verticalAlign:"top",height:36}),(0,ie.jsx)("defs",{children:(0,ie.jsxs)("linearGradient",{id:"splitOpacity".concat(t.id),x1:"0",y1:"0",x2:K,y2:"0",children:[(0,ie.jsx)("stop",{offset:1,stopColor:"orange",stopOpacity:0}),(0,ie.jsx)("stop",{offset:0,stopColor:"orange",stopOpacity:1})]})}),(0,ie.jsx)(Or.x,{dataKey:"dne",stroke:"red",name:"Current Damage"}),d&&!o&&(0,ie.jsx)(Bs.u,{type:"monotone",dataKey:"est",stroke:"grey",dot:!1,fill:"grey",legendType:"none",tooltipType:"none",opacity:.5,activeDot:!1}),d&&o&&(0,ie.jsx)(Bs.u,{type:"stepAfter",dataKey:"exact",dot:!1,legendType:"none",tooltipType:"none",opacity:.7,activeDot:!1,fill:"grey",stroke:"grey"}),(0,ie.jsx)(Bs.u,{type:"monotone",dataKey:"estCons",stroke:"orange",dot:!1,fill:"url(#splitOpacity".concat(t.id,")"),opacity:.5,name:"Estimated Distribution",activeDot:!1}),o&&(0,ie.jsx)(Bs.u,{type:"stepAfter",dataKey:"exactCons",dot:!1,opacity:.7,name:"Exact".concat(d?" Constrained":""," Distribution (Histogram)"),activeDot:!1}),(0,ie.jsx)(zs.d,{x:b(y),stroke:"red",strokeDasharray:"3 3",name:"Current Damage"}),(0,ie.jsx)(Gs.q,{x:b(y+U),y:(Z(y+U)||S)/2,shape:(0,ie.jsx)("circle",{radius:1,opacity:.5})}),(0,ie.jsx)(Ar.u,{content:(0,ie.jsx)(Y,{}),cursor:!1})]})},t.id),(0,ie.jsx)(fe.ZP,{direction:"row",container:!0,spacing:.75,columns:12,children:v.map((function(e){var n=(0,i.Z)(e,2),r=n[0],a=n[1];return r!==h?(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)($r.Z,{slotKey:r,artifactObj:a})},"".concat(r,"_").concat(t.id)):(0,ie.jsx)(fe.ZP,{item:!0,xs:1,children:(0,ie.jsx)(m.Z,{variant:"contained",style:{height:"100%",width:"100%"},onClick:function(){return c(!0)},startIcon:(0,ie.jsx)(f.Z,{sx:{position:"absolute",width:"70%",height:"70%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",opacity:.7},component:"img",src:Xn.Z.slot[r]}),sx:{minWidth:0}})},"".concat(r,"_").concat(t.id))}))}),(0,ie.jsx)("br",{}),(0,ie.jsx)("span",{children:"Click above to calculate Exact upgrade distribution"}),(0,ie.jsx)("br",{})]})})}function Us(){var e,t=(0,j.useContext)(E.K),n=t.character,r=t.character.key,a=(0,j.useContext)(T.t).database,s=(0,I.Z)(r),o=(0,Bt.Z)(),c=(0,j.useMemo)((function(){return!a.arts.values.length}),[a]),l=Tn(r),u=l.buildSetting,d=l.buildSettingDispatch,x=u.optimizationTarget,v=u.levelLow,Z=u.levelHigh,y=(0,$.Z)(r),C=null!==(e=null===y||void 0===y?void 0:y[r])&&void 0!==e?e:{},S=C.characterSheet,P=C.target,A=(0,j.useState)(void 0),K=(0,i.Z)(A,2),O=K[0],D=K[1],M=(0,j.useState)(!0),R=(0,i.Z)(M,2),W=R[0],N=R[1],L=(0,j.useState)(!0),F=(0,i.Z)(L,2),B=F[0],z=F[1],G=(0,j.useState)(!1),q=(0,i.Z)(G,2),H=q[0],U=q[1],J=(0,j.useCallback)((function(e,t,n){var r=e.query,i=e.arts,s=a.arts.values.filter((function(e){return 5===e.rarity})).map((function(e){return $s(e,20)})),o={};s.forEach((function(e){return o[e.id]=e}));var c=i.slice(0,t),l=i.slice(t),u=0,d=Math.min(n-t+5,l.length);do{for(;u<d;u++){var f=o[l[u].id];f&&(l[u]=Ms(r,f,!0,B))}for(l.sort(Ns),u=0;u<d&&"fast"!==l[u].evalMode;u++);}while(u<d);return{query:r,arts:[].concat((0,ue.Z)(c),(0,ue.Z)(l))}}),[a,B]),Y=(0,j.useState)(0),X=(0,i.Z)(Y,2),Q=X[0],ee=X[1],te=(0,j.useRef)(null),ne=(0,j.useMemo)((function(){if(!O)return{artifactsToShow:[],numPages:0,toShow:0,minObj0:0,maxObj0:0};var e=Math.ceil(O.arts.length/5),t=(0,jt.uZ)(Q,0,e-1),n=O.arts.slice(5*t,5*(t+1)),r=n.length>0?n[0].thresholds[0]:0;return{artifactsToShow:n,numPages:e,currentPageIndex:t,minObj0:n.reduce((function(e,t){return Math.min(t.distr.lower,e)}),r),maxObj0:n.reduce((function(e,t){return Math.max(t.distr.upper,e)}),r)}}),[O,5,Q]),re=ne.artifactsToShow,ae=ne.numPages,se=ne.currentPageIndex,oe=ne.minObj0,ce=ne.maxObj0,le=(0,j.useCallback)((function(e,t){var n;if(O){null===(n=te.current)||void 0===n||n.scrollIntoView({behavior:"smooth"});var r=J(O,5*(se+1),5*t);D(r),ee(t-1)}}),[ee,D,te,se,5,O,J]),de=(0,j.useCallback)((0,tt.Z)((0,Qe.Z)().mark((function e(){var t,n,s,o,c,l,d,f,h,p,x,v,m,j,Z,g,y,b,w,C,k,S,E,_,A;return(0,Qe.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=function(e){var t=(0,pe.Z)({},y);t[e.slotKey]=e.setKey;var n={};if(V.eV.forEach((function(e){var r;return n[t[e]]=(null!==(r=n[t[e]])&&void 0!==r?r:0)+1})),!Object.entries(n).every((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];if(!p[n])return!0;switch(r){case 0:case 1:return!0;case 2:case 3:return!p[n].includes(2);case 4:case 5:return!p[n].includes(4);default:throw Error("error in respectSex: num > 5")}})))return!1;if(!p.rainbow)return!0;switch(Object.values(n).reduce((function(e,t){return e+t%2}),0)){case 0:case 1:return!0;case 2:case 3:return!p.rainbow.includes(2);case 4:case 5:return!p.rainbow.includes(4);default:throw Error("error in respectSex: nRainbow > 5")}},c=u.statFilters,l=u.optimizationTarget,d=u.mainStatKeys,f=u.levelLow,h=u.levelHigh,p=u.artSetExclusion,r&&l){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,(0,$.V)(a,r,0,[]);case 6:if(x=e.sent){e.next=9;break}return e.abrupt("return");case 9:if(v=null===(t=(0,Ft.Qo)(x.teamData,r)[r])||void 0===t?void 0:t.target.data[0]){e.next=12;break}return e.abrupt("return");case 12:if(Object.assign(v,(0,Ft.b3)([v,Ri])),m=(0,jt.Hm)(null!==(n=v.display)&&void 0!==n?n:{},l)){e.next=16;break}return e.abrupt("return");case 16:D(void 0),ee(0),j=Object.entries(c).flatMap((function(e){var t=(0,i.Z)(e,2),n=t[0];return t[1].filter((function(e){return!e.disabled})).map((function(e){var t,r,i=(0,jt.Hm)(null!==(t=v.display)&&void 0!==t?t:{},JSON.parse(n));return{value:i,minimum:"%"===(null===(r=i.info)||void 0===r?void 0:r.unit)?e.value/100:e.value}}))})),Z=null!==(s=null===(o=a.chars.get(r))||void 0===o?void 0:o.equippedArtifacts)&&void 0!==s?s:{},g=(0,jt.O)(V.eV,(function(e){var t,n=a.arts.get(null!==(t=Z[e])&&void 0!==t?t:"");return n?$s(n):void 0})),y=(0,jt.O)(V.eV,(function(e){var t,n,r=a.arts.get(null!==(t=Z[e])&&void 0!==t?t:"");return null!==(n=null===r||void 0===r?void 0:r.setKey)&&void 0!==n?n:""})),w=a.arts.values.filter((function(e){return 5===e.rarity})).filter(b).filter((function(e){return W||20!==e.level})).filter((function(e){var t,n;return!H||!(null!==(t=d[e.slotKey])&&void 0!==t&&t.length)||(null===(n=d[e.slotKey])||void 0===n?void 0:n.includes(e.mainStatKey))})).filter((function(e){return!H||f<=e.level&&e.level<=h})).map((function(e){return $s(e,20)})),C={},w.forEach((function(e){return C[e.id]=e})),k=[m].concat((0,ue.Z)(j.map((function(e){return e.value})))),S=(0,xt.tL)(k,v,(function(e){return"dyn"!==(0,i.Z)(e.path,1)[0]})),E=Ws(S,j.map((function(e){return e.minimum})),g,P),_=(_=w.map((function(e){return Ms(E,e,!1,B)}))).sort((function(e,t){return t.prob*t.upAvg-e.prob*e.upAvg})),A=J(A={query:E,arts:_},0,5),D(A),console.log("result",A);case 34:case"end":return e.stop()}}),e)}))),[W,B,H,r,u,P,a,D,ee,J]),he=(0,j.useMemo)((function(){return n&&P&&S&&y&&{data:P,characterSheet:S,character:n,mainStatAssumptionLevel:0,teamData:y,characterDispatch:s}}),[P,S,n,y,s]);return(0,ie.jsxs)(f.Z,{display:"flex",flexDirection:"column",gap:1,children:[c&&(0,ie.jsxs)(it.Z,{severity:"warning",variant:"filled",children:[" Opps! It looks like you haven't added any artifacts to GO yet! You should go to the ",(0,ie.jsx)(at.Z,{component:g.rU,to:"/artifact",children:"Artifacts"})," page and add some!"]}),he&&(0,ie.jsx)(_.R.Provider,{value:he,children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsx)(f.Z,{children:(0,ie.jsx)(dt.Z,{characterKey:r,onClickTeammate:o})}),(0,ie.jsx)(Nn,{})]}),(0,ie.jsxs)(fe.ZP,{item:!0,xs:12,sm:6,lg:9,display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsxs)(fe.ZP,{item:!0,lg:4,display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsx)(w.Z,{children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)("span",{children:"Optimization Target: "}),(0,ie.jsx)(Mr.Z,{optimizationTarget:x,setTarget:function(e){return d({optimizationTarget:e})},disabled:!1})]})}),(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(pi,{disabled:!1})})}),H&&(0,ie.jsxs)(w.Z,{children:[(0,ie.jsx)(p.Z,{sx:{py:1},children:"Artifact Level Filter"}),(0,ie.jsx)(lt.Z,{levelLow:v,levelHigh:Z,setLow:function(e){return d({levelLow:e})},setHigh:function(e){return d({levelHigh:e})},setBoth:function(e,t){return d({levelLow:e,levelHigh:t})},disabled:!1}),(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(di,{disabled:!1})})]})]}),(0,ie.jsxs)(fe.ZP,{item:!0,lg:8,display:"flex",flexDirection:"column",gap:1,children:[(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsx)(Dn,{disabled:!1})})}),(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(m.Z,{startIcon:W?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:W?"success":"secondary",onClick:function(){return N(!W)},children:"show lvl 20"})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(m.Z,{startIcon:B?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:B?"success":"secondary",onClick:function(){return z(!B)},children:"compute 4th sub"})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(m.Z,{startIcon:H?(0,ie.jsx)(ve.Z,{}):(0,ie.jsx)(me.Z,{}),color:H?"success":"secondary",onClick:function(){return U(!H)},children:"enable filters"})})]})})})]})]}),(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,lg:12,children:(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(m.Z,{disabled:!r||!x||!(0,jt.Hm)(null===P||void 0===P?void 0:P.getDisplay(),x),color:r?"success":"warning",onClick:de,startIcon:(0,ie.jsx)(cn.G,{icon:on.lTt}),children:"Calc Upgrade Priority"})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(k.Hn,{size:"small"})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(k.oX,{size:"small"})})]})})})}),ae>1&&(0,ie.jsx)(b.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,children:[(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsx)(gs.Z,{count:ae,page:se+1,onChange:le})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(Js,{numShowing:re.length,total:null===O||void 0===O?void 0:O.arts.length})})]})})}),(0,ie.jsx)(fe.ZP,{item:!0,lg:12,spacing:1,children:(0,ie.jsxs)(fe.ZP,{container:!0,display:"flex",flexDirection:"column",gap:1,children:[c&&(0,ie.jsxs)(it.Z,{severity:"info",variant:"filled",children:["Looks like you haven't added any artifacts yet. If you want, there are ",(0,ie.jsx)(at.Z,{color:"warning.main",component:g.rU,to:"/scanner",children:"automatic scanners"})," that can speed up the import process!"]}),(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",sx:{width:"100%",height:600,minHeight:5e3}}),children:re.map((function(e){return(0,ie.jsxs)(fe.ZP,{container:!0,spacing:1,children:[(0,ie.jsx)(fe.ZP,{item:!0,xs:5,sm:4,md:4,lg:3,xl:3,children:(0,ie.jsx)(vr.Z,{artifactId:e.id,editorProps:{}})}),(0,ie.jsx)(fe.ZP,{item:!0,xs:7,sm:8,md:8,lg:9,xl:9,children:(0,ie.jsx)(Hs,{upgradeOpt:e,objMax:ce,objMin:oe})})]},e.id+"asdfsf")}))})]})}),ae>1&&(0,ie.jsx)(b.Z,{children:(0,ie.jsx)(p.Z,{children:(0,ie.jsxs)(fe.ZP,{container:!0,children:[(0,ie.jsx)(fe.ZP,{item:!0,flexGrow:1,children:(0,ie.jsx)(gs.Z,{count:ae,page:se+1,onChange:le})}),(0,ie.jsx)(fe.ZP,{item:!0,children:(0,ie.jsx)(Js,{numShowing:re.length,total:null===O||void 0===O?void 0:O.arts.length})})]})})})]})]})]})})]})}function Js(e){var t=e.numShowing,n=e.total;return(0,ie.jsx)(U.Z,{color:"text.secondary",children:(0,ie.jsxs)(ct.c,{i18nKey:"showingNum",count:t,value:n,children:["Showing ",(0,ie.jsx)("b",{children:{count:t}})," out of ",{value:n}," Artifacts"]})})}var Ys=n(53343);function Xs(){var e=(0,j.useContext)(E.K).character.key,t=(0,Bt.Z)();if(!e.startsWith("Traveler"))return null;var n=V.N.find((function(t){return e.toLowerCase().includes(t)}));return(0,ie.jsx)(ft.Z,{color:n,title:(0,ie.jsx)("strong",{children:(0,Ys.el)("element.".concat(n))}),children:V.DZ.map((function(r){return(0,ie.jsx)(st.Z,{selected:n===r,disabled:n===r,onClick:function(){return t((0,V.rq)(e,r))},children:(0,ie.jsx)("strong",{children:(0,ie.jsx)(Q.Z,{color:r,children:(0,Ys.el)("element.".concat(r))})})},r)}))})}var Qs,eo=n(24796),to=n(49547);function no(){var e=(0,Z.$)("ui").t,t=(0,j.useContext)(T.t).database,n=(0,j.useContext)(E.K).character.key,r=(0,R.Z)().gender,i=(0,j.useCallback)((function(){return t.dbMeta.set({gender:"F"===r?"M":"F"})}),[r,t]);return n.startsWith("Traveler")?(0,ie.jsxs)(m.Z,{onClick:i,startIcon:"F"===r?(0,ie.jsx)(eo.Z,{}):(0,ie.jsx)(to.Z,{}),children:[(0,ie.jsx)("strong",{children:e("gender.".concat(r))}),"  "]}):null}function ro(){var e=(0,y.s0)(),t=(0,j.useContext)(T.t).database,n=(0,j.useCallback)((function(){return e("/characters")}),[e]),r=(0,y.UO)().characterKey;return!t.chars.keys.includes(r)?(0,ie.jsx)(y.Fg,{to:"/characters"}):(0,ie.jsx)(f.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:1e3}),children:r&&(0,ie.jsx)(io,{characterKey:r,onClose:n})})})}function io(e){var t,n,r,a=e.characterKey,s=e.onClose,o=(0,M.Z)(a),c=(0,R.Z)().gender,l=(0,W.Z)((function(){return O.Z.get(a,c)}),[a,c]),u=(0,$.Z)(a),d=(null!==(t=null===u||void 0===u?void 0:u[a])&&void 0!==t?t:{}).target,x=(null!==(n=(0,y.bS)({path:"/characters/:charKey/:tab",end:!1}))&&void 0!==n?n:{params:{tab:"overview"}}).params.tab,v=void 0===x?"overview":x,m=(0,Z.$)(["charNames_gen","page_character"]).t;(0,N.Z)((0,j.useMemo)((function(){return"".concat(m("charNames_gen:".concat((0,V.LP)(a,c)))," - ").concat(m("page_character:tabs.".concat(v)))}),[m,a,c,v]));var g=(0,I.Z)(null!==(r=null===o||void 0===o?void 0:o.key)&&void 0!==r?r:""),P=(0,j.useMemo)((function(){if(u&&d)return{data:d,teamData:u,oldData:void 0}}),[d,u]),T=(0,j.useMemo)((function(){if(o&&l)return{character:o,characterSheet:l,characterDispatch:g}}),[o,l,g]),D=(0,j.useState)(void 0),B=(0,i.Z)(D,2),z=B[0],G=B[1],q=(0,j.useState)(),H=(0,i.Z)(q,2),U=H[0],J=H[1],Y=(0,j.useMemo)((function(){return{chartData:z,setChartData:G,graphBuilds:U,setGraphBuilds:J}}),[z,U]);return(0,j.useEffect)((function(){G(void 0),J(void 0)}),[a]),(0,ie.jsx)(b.Z,{children:P&&T&&Y?(0,ie.jsx)(E.K.Provider,{value:T,children:(0,ie.jsx)(_.R.Provider,{value:P,children:(0,ie.jsx)(K.Provider,{value:Y,children:(0,ie.jsx)(A.B,{children:(0,ie.jsxs)(p.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsxs)(f.Z,{display:"flex",children:[(0,ie.jsxs)(f.Z,{display:"flex",gap:1,flexWrap:"wrap",flexGrow:1,children:[(0,ie.jsx)(F.Z,{}),(0,ie.jsx)(Xs,{}),(0,ie.jsx)(no,{}),(0,ie.jsx)(oo,{}),(0,ie.jsx)(L.J,{}),(0,ie.jsx)(co,{})]}),!!s&&(0,ie.jsx)(C.Z,{onClick:s})]}),(0,ie.jsxs)(f.Z,{display:"flex",gap:1,flexWrap:"wrap",children:[o&&(0,ie.jsx)(S.Z,{level:o.level,ascension:o.ascension,setBoth:g}),(0,ie.jsx)(k.Hn,{size:"small"}),(0,ie.jsx)(k.pg,{}),(0,ie.jsx)(k.oX,{size:"small"})]}),(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(so,{tab:v})}),(0,ie.jsx)(ao,{}),(0,ie.jsx)(w.Z,{children:(0,ie.jsx)(so,{tab:v})})]})})})})}):(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:1e3})})}function ao(){return(0,ie.jsx)(j.Suspense,{fallback:(0,ie.jsx)(h.Z,{variant:"rectangular",width:"100%",height:500}),children:(0,ie.jsxs)(y.Z5,{children:[(0,ie.jsx)(y.AW,{index:!0,element:(0,ie.jsx)(Ta,{})}),(0,ie.jsx)(y.AW,{path:"/talent",element:(0,ie.jsx)(Ra,{})}),(0,ie.jsx)(y.AW,{path:"/teambuffs",element:(0,ie.jsx)(qa,{})}),(0,ie.jsx)(y.AW,{path:"/optimize",element:(0,ie.jsx)(Fi,{})}),(0,ie.jsx)(y.AW,{path:"/upgradeOpt",element:(0,ie.jsx)(Us,{})}),(0,ie.jsx)(y.AW,{path:"/theorycraft",element:(0,ie.jsx)(fs,{})})]})})}function so(e){var t=e.tab,n=(0,Z.$)("page_character").t;return(0,ie.jsxs)(x.Z,{value:t,variant:"scrollable",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"}},children:[(0,ie.jsx)(v.Z,{sx:{minWidth:"20%"},value:"overview",label:n("tabs.overview"),icon:(0,ie.jsx)(a.Z,{}),component:g.rU,to:""}),(0,ie.jsx)(v.Z,{sx:{minWidth:"20%"},value:"talent",label:n("tabs.talent"),icon:(0,ie.jsx)(s.Z,{}),component:g.rU,to:"talent"}),(0,ie.jsx)(v.Z,{sx:{minWidth:"20%"},value:"teambuffs",label:n("tabs.teambuffs"),icon:(0,ie.jsx)(o.Z,{}),component:g.rU,to:"teambuffs"}),(0,ie.jsx)(v.Z,{sx:{minWidth:"20%"},value:"optimize",label:n("tabs.optimize"),icon:(0,ie.jsx)(c.Z,{}),component:g.rU,to:"optimize"}),(0,ie.jsx)(v.Z,{sx:{minWidth:"20%"},value:"upgradeOpt",label:n("tabs.upgradeOpt"),icon:(0,ie.jsx)(l.Z,{}),component:g.rU,to:"upgradeOpt"}),(0,ie.jsx)(v.Z,{sx:{minWidth:"20%"},value:"theorycraft",label:n("tabs.theorycraft"),icon:(0,ie.jsx)(u.Z,{}),component:g.rU,to:"theorycraft"})]})}function oo(){var e=(0,Z.$)("page_character").t,t=(0,D.Z)(),n=(0,i.Z)(t,3),a=n[0],s=n[1],o=n[2],c=(0,j.useContext)(E.K).character.bonusStats,l=Object.keys(c).length;return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)(m.Z,{color:"info",startIcon:(0,ie.jsx)(d.Z,{}),onClick:s,children:[e(Qs||(Qs=(0,r.Z)(["addStats.title"]))),!!l&&(0,ie.jsx)(P.Z,{sx:{ml:1},color:"success",children:l})]}),(0,ie.jsx)(Ve,{open:a,onClose:o})]})}function co(){var e=(0,j.useContext)(A.M).onModalOpen;return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)(m.Z,{color:"info",startIcon:(0,ie.jsx)(l.Z,{}),onClick:e,children:["Formulas ","&"," Calcs"]}),(0,ie.jsx)(ae,{})]})}},90543:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r,i=n(30168),a=n(53174),s=n(54483),o=n(40117),c=n(62002),l=n(66647),u=n(64554),d=n(47047),f=n(13400),h=n(20890),p=n(39504),x=n(2199),v=n(40165),m=n(24518),j=n(72791),Z=n(22020),g=n(10658),y=n(71310),b=n(30066),w=n(40020),C=n(20005),k=n(55942),S=n(10157),P=n(2139),E=n(66218),_=n(66101),A=n(27235),K=n(73036),O=n(18327),T=n(42320),D=n(74480),M=n(80184);function I(e){var t,n=e.weaponId,I=e.onClick,R=e.onEdit,W=e.onDelete,$=e.canEquip,N=void 0!==$&&$,V=e.extraButtons,L=(0,Z.$)(["page_weapon","ui"]).t,F=(0,j.useContext)(_.t).database,B=(0,D.Z)(n),z=(0,T.Z)((function(){return null!==B&&void 0!==B&&B.key?E.Z.get(B.key):void 0}),[null===B||void 0===B?void 0:B.key]),G=(0,j.useCallback)((function(e){return e.weaponTypeKey===(null===z||void 0===z?void 0:z.weaponType)}),[z]),q=(0,j.useCallback)((function(e){return(0,M.jsx)(l.Z,{onClick:function(){return null===I||void 0===I?void 0:I(n)},children:e})}),[I,n]),H=(0,j.useCallback)((function(e){return(0,M.jsx)(u.Z,{children:e})}),[]),U=(0,j.useCallback)((function(e){return n&&F.weapons.set(n,{location:e})}),[F,n]),J=(0,j.useMemo)((function(){return z&&B&&(0,K.mP)([z.data,(0,K.v0)(B)])}),[z,B]);if(!B||!z||!J)return null;var Y=B.level,X=B.ascension,Q=B.refinement,ee=B.id,te=B.location,ne=void 0===te?"":te,re=B.lock,ie=J.get(A.ri.weapon.type).value,ae=[A.ri.weapon.main,A.ri.weapon.sub,A.ri.weapon.sub2].map((function(e){return J.get(e)})),se=z.getImg(X);return(0,M.jsx)(j.Suspense,{fallback:(0,M.jsx)(d.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:300}}),children:(0,M.jsxs)(y.Z,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,M.jsxs)(C.Z,{condition:!!I,wrapper:q,falseWrapper:H,children:[(0,M.jsxs)(u.Z,{className:"grad-".concat(z.rarity,"star"),sx:{position:"relative",pt:2,px:2},children:[!I&&(0,M.jsx)(f.Z,{color:"primary",onClick:function(){return F.weapons.set(ee,{lock:!re})},sx:{position:"absolute",right:0,bottom:0,zIndex:2},children:re?(0,M.jsx)(o.Z,{}):(0,M.jsx)(c.Z,{})}),(0,M.jsxs)(u.Z,{sx:{position:"relative",zIndex:1},children:[(0,M.jsxs)(u.Z,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,M.jsx)(k.Z,{sx:{fontSize:"1.5em"},src:null===(t=g.Z.weaponTypes)||void 0===t?void 0:t[ie]}),(0,M.jsx)(h.Z,{noWrap:!0,sx:{textAlign:"center",backgroundColor:"rgba(100,100,100,0.35)",borderRadius:"1em",px:1},children:(0,M.jsx)("strong",{children:z.name})})]}),(0,M.jsxs)(h.Z,{component:"span",variant:"h5",children:["Lv. ",Y]}),(0,M.jsxs)(h.Z,{component:"span",variant:"h5",color:"text.secondary",children:["/",P.SJ[X]]}),(0,M.jsxs)(h.Z,{variant:"h6",children:["Refinement ",(0,M.jsx)("strong",{children:Q})]}),(0,M.jsx)(h.Z,{children:(0,M.jsx)(S.q,{stars:z.rarity,colored:!0})})]}),(0,M.jsx)(u.Z,{sx:{height:"100%",position:"absolute",right:0,top:0},children:(0,M.jsx)(u.Z,{component:"img",src:null!==se&&void 0!==se?se:"",width:"auto",height:"100%",sx:{float:"right"}})})]}),(0,M.jsx)(p.Z,{children:ae.map((function(e){return e.info.name?(0,M.jsxs)(u.Z,{sx:{display:"flex"},children:[(0,M.jsxs)(h.Z,{flexGrow:1,children:[e.info.icon," ",e.info.name]}),(0,M.jsx)(h.Z,{children:(0,O.p)(e)})]},JSON.stringify(e.info)):null}))})]}),(0,M.jsxs)(u.Z,{sx:{p:1,display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[(0,M.jsx)(u.Z,{sx:{flexGrow:1},children:N?(0,M.jsx)(b.W,{location:ne,setLocation:U,filter:G,autoCompleteProps:{getOptionDisabled:function(e){return!e.key},disableClearable:!0}}):(0,M.jsx)(w.Z,{location:ne})}),(0,M.jsxs)(x.Z,{sx:{height:"100%"},children:[!!R&&(0,M.jsx)(v.Z,{title:(0,M.jsx)(h.Z,{children:L(r||(r=(0,i.Z)(["page_weapon:edit"])))}),placement:"top",arrow:!0,children:(0,M.jsx)(m.Z,{color:"info",onClick:function(){return R(ee)},children:(0,M.jsx)(s.G,{icon:a.Xcf,className:"fa-fw"})})}),!!W&&(0,M.jsx)(m.Z,{color:"error",onClick:function(){return W(ee)},disabled:!!ne||re,children:(0,M.jsx)(s.G,{icon:a.I7k,className:"fa-fw"})}),V]})]})]})})}},61503:function(e,t,n){"use strict";n.d(t,{Y:function(){return l}}),e=n.hmd(e);var r,i,a,s,o,c,l="undefined"!==typeof l?l:{},u=Object.assign,d=u({},l),f=[],h="object"===typeof window,p="function"===typeof importScripts,x="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,v="";x?(v=p?n(10699).dirname(v)+"/":"//",c=function(){o||(s=n(21678),o=n(10699))},r=function(e,t){return c(),e=o.normalize(e),s.readFileSync(e,t?null:"utf8")},a=function(e){var t=r(e,!0);return t.buffer||(t=new Uint8Array(t)),t},i=function(e,t,n){c(),e=o.normalize(e),s.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),f=process.argv.slice(2),e.exports=l,process.on("uncaughtException",(function(e){if(!(e instanceof bt))throw e})),process.on("unhandledRejection",(function(e){throw e})),function(e,t){if(z())throw process.exitCode=e,t;var n;(n=t)instanceof bt||m("exiting due to exception: "+n),process.exit(e)},l.inspect=function(){return"[Emscripten Module object]"}):(h||p)&&(p?v=self.location.href:"undefined"!==typeof document&&document.currentScript&&(v=document.currentScript.src),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",r=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},p&&(a=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});l.print||console.log.bind(console);var m=l.printErr||console.warn.bind(console);u(l,d),d=null,l.arguments&&(f=l.arguments),l.thisProgram&&l.thisProgram,l.quit&&l.quit;var j;l.wasmBinary&&(j=l.wasmBinary);var Z,g=l.noExitRuntime||!0;"object"!==typeof WebAssembly&&U("no native wasm support detected");var y=!1;var b="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function w(e,t){return e?function(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.subarray&&b)return b.decode(e.subarray(t,i));for(var a="";t<i;){var s=e[t++];if(128&s){var o=63&e[t++];if(192!=(224&s)){var c=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|c:(7&s)<<18|o<<12|c<<6|63&e[t++])<65536)a+=String.fromCharCode(s);else{var l=s-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else a+=String.fromCharCode((31&s)<<6|o)}else a+=String.fromCharCode(s)}return a}(P,e,t):""}function C(e,t,n){return function(e,t,n,r){if(!(r>0))return 0;for(var i=n,a=n+r-1,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++s)),o<=127){if(n>=a)break;t[n++]=o}else if(o<=2047){if(n+1>=a)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=a)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+3>=a)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}return t[n]=0,n-i}(e,P,t,n)}var k,S,P,E,_,A,K,O,T,D="undefined"!==typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function M(e,t){for(var n=e,r=n>>1,i=r+t/2;!(r>=i)&&_[r];)++r;if((n=r<<1)-e>32&&D)return D.decode(P.subarray(e,n));for(var a="",s=0;!(s>=t/2);++s){var o=E[e+2*s>>1];if(0==o)break;a+=String.fromCharCode(o)}return a}function I(e,t,n){if(void 0===n&&(n=2147483647),n<2)return 0;for(var r=t,i=(n-=2)<2*e.length?n/2:e.length,a=0;a<i;++a){var s=e.charCodeAt(a);E[t>>1]=s,t+=2}return E[t>>1]=0,t-r}function R(e){return 2*e.length}function W(e,t){for(var n=0,r="";!(n>=t/4);){var i=A[e+4*n>>2];if(0==i)break;if(++n,i>=65536){var a=i-65536;r+=String.fromCharCode(55296|a>>10,56320|1023&a)}else r+=String.fromCharCode(i)}return r}function $(e,t,n){if(void 0===n&&(n=2147483647),n<4)return 0;for(var r=t,i=r+n-4,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a);if(A[t>>2]=s,(t+=4)+4>i)break}return A[t>>2]=0,t-r}function N(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&++n,t+=4}return t}l.INITIAL_MEMORY;var V,L=[],F=[],B=[];function z(){return g||!1}var G=0,q=null,H=null;function U(e){throw l.onAbort&&l.onAbort(e),m(e="Aborted("+e+")"),y=!0,1,e+=". Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}l.preloadedImages={},l.preloadedAudios={};var J,Y;function X(e){return e.startsWith("data:application/octet-stream;base64,")}function Q(e){return e.startsWith("file://")}function ee(e){try{if(e==J&&j)return new Uint8Array(j);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}catch(m){U(m)}}function te(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"===typeof n?void 0===t.arg?re(n)():re(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(l)}}X(J="assembly.wasm")||(Y=J,J=l.locateFile?l.locateFile(Y,v):v+Y);var ne=[];function re(e){var t=ne[e];return t||(e>=ne.length&&(ne.length=e+1),ne[e]=t=V.get(e)),t}function ie(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){A[this.ptr+4>>2]=e},this.get_type=function(){return A[this.ptr+4>>2]},this.set_destructor=function(e){A[this.ptr+8>>2]=e},this.get_destructor=function(){return A[this.ptr+8>>2]},this.set_refcount=function(e){A[this.ptr>>2]=e},this.set_caught=function(e){e=e?1:0,S[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=S[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,S[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=S[this.ptr+13>>0]},this.init=function(e,t){this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=A[this.ptr>>2];A[this.ptr>>2]=e+1},this.release_ref=function(){var e=A[this.ptr>>2];return A[this.ptr>>2]=e-1,1===e}}function ae(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var se=void 0;function oe(e){for(var t="",n=e;P[n];)t+=se[P[n++]];return t}var ce={},le={},ue={};function de(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=48&&t<=57?"_"+e:e}function fe(e,t){return e=de(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function he(e,t){var n=fe(t,(function(e){this.name=t,this.message=e;var n=new Error(e).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var pe=void 0;function xe(e){throw new pe(e)}var ve=void 0;function me(e){throw new ve(e)}function je(e,t,n){function r(t){var r=n(t);r.length!==e.length&&me("Mismatched type converter count");for(var i=0;i<e.length;++i)Ze(e[i],r[i])}e.forEach((function(e){ue[e]=t}));var i=new Array(t.length),a=[],s=0;t.forEach((function(e,t){le.hasOwnProperty(e)?i[t]=le[e]:(a.push(e),ce.hasOwnProperty(e)||(ce[e]=[]),ce[e].push((function(){i[t]=le[e],++s===a.length&&r(i)})))})),0===a.length&&r(i)}function Ze(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||xe('type "'+r+'" must have a positive integer typeid pointer'),le.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;xe("Cannot register type '"+r+"' twice")}if(le[e]=t,delete ue[e],ce.hasOwnProperty(e)){var i=ce[e];delete ce[e],i.forEach((function(e){e()}))}}function ge(e){if(!(this instanceof Te))return!1;if(!(e instanceof Te))return!1;for(var t=this.$$.ptrType.registeredClass,n=this.$$.ptr,r=e.$$.ptrType.registeredClass,i=e.$$.ptr;t.baseClass;)n=t.upcast(n),t=t.baseClass;for(;r.baseClass;)i=r.upcast(i),r=r.baseClass;return t===r&&n===i}function ye(e){xe(e.$$.ptrType.registeredClass.name+" instance already deleted")}var be=!1;function we(e){}function Ce(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)}function ke(e){return"undefined"===typeof FinalizationGroup?(ke=function(e){return e},e):(be=new FinalizationGroup((function(e){for(var t=e.next();!t.done;t=e.next()){var n=t.value;n.ptr?Ce(n):console.warn("object already deleted: "+n.ptr)}})),ke=function(e){return be.register(e,e.$$,e.$$),e},we=function(e){be.unregister(e.$$)},ke(e))}function Se(){if(this.$$.ptr||ye(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e,t=ke(Object.create(Object.getPrototypeOf(this),{$$:{value:(e=this.$$,{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType})}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t}function Pe(){this.$$.ptr||ye(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&xe("Object already scheduled for deletion"),we(this),Ce(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ee(){return!this.$$.ptr}var _e=void 0,Ae=[];function Ke(){for(;Ae.length;){var e=Ae.pop();e.$$.deleteScheduled=!1,e.delete()}}function Oe(){return this.$$.ptr||ye(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&xe("Object already scheduled for deletion"),Ae.push(this),1===Ae.length&&_e&&_e(Ke),this.$$.deleteScheduled=!0,this}function Te(){}var De={};function Me(e,t,n){if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||xe("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}}function Ie(e,t,n,r,i,a,s,o){this.name=e,this.constructor=t,this.instancePrototype=n,this.rawDestructor=r,this.baseClass=i,this.getActualType=a,this.upcast=s,this.downcast=o,this.pureVirtualFunctions=[]}function Re(e,t,n){for(;t!==n;)t.upcast||xe("Expected null or instance of "+n.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function We(e,t){if(null===t)return this.isReference&&xe("null is not a valid "+this.name),0;t.$$||xe('Cannot pass "'+pt(t)+'" as a '+this.name),t.$$.ptr||xe("Cannot pass deleted object as a pointer of type "+this.name);var n=t.$$.ptrType.registeredClass;return Re(t.$$.ptr,n,this.registeredClass)}function $e(e,t){var n;if(null===t)return this.isReference&&xe("null is not a valid "+this.name),this.isSmartPointer?(n=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,n),n):0;t.$$||xe('Cannot pass "'+pt(t)+'" as a '+this.name),t.$$.ptr||xe("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&xe("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass;if(n=Re(t.$$.ptr,r,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&xe("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?n=t.$$.smartPtr:xe("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:n=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)n=t.$$.smartPtr;else{var i=t.clone();n=this.rawShare(n,ht.toHandle((function(){i.delete()}))),null!==e&&e.push(this.rawDestructor,n)}break;default:xe("Unsupporting sharing policy")}return n}function Ne(e,t){if(null===t)return this.isReference&&xe("null is not a valid "+this.name),0;t.$$||xe('Cannot pass "'+pt(t)+'" as a '+this.name),t.$$.ptr||xe("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&xe("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var n=t.$$.ptrType.registeredClass;return Re(t.$$.ptr,n,this.registeredClass)}function Ve(e){return this.fromWireType(K[e>>2])}function Le(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function Fe(e){this.rawDestructor&&this.rawDestructor(e)}function Be(e){null!==e&&e.delete()}function ze(e,t,n){if(t===n)return e;if(void 0===n.baseClass)return null;var r=ze(e,t,n.baseClass);return null===r?null:n.downcast(r)}function Ge(){return Object.keys(Ue).length}function qe(){var e=[];for(var t in Ue)Ue.hasOwnProperty(t)&&e.push(Ue[t]);return e}function He(e){_e=e,Ae.length&&_e&&_e(Ke)}var Ue={};function Je(e,t){return t=function(e,t){for(void 0===t&&xe("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}(e,t),Ue[t]}function Ye(e,t){return t.ptrType&&t.ptr||me("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!==!!t.smartPtr&&me("Both smartPtrType and smartPtr must be specified"),t.count={value:1},ke(Object.create(e,{$$:{value:t}}))}function Xe(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var n=Je(this.registeredClass,t);if(void 0!==n){if(0===n.$$.count.value)return n.$$.ptr=t,n.$$.smartPtr=e,n.clone();var r=n.clone();return this.destructor(e),r}function i(){return this.isSmartPointer?Ye(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Ye(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var a,s=this.registeredClass.getActualType(t),o=De[s];if(!o)return i.call(this);a=this.isConst?o.constPointerType:o.pointerType;var c=ze(t,this.registeredClass,a.registeredClass);return null===c?i.call(this):this.isSmartPointer?Ye(a.registeredClass.instancePrototype,{ptrType:a,ptr:c,smartPtrType:this,smartPtr:e}):Ye(a.registeredClass.instancePrototype,{ptrType:a,ptr:c})}function Qe(e,t,n,r,i,a,s,o,c,l,u){this.name=e,this.registeredClass=t,this.isReference=n,this.isConst=r,this.isSmartPointer=i,this.pointeeType=a,this.sharingPolicy=s,this.rawGetPointee=o,this.rawConstructor=c,this.rawShare=l,this.rawDestructor=u,i||void 0!==t.baseClass?this.toWireType=$e:r?(this.toWireType=We,this.destructorFunction=null):(this.toWireType=Ne,this.destructorFunction=null)}function et(e,t,n){return e.includes("j")?function(e,t,n){var r=l["dynCall_"+e];return n&&n.length?r.apply(null,[t].concat(n)):r.call(null,t)}(e,t,n):re(t).apply(null,n)}function tt(e,t){var n=(e=oe(e)).includes("j")?function(e,t){var n=[];return function(){n.length=arguments.length;for(var r=0;r<arguments.length;r++)n[r]=arguments[r];return et(e,t,n)}}(e,t):re(t);return"function"!==typeof n&&xe("unknown function pointer with signature "+e+": "+t),n}var nt=void 0;function rt(e){var t=yt(e),n=oe(t);return gt(t),n}function it(e,t){var n=[],r={};throw t.forEach((function e(t){r[t]||le[t]||(ue[t]?ue[t].forEach(e):(n.push(t),r[t]=!0))})),new nt(e+": "+n.map(rt).join([", "]))}function at(e,t){for(var n=[],r=0;r<e;r++)n.push(A[(t>>2)+r]);return n}function st(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function ot(e,t,n,r,i){var a=t.length;a<2&&xe("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=null!==t[1]&&null!==n,o=!1,c=1;c<t.length;++c)if(null!==t[c]&&void 0===t[c].destructorFunction){o=!0;break}var l="void"!==t[0].name,u="",d="";for(c=0;c<a-2;++c)u+=(0!==c?", ":"")+"arg"+c,d+=(0!==c?", ":"")+"arg"+c+"Wired";var f="return function "+de(e)+"("+u+") {\nif (arguments.length !== "+(a-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(a-2)+" args!');\n}\n";o&&(f+="var destructors = [];\n");var h=o?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],x=[xe,r,i,st,t[0],t[1]];s&&(f+="var thisWired = classParam.toWireType("+h+", this);\n");for(c=0;c<a-2;++c)f+="var arg"+c+"Wired = argType"+c+".toWireType("+h+", arg"+c+"); // "+t[c+2].name+"\n",p.push("argType"+c),x.push(t[c+2]);if(s&&(d="thisWired"+(d.length>0?", ":"")+d),f+=(l?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",o)f+="runDestructors(destructors);\n";else for(c=s?1:2;c<t.length;++c){var v=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==t[c].destructorFunction&&(f+=v+"_dtor("+v+"); // "+t[c].name+"\n",p.push(v+"_dtor"),x.push(t[c].destructorFunction))}return l&&(f+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),f+="}\n",p.push(f),function(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var n=fe(e.name||"unknownFunctionName",(function(){}));n.prototype=e.prototype;var r=new n,i=e.apply(r,t);return i instanceof Object?i:r}(Function,p).apply(null,x)}function ct(e,t,n){return e instanceof Object||xe(n+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||xe(n+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||xe("cannot call emscripten binding method "+n+" on deleted object"),Re(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}var lt=[],ut=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function dt(){for(var e=0,t=5;t<ut.length;++t)void 0!==ut[t]&&++e;return e}function ft(){for(var e=5;e<ut.length;++e)if(void 0!==ut[e])return ut[e];return null}var ht={toValue:function(e){return e||xe("Cannot use deleted val. handle = "+e),ut[e].value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=lt.length?lt.pop():ut.length;return ut[t]={refcount:1,value:e},t}}};function pt(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function xt(e,t){switch(t){case 2:return function(e){return this.fromWireType(O[e>>2])};case 3:return function(e){return this.fromWireType(T[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function vt(e,t,n){switch(t){case 0:return n?function(e){return S[e]}:function(e){return P[e]};case 1:return n?function(e){return E[e>>1]}:function(e){return _[e>>1]};case 2:return n?function(e){return A[e>>2]}:function(e){return K[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}!function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);se=e}(),pe=l.BindingError=he(Error,"BindingError"),ve=l.InternalError=he(Error,"InternalError"),Te.prototype.isAliasOf=ge,Te.prototype.clone=Se,Te.prototype.delete=Pe,Te.prototype.isDeleted=Ee,Te.prototype.deleteLater=Oe,Qe.prototype.getPointee=Le,Qe.prototype.destructor=Fe,Qe.prototype.argPackAdvance=8,Qe.prototype.readValueFromPointer=Ve,Qe.prototype.deleteObject=Be,Qe.prototype.fromWireType=Xe,l.getInheritedInstanceCount=Ge,l.getLiveInheritedInstances=qe,l.flushPendingDeletes=Ke,l.setDelayFunction=He,nt=l.UnboundTypeError=he(Error,"UnboundTypeError"),l.count_emval_handles=dt,l.get_first_emval=ft;var mt,jt={__cxa_allocate_exception:function(e){return Zt(e+16)+16},__cxa_throw:function(e,t,n){throw new ie(e).init(t,n),e,e},_embind_register_bigint:function(e,t,n,r,i){},_embind_register_bool:function(e,t,n,r,i){var a=ae(n);Ze(e,{name:t=oe(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:i},argPackAdvance:8,readValueFromPointer:function(e){var r;if(1===n)r=S;else if(2===n)r=E;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);r=A}return this.fromWireType(r[e>>a])},destructorFunction:null})},_embind_register_class:function(e,t,n,r,i,a,s,o,c,u,d,f,h){d=oe(d),a=tt(i,a),o&&(o=tt(s,o)),u&&(u=tt(c,u)),h=tt(f,h);var p=de(d);!function(e,t,n){l.hasOwnProperty(e)?((void 0===n||void 0!==l[e].overloadTable&&void 0!==l[e].overloadTable[n])&&xe("Cannot register public name '"+e+"' twice"),Me(l,e,e),l.hasOwnProperty(n)&&xe("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),l[e].overloadTable[n]=t):(l[e]=t,void 0!==n&&(l[e].numArguments=n))}(p,(function(){it("Cannot construct "+d+" due to unbound types",[r])})),je([e,t,n],r?[r]:[],(function(t){var n,i;t=t[0],i=r?(n=t.registeredClass).instancePrototype:Te.prototype;var s=fe(p,(function(){if(Object.getPrototypeOf(this)!==c)throw new pe("Use 'new' to construct "+d);if(void 0===f.constructor_body)throw new pe(d+" has no accessible constructor");var e=f.constructor_body[arguments.length];if(void 0===e)throw new pe("Tried to invoke ctor of "+d+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(f.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),c=Object.create(i,{constructor:{value:s}});s.prototype=c;var f=new Ie(d,s,c,h,n,a,o,u),x=new Qe(d,f,!0,!1,!1),v=new Qe(d+"*",f,!1,!1,!1),m=new Qe(d+" const*",f,!1,!0,!1);return De[e]={pointerType:v,constPointerType:m},function(e,t,n){l.hasOwnProperty(e)||me("Replacing nonexistant public symbol"),void 0!==l[e].overloadTable&&void 0!==n?l[e].overloadTable[n]=t:(l[e]=t,l[e].argCount=n)}(p,s),[x,v,m]}))},_embind_register_class_constructor:function(e,t,n,r,i,a){var s;t>0||U(s);var o=at(t,n);i=tt(r,i),je([],[e],(function(e){var n="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new pe("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[t-1]=function(){it("Cannot construct "+e.name+" due to unbound types",o)},je([],o,(function(r){return r.splice(1,0,null),e.registeredClass.constructor_body[t-1]=ot(n,r,null,i,a),[]})),[]}))},_embind_register_class_function:function(e,t,n,r,i,a,s,o){var c=at(n,r);t=oe(t),a=tt(i,a),je([],[e],(function(e){var r=(e=e[0]).name+"."+t;function i(){it("Cannot call "+r+" due to unbound types",c)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]),o&&e.registeredClass.pureVirtualFunctions.push(t);var l=e.registeredClass.instancePrototype,u=l[t];return void 0===u||void 0===u.overloadTable&&u.className!==e.name&&u.argCount===n-2?(i.argCount=n-2,i.className=e.name,l[t]=i):(Me(l,t,r),l[t].overloadTable[n-2]=i),je([],c,(function(i){var o=ot(r,i,e,a,s);return void 0===l[t].overloadTable?(o.argCount=n-2,l[t]=o):l[t].overloadTable[n-2]=o,[]})),[]}))},_embind_register_class_property:function(e,t,n,r,i,a,s,o,c,l){t=oe(t),i=tt(r,i),je([],[e],(function(e){var r=(e=e[0]).name+"."+t,u={get:function(){it("Cannot access "+r+" due to unbound types",[n,s])},enumerable:!0,configurable:!0};return u.set=c?function(){it("Cannot access "+r+" due to unbound types",[n,s])}:function(e){xe(r+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,t,u),je([],c?[n,s]:[n],(function(n){var s=n[0],u={get:function(){var t=ct(this,e,r+" getter");return s.fromWireType(i(a,t))},enumerable:!0};if(c){c=tt(o,c);var d=n[1];u.set=function(t){var n=ct(this,e,r+" setter"),i=[];c(l,n,d.toWireType(i,t)),st(i)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,u),[]})),[]}))},_embind_register_emval:function(e,t){Ze(e,{name:t=oe(t),fromWireType:function(e){var t=ht.toValue(e);return function(e){e>4&&0===--ut[e].refcount&&(ut[e]=void 0,lt.push(e))}(e),t},toWireType:function(e,t){return ht.toHandle(t)},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:null})},_embind_register_float:function(e,t,n){var r=ae(n);Ze(e,{name:t=oe(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:xt(t,r),destructorFunction:null})},_embind_register_integer:function(e,t,n,r,i){t=oe(t),-1===i&&(i=4294967295);var a=ae(n),s=function(e){return e};if(0===r){var o=32-8*n;s=function(e){return e<<o>>>o}}var c=t.includes("unsigned");Ze(e,{name:t,fromWireType:s,toWireType:c?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:vt(t,a,0!==r),destructorFunction:null})},_embind_register_memory_view:function(e,t,n){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function i(e){var t=K,n=t[e>>=2],i=t[e+1];return new r(k,i,n)}Ze(e,{name:n=oe(n),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},_embind_register_std_string:function(e,t){var n="std::string"===(t=oe(t));Ze(e,{name:t,fromWireType:function(e){var t,r=K[e>>2];if(n)for(var i=e+4,a=0;a<=r;++a){var s=e+4+a;if(a==r||0==P[s]){var o=w(i,s-i);void 0===t?t=o:(t+=String.fromCharCode(0),t+=o),i=s+1}}else{var c=new Array(r);for(a=0;a<r;++a)c[a]=String.fromCharCode(P[e+4+a]);t=c.join("")}return gt(e),t},toWireType:function(e,t){var r;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"===typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||xe("Cannot pass non-string to std::string"),r=n&&i?function(){return function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++n)),r<=127?++t:t+=r<=2047?2:r<=65535?3:4}return t}(t)}:function(){return t.length};var a=r(),s=Zt(4+a+1);if(K[s>>2]=a,n&&i)C(t,s+4,a+1);else if(i)for(var o=0;o<a;++o){var c=t.charCodeAt(o);c>255&&(gt(s),xe("String has UTF-16 code units that do not fit in 8 bits")),P[s+4+o]=c}else for(o=0;o<a;++o)P[s+4+o]=t[o];return null!==e&&e.push(gt,s),s},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:function(e){gt(e)}})},_embind_register_std_wstring:function(e,t,n){var r,i,a,s,o;n=oe(n),2===t?(r=M,i=I,s=R,a=function(){return _},o=1):4===t&&(r=W,i=$,s=N,a=function(){return K},o=2),Ze(e,{name:n,fromWireType:function(e){for(var n,i=K[e>>2],s=a(),c=e+4,l=0;l<=i;++l){var u=e+4+l*t;if(l==i||0==s[u>>o]){var d=r(c,u-c);void 0===n?n=d:(n+=String.fromCharCode(0),n+=d),c=u+t}}return gt(e),n},toWireType:function(e,r){"string"!==typeof r&&xe("Cannot pass non-string to C++ string type "+n);var a=s(r),c=Zt(4+a+t);return K[c>>2]=a>>o,i(r,c+4,a+t),null!==e&&e.push(gt,c),c},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:function(e){gt(e)}})},_embind_register_void:function(e,t){Ze(e,{isVoid:!0,name:t=oe(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},abort:function(){U("")},emscripten_memcpy_big:function(e,t,n){P.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){P.length,U("OOM")}},Zt=(function(){var e={env:jt,wasi_snapshot_preview1:jt};function t(e,t){var n,r,i=e.exports;l.asm=i,Z=l.asm.memory,n=Z.buffer,k=n,l.HEAP8=S=new Int8Array(n),l.HEAP16=E=new Int16Array(n),l.HEAP32=A=new Int32Array(n),l.HEAPU8=P=new Uint8Array(n),l.HEAPU16=_=new Uint16Array(n),l.HEAPU32=K=new Uint32Array(n),l.HEAPF32=O=new Float32Array(n),l.HEAPF64=T=new Float64Array(n),V=l.asm.__indirect_function_table,r=l.asm.__wasm_call_ctors,F.unshift(r),function(e){if(G--,l.monitorRunDependencies&&l.monitorRunDependencies(G),0==G&&(null!==q&&(clearInterval(q),q=null),H)){var t=H;H=null,t()}}()}function n(e){t(e.instance)}function r(t){return function(){if(!j&&(h||p)){if("function"===typeof fetch&&!Q(J))return fetch(J,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+J+"'";return e.arrayBuffer()})).catch((function(){return ee(J)}));if(i)return new Promise((function(e,t){i(J,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ee(J)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){m("failed to asynchronously prepare wasm: "+e),U(e)}))}if(G++,l.monitorRunDependencies&&l.monitorRunDependencies(G),l.instantiateWasm)try{return l.instantiateWasm(e,t)}catch(a){return m("Module.instantiateWasm callback failed with error: "+a),!1}j||"function"!==typeof WebAssembly.instantiateStreaming||X(J)||Q(J)||"function"!==typeof fetch?r(n):fetch(J,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return m("wasm streaming compile failed: "+e),m("falling back to ArrayBuffer instantiation"),r(n)}))}))}(),l.___wasm_call_ctors=function(){return(l.___wasm_call_ctors=l.asm.__wasm_call_ctors).apply(null,arguments)},l._malloc=function(){return(Zt=l._malloc=l.asm.malloc).apply(null,arguments)}),gt=l._free=function(){return(gt=l._free=l.asm.free).apply(null,arguments)},yt=l.___getTypeName=function(){return(yt=l.___getTypeName=l.asm.__getTypeName).apply(null,arguments)};l.___embind_register_native_and_builtin_types=function(){return(l.___embind_register_native_and_builtin_types=l.asm.__embind_register_native_and_builtin_types).apply(null,arguments)},l.___errno_location=function(){return(l.___errno_location=l.asm.__errno_location).apply(null,arguments)},l.stackSave=function(){return(l.stackSave=l.asm.stackSave).apply(null,arguments)},l.stackRestore=function(){return(l.stackRestore=l.asm.stackRestore).apply(null,arguments)},l.stackAlloc=function(){return(l.stackAlloc=l.asm.stackAlloc).apply(null,arguments)};function bt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function wt(e){function t(){mt||(mt=!0,l.calledRun=!0,y||(!0,te(F),l.onRuntimeInitialized&&l.onRuntimeInitialized(),function(){if(l.postRun)for("function"==typeof l.postRun&&(l.postRun=[l.postRun]);l.postRun.length;)e=l.postRun.shift(),B.unshift(e);var e;te(B)}()))}e=e||f,G>0||(!function(){if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)e=l.preRun.shift(),L.unshift(e);var e;te(L)}(),G>0||(l.setStatus?(l.setStatus("Running..."),setTimeout((function(){setTimeout((function(){l.setStatus("")}),1),t()}),1)):t()))}if(H=function e(){mt||wt(),mt||(H=e)},l.run=wt,l.preInit)for("function"==typeof l.preInit&&(l.preInit=[l.preInit]);l.preInit.length>0;)l.preInit.pop()();wt()},21678:function(){},10699:function(){}}]);
//# sourceMappingURL=800.bf5acd4b.chunk.js.map