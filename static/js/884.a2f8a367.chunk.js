(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[884],{21977:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(29439),i=t(57621),a=t(10889),s=t(72791),o=t(60393),c=t(10600),l=t(80184);function u(e){var n=e.levelLow,t=e.levelHigh,u=e.setLow,d=e.setHigh,f=e.setBoth,h=e.dark,p=void 0!==h&&h,x=e.disabled,v=void 0!==x&&x,m=e.showLevelText,j=void 0!==m&&m,Z=(0,s.useState)(n),g=(0,r.Z)(Z,2),y=g[0],b=g[1],w=(0,s.useState)(t),C=(0,r.Z)(w,2),k=C[0],P=C[1],S=(0,s.useCallback)((function(e,n){if("number"==typeof n)throw new TypeError;var t=(0,r.Z)(n,2),i=t[0],a=t[1];b(i),P(a)}),[b,P]);return(0,s.useEffect)((function(){return b(n)}),[b,n]),(0,s.useEffect)((function(){return P(t)}),[P,t]),(0,l.jsxs)(i.Z,{sx:{width:"100%",display:"flex",alignItems:"center",bgcolor:p?"contentDark.main":"contentLight.main"},children:[(0,l.jsx)(c.ZP,{value:y,onChange:function(e){return u((0,o.uZ)(e,0,t))},sx:{px:1,pl:j?2:void 0,width:j?100:50},inputProps:{sx:{textAlign:"center"}},startAdornment:j?"Level: ":void 0,disabled:v}),(0,l.jsx)(a.ZP,{sx:{width:100,flexGrow:1,mx:2},getAriaLabel:function(){return"Arifact Level Range"},value:[y,k],onChange:S,onChangeCommitted:function(e,n){return f(n[0],n[1])},valueLabelDisplay:"auto",min:0,max:20,step:1,marks:!0,disabled:v}),(0,l.jsx)(c.ZP,{value:k,onChange:function(e){return d((0,o.uZ)(e,n,20))},sx:{px:1,width:50},inputProps:{sx:{textAlign:"center"}},disabled:v})]})}},18726:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(20890),i=t(52791),a=t(80184);function s(e){var n=e.avatar,t=e.title,s=e.action;return(0,a.jsxs)(i.Z,{display:"flex",gap:1,p:2,alignItems:"center",children:[n,(0,a.jsx)(r.Z,{variant:"subtitle1",sx:{flexGrow:1},children:t}),s&&(0,a.jsx)(r.Z,{variant:"caption",children:s})]})}},37503:function(e,n,t){"use strict";t.d(n,{X:function(){return R},Z:function(){return M}});var r=t(68870),i=t(20890),a=t(94721),s=t(72791),o=t(13746),c=t(60393),l=t(3992),u=t(18726),d=t(39504),f=t(88034),h=t(29439),p=t(72247),x=t(9912),v=t(24518),m=t(23786),j=t(2199),Z=t(97714),g=t(33890),y=t(25617),b=t(66624),w=t(80184);function C(e){var n=e.conditional,t=e.disabled,r=void 0!==t&&t;return 1===Object.keys(n.states).length&&"path"in n?(0,w.jsx)(k,{conditional:n,disabled:r}):"path"in n?(0,w.jsx)(P,{conditional:n,disabled:r}):(0,w.jsx)(S,{conditional:n,disabled:r})}function k(e){var n=e.conditional,t=e.disabled,r=(0,s.useContext)(Z.K),i=r.character,a=r.characterDispatch,l=(0,s.useContext)(o.R).data,u=(0,s.useCallback)((function(e){var t=(0,c.I8)(i.conditional);e?(0,c.SR)(t,n.path,e):(0,c.uH)(t,n.path),a({conditional:t})}),[n,i,a]),d=l.get(n.value).value,f=(0,h.Z)(Object.entries(n.states)[0],2),m=f[0],j=O(f[1].name),g=_(n.name);return(0,w.jsxs)(v.Z,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:d?"success":"primary",onClick:function(){return u(d?void 0:m)},disabled:t,startIcon:d?(0,w.jsx)(p.Z,{}):(0,w.jsx)(x.Z,{}),children:[g," ",j]})}function P(e){var n=e.conditional,t=e.disabled,r=(0,s.useContext)(Z.K),i=r.character,l=r.characterDispatch,u=(0,s.useContext)(o.R).data,d=(0,s.useCallback)((function(e){var t=(0,c.I8)(i.conditional);e?(0,c.SR)(t,n.path,e):(0,c.uH)(t,n.path),l({conditional:t})}),[n,i,l]),f=u.get(n.value).value,p=f?n.states[f]:void 0,x=p?O(p.name):(0,w.jsx)(y.Z,{color:"secondary",children:"Not Active"}),v=_(n.name);return(0,w.jsxs)(g.Z,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:f?"success":"primary",title:(0,w.jsxs)("span",{children:[v," ",x]}),disabled:t,children:[(0,w.jsx)(m.Z,{onClick:function(){return d()},selected:!p,disabled:!p,children:(0,w.jsx)("span",{children:"Not Active"})}),(0,w.jsx)(a.Z,{}),Object.entries(n.states).map((function(e){var n=(0,h.Z)(e,2),t=n[0],r=n[1];return(0,w.jsx)(m.Z,{onClick:function(){return d(t)},selected:f===t,disabled:f===t,children:r.name},t)}))]})}function S(e){var n=e.conditional,t=e.disabled,r=(0,s.useContext)(Z.K),i=r.character,a=r.characterDispatch,l=(0,s.useContext)(o.R).data,u=(0,s.useCallback)((function(e,n){var t=(0,c.I8)(i.conditional);n?(0,c.SR)(t,e,n):(0,c.uH)(t,e),a({conditional:t})}),[i,a]);return(0,w.jsx)(j.Z,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(n.states).map((function(e){var n=(0,h.Z)(e,2),r=n[0],i=n[1],a=l.get(i.value).value,s=a===r;return(0,w.jsx)(v.Z,{color:s?"success":"primary",disabled:t,fullWidth:!0,onClick:function(){return u(i.path,a?void 0:r)},size:"small",startIcon:s?(0,w.jsx)(p.Z,{}):(0,w.jsx)(x.Z,{}),sx:{borderRadius:0},children:_(i.name)},r)}))})}function E(e){return"string"!==typeof e}function O(e){if(!e)return"";var n="primary",t=e;return e&&E(e)&&e.props.color&&(n=e.props.color,t=(0,w.jsx)("span",{children:e.props.children})),(0,w.jsx)(y.Z,{sx:{ml:.5},color:n,children:t})}function _(e){if(E(e)){var n=e.props.key18,t=e.props.ns,r=e.props.values;return(0,w.jsx)(b.v,{ns:t,key18:n,values:r,useBadge:!0})}return e}function A(e){var n,t=e.conditional,r=e.hideHeader,i=void 0!==r&&r,a=e.hideDesc,u=void 0!==a&&a,h=(0,s.useContext)(o.R).data;if("path"in t){var p,x=h.get(t.value).value;n=x&&(null===(p=t.states[x])||void 0===p?void 0:p.fields)}else n=Object.values(t.states).flatMap((function(e){return h.get(e.value).value?e.fields:[]}));return(0,w.jsxs)(l.Z,{children:[!(0,c.mY)(i,t)&&(0,w.jsx)(R,{header:t.header,hideDesc:u}),(0,w.jsx)(d.Z,{sx:{p:0,"&:last-child":{pb:0}},children:(0,w.jsx)(C,{conditional:t})}),n&&(0,w.jsx)(f.ZP,{fields:n})]})}var D=t(55221);function M(e){var n=e.sections,t=e.teamBuffOnly,i=e.hideDesc,a=void 0!==i&&i,c=e.hideHeader,l=void 0!==c&&c,u=(0,s.useContext)(o.R).data;if(!n.length)return null;var d=n.map((function(e,n){return e.canShow&&!u.get(e.canShow).value||t&&!e.teamBuff?null:(0,w.jsx)(T,{section:e,hideDesc:a,hideHeader:l},n)})).filter((function(e){return e}));return d.length?(0,w.jsx)(r.Z,{display:"flex",flexDirection:"column",gap:1,children:d}):null}function T(e){var n=e.section,t=e.hideDesc,r=void 0!==t&&t,i=e.hideHeader,a=void 0!==i&&i;return"fields"in n?(0,w.jsx)(K,{section:n,hideDesc:r,hideHeader:a}):"states"in n?(0,w.jsx)(A,{conditional:n,hideDesc:r,hideHeader:a}):(0,w.jsx)(I,{section:n})}function K(e){var n=e.section,t=e.hideDesc,r=e.hideHeader;return(0,w.jsxs)(l.Z,{children:[!(0,c.mY)(r,n)&&n.header&&(0,w.jsx)(R,{header:n.header,hideDesc:t,hideDivider:0===n.fields.length}),(0,w.jsx)(f.ZP,{fields:n.fields})]})}function I(e){var n=e.section,t=(0,s.useContext)(o.R).data;return(0,w.jsx)("div",{children:(0,c.mY)(n.text,t)})}function R(e){var n=e.header,t=e.hideDesc,r=e.hideDivider,l=(0,s.useContext)(o.R).data,d=n.icon,f=n.title,h=n.action;d=(0,c.mY)(d,l);var p=!t&&(0,c.mY)(n.description,l),x=t?f:(0,w.jsxs)("span",{children:[f," ",(0,w.jsx)(D.Z,{title:(0,w.jsx)(i.Z,{children:p})})]});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{avatar:d,title:x,action:h}),!r&&(0,w.jsx)(a.Z,{})]})}},29371:function(e,n,t){"use strict";t.d(n,{Z:function(){return x}});var r=t(29439),i=t(93433),a=t(2199),s=t(24518),o=t(23786),c=t(72791),l=t(22020),u=t(2139),d=t(60393),f=t(10600),h=t(33890),p=t(80184);function x(e){var n=e.level,t=e.ascension,x=e.setBoth,v=e.useLow,m=void 0!==v&&v,j=(0,l.$)("ui").t,Z=m?u.sU:u.SJ,g=(0,c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e=(0,d.uZ)(e,1,m?u.d8:u.Qq);var n=Z.findIndex((function(n){return e<=n}));x({level:e,ascension:n})}),[x,Z,m]),y=(0,c.useCallback)((function(){var e=Z.findIndex((function(e){return 90!==n&&n===e}));x(t===e?{ascension:t+1}:{ascension:e})}),[x,Z,t,n]);return(0,p.jsxs)(a.Z,{sx:{bgcolor:function(e){return e.palette.contentDark.main}},children:[(0,p.jsx)(f.CC,{children:(0,p.jsx)(f.ZP,{onChange:g,value:n,startAdornment:"Lv. ",inputProps:{min:1,max:90,sx:{textAlign:"center",width:"3em"}},sx:{height:"100%",pl:2}})}),(0,p.jsx)(s.Z,{sx:{pl:1,whiteSpace:"nowrap"},disabled:!(m?u.nB:u.ek)(n),onClick:y,children:(0,p.jsxs)("strong",{children:["/ ",u.SJ[t]]})}),(0,p.jsx)(h.Z,{title:j("selectlevel"),sx:{flexGrow:1},children:(0,i.Z)(m?u.vF:u.D4).map((function(e){var i=(0,r.Z)(e,2),a=i[0],s=i[1],c=a===n&&s===t;return(0,p.jsx)(o.Z,{selected:c,disabled:c,onClick:function(){return x({level:a,ascension:s})},children:a===Z[s]?"Lv. ".concat(a):"Lv. ".concat(a,"/").concat(Z[s])},"".concat(a,"/").concat(s))}))})]})}},92443:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(1413),i=t(45987),a=t(66934),s=t(24518),o=t(80184),c=["children","disabled"],l=(0,a.ZP)(s.Z)((function(e){var n=e.theme;return{"&.Mui-disabled":{backgroundColor:n.palette.primary.dark,color:n.palette.text.secondary}}}));function u(e){var n=e.children,t=(e.disabled,(0,i.Z)(e,c));return(0,o.jsx)(l,(0,r.Z)((0,r.Z)({},t),{},{disabled:!0,children:n}))}},43884:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Ya}});var r=t(29439),i=t(63833),a=t(45781),s=t(35893),o=t(10284),c=t(66630),l=t(68575),u=t(68870),d=t(47047),f=t(39504),h=t(25228),p=t(43896),x=t(24518),v=t(72791),m=t(22020),j=t(43504),Z=t(16871),g=t(3992),y=t(71310),b=t(68198),w=t(32490),C=t(97714),k=t(13746),P=t(60705),S=t(947),E=t(24711),O=t(13434),_=t(50920),A=t(42320),D=t(47639),M=t(72056),T=t(24351),K=t(28057),I=t(3082),R=t(2380),z=t(566),$=t(80184);function W(){var e,n=(0,m.$)("page_character").t,t=(0,v.useContext)(C.K).characterSheet,i=(0,v.useState)(!1),a=(0,r.Z)(i,2),s=a[0],o=a[1],c=(0,z.Z)();return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(I.w,{show:s,onHide:function(){return o(!1)},onSelect:c}),(0,$.jsx)(x.Z,{color:"info",onClick:function(){return o(!0)},startIcon:(0,$.jsx)(R.Z,{src:null===t||void 0===t?void 0:t.thumbImgSide}),children:null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:n("selectCharacter")})]})}var N=t(37355),F=t(9585),B=t(94721),V=t(89673),L=t(55818),q=t(20890),G=t(3721),H=t(63210),U=t(18726),J=t(91702),X=t(55942),Y=t(9321),Q=t(25617),ee=t(8430),ne=t(79406);function te(){var e=(0,v.useContext)(P.M).modalOpen,n=(0,v.useContext)(P.M).setFormulaData,t=(0,v.useCallback)((function(){return null===n||void 0===n?void 0:n(void 0,void 0)}),[n]);return(0,$.jsx)(Y.Z,{open:!!e,onClose:t,children:(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(F.Z,{title:"Formulas & Calculations",action:(0,$.jsx)(b.Z,{onClick:t})}),(0,$.jsx)(f.Z,{sx:{pt:0},children:(0,$.jsx)(re,{})})]})})}function re(){var e=(0,v.useContext)(k.R).data,n=(0,v.useContext)(P.M).data,t=(0,ee.U)(null!==n&&void 0!==n?n:e);return(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:1e3}),children:(0,$.jsx)(u.Z,{sx:{mr:-1,mb:-1},children:t.map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return(0,$.jsx)(ie,{displayNs:i,sectionKey:t},t)}))})})}function ie(e){var n=e.sectionKey,t=e.displayNs,i=(0,v.useContext)(k.R).data,a=(0,v.useContext)(P.M).data,s=(0,A.Z)((function(){return(0,ee.f)(null!==a&&void 0!==a?a:i,n)}),[a,i,n]);if(!s)return null;if(Object.entries(t).every((function(e){var n=(0,r.Z)(e,2);n[0];return n[1].isEmpty})))return null;var o=s.title,c=s.icon,l=s.action;return(0,$.jsxs)(y.Z,{sx:{mb:1},children:[(0,$.jsx)(U.Z,{avatar:c&&(0,$.jsx)(X.Z,{size:2,sx:{m:-1},src:c}),title:o,action:l&&(0,$.jsx)(Q.Z,{children:l})}),(0,$.jsx)(B.Z,{}),(0,$.jsx)(f.Z,{children:Object.entries(t).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return!i.isEmpty&&(0,$.jsx)(ae,{node:i},t)}))})]})}function ae(e){var n,t=e.node,i=(0,v.useContext)(P.M).node,a=(0,v.useState)(!1),s=(0,r.Z)(a,2),o=s[0],c=s[1],l=(0,v.useCallback)((function(e,n){return c(n)}),[]),d=(0,v.useRef)();return(0,v.useEffect)((function(){t===i&&setTimeout((function(){var e,n;return null===d||void 0===d||null===(e=d.current)||void 0===e||null===(n=e.scrollIntoView)||void 0===n?void 0:n.call(e,{behavior:"smooth"})}),300)}),[d,t,i]),(0,$.jsxs)(V.Z,{sx:{bgcolor:"contentDark.main"},expanded:t===i||o,onChange:l,ref:d,children:[(0,$.jsxs)(L.Z,{expandIcon:(0,$.jsx)(N.Z,{}),children:[(0,$.jsxs)(q.Z,{children:[(0,$.jsx)(J.Z,{color:t.info.variant,children:ne.ZP.get(null!==(n=t.info.key)&&void 0!==n?n:"")})," ",(0,$.jsx)("strong",{children:(0,ne.EC)(t.value,t.unit)})]}),T.jU.includes(t.info.variant)&&(0,$.jsx)(u.Z,{sx:{display:"inline-block",ml:"auto",mr:2},children:(0,$.jsx)(H.Z,{reaction:t.info.variant,trigger:t.info.subVariant})})]}),(0,$.jsx)(G.Z,{children:t.formulas.map((function(e,n){return(0,$.jsx)(q.Z,{children:e},n)}))})]})}var se=t(29371),oe=t(93433),ce=t(53767),le=t(61889),ue=t(15021),de=t(52791),fe=t(1413),he=t(72247),pe=t(9912),xe=t(81918),ve=t(56125),me=t(26138),je=t(45987),Ze=t(66934),ge=t(13400),ye=["expand"],be=(0,Ze.ZP)((function(e){e.expand;var n=(0,je.Z)(e,ye);return(0,$.jsx)(ge.Z,(0,fe.Z)({},n))}))((function(e){var n=e.theme;return{transform:e.expand?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest})}})),we=t(75545),Ce=t(49670),ke=t(2199),Pe=t(10600),Se=t(92443),Ee=["name","children","value","placeholder","defaultValue","onValueChange","percent","disabled","onReset"],Oe=(0,Ze.ZP)(ke.Z)({display:"flex"});function _e(e){var n=e.name,t=e.children,r=e.value,i=e.placeholder,a=e.defaultValue,s=void 0===a?0:a,o=e.onValueChange,c=e.percent,l=void 0!==c&&c,u=e.disabled,d=void 0!==u&&u,f=e.onReset,h=(0,je.Z)(e,Ee);return(0,$.jsxs)(Oe,(0,fe.Z)((0,fe.Z)({},h),{},{children:[t,(0,$.jsx)(Se.Z,{sx:{px:1},children:n}),(0,$.jsx)(Pe.CC,{sx:{flexBasis:"10em",flexGrow:1},children:(0,$.jsx)(Pe.ZP,{sx:{px:1},inputProps:{sx:{textAlign:"right"}},float:l,placeholder:i,value:r,onChange:o,disabled:d,endAdornment:l?"%":void 0})}),(0,$.jsx)(x.Z,{sx:{flexShrink:2},size:"small",color:"error",onClick:function(){return f?f():o(s)},disabled:d||r===s,children:(0,$.jsx)(Ce.Z,{})})]}))}function Ae(){var e=(0,v.useContext)(k.R).data,n=(0,v.useState)(!1),t=(0,r.Z)(n,2),i=t[0],a=t[1],s=(0,v.useCallback)((function(){return a(!i)}),[a,i]),o=e.get(me.ri.enemy.level),c=e.get(me.ri.enemy.defRed),l=e.get(me.ri.enemy.defIgn);return(0,$.jsxs)(y.Z,{children:[(0,$.jsxs)(f.Z,{sx:{display:"flex"},children:[(0,$.jsxs)(le.ZP,{container:!0,spacing:1,flexGrow:1,alignItems:"center",children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(xe.Z,{size:"small",color:"success",label:(0,$.jsxs)("span",{children:[ne.ZP.get(o.info.key)," ",(0,$.jsx)("strong",{children:o.value})]})})}),T.Kj.map((function(e){return(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(q.Z,{children:(0,$.jsx)(De,{element:e})},e)},e)})),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsxs)(q.Z,{children:["DEF Reduction ",(0,ne.EC)(c.value,c.unit)]})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsxs)(q.Z,{children:["DEF Ignore ",(0,ne.EC)(l.value,l.unit)]})})]}),(0,$.jsx)(be,{expand:i,onClick:s,"aria-expanded":i,"aria-label":"show more",size:"small",sx:{p:0},children:(0,$.jsx)(N.Z,{})})]}),(0,$.jsx)(ve.Z,{in:i,timeout:"auto",unmountOnExit:!0,children:(0,$.jsx)(f.Z,{sx:{pt:0},children:(0,$.jsx)(Me,{})})})]})}function De(e){var n=e.element,t=(0,v.useContext)(k.R).data.get(me.ri.enemy["".concat(n,"_res_")]),r=!isFinite(t.value)?(0,$.jsxs)("span",{children:[we.hJ[n]," IMMUNE"]}):(0,$.jsxs)("span",{children:[we.hJ[n],"RES ",(0,$.jsx)("strong",{children:(0,ne.EC)(t.value,t.unit)})]});return(0,$.jsx)(J.Z,{color:n,children:r})}function Me(e){var n,t,r,i=e.bsProps,a=void 0===i?{xs:12,md:6}:i,s=(0,v.useContext)(C.K),o=s.character.enemyOverride,c=s.characterDispatch,l=(0,v.useContext)(k.R).data,u=null!==(n=o.enemyLevel)&&void 0!==n?n:l.get(me.ri.lvl).value,d=null!==(t=o.enemyDefIgn_)&&void 0!==t?t:0,f=null!==(r=o.enemyDefRed_)&&void 0!==r?r:0;return(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},a),{},{children:(0,$.jsx)(x.Z,{fullWidth:!0,sx:{height:"100%"},size:"small",component:"a",color:"warning",href:"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances",target:"_blank",rel:"noreferrer",children:"To get the specific resistance values of enemies, please visit the wiki."})})),(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},a),{},{children:(0,$.jsx)(_e,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,$.jsx)("b",{children:ne.ZP.get("enemyLevel")}),value:u,placeholder:ne.ZP.getStr("enemyLevel"),defaultValue:l.get(me.ri.lvl).value,onValueChange:function(e){return c({type:"enemyOverride",statKey:"enemyLevel",value:e})},onReset:function(){return c({type:"enemyOverride",statKey:"enemyLevel",value:void 0})}})})),T.Kj.map((function(e){var n="".concat(e,"_enemyRes_"),t=o[n],r=t===Number.MAX_VALUE;return(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},a),{},{children:(0,$.jsx)(_e,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,$.jsx)(J.Z,{color:e,children:(0,$.jsx)("b",{children:ne.ZP.get(n)})}),value:t?r?1/0:t:10,placeholder:r?"Immune ":ne.ZP.getStr(n),defaultValue:10,onValueChange:function(e){return c({type:"enemyOverride",statKey:n,value:e})},disabled:r,percent:!0,children:(0,$.jsx)(x.Z,{color:e,onClick:function(){return c({type:"enemyOverride",statKey:n,value:r?10:Number.MAX_VALUE})},startIcon:r?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),children:"Immunity"})})}),e)})),(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},a),{},{children:(0,$.jsx)(_e,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,$.jsx)("b",{children:ne.ZP.get("enemyDefIgn_")}),value:d,placeholder:ne.ZP.getStr("enemyDefIgn_"),defaultValue:0,onValueChange:function(e){return c({type:"enemyOverride",statKey:"enemyDefIgn_",value:e})},percent:!0})})),(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},a),{},{children:(0,$.jsx)(_e,{sx:{bgcolor:function(e){return e.palette.contentLight.main},width:"100%"},name:(0,$.jsx)("b",{children:ne.ZP.get("enemyDefRed_")}),value:f,placeholder:ne.ZP.getStr("enemyDefRed_"),defaultValue:0,onValueChange:function(e){return c({type:"enemyOverride",statKey:"enemyDefRed_",value:e})},percent:!0})})),(0,$.jsx)(le.ZP,{item:!0,xs:12,children:(0,$.jsx)("small",{children:"Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)"})})]})}var Te=t(88034),Ke=t(43696),Ie={xs:1,md:2,lg:3};function Re(e){var n=e.open,t=e.onClose;return(0,$.jsx)(Y.Z,{open:n,onClose:t,children:(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(F.Z,{title:"Detailed Stats",action:(0,$.jsx)(b.Z,{onClick:t})}),(0,$.jsx)(f.Z,{sx:{pt:0},children:(0,$.jsxs)(ce.Z,{spacing:1,children:[(0,$.jsx)(We,{}),(0,$.jsx)(Ae,{}),(0,$.jsx)(Ge,{})]})})]})})}var ze=(0,oe.Z)(me.lR),$e=function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:1,children:e})};function We(){var e=(0,v.useContext)(C.K),n=e.character.bonusStats,t=e.characterDispatch,r=(0,v.useCallback)((function(e){return t({bonusStats:e})}),[t]);return(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{sx:{display:"flex"},children:(0,$.jsx)(le.ZP,{container:!0,columns:Ie,sx:{pt:1},spacing:1,children:(0,$.jsx)(Ke.Z,{statKeys:ze,statFilters:n,setStatFilters:r,wrapperFunc:$e})})})})}var Ne=["eleMas","critRate_","critDMG_","enerRech_","heal_"],Fe=[].concat(["hp","atk","def"],Ne).map((function(e){return me.ri.total[e]})),Be=["atk_","atk","hp_","hp","def_","def"].concat(Ne),Ve=[].concat((0,oe.Z)(ne.hX),(0,oe.Z)(ne.Sx),["stamina","incHeal_","shield_","cdRed_"]),Le=me.lR.filter((function(e){return!Be.includes(e)&&!Ve.includes(e)}));function qe(e){var n=e.nodes,t=e.extra,r=(0,v.useContext)(k.R),i=r.data,a=r.oldData;return(0,$.jsxs)(Te.lD,{children:[n.map((function(e){var n,t;return(0,$.jsx)(Te.JW,{component:ue.ZP,node:i.get(e),oldValue:null===a||void 0===a||null===(t=a.get(e))||void 0===t?void 0:t.value},null===(n=e.info)||void 0===n?void 0:n.key)})),t]})}function Ge(){var e=(0,v.useContext)(C.K),n=e.character.elementKey,t=e.characterSheet,r=(0,v.useContext)(k.R).data,i=r.get(me.ri.special),a=null!==n&&void 0!==n?n:t.elementKey,s=t.isMelee(),o=(0,v.useMemo)((function(){var e=Ve.map((function(e){return me.ri.total[e]})),n=(0,oe.Z)(T.N).filter((function(e){return e!==a}));return s&&n.concat(["physical"]),e.filter((function(e){return!(!r.get(e).value&&n.some((function(n){var t,r,i;return null===(t=e.info)||void 0===t||null===(r=t.key)||void 0===r||null===(i=r.includes)||void 0===i?void 0:i.call(r,n)})))}))}),[r,a,s]),c=(0,v.useMemo)((function(){return Le.map((function(e){return me.ri.total[e]})).filter((function(e){return r.get(e).value}))}),[r]);return(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,columns:Ie,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(He,{title:"Main Stats",children:(0,$.jsx)(qe,{nodes:Fe,extra:i&&(0,$.jsxs)(ue.ZP,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,$.jsxs)("span",{children:[(0,$.jsx)("b",{children:"Special:"})," ",(0,$.jsxs)(J.Z,{color:i.info.variant,children:[i.info.key&&we.ZP[i.info.key]," ",i.info.key&&ne.ZP.get(i.info.key)]})]}),(0,$.jsx)("span",{children:(0,ne.EC)(i.value,i.unit)})]})})})}),(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(He,{title:"Other Stats",children:(0,$.jsx)(qe,{nodes:o})})}),!!c.length&&(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(He,{title:"Misc Stats",children:(0,$.jsx)(qe,{nodes:c})})})]})})})}function He(e){var n=e.title,t=e.children;return(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(f.Z,{sx:{py:1},children:(0,$.jsx)(de.Z,{display:"flex",justifyContent:"space-between",children:(0,$.jsx)(q.Z,{variant:"subtitle1",children:n})})}),t]})}var Ue=t(30168),Je=t(74165),Xe=t(37762),Ye=t(15861),Qe=t(96739),en=t(94070),nn=t(50533),tn=t(23786),rn=t(90388),an=t(57246);function sn(){return new Worker(t.p+"static/js/BackgroundWorker.820b968b.worker.js")}var on=t(21977),cn=t(96106),ln=t(30865),un=t(33890),dn=t(91839),fn=t(78661),hn=t(69292),pn=t(64737),xn=t(4942),vn=t(60393);function mn(e,n){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=t.length,i=0;i<5;i++){for(var a="",s=0;s<e;s++)a+=t.charAt(Math.floor(Math.random()*r));if(!n||!n.includes(a))return a}throw Error("Too many collisions in `makeid`")}function jn(e){return{operation:"read",operands:[],path:["dyn",e],type:"number",accu:"add"}}function Zn(e){return"const"===e.operation||"read"===e.operation||"threshold"===e.operation||"add"===e.operation&&e.operands.every((function(e){return"const"===e.operation||"read"===e.operation||"threshold"===e.operation}))}function gn(e,n){delete e.base[n],e.values.flower.forEach((function(e){return delete e.values[n]})),e.values.plume.forEach((function(e){return delete e.values[n]})),e.values.sands.forEach((function(e){return delete e.values[n]})),e.values.goblet.forEach((function(e){return delete e.values[n]})),e.values.circlet.forEach((function(e){return delete e.values[n]}))}function yn(e,n){var t=Object.keys(e.base),i={};function a(e,n){if(!Zn(e))throw Error("`distribute` only works on shallow node type.");if(1===n)return e;switch(e.operation){case"threshold":var s=(0,r.Z)(e.operands,4),o=s[0],c=s[1],l=s[2],u=s[3];if("read"===o.operation)return(0,fn.ER)(o,c,Rn([l,(0,fn.a9)(n)]),Rn([u,(0,fn.a9)(n)]),{source:o.path[1]});throw console.log(e),Error("branch is not read...?");case"const":return(0,fn.a9)(n*e.value);case"add":return fn.Sm.apply(void 0,(0,oe.Z)(e.operands.map((function(e){return a(e,n)}))));case"read":var d=mn(5,[].concat((0,oe.Z)(t),(0,oe.Z)(Object.keys(i))));return i[d]={base:0,coeff:n,sumKeys:[e.path[1]]},jn(d);default:throw Error("Should not reach here...")}}for(var s=(0,pn.uW)(n,(function(e){return e}),(function(e){switch(e.operation){case"mul":var n=e.operands;if(n.some((function(e){return"mul"===e.operation}))){var r=n.filter((function(e){return"mul"===e.operation})).flatMap((function(e){return(0,oe.Z)(e.operands)})),s=n.filter((function(e){return"mul"!==e.operation}));n=[].concat((0,oe.Z)(s),(0,oe.Z)(r))}if(n.every(Zn)&&n.some((function(e){return"const"===e.operation}))){var o=n.reduce((function(e,n){return"const"===n.operation?e*n.value:e}),1),c=n.filter((function(e){return"const"!==e.operation}));if(0===c.length)return(0,fn.a9)(o);var l=a(c.pop(),o);return 0===c.length?l:fn.WV.apply(void 0,[l].concat((0,oe.Z)(c)))}return e;case"add":var u=e.operands;if(u.some((function(e){return"add"===e.operation}))){var d=u.filter((function(e){return"add"===e.operation})).flatMap((function(e){return(0,oe.Z)(e.operands)})),f=u.filter((function(e){return"add"!==e.operation}));u=[].concat((0,oe.Z)(f),(0,oe.Z)(d))}if(u.filter((function(e){return"const"===e.operation||"read"===e.operation})).length>1){var h=u.filter((function(e){return"const"!==e.operation&&"read"!==e.operation})),p=u.filter((function(e){return"const"===e.operation||"read"===e.operation})),x=mn(5,[].concat((0,oe.Z)(t),(0,oe.Z)(Object.keys(i)))),v=p.reduce((function(e,n){return"const"===n.operation?e+n.value:e}),0),m=p.map((function(e){return"read"===e.operation?e.path[1]:void 0})).filter((function(e){return e}));return i[x]={base:v,coeff:1,sumKeys:m},0===h.length?jn(x):fn.Sm.apply(void 0,(0,oe.Z)(h).concat([jn(x)]))}return e;default:return e}})),o=new Set(Object.keys(e.base)),c=Object.entries(i),l=function(){var n=c.shift(),t=(0,r.Z)(n,2),i=t[0],a=t[1],s=a.base,l=a.coeff,u=a.sumKeys;if(!u.every((function(e){return o.has(e)})))return c.push([i,{base:s,coeff:l,sumKeys:u}]),"continue";var d=function(e){return l*u.reduce((function(n,t){return n+e[t]}),0)};e.base[i]=s+d(e.base),e.values.flower.forEach((function(e){return e.values[i]=d(e.values)})),e.values.plume.forEach((function(e){return e.values[i]=d(e.values)})),e.values.sands.forEach((function(e){return e.values[i]=d(e.values)})),e.values.goblet.forEach((function(e){return e.values[i]=d(e.values)})),e.values.circlet.forEach((function(e){return e.values[i]=d(e.values)})),o.add(i)};c.length>0;)l();var u=new Set(o);return(0,pn.aD)(s,(function(e){}),(function(e){"read"===e.operation&&u.delete(e.path[1])})),u.forEach((function(n){return gn(e,n)})),{a:e,nodes:s}}function bn(e,n){var t=function(e){var n=(0,fe.Z)({},e.base),t=(0,fe.Z)({},e.base);return Object.entries(e.values).forEach((function(e){var i=(0,r.Z)(e,2),a=(i[0],function(e){if(0===e.length)return{statsMin:{},statsMax:{}};var n=Object.keys(e[0].values),t={},i={},a=new Set;n.forEach((function(e){t[e]=1/0,i[e]=-1/0}));for(var s=0;s<e.length;s++){for(var o=0;o<n.length;o++){var c=n[o];t[c]=Math.min(e[s].values[c],t[c]),i[c]=Math.max(e[s].values[c],i[c])}e[s].set&&a.add(e[s].set)}if(a.forEach((function(e){i[e]=1,t[e]=0})),1===a.size){var l=(0,r.Z)(a,1)[0];t[l]=1}return{statsMin:t,statsMax:i}}(i[1])),s=a.statsMin,o=a.statsMax;Object.keys(s).forEach((function(e){var r,i;n[e]=s[e]+(null!==(r=n[e])&&void 0!==r?r:0),t[e]=o[e]+(null!==(i=t[e])&&void 0!==i?i:0)}))})),{statsMin:n,statsMax:t}}(e),i=t.statsMin,a=t.statsMax;n=function(e,n,t){var i=Object.keys(n).filter((function(e){return n[e]===t[e]})),a=(0,pn.uW)(e,(function(e){return e}),(function(e){switch(e.operation){case"add":return In(e.operands);case"mul":return Rn(e.operands);case"read":return i.includes(e.path[1])?(0,fn.a9)(n[e.path[1]]):e;case"threshold":var a=(0,r.Z)(e.operands,4),s=a[0],o=a[1],c=a[2],l=a[3];if("const"===s.operation&&"const"===o.operation)return s.value>=o.value?c:l;if("read"===s.operation&&"const"===o.operation){if(n[s.path[1]]>=o.value)return c;if(t[s.path[1]]<o.value)return l}return e;case"min":case"max":case"res":case"sum_frac":if(e.operands.every((function(e){return"const"===e.operation}))){var u=hn.aj[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})));return(0,fn.a9)(u)}return e;default:return e}}));return a}(n,i,a);var s=yn(e,n);e=s.a,n=s.nodes;for(var o=Object.keys(e.base),c=[e.base].concat((0,oe.Z)(Object.values(e.values).flatMap((function(e){return e.map((function(e){return e.values}))})))),l=o.length,u=c.length,d=o.map((function(e){return c.map((function(n){return n[e]}))})),f=Array(l).fill(0).map((function(e){return Array(l).fill(0)})),h=0;h<l;h++)f[h][h]=1;for(var p=new Set,x=function(e){for(var n=-1,t=0;t<l;t++)if(!p.has(t)&&Math.abs(d[t][e])>1e-8){n=t;break}if(n<0)return"continue";p.add(n);for(var r=n,i=0;i<l;i++)p.has(i)||Math.abs(d[i][e])>1e-8&&function(){var n=d[i][e]/d[r][e];d[i]=d[i].map((function(e,t){return e-n*d[r][t]})),f[i]=f[i].map((function(e,t){return e-n*f[r][t]}))}();return p.size===l?"break":void 0},v=0;v<u;v++){var m=x(v);if("continue"!==m&&"break"===m)break}if(p.size===l)return{a:e,nodes:n};for(var j=function(t){if(!p.has(t)){var r=f[t].map((function(e,n){return{w:n===t?0:-e,key:o[n]}})).filter((function(e){var n=e.w;return Math.abs(n)>1e-8}));if(r.some((function(e){return e.w<0})))return"continue";var i=In(r.map((function(e){var n=e.w,t=e.key;return 1===n?jn(t):(0,fn.WV)(n,jn(t))})));n=(0,pn.uW)(n,(function(e){return e}),(function(e){return"read"===e.operation&&e.path[1]===o[t]?i:e})),gn(e,o[t])}},Z=0;Z<l;Z++)j(Z);return{a:e,nodes:n}}function wn(e){return(0,pn.uW)(e,(function(e){return e}),(function(e){if("threshold"===e.operation){var n=(0,r.Z)(e.operands,4),t=n[0],i=n[1],a=n[2],s=n[3];if("const"===t.operation&&"const"===i.operation)return t.value>=i.value?a:s;if("threshold"===t.operation&&"const"===i.operation){var o=(0,r.Z)(t.operands,4),c=o[0],l=o[1],u=o[2],d=o[3];if("read"===c.operation&&"const"===l.operation&&"const"===u.operation&&"const"===d.operation){var f=u.value>=i.value?a:s,h=d.value>=i.value?a:s;return console.log("non-stacking buff",e,(0,fn.ER)(c,l,f,h)),(0,fn.ER)(c,l,f,h)}throw console.log("faulty node:",e),Error("Not Implemented: nested threshold must follow the form [read, const, const, const]")}if("const"!==a.operation||"const"!==s.operation){if("const"===s.operation&&0===s.value)return(0,fn.WV)((0,fn.ER)(t,i,1,0),a);throw console.log("faulty node:",e),Error("Not Implemented: threshold() node with non-constant `pass` AND non-zero `fail`")}if("read"!==t.operation)throw console.log("faulty node:",e),Error("Not Implemented: threshold() node with non-read `branch`");return e}return e}))}function Cn(e){if("add"===e.operation)return e.operands.map((function(e){return Cn(e)})).reduce((function(e,n){return Object.entries(n).forEach((function(n){var t,i=(0,r.Z)(n,2),a=i[0],s=i[1];return e[a]=Math.min(s,null!==(t=e[a])&&void 0!==t?t:0)})),e}),{});if("mul"===e.operation)return e.operands.map((function(e){return Cn(e)})).reduce((function(e,n){return Object.entries(n).forEach((function(n){var t,i=(0,r.Z)(n,2),a=i[0],s=i[1];return e[a]=Math.max(s,null!==(t=e[a])&&void 0!==t?t:0)})),e}),{});if("threshold"===e.operation){var n=e.operands[0];if("read"===n.operation&&T.q2.includes(n.path[1])){var t=e.operands[1];return(0,xn.Z)({},n.path[1],t.value)}}return{}}function kn(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.flat()}function Pn(){return vn.Og.apply(void 0,arguments).map((function(e){return e.reduce((function(e,n){var t;return e.coeff*=n.coeff,(t=e.terms).push.apply(t,(0,oe.Z)(n.terms)),e}),{coeff:1,terms:[]})}))}function Sn(e){return[{coeff:e,terms:[]}]}function En(e){return[{coeff:1,terms:[e]}]}function On(e){var n=(0,oe.Z)(e);n.forEach((function(e){return e.terms.sort()})),n.sort((function(e,n){var t=e.terms,r=n.terms;if(t.length!==r.length)return t.length-r.length;for(var i=0;i<t.length;i++)if(t[i]!==r[i])return t[i]<r[i]?-1:1;return 0}));for(var t=function(e){var t,r,i=n[e].terms,a=n[e+1].terms;if(i.length!==a.length)return"continue";i.every((function(e,n){return e===a[n]}))&&(n[e].coeff=(null!==(t=n[e].coeff)&&void 0!==t?t:0)+(null!==(r=n[e+1].coeff)&&void 0!==r?r:0),n.splice(e+1,1))},r=n.length-2;r>=0;r--)t(r);return n}function _n(e,n){var t={},i={},a=null!==n&&void 0!==n?n:[];function s(e){for(var n=(0,fn.PX)(e),r=t[n];void 0!==r;){if((0,fn.NY)(r.n,e))return r.tag;r=r.next}var s=mn(10,a);return t[n]={n:e,tag:s,next:t[n]},i[s]=e,a.push(s),s}var o={};(0,pn.aD)([e],(function(e){}),(function(e){"read"===e.operation&&(o[e.path[1]]=s(e))}));var c=On(function e(n){switch(n.operation){case"add":return kn.apply(void 0,(0,oe.Z)(n.operands.map(e)));case"mul":return Pn.apply(void 0,(0,oe.Z)(n.operands.map(e)));case"const":return Sn(n.value);default:return En(s(n))}}(e));return function(e){var n=e.terms,t=e.nodes,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=Object.fromEntries(Object.entries(t).map((function(e){var n=(0,r.Z)(e,2);return[n[0],Cn(n[1])]})));return{terms:n=n.filter((function(e){var n=e.terms.reduce((function(e,n){return Object.entries(a[n]).forEach((function(n){var t,i=(0,r.Z)(n,2),a=i[0],s=i[1];return e[a]=Math.max(s,null!==(t=e[a])&&void 0!==t?t:0)})),e}),{});return Object.values(n).reduce((function(e,n){return e+n}),0)<=i})),nodes:t}}({terms:c,nodes:i})}function An(e,n){for(var t=n.i,r=n.j,i=e[t][r],a=0;a<e.length;a++)if(a!==t)for(var s=0;s<e[0].length;s++)s!==r&&(e[a][s]-=e[t][s]*e[a][r]/i);for(var o=0;o<e.length;o++)o!==t&&(e[o][r]=-e[o][r]/i);for(var c=0;c<e[0].length;c++)c!==r&&(e[t][c]=e[t][c]/i);e[t][r]=1/i}function Dn(e){for(var n=e.length,t=e[0].length,r={i:-1,j:-1,cmp:1/0},i=0;i<t-1;i++)if(!(e[n-1][i]>=0)){for(var a=0;a<n-1;a++)if(e[a][i]>1e-5){var s=e[a][t-1]/e[a][i];s<r.cmp&&(r={i:a,j:i,cmp:s})}if(r.i<0)throw Error("UNBOUNDED FEASIBLE")}if(r.i<0)throw Error("NO PIVOTS (done)");return{i:r.i,j:r.j}}function Mn(e){for(var n=e.length,t=e[0].length,r={i:-1,j:-1,cmp:1/0},i=0;i<n-1;i++)if(!(e[i][t-1]>=0)){for(var a=0;a<t-1;a++)if(e[i][a]<-1e-5){var s=e[i][t-1]/e[i][a];s<r.cmp&&(r={i:i,j:a,cmp:s})}if(r.i<0)throw Error("INFEASIBLE");return{i:r.i,j:r.j}}throw Error("NO PIVOTS (done)")}function Tn(e,n,t){var i=(0,hn.I3)([e],(function(e){return e.path[1]})),a=(0,r.Z)(i,3),s=a[0],o=a[1],c=a[2];zn(n,o,c);var l=s()[0];return zn(t,o,c),[l,s()[0]]}function Kn(e,n,t){var i=e.nodes,a=e.terms,s={};Object.entries(i).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];"read"===i.operation&&(s[i.path[1]]=t)}));function o(e){switch(e.operation){case"const":return Sn(e.value);case"read":return En(s[e.path[1]]);case"add":return kn.apply(void 0,(0,oe.Z)(e.operands.map(o)));case"mul":return Pn.apply(void 0,(0,oe.Z)(e.operands.map(o)));case"threshold":var i=(0,r.Z)(e.operands,4),a=i[0],c=i[1],l=i[2],u=i[3];if("read"===a.operation&&"const"===c.operation&&"const"===u.operation&&"const"===l.operation){if(l.value<u.value)throw console.log(e),Error("Not Implemented (threshold must be increasing)");var d=a.path[1];if(n[d]>=c.value)return Sn(l.value);if(t[d]<c.value)return Sn(u.value);var f=(l.value-u.value)/(c.value-n[d]),h=Pn(Sn(f),En(s[a.path[1]])),p=u.value-f*n[d];return 0===p?h:kn(Sn(p),h)}throw console.log(e),Error("Not Implemented (threshold must branch between constants)");case"res":var x=function(e,n,t){var i=function e(n){switch(n.operation){case"add":return fn.Sm.apply(void 0,(0,oe.Z)(n.operands.map((function(n){return e(n)}))));case"const":return(0,fn.a9)(-n.value);case"threshold":var t=(0,r.Z)(n.operands,4),i=t[0],a=t[1],s=t[2],o=t[3];if("const"===s.operation&&"const"===o.operation&&s.value<=o.value)return(0,fn.ER)(i,a,-s.value,-o.value);throw console.log(n),Error("(res neg slope): threshold. Something went wrong.");default:throw console.log(n),Error("(res neg slope) Havent written logic to handle this")}}(e.operands[0]),a=Tn(i,n,t),s=(0,r.Z)(a,2),o=s[0],c=s[1],l=hn.aj.res,u=[l([-o]),l([-c])],d=u[0],f=u[1];if(c>0&&o>-1.75)return(0,fn.Sm)(1,(0,fn.WV)(.5,i));var h=(c*d-o*f)/(c-o),p=(d-f)/(c-o);return(0,fn.Sm)(h,(0,fn.WV)(p,i))}(e,n,t);return o(x);case"min":case"max":var v=(0,r.Z)(e.operands,2),m=v[0],j=v[1];if("const"!==j.operation){var Z=[j,m];m=Z[0],j=Z[1]}if("min"===e.operation)return o(m);if("const"===j.operation){var g=j.value,y=Tn(m,n,t),b=(0,r.Z)(y,2),w=b[0],C=b[1];if(w>g)return o(m);if(g>C)return Sn(g);var k=(C-g)/(C-w);return kn(Sn(g-k*w),Pn(Sn(k),o(m)))}throw console.log(e),Error("Not Implemented (max between two non-constants)");case"sum_frac":var P=(0,r.Z)(e.operands,2),S=P[0],E=P[1];if("const"!==E.operation)throw Error("Not Implemented (non-constant sum_frac denominator)");var O=Tn(S,n,t),_=(0,r.Z)(O,2),A=_[0],D=_[1],M=E.value,T=Math.sqrt((A+M)*(D+M))-M,K=(M+T)*(M+T),I=M/K;return kn(Sn(T*T/K),Pn(Sn(I),o(S)));default:throw console.log(e),Error("Not Implemented")}}var c=Object.fromEntries(Object.entries(i).filter((function(e){var n=(0,r.Z)(e,2);n[0];return"read"!==n[1].operation})).map((function(e){var n=(0,r.Z)(e,2);return[n[0],o(n[1])]}))),l=a.flatMap((function(e){var n=e.coeff,t=e.terms;return Pn.apply(void 0,[Sn(n)].concat((0,oe.Z)(t.map((function(e){var n;return null!==(n=c[e])&&void 0!==n?n:En(e)})))))}));l=(l=On(l)).map((function(e){var n=e.coeff,t=e.terms;return{coeff:n,terms:t=t.map((function(e){var n=i[e];if(!n||"read"!==n.operation)throw Error("MUST be a read node.");return n.path[1]}))}}));var u=l.map((function(e){var r=e.coeff,i=e.terms;if(0===i.length)return{w:{},c:r,err:0};if(1===i.length)return{w:(0,xn.Z)({},i[0],r),c:0,err:0};var a=function(e){if(0===e.length)return{w:[],c:0,err:0};var n=e.length,t=e.map((function(e){return e.upper})),r=t.reduce((function(e,n){return e*n}),1);e=e.map((function(e){return{lower:e.lower/e.upper,upper:1}}));var i,a=vn.Og.apply(void 0,(0,oe.Z)(e.map((function(e){return[e.lower,e.upper]})))).flatMap((function(e){var n=e.reduce((function(e,n){return e*n}),1);return[[].concat((0,oe.Z)(e.map((function(e){return-e}))),[1,0,-n]),[].concat((0,oe.Z)(e),[-1,-1,n])]})),s=[].concat((0,oe.Z)(e.map((function(e){return 0}))),[0,1]);try{i=function(e,n){var t=n.length+1,r=n[0].length,i=Array(t).fill(0).map((function(e){return Array(r).fill(0)}));n.forEach((function(e,n){return e.forEach((function(e,t){return i[n][t]=e}))})),e.forEach((function(e,n){return i[t-1][n]=e}));for(var a=[];i.some((function(e,n){return n<t-1&&e[r-1]<0}));){var s=Mn(i);a.push(s),An(i,s)}for(;i[t-1].some((function(e,n){return n<r-1&&e<0}));){var o=Dn(i);a.push(o),An(i,o)}return e.map((function(e,n){return function(e,n,t){var r=1;n.forEach((function(e){var n=e.i,i=e.j;1===r&&i===t?(t=n,r=0):0===r&&n===t&&(t=i,r=1)}));var i=e[0].length;return 0===r?e[t][i-1]:0}(i,a,n)}))}(s,a)}catch(o){throw console.log("ERROR on bounds",e),console.log("Possibly numerical instability issue."),o}return{w:i.slice(0,n).map((function(e,n){return e*r/t[n]})),c:-r*i[n],err:r*i[n+1]}}(i.map((function(e){return{lower:n[e],upper:t[e]}}))),s=a.w,o=a.c,c=a.err;return{w:s.reduce((function(e,n,t){var a;return e[i[t]]=n*r+(null!==(a=e[i[t]])&&void 0!==a?a:0),e}),{}),c:r*o,err:r*c+0}}));return u.reduce((function(e,n){return e.c+=n.c,e.err+=n.err,Object.entries(n.w).forEach((function(n){var t,i=(0,r.Z)(n,2),a=i[0],s=i[1];return e.w[a]=s+(null!==(t=e.w[a])&&void 0!==t?t:0)})),e}),{w:{},c:0,err:0})}function In(e){if(1===e.length)return e[0];var n=(e=e.flatMap((function(e){return"add"===e.operation?e.operands:e}))).reduce((function(e,n){return"const"===n.operation?e+n.value:e}),0);return 0===(e=e.filter((function(e){return"const"!==e.operation}))).length?(0,fn.a9)(n):0===n?1===e.length?e[0]:fn.Sm.apply(void 0,(0,oe.Z)(e)):fn.Sm.apply(void 0,(0,oe.Z)(e).concat([(0,fn.a9)(n)]))}function Rn(e){if(1===e.length)return e[0];var n=(e=e.flatMap((function(e){return"mul"===e.operation?e.operands:e}))).reduce((function(e,n){return"const"===n.operation?e*n.value:e}),1);return 0===(e=e.filter((function(e){return"const"!==e.operation}))).length?(0,fn.a9)(n):1===n?fn.WV.apply(void 0,(0,oe.Z)(e)):fn.WV.apply(void 0,(0,oe.Z)(e).concat([(0,fn.a9)(n)]))}function zn(e,n,t){Object.entries(e).filter((function(e){var t=(0,r.Z)(e,1)[0];return void 0!==n[t]})).forEach((function(e){var i=(0,r.Z)(e,2),a=i[0],s=i[1];return t[n[a]]=s}))}function $n(e,n){return e=(0,pn.uW)(e,(function(e){return e}),(function(e){if("threshold"===e.operation){var t=(0,r.Z)(e.operands,4),i=t[0],a=t[1],s=t[2],o=t[3];if("read"===i.operation&&"const"===a.operation){var c=i.path[1];if(void 0!==n[c]){var l=n[c];if(2===a.value&&l.includes(2))return l.includes(4)?o:(0,fn.ER)(i,4,s,o);if(4===a.value&&l.includes(4))return o}}return e}return e}))}var Wn=t(7618),Nn=t(73036),Fn=t(17278),Bn=t(68544),Vn=t(12759),Ln=t(9138);function qn(e,n,t,r,i,a){for(var s=a,o={pruneNodeRange:!0},c={pruneNodeRange:!0},l={reaffine:!0},u={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0},d=0;Object.values(s).some((function(e){return e}))&&d++<20;){if(s.pruneOrder){delete s.pruneOrder;var f=Hn(t,r,i);t!==f&&(t=f,s=(0,fe.Z)((0,fe.Z)({},s),o))}if(s.pruneArtRange){delete s.pruneArtRange;var h=Un(e,t,n);t!==h&&(t=h,s=(0,fe.Z)((0,fe.Z)({},s),c))}if(s.pruneNodeRange){delete s.pruneNodeRange;var p=Jn(e,t);e!==p&&(e=p,s=(0,fe.Z)((0,fe.Z)({},s),l))}if(s.reaffine){delete s.reaffine;var x=Gn(e,t),v=x.nodes,m=x.arts;e===v&&t===m||(e=v,t=m,s=(0,fe.Z)((0,fe.Z)({},s),u))}}return{nodes:e,arts:t}}function Gn(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new Set,a=new Set;function s(e,n){n?i.add(e):e.operands.forEach((function(e){var n=e;i.has(n)&&a.add(n)}))}var o=new Set;if((0,pn.aD)(e,(function(e){}),(function(e){var n=e.operation;switch(n){case"read":if("number"!==e.type||"dyn"!==e.path[0]||"add"!==e.accu)throw new Error("Found unsupported ".concat(n," node at path ").concat(e.path," when computing affine nodes"));o.add(e.path[1]),s(e,!0);break;case"add":s(e,e.operands.every((function(e){return i.has(e)})));break;case"mul":var t=e.operands.filter((function(e){return"const"!==e.operation}));s(e,0===t.length||1===t.length&&i.has(t[0]));break;case"const":if("string"===typeof e.value||void 0===e.value)throw new Error("Found constant ".concat(e.value," while compacting"));s(e,!0);break;case"res":case"threshold":case"sum_frac":case"max":case"min":s(e,!1);break;case"data":case"subscript":case"lookup":case"match":case"prio":case"small":throw new Error("Found unsupported ".concat(n," node when computing affine nodes"));default:(0,vn.UT)(n)}})),(0,oe.Z)(a).every((function(e){var n=e.operation;return"read"===n||"const"===n}))&&Object.keys(n.base).length===o.size)return{nodes:e,arts:n};var c=-1;function l(){for(;o.has("".concat(++c)););return"".concat(c)}e.forEach((function(e){return i.has(e)&&a.add(e)}));var u=(0,oe.Z)(a).filter((function(e){return"const"!==e.operation})),d=new Map(u.map((function(e){return[e,t||"read"!==e.operation||"dyn"!==e.path[0]?(0,fe.Z)((0,fe.Z)({},(0,fn.UF)(["dyn","".concat(l())])),{},{accu:"add"}):e]})));function f(e){var n=(0,hn.CG)((0,oe.Z)(d.keys()),{dyn:(0,vn.xh)(e,(function(e){return(0,fn.a9)(e)}))},(function(e){return!0}));return Object.fromEntries((0,oe.Z)(d.values()).map((function(e,t){return[e.path[1],n[t].value]})))}for(var h={nodes:e=(0,pn.uW)(e,(function(e){var n;return null!==(n=d.get(e))&&void 0!==n?n:e}),(function(e){return e})),arts:{base:f(n.base),values:(0,vn.O)(T.eV,(function(e){return n.values[e].map((function(e){return{id:e.id,set:e.set,values:f(e.values)}}))}))}},p=Object.entries(f({})),x=0,v=Object.values(h.arts.values);x<v.length;x++){var m,j=v[x],Z=(0,Xe.Z)(j);try{for(Z.s();!(m=Z.n()).done;){var g,y=m.value.values,b=(0,Xe.Z)(p);try{for(b.s();!(g=b.n()).done;){var w=(0,r.Z)(g.value,2),C=w[0],k=w[1];y[C]-=k}}catch(P){b.e(P)}finally{b.f()}}}catch(P){Z.e(P)}finally{Z.f()}}return h}function Hn(e,n,t){var i,a=!1,s=!(null!==(i=t.rainbow)&&void 0!==i&&i.length),o=new Set(Object.entries(t).filter((function(e){var n=(0,r.Z)(e,2);n[0];return n[1].length})).map((function(e){return(0,r.Z)(e,1)[0]}))),c=new Set(Object.entries(t).filter((function(e){var n=(0,r.Z)(e,2),t=(n[0],n[1]);return t.includes(2)&&!t.includes(4)})).map((function(e){return(0,r.Z)(e,1)[0]}))),l=(0,vn.O)(T.eV,(function(t){var i=e.values[t],l=i.filter((function(e){var t=0;return i.every((function(i){var a=Object.entries(i.values).every((function(n){var t=(0,r.Z)(n,2),i=t[0];return t[1]>=e.values[i]})),l=Object.entries(i.values).some((function(n){var t=(0,r.Z)(n,2),i=t[0];return t[1]>e.values[i]}));return a&&(l||i.id>e.id)&&(s&&!o.has(i.set)&&!c.has(e.set)||e.set===i.set)&&t++,t<n}))}));return l.length!==i.length&&(a=!0),l}));return a?{base:e.base,values:l}:e}function Un(e,n,t){for(var i=Object.fromEntries(Object.entries(n.base).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return[t,{min:i,max:i}]}))),a={arts:n},s=function(){var n=(0,vn.O)(T.eV,(function(e){return Yn(a.arts.values[e])})),r=(0,vn.O)(T.eV,(function(e){return Xn(Object.entries(n).map((function(n){return n[0]===e?i:n[1]})).filter((function(e){return e})))})),s=!1,o=(0,vn.O)(T.eV,(function(n){var i=a.arts.values[n].filter((function(i){var a=Xn([Yn([i]),r[n]]),s=Qn(e,a);return e.every((function(e,n){var r;return s.get(e).max>=(null!==(r=t[n])&&void 0!==r?r:-1/0)}))}));return i.length!==a.arts.values[n].length&&(s=!0),i}));if(!s)return"break";a.arts={base:a.arts.base,values:o}};;){if("break"===s())break}return a.arts}function Jn(e,n){var t=Qn(e,Xn([Object.fromEntries(Object.entries(n.base).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return[t,{min:i,max:i}]})))].concat((0,oe.Z)(Object.values(n.values).map((function(e){return Yn(e)}))))));return(0,pn.uW)(e,(function(e){var n=e.operation,i=e.operands.map((function(e){return t.get(e)}));switch(n){case"threshold":var a=(0,r.Z)(i,4),s=a[0],o=a[1],c=a[2],l=a[3];if(s.min>=o.max)return e.operands[2];if(s.max<o.min)return(0,fn.a9)(0);if(c.max===c.min&&l.max===l.min&&c.min===l.min&&isFinite(c.min))return(0,fn.a9)(c.max);break;case"min":var u=e.operands.filter((function(e,n){var t=i[n];return i.every((function(e,n){return t.min<=e.max}))}));if(u.length<i.length)return fn.VV.apply(void 0,(0,oe.Z)(u));break;case"max":var d=e.operands.filter((function(e,n){var t=i[n];return i.every((function(e){return t.max>=e.min}))}));if(d.length<i.length)return fn.Fp.apply(void 0,(0,oe.Z)(d))}return e}),(function(e){return e}))}function Xn(e){var n={};return e.forEach((function(e){Object.entries(e).forEach((function(e){var t=(0,r.Z)(e,2),i=t[0],a=t[1];n[i]?(n[i].min+=a.min,n[i].max+=a.max):n[i]=(0,fe.Z)({},a)}))})),n}function Yn(e){var n={};return e.length&&(Object.keys(e[0].values).filter((function(n){return e.every((function(e){return e.values[n]}))})).forEach((function(t){return n[t]={min:e[0].values[t],max:e[0].values[t]}})),e.forEach((function(e){for(var t=e.values,i=0,a=Object.entries(t);i<a.length;i++){var s=(0,r.Z)(a[i],2),o=s[0],c=s[1];n[o]?(n[o].max<c&&(n[o].max=c),n[o].min>c&&(n[o].min=c)):n[o]={min:0,max:c}}}))),n}function Qn(e,n){var t=new Map;return(0,pn.aD)(e,(function(e){}),(function(e){var i,a,s=e,o=s.operation,c=s.operands.map((function(e){return t.get(e)}));switch(o){case"read":if("dyn"!==s.path[0])throw new Error("Found non-dyn path ".concat(s.path," while computing range"));a=null!==(i=n[s.path[1]])&&void 0!==i?i:{min:0,max:0};break;case"const":a=et([s.value]);break;case"subscript":a=et(s.list);break;case"add":case"min":case"max":a={min:hn.aj[o](c.map((function(e){return e.min}))),max:hn.aj[o](c.map((function(e){return e.max})))};break;case"res":a={min:hn.aj[o]([c[0].max]),max:hn.aj[o]([c[0].min])};break;case"mul":a=c.reduce((function(e,n){return et([e.min*n.min,e.min*n.max,e.max*n.min,e.max*n.max])}));break;case"threshold":a=c[0].min>=c[1].max?c[2]:c[0].max<c[1].min?et([0]):et([0],[c[2]]);break;case"sum_frac":var l=(0,r.Z)(c,2),u=l[0],d=l[1],f={min:u.min+d.min,max:u.max+d.max};a=f.min<=0&&f.max>=0?u.min<=0&&u.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:et([u.min/f.min,u.min/f.max,u.max/f.min,u.max/f.max]);break;case"data":case"lookup":case"match":throw new Error("Unsupported ".concat(o," node"));default:(0,vn.UT)(o)}t.set(s,a)})),t}function et(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=Math.max.apply(Math,(0,oe.Z)(e).concat((0,oe.Z)(n.map((function(e){return e.max}))))),r=Math.min.apply(Math,(0,oe.Z)(e).concat((0,oe.Z)(n.map((function(e){return e.min})))));return{min:r,max:t}}function nt(e,n){return e.flatMap((function(e){return e})).sort((function(e,n){return n.value-e.value})).slice(0,n)}function tt(e){for(var n=.01,t=new Set(e.flatMap((function(e){return Object.values(e).map((function(e){return Math.round(e.plot/n)}))})));t.size>1500;)n*=2,t=new Set((0,oe.Z)(t).map((function(e){return Math.round(e/2)})));var r,i={},a=(0,Xe.Z)(e);try{for(a.s();!(r=a.n()).done;)for(var s=r.value,o=0,c=Object.values(s);o<c.length;o++){var l=c[o],u=Math.round(l.plot/n)*n;(!i[u]||i[u].value<l.value)&&(i[u]=l)}}catch(d){a.e(d)}finally{a.f()}return i}(0,vn.O)(T.eV,(function(e){return{kind:"exclude",sets:new Set}}));var rt=t(53174),it=t(54483),at=t(16614),st=t(76899),ot=t(31148),ct=t(37503);function lt(e){var n,t=e.setKey,r=e.setNumKey,i=e.hideHeader,a=void 0!==i&&i,s=e.conditionalsOnly,o=void 0!==s&&s,c=(0,A.Z)((function(){return ot.y.get(t)}),[t]);if(!c)return null;var l=o?null===(n=c.setEffectDocument(r))||void 0===n?void 0:n.filter((function(e){return"states"in e})):c.setEffectDocument(r);return(0,$.jsx)(u.Z,{display:"flex",flexDirection:"column",children:l?(0,$.jsx)(ct.Z,{sections:l,hideHeader:a}):null})}var ut,dt,ft,ht,pt,xt,vt,mt,jt,Zt,gt,yt,bt,wt,Ct,kt,Pt=t(95614),St=t(55221),Et=t(10157),Ot=t(66624),_t=t(18327);function At(e){var n=(0,v.useContext)(Wn.t).database,t=(0,v.useState)((function(){return n.buildSettings.get(e)})),i=(0,r.Z)(t,2),a=i[0],s=i[1];return(0,v.useEffect)((function(){return s(n.buildSettings.get(e))}),[n,e]),(0,v.useEffect)((function(){return n.buildSettings.follow(e,s)}),[e,s,n]),{buildSetting:a,buildSettingDispatch:(0,v.useCallback)((function(t){return e&&n.buildSettings.set(e,t)}),[e,n])}}function Dt(e){var n,t,i=e.disabled,a=(0,m.$)(["page_character","sheet"]).t,s=(0,v.useContext)(k.R),o=(0,v.useContext)(Wn.t).database,c=(0,v.useContext)(C.K),l=c.character,d=l.key,h=l.conditional,p=c.characterDispatch,j=At(d),Z=j.buildSetting.artSetExclusion,w=j.buildSettingDispatch,P=(0,v.useState)(!1),S=(0,r.Z)(P,2),E=S[0],O=S[1],_=(0,v.useCallback)((function(){return O(!0)}),[O]),D=(0,v.useCallback)((function(){return O(!1)}),[O]),M=(0,A.Z)((function(){return ot.y.getAll}),[]),K=(0,v.useMemo)((function(){return M?Object.entries(ot.y.setKeysByRarities(M)).reverse().flatMap((function(e){return(0,r.Z)(e,2)[1]})).filter((function(e){return!e.includes("Prayers")})):[]}),[M]),I=(0,Bn.Z)(),R=(0,r.Z)(I,2),z=R[0],W=R[1];(0,v.useEffect)((function(){return o.arts.followAny(W)}),[o,W]);var N=(0,v.useMemo)((function(){var e=Object.fromEntries(K.map((function(e){return[e,Object.fromEntries(T.eV.map((function(e){return[e,0]})))]})));return o.arts.values.map((function(n){return e[n.setKey]&&e[n.setKey][n.slotKey]++})),z&&e}),[z,o,K]),F=!(null!==(n=Z.rainbow)&&void 0!==n&&n.includes(2)),V=!(null!==(t=Z.rainbow)&&void 0!==t&&t.includes(4)),L=(0,v.useMemo)((function(){return{allow2:K.filter((function(e){var n;return!(null!==(n=Z[e])&&void 0!==n&&n.includes(2))})).length,allow4:K.filter((function(e){var n;return!(null!==(n=Z[e])&&void 0!==n&&n.includes(4))})).length,exclude2:K.filter((function(e){var n;return null===(n=Z[e])||void 0===n?void 0:n.includes(2)})).length,exclude4:K.filter((function(e){var n;return null===(n=Z[e])||void 0===n?void 0:n.includes(4)})).length}}),[K,Z]),G=L.allow2,H=L.allow4,U=L.exclude2,X=L.exclude4,ee=(0,v.useMemo)((function(){return Object.keys(h).filter((function(e){return T.q2.includes(e)&&0!==Object.keys(h[e]).length})).length}),[h]),ne=(0,v.useMemo)((function(){return e=s,(0,fe.Z)((0,fe.Z)({},e),{},{data:new _t.w((0,fe.Z)((0,fe.Z)({},e.data.data[0]),{},{artSet:(0,vn.O)(T.q2,(function(e){return(0,fn.a9)(4)}))}),void 0)});var e}),[s]),te=(0,v.useCallback)((function(){var e=Object.fromEntries(Object.entries(h).filter((function(e){var n=(0,r.Z)(e,2),t=n[0];n[1];return!T.q2.includes(t)})));p({conditional:e})}),[h,p]),re=(0,v.useCallback)((function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,vn.I8)(Z);K.forEach((function(r){var i;n?t[r]=[].concat((0,oe.Z)(null!==(i=t[r])&&void 0!==i?i:[]),[e]):t[r]&&(t[r]=t[r].filter((function(n){return n!==e})))})),w({artSetExclusion:t})}),[K,Z,w]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(y.Z,{sx:{display:"flex"},children:[(0,$.jsxs)(f.Z,{sx:{flexGrow:1},children:[(0,$.jsx)(q.Z,{children:(0,$.jsx)("strong",{children:a(ut||(ut=(0,Ue.Z)(["tabOptimize.artSetConfig.title"])))})}),(0,$.jsxs)(ce.Z,{spacing:1,children:[(0,$.jsxs)(q.Z,{children:[a(dt||(dt=(0,Ue.Z)(["tabOptimize.artSetConfig.setEffCond"])))," ",(0,$.jsxs)(Q.Z,{color:ee?"success":"secondary",children:[ee," ",a("tabOptimize.artSetConfig.enabled")]})]}),(0,$.jsxs)(q.Z,{children:[a(ft||(ft=(0,Ue.Z)(["sheet:2set"])))," ",(0,$.jsxs)(Q.Z,{color:"success",children:[G," ",(0,$.jsx)(it.G,{icon:rt.Stf,className:"fa-fw"})," ",a("tabOptimize.artSetConfig.allowed")]}),!!U&&" / ",!!U&&(0,$.jsxs)(Q.Z,{color:"secondary",children:[U," ",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," ",a("tabOptimize.artSetConfig.excluded")]})]}),(0,$.jsxs)(q.Z,{children:[a(ht||(ht=(0,Ue.Z)(["sheet:4set"])))," ",(0,$.jsxs)(Q.Z,{color:"success",children:[H," ",(0,$.jsx)(it.G,{icon:rt.Stf,className:"fa-fw"})," ",a("tabOptimize.artSetConfig.allowed")]}),!!X&&" / ",!!X&&(0,$.jsxs)(Q.Z,{color:"secondary",children:[X," ",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," ",a("tabOptimize.artSetConfig.excluded")]})]}),(0,$.jsxs)(q.Z,{children:[a(pt||(pt=(0,Ue.Z)(["tabOptimize.artSetConfig.2rainbow"])))," ",(0,$.jsxs)(Q.Z,{color:F?"success":"secondary",children:[(0,$.jsx)(it.G,{icon:F?rt.Stf:rt.gPx,className:"fa-fw"})," ",F?a("tabOptimize.artSetConfig.allowed"):"Excluded"]})]}),(0,$.jsxs)(q.Z,{children:[a(xt||(xt=(0,Ue.Z)(["tabOptimize.artSetConfig.4rainbow"])))," ",(0,$.jsxs)(Q.Z,{color:V?"success":"secondary",children:[(0,$.jsx)(it.G,{icon:V?rt.Stf:rt.gPx,className:"fa-fw"})," ",V?a("tabOptimize.artSetConfig.allowed"):"Excluded"]})]})]})]}),(0,$.jsx)(x.Z,{onClick:_,disabled:i,color:"info",sx:{borderRadius:0},children:(0,$.jsx)(at.Z,{})})]}),M&&(0,$.jsx)(Y.Z,{open:E,onClose:D,children:(0,$.jsxs)(g.Z,{children:[(0,$.jsxs)(f.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,$.jsx)(q.Z,{variant:"h6",children:a(vt||(vt=(0,Ue.Z)(["tabOptimize.artSetConfig.title"])))}),(0,$.jsx)(b.Z,{onClick:D})]}),(0,$.jsx)(B.Z,{}),(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(y.Z,{sx:{mb:1},children:(0,$.jsxs)(f.Z,{children:[(0,$.jsxs)(u.Z,{display:"flex",gap:1,children:[(0,$.jsx)(q.Z,{children:(0,$.jsx)("strong",{children:a(mt||(mt=(0,Ue.Z)(["tabOptimize.artSetConfig.modal.setCond.title"])))})}),(0,$.jsx)(q.Z,{sx:{flexGrow:1},children:(0,$.jsxs)(Q.Z,{color:ee?"success":"secondary",children:[ee," ",a("tabOptimize.artSetConfig.selected")]})}),(0,$.jsx)(x.Z,{size:"small",onClick:te,color:"error",startIcon:(0,$.jsx)(Ce.Z,{}),children:a(jt||(jt=(0,Ue.Z)(["tabOptimize.artSetConfig.modal.setCond.reset"])))})]}),(0,$.jsx)(q.Z,{children:a(Zt||(Zt=(0,Ue.Z)(["tabOptimize.artSetConfig.modal.setCond.text"])))})]})}),(0,$.jsx)(y.Z,{sx:{mb:1},children:(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(q.Z,{sx:{flexGrow:1},children:(0,$.jsx)("strong",{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.modal.ArtSetFilter.title",children:["Artifact Sets ",(0,$.jsxs)(J.Z,{color:"success",children:["Allowed",(0,$.jsx)(it.G,{icon:rt.Stf,className:"fa-fw"})]})," / ",(0,$.jsxs)(J.Z,{color:"secondary",variant:"light",children:["Excluded",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})]})]})})}),(0,$.jsx)(q.Z,{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.modal.ArtSetFilter.intro",children:["You can allow/exclude which sets you want the builder to consider. In the following examples, ",(0,$.jsx)("strong",{children:"A"})," is on-set, and ",(0,$.jsx)("strong",{children:"R"})," is rainbow(off-set)"]})}),(0,$.jsx)(q.Z,{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.modal.ArtSetFilter.2set",children:[(0,$.jsx)("strong",{children:(0,$.jsxs)(J.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," 2-Set"]})})," would exclude 2-Set builds: ",(0,$.jsxs)("strong",{children:[(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"AA"}),"RRR"]})," and ",(0,$.jsxs)("strong",{children:[(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"AAA"}),"RR"]}),"."]})}),(0,$.jsx)(q.Z,{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.modal.ArtSetFilter.4set",children:[(0,$.jsx)("strong",{children:(0,$.jsxs)(J.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," 4-Set"]})})," would exclude 4-Set builds: ",(0,$.jsxs)("strong",{children:[(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"AAAA"}),"R"]})," and ",(0,$.jsx)("strong",{children:(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"AAAAA"})}),"."]})}),(0,$.jsx)(q.Z,{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.modal.ArtSetFilter.2rain",children:[(0,$.jsx)("strong",{children:(0,$.jsxs)(J.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," 3-Rainbow"]})})," would exclude 2-Set + 3-Rainbow builds: ",(0,$.jsxs)("strong",{children:["AA",(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"RRR"})]})," and ",(0,$.jsxs)("strong",{children:["AAA",(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"RR"})]}),"."]})}),(0,$.jsx)(q.Z,{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.modal.ArtSetFilter.4rain",children:[(0,$.jsx)("strong",{children:(0,$.jsxs)(J.Z,{color:"secondary",variant:"light",children:["Excluding",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," 5-Rainbow"]})})," would exclude full 5-Rainbow builds: ",(0,$.jsx)("strong",{children:(0,$.jsx)(J.Z,{color:"secondary",variant:"light",children:"RRRRR"})}),"."]})})]})}),(0,$.jsxs)(le.ZP,{container:!0,columns:{xs:2,lg:3},sx:{mb:1},spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Mt,{setNum:2,numAllow:G,numExclude:U,setAllExclusion:re})}),(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Mt,{setNum:4,numAllow:H,numExclude:X,setAllExclusion:re})}),(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(y.Z,{children:(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(q.Z,{gutterBottom:!0,children:(0,$.jsx)("strong",{children:(0,$.jsxs)(st.c,{t:a,i18nKey:"tabOptimize.artSetConfig.alExRainbow",children:[(0,$.jsxs)(J.Z,{color:"success",children:["Allow ",(0,$.jsx)(it.G,{icon:rt.Stf,className:"fa-fw"})]})," / ",(0,$.jsxs)(J.Z,{color:"secondary",variant:"light",children:["Exclude ",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})]})," Rainbow Builds"]})})}),(0,$.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.jsx)(x.Z,{fullWidth:!0,onClick:function(){return w({type:"artSetExclusion",setKey:"rainbow",num:2})},color:F?"success":"secondary",startIcon:F?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),endIcon:(0,$.jsx)(it.G,{icon:F?rt.Stf:rt.gPx,className:"fa-fw"}),children:a(gt||(gt=(0,Ue.Z)(["tabOptimize.artSetConfig.2rainbow"])))}),(0,$.jsx)(x.Z,{fullWidth:!0,onClick:function(){return w({type:"artSetExclusion",setKey:"rainbow",num:4})},color:V?"success":"secondary",startIcon:V?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),endIcon:(0,$.jsx)(it.G,{icon:V?rt.Stf:rt.gPx,className:"fa-fw"}),children:a(yt||(yt=(0,Ue.Z)(["tabOptimize.artSetConfig.4rainbow"])))})]})]})})})]}),(0,$.jsx)(le.ZP,{container:!0,spacing:1,columns:{xs:2,lg:3},children:K.map((function(e){return(0,$.jsx)(Tt,{setKey:e,sheet:M[e],fakeDataContextObj:ne,slotCount:N[e]},e)}))})]}),(0,$.jsx)(B.Z,{}),(0,$.jsx)(f.Z,{sx:{py:1},children:(0,$.jsx)(b.Z,{large:!0,onClick:D})})]})})]})}function Mt(e){var n=e.numAllow,t=e.numExclude,r=e.setNum,i=e.setAllExclusion,a=(0,m.$)(["page_character","sheet"]).t;return(0,$.jsx)(y.Z,{children:(0,$.jsxs)(f.Z,{children:[(0,$.jsxs)(q.Z,{gutterBottom:!0,children:[(0,$.jsx)("strong",{children:a("sheet:".concat(r,"set"))})," ",(0,$.jsxs)(Q.Z,{color:"success",children:[n," ",(0,$.jsx)(it.G,{icon:rt.Stf,className:"fa-fw"})," ",a("tabOptimize.artSetConfig.allowed")]}),!!t&&" / ",!!t&&(0,$.jsxs)(Q.Z,{color:"secondary",children:[t," ",(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"})," ",a("tabOptimize.artSetConfig.excluded")]})]}),(0,$.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.jsx)(x.Z,{fullWidth:!0,disabled:!t,onClick:function(){return i(r,!1)},color:"success",startIcon:(0,$.jsx)(it.G,{icon:rt.Stf,className:"fa-fw"}),children:a("tabOptimize.artSetConfig.allowAll".concat(r,"set"))}),(0,$.jsx)(x.Z,{fullWidth:!0,disabled:!n,onClick:function(){return i(r,!0)},color:"secondary",startIcon:(0,$.jsx)(it.G,{icon:rt.gPx,className:"fa-fw"}),children:a("tabOptimize.artSetConfig.excludeAll".concat(r,"set"))})]})]})})}function Tt(e){var n,t,i,a=e.sheet,s=e.setKey,o=e.fakeDataContextObj,c=e.slotCount,l=(0,m.$)("sheet").t,d=At((0,v.useContext)(C.K).character.key),h=d.buildSetting,p=d.buildSettingDispatch,j=null!==(n=null===h||void 0===h||null===(t=h.artSetExclusion)||void 0===t?void 0:t[s])&&void 0!==n?n:[],Z=!j.includes(4),g=(0,v.useMemo)((function(){return Object.values(c).reduce((function(e,n){return e+(n?1:0)}),0)}),[c]),b=(0,v.useMemo)((function(){return!Z||g<4?[]:Object.keys(a.setEffects).filter((function(e){var n;return null===(n=a.setEffects[e])||void 0===n?void 0:n.document.some((function(e){return"states"in e}))}))}),[a.setEffects,Z,g]),w=j.includes(2),P=j.includes(4);return g<2?null:(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsxs)(y.Z,{sx:{height:"100%"},children:[(0,$.jsxs)(u.Z,{className:"grad-".concat(a.rarity[0],"star"),width:"100%",sx:{display:"flex"},children:[(0,$.jsx)(u.Z,{component:"img",src:a.defIconSrc,sx:{height:100,width:"auto",mx:-1}}),(0,$.jsxs)(u.Z,{sx:{flexGrow:1,px:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,$.jsx)(q.Z,{variant:"h6",children:null!==(i=a.name)&&void 0!==i?i:""}),(0,$.jsxs)(u.Z,{display:"flex",gap:1,children:[(0,$.jsx)(q.Z,{variant:"subtitle1",children:a.rarity.map((function(e,n){return(0,$.jsxs)("span",{children:[e," ",(0,$.jsx)(Et.q,{stars:1})," ",n<a.rarity.length-1?"/ ":null]},e)}))}),(0,$.jsx)(St.Z,{title:(0,$.jsxs)(u.Z,{children:[(0,$.jsx)(q.Z,{children:(0,$.jsx)(Q.Z,{color:"success",children:l(bt||(bt=(0,Ue.Z)(["2set"])))})}),(0,$.jsx)(q.Z,{children:(0,$.jsx)(Ot.v,{ns:"artifact_".concat(s,"_gen"),key18:"setEffects.2"})}),(0,$.jsxs)(u.Z,{paddingTop:2,sx:{opacity:j.includes(4)?.6:1},children:[(0,$.jsx)(q.Z,{children:(0,$.jsx)(Q.Z,{color:"success",children:l(wt||(wt=(0,Ue.Z)(["4set"])))})}),(0,$.jsx)(q.Z,{children:(0,$.jsx)(Ot.v,{ns:"artifact_".concat(s,"_gen"),key18:"setEffects.4"})})]})]})})]}),(0,$.jsx)(u.Z,{sx:{display:"flex",gap:1},children:Object.entries(c).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return(0,$.jsx)(q.Z,{sx:{flexGrow:1},variant:"subtitle2",children:(0,$.jsxs)(Q.Z,{sx:{width:"100%"},color:i?"primary":"secondary",children:[(0,Pt.Ir)(t),i]})},t)}))})]})]}),(0,$.jsxs)(ke.Z,{sx:{".MuiButton-root":{borderRadius:0}},fullWidth:!0,children:[g>=2&&(0,$.jsx)(x.Z,{startIcon:w?(0,$.jsx)(pe.Z,{}):(0,$.jsx)(he.Z,{}),onClick:function(){return p({type:"artSetExclusion",setKey:s,num:2})},color:w?"secondary":"success",endIcon:(0,$.jsx)(it.G,{icon:w?rt.gPx:rt.Stf,className:"fa-fw"}),children:l(Ct||(Ct=(0,Ue.Z)(["2set"])))}),g>=4&&(0,$.jsx)(x.Z,{startIcon:P?(0,$.jsx)(pe.Z,{}):(0,$.jsx)(he.Z,{}),onClick:function(){return p({type:"artSetExclusion",setKey:s,num:4})},color:P?"secondary":"success",endIcon:(0,$.jsx)(it.G,{icon:P?rt.gPx:rt.Stf,className:"fa-fw"}),children:l(kt||(kt=(0,Ue.Z)(["4set"])))})]}),!!b.length&&(0,$.jsx)(k.R.Provider,{value:o,children:(0,$.jsx)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:b.map((function(e){return(0,$.jsx)(lt,{setKey:s,setNumKey:parseInt(e),hideHeader:!0,conditionalsOnly:!0},e)}))})})]})},s)}var Kt=[0,4,8,12,16,20];function It(e){var n=e.mainStatAssumptionLevel,t=void 0===n?0:n,r=e.setmainStatAssumptionLevel,i=e.disabled,a=(0,m.$)("page_character").t;return(0,$.jsx)(un.Z,{fullWidth:!0,color:t?"success":"primary",disabled:i,title:t?a("tabOptimize.assumptionLvl.lvl",{lvl:t}):a("tabOptimize.assumptionLvl.no"),children:Kt.map((function(e){return(0,$.jsx)(tn.Z,{onClick:function(){return r(e)},children:e?a("tabOptimize.assumptionLvl.lvl",{lvl:e}):a("tabOptimize.assumptionLvl.no")},e)}))})}function Rt(){var e=(0,v.useContext)(C.K).character.bonusStats,n=(0,v.useContext)(k.R).data,t=Object.keys(e);if(!t.length)return null;var r=t.map((function(e){return n.get(me.ri.customBonus[e])}));return(0,$.jsxs)(y.Z,{children:[(0,$.jsx)(f.Z,{children:(0,$.jsx)(q.Z,{children:"Bonus Stats"})}),(0,$.jsx)(B.Z,{}),(0,$.jsx)(f.Z,{children:r.map((function(e){return(0,$.jsx)(Te.JW,{node:e},e.info.key)}))})]})}var zt=t(57482),$t=t(52771),Wt=(0,Ze.ZP)("strong")({fontFamily:"monospace"}),Nt=(0,Ze.ZP)(zt.Z)((function(e){e.theme;return{height:10,borderRadius:5}}));function Ft(e){var n=e.status,t=n.type,r=n.tested,i=(n.failed,n.skipped),a=n.total,s=n.startTime,o=n.finishTime,c=e.characterName,l=isFinite(a),u="inactive"!==t,d=a-i,f=(0,$.jsx)(Wt,{children:r.toLocaleString()}),h=(0,$.jsx)(Wt,{children:d.toLocaleString()}),p=!!i&&(0,$.jsxs)("span",{children:["(",(0,$.jsx)("b",{children:(0,$.jsx)(Wt,{children:i.toLocaleString()})})," skipped)"]}),x=(0,$.jsx)(Wt,{children:(0,$t.e6)(Math.round((null!==o&&void 0!==o?o:performance.now())-(null!==s&&void 0!==s?s:NaN)))}),v="",m="",j=void 0;if(u)j=100*(i+r)/(i+d),v=(0,$.jsxs)(q.Z,{children:["Generating and testing ",f,l?(0,$.jsxs)($.Fragment,{children:["/",h]}):void 0," build configurations against the criteria for ",(0,$.jsx)("b",{children:c}),". ",p]}),m=(0,$.jsxs)(q.Z,{children:["Time elapsed: ",x]});else{if(!(r+i))return null;j=100,v=(0,$.jsxs)(q.Z,{children:["Generated and tested ",f," Build configurations against the criteria for ",(0,$.jsx)("b",{children:c}),". ",p]}),m=(0,$.jsxs)(q.Z,{children:["Total duration: ",x]})}return(0,$.jsxs)(en.Z,{severity:"success",variant:"filled",sx:{"& .MuiAlert-message":{flexGrow:1}},children:[v,m,void 0!==j&&(0,$.jsxs)(le.ZP,{container:!0,spacing:1,alignItems:"center",children:[l&&(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(q.Z,{children:"".concat(j.toFixed(1),"%")})}),(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(Nt,{variant:l?"determinate":"indeterminate",value:j,color:"primary"})})]})]})}var Bt=t(98268),Vt=t(63204),Lt=t(66647),qt=t(13967),Gt=t(12065),Ht=t(10658),Ut=t(98620),Jt=t(63372),Xt=t(20005),Yt=t(64929);function Qt(e){var n,t,r=e.artifactId,i=e.slotKey,a=e.mainStatAssumptionLevel,s=void 0===a?0:a,o=e.showLocation,c=void 0!==o&&o,l=e.onClick,d=e.BGComponent,f=void 0===d?g.Z:d,h=(0,Jt.Z)(r),p=(0,A.Z)((function(){return ot.y.get(null===h||void 0===h?void 0:h.setKey)}),[null===h||void 0===h?void 0:h.setKey]),x=(0,v.useCallback)((function(e){return(0,$.jsx)(Lt.Z,{onClick:l,sx:{height:"100%"},children:e})}),[l]),m=(0,qt.Z)();if(!h)return(0,$.jsx)(f,{sx:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center"},children:(0,$.jsx)(u.Z,{component:"img",src:Ht.Z.slot[i],sx:{width:"25%",height:"auto",opacity:.7}})});var j=h.slotKey,Z=h.rarity,y=h.level,b=h.mainStatKey,w=h.substats,C=h.location,k=Math.max(Math.min(s,4*Z),y),P=ne.ZP.unit(b),S=T.Kj.find((function(e){return h.mainStatKey.includes(e)})),E=S?(0,Gt.Fq)(m.palette[S].main,.6):(0,Gt.Fq)(m.palette.secondary.main,.6);return(0,$.jsx)(f,{sx:{height:"100%"},children:(0,$.jsx)(Xt.Z,{condition:!!l,wrapper:x,children:(0,$.jsxs)(u.Z,{display:"flex",height:"100%",children:[(0,$.jsxs)(u.Z,{className:"grad-".concat(Z,"star"),sx:{position:"relative",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,$.jsx)(Yt.Z,{art:h,children:(0,$.jsx)(u.Z,{component:"img",src:null!==(n=null===p||void 0===p?void 0:p.slotIcons[j])&&void 0!==n?n:"",sx:{m:-1,maxHeight:"110%",maxWidth:"110%"}})}),(0,$.jsxs)(u.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"space-between",pointerEvents:"none"},children:[(0,$.jsx)(xe.Z,{size:"small",label:(0,$.jsx)("strong",{children:" +".concat(y)}),color:Ut.ZP.levelVariant(y)}),c&&(0,$.jsx)(xe.Z,{size:"small",label:(0,$.jsx)(nr,{location:C}),color:"secondary",sx:{overflow:"visible",".MuiChip-label":{overflow:"visible"}}})]}),(0,$.jsx)(xe.Z,{size:"small",sx:{position:"absolute",bottom:0,mb:1,backgroundColor:E},label:(0,$.jsxs)(q.Z,{sx:{display:"flex",gap:.5,px:1,zIndex:1},children:[(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsx)(q.Z,{children:ne.ZP.getArtStr(b)}),disableInteractive:!0,children:(0,$.jsx)("span",{children:S?we.hJ[S]:we.ZP[b]})}),(0,$.jsxs)(J.Z,{color:k!==y?"warning":void 0,children:[(0,ne.qs)(null!==(t=Ut.ZP.mainStatValue(b,Z,k))&&void 0!==t?t:0,ne.ZP.unit(b)),P]})]})})]}),(0,$.jsx)(u.Z,{display:"flex",flexDirection:"column",justifyContent:"space-between",sx:{p:1},children:w.map((function(e,n){return(0,$.jsx)(er,{stat:e},n+e.key)}))})]})})})}function er(e){var n,t,r=e.stat;if(!r.value)return null;var i=null!==(n=null===(t=r.rolls)||void 0===t?void 0:t.length)&&void 0!==n?n:0,a="roll".concat((0,vn.uZ)(i,1,6)),s=ne.ZP.unit(r.key);return(0,$.jsx)(u.Z,{display:"flex",gap:1,alignContent:"center",children:(0,$.jsxs)(q.Z,{sx:{flexGrow:1,display:"flex",gap:.5},color:i?"".concat(a,".main"):"error.main",component:"span",children:[(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsx)(q.Z,{children:r.key&&ne.ZP.getArtStr(r.key)}),disableInteractive:!0,children:(0,$.jsx)("span",{children:we.ZP[r.key]})}),(0,$.jsx)("span",{children:"".concat((0,ne.qs)(r.value,ne.ZP.unit(r.key))).concat(s)})]})})}function nr(e){var n=e.location,t=(0,A.Z)((function(){return S.Z.get(null!==n&&void 0!==n?n:"")}),[n]);return t?(0,$.jsx)(cn.Z,{placement:"right-end",title:(0,$.jsx)(q.Z,{children:t.name}),children:(0,$.jsx)(X.Z,{src:t.thumbImgSide,sx:{height:"3em",marginTop:"-1.5em",marginLeft:"-0.5em"}})}):(0,$.jsx)(Vt.Z,{})}var tr=t(16002),rr=(0,v.createContext)(void 0);function ir(){var e=(0,v.useContext)(k.R).data,n=(0,v.useMemo)((function(){return(0,ee.U)(e).filter((function(e){var n=(0,r.Z)(e,2)[1];return Object.values(n).some((function(e){return!e.isEmpty}))}))}),[e]);return(0,$.jsx)(de.Z,{sx:{mr:-1,mb:-1},children:(0,$.jsx)(tr.ZP,{columns:{xs:1,sm:2,md:3,xl:4},spacing:1,children:n.map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return(0,$.jsx)(ar,{displayNs:i,sectionKey:t},t)}))})})}function ar(e){var n=e.displayNs,t=e.sectionKey,i=(0,v.useContext)(rr),a=(0,v.useContext)(k.R),s=a.data,o=a.oldData,c=(0,A.Z)((function(){return(0,ee.f)(s,t)}),[s,t]),l=(0,v.useMemo)((function(){return(0,vn.xh)(n,(function(e,n){return(0,fn.UF)(["display",t,n])}))}),[n,t]);if(!c)return(0,$.jsx)(g.Z,{});var u=c.title,d=c.icon,f=c.action;return(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(U.Z,{avatar:d&&(0,$.jsx)(X.Z,{size:2,sx:{m:-1},src:d}),title:u,action:f&&(0,$.jsx)(Q.Z,{children:f})}),(0,$.jsx)(B.Z,{}),(0,$.jsx)(Te.lD,{sx:{m:0},children:Object.entries(n).map((function(e){var n=(0,r.Z)(e,2),a=n[0],s=n[1];return(0,$.jsx)(Te.JW,{node:s,oldValue:o?o.get(l[a]).value:void 0,component:ue.ZP,emphasize:JSON.stringify(i)===JSON.stringify([t,a])},a)}))})]})}var sr=t(66218),or=t(74480),cr=t(41717);function lr(e){var n=e.weaponId,t=e.showLocation,r=void 0!==t&&t,i=e.onClick,a=e.BGComponent,s=void 0===a?g.Z:a,o=(0,or.Z)(n),c=(0,A.Z)((function(){return(null===o||void 0===o?void 0:o.key)&&sr.Z.get(o.key)}),[null===o||void 0===o?void 0:o.key]),l=(0,v.useCallback)((function(e){return(0,$.jsx)(Lt.Z,{sx:{height:"100%"},onClick:i,children:e})}),[i]),f=(0,v.useMemo)((function(){return c&&o&&(0,Nn.mP)([c.data,(0,Nn.v0)(o)])}),[c,o]);if(!o||!c||!f)return(0,$.jsx)(s,{sx:{height:"100%"},children:(0,$.jsx)(d.Z,{variant:"rectangular",sx:{width:"100%",height:"100%"}})});var h=o.refinement,p=o.location;return(0,$.jsx)(s,{sx:{height:"100%"},children:(0,$.jsx)(Xt.Z,{condition:!!i,wrapper:l,children:(0,$.jsxs)(u.Z,{display:"flex",height:"100%",alignItems:"stretch",children:[(0,$.jsxs)(u.Z,{className:"grad-".concat(c.rarity,"star"),sx:{height:"100%",position:"relative",flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[(0,$.jsx)(cr.Z,{sheet:c,children:(0,$.jsx)(u.Z,{component:"img",src:c.getImg(o.ascension),sx:{mx:-1,maxHeight:"100%",maxWidth:"100%"}})}),(0,$.jsxs)(u.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"space-between",pointerEvents:"none"},children:[(0,$.jsx)(xe.Z,{size:"small",label:(0,$.jsx)("strong",{children:sr.Z.getLevelString(o)}),color:"primary"}),r&&(0,$.jsx)(xe.Z,{size:"small",label:(0,$.jsx)(dr,{location:p}),color:"secondary",sx:{overflow:"visible",".MuiChip-label":{overflow:"visible"}}})]}),(0,$.jsx)(u.Z,{sx:{position:"absolute",width:"100%",height:"100%",p:.5,opacity:.85,display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:c.hasRefinement&&(0,$.jsx)(xe.Z,{size:"small",color:"info",label:(0,$.jsxs)("strong",{children:["R",h]})})})]}),(0,$.jsxs)(u.Z,{display:"flex",flexDirection:"column",sx:{p:1},children:[(0,$.jsx)(ur,{node:f.get(me.qH.weapon.main)}),(0,$.jsx)(ur,{node:f.get(me.qH.weapon.sub)})]})]})})})}function ur(e){var n=e.node;if(!n.info.key)return null;var t=(0,ne.EC)(n.value,n.unit,n.unit?void 0:0);return(0,$.jsx)(u.Z,{display:"flex",gap:1,alignContent:"center",children:(0,$.jsxs)(q.Z,{sx:{flexGrow:1,display:"flex",gap:1},component:"span",children:[(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsx)(q.Z,{children:n.info.key&&ne.ZP.getArtStr(n.info.key)}),disableInteractive:!0,children:(0,$.jsx)("span",{children:we.ZP[n.info.key]})}),(0,$.jsx)("span",{children:t})]})})}function dr(e){var n=e.location,t=(0,A.Z)((function(){return S.Z.get(null!==n&&void 0!==n?n:"")}),[n]);return t?(0,$.jsx)(cn.Z,{placement:"right-end",title:(0,$.jsx)(q.Z,{children:t.name}),children:(0,$.jsx)(X.Z,{src:t.thumbImgSide,sx:{height:"3em",marginTop:"-1.5em",marginLeft:"-0.5em"}})}):(0,$.jsx)(Vt.Z,{})}var fr=t(72838);function hr(e){var n=e.index,t=e.compareBuild,i=e.extraButtons,a=e.disabled,s=(0,v.useContext)(C.K).character,o=s.key,c=s.equippedArtifacts,l=At(o).buildSetting.mainStatAssumptionLevel,u=(0,v.useContext)(Wn.t).database,h=(0,v.useContext)(k.R),p=h.data,m=h.oldData,j=(0,v.useState)(void 0),Z=(0,r.Z)(j,2),g=Z[0],b=Z[1],w=(0,v.useCallback)((function(){return b(void 0)}),[b]),P=(0,v.useCallback)((function(){if(window.confirm("Do you want to equip this build to this character?")){var e=Object.fromEntries(T.eV.map((function(e){return[e,p.get(me.ri.art[e].id).value]})));u.chars.equipArtifacts(o,e),u.weapons.set(p.get(me.ri.weapon.id).value,{location:o})}}),[o,p,u]),S=(0,v.useMemo)((function(){var e=(0,fe.Z)({},h);return t||(e.oldData=void 0),e}),[h,t]),E=(0,v.useMemo)((function(){return T.eV.map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Qt,{showLocation:!0,slotKey:e,artifactId:p.get(me.ri.art[e].id).value,mainStatAssumptionLevel:l,onClick:function(){var n=c[e],t=p.get(me.ri.art[e].id).value;b({oldId:n!==t?n:void 0,newId:t})}})},e)}))}),[p,b,c,l]);if(!m)return null;var O=T.eV.every((function(e){return p.get(me.ri.art[e].id).value===m.get(me.ri.art[e].id).value}))&&p.get(me.ri.weapon.id).value===m.get(me.ri.weapon.id).value;return(0,$.jsx)(y.Z,{children:(0,$.jsxs)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:600}),children:[g&&(0,$.jsx)(mr,{newOld:g,mainStatAssumptionLevel:l,onClose:w}),(0,$.jsxs)(f.Z,{children:[(0,$.jsxs)(de.Z,{display:"flex",gap:1,sx:{pb:1},flexWrap:"wrap",children:[void 0!==n&&(0,$.jsx)(Q.Z,{color:"info",children:(0,$.jsx)(q.Z,{children:(0,$.jsxs)("strong",{children:["#",n+1,O?" (Equipped)":""]})})}),(0,$.jsx)(pr,{currentlyEquipped:O}),(0,$.jsx)(de.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"flex-end"}}),(0,$.jsx)(x.Z,{size:"small",color:"success",onClick:P,disabled:a||O,children:"Equip Build"}),i]}),(0,$.jsxs)(le.ZP,{container:!0,spacing:1,sx:{pb:1},columns:{xs:2,sm:3,md:4,lg:6},children:[(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(lr,{showLocation:!0,weaponId:p.get(me.ri.weapon.id).value})}),E]}),(0,$.jsx)(k.R.Provider,{value:S,children:(0,$.jsx)(ir,{})})]})]})})}function pr(e){var n=e.currentlyEquipped,t=void 0!==n&&n,i=(0,v.useContext)(k.R).data,a={};return T.eV.forEach((function(e){var n=i.get(me.ri.art[e].set).value;n&&(a[n]?a[n].push(e):a[n]=[e])})),(0,$.jsx)($.Fragment,{children:Object.entries(a).sort((function(e,n){var t=(0,r.Z)(e,2),i=(t[0],t[1]),a=(0,r.Z)(n,2);a[0];return a[1].length-i.length})).map((function(e){var n=(0,r.Z)(e,2),i=n[0],a=n[1];return(0,$.jsx)(xr,{setKey:i,currentlyEquipped:t,slotarr:a},i)}))})}function xr(e){var n,t=e.setKey,r=e.currentlyEquipped,i=void 0!==r&&r,a=e.slotarr,s=(0,A.Z)((function(){return ot.y.get(t)}),[]);if(!s)return null;var o=a.length,c=Object.keys(s.setEffects).map((function(e){return parseInt(e)})).filter((function(e){return e<=o}));return(0,$.jsx)(de.Z,{children:(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:100,height:100}),children:(0,$.jsx)(vr,{artifactSheet:s,numInSet:o})}),disableInteractive:!0,children:(0,$.jsx)(Q.Z,{color:i?"success":"primary",children:(0,$.jsxs)(q.Z,{children:[a.map((function(e){return(0,Pt.Ir)(e)}))," ",null!==(n=s.name)&&void 0!==n?n:"",c.map((function(e){return(0,$.jsx)(Q.Z,{sx:{ml:.5},color:"success",children:e},e)}))]})})})})}function vr(e){var n=e.artifactSheet,t=e.numInSet,r=(0,m.$)("sheet").t;return(0,$.jsx)(ce.Z,{spacing:2,sx:{p:1},children:Object.keys(n.setEffects).map((function(e){return(0,$.jsxs)(de.Z,{sx:{opacity:parseInt(e)<=t?1:.5},children:[(0,$.jsx)(q.Z,{children:(0,$.jsx)(Q.Z,{color:"success",children:r("".concat(e,"set"))})}),(0,$.jsx)(q.Z,{children:(0,$.jsx)(Ot.v,{ns:"artifact_".concat(n.key,"_gen"),key18:"setEffects.".concat(e)})})]},e)}))})}function mr(e){var n=e.newOld,t=n.newId,r=n.oldId,i=e.mainStatAssumptionLevel,a=e.onClose,s=(0,v.useContext)(Wn.t).database,o=(0,v.useContext)(C.K).character.key,c=(0,v.useCallback)((function(){window.confirm("Do you want to equip this artifact to this character?")&&(s.arts.set(t,{location:o}),a())}),[t,s,o,a]);return(0,$.jsx)(Y.Z,{open:!!t,onClose:a,containerProps:{maxWidth:r?"md":"xs"},children:(0,$.jsx)(g.Z,{children:(0,$.jsxs)(f.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"stretch",gap:2,height:"100%"},children:[r&&(0,$.jsx)(de.Z,{minWidth:320,children:(0,$.jsx)(fr.Z,{artifactId:r,mainStatAssumptionLevel:i,canExclude:!0,canEquip:!0})}),r&&(0,$.jsx)(de.Z,{display:"flex",flexGrow:1}),r&&(0,$.jsx)(de.Z,{display:"flex",alignItems:"center",justifyContent:"center",children:(0,$.jsx)(x.Z,{onClick:c,sx:{display:"flex"},children:(0,$.jsx)(Bt.Z,{sx:{fontSize:40}})})}),r&&(0,$.jsx)(de.Z,{display:"flex",flexGrow:1}),(0,$.jsx)(de.Z,{minWidth:320,children:(0,$.jsx)(fr.Z,{artifactId:t,mainStatAssumptionLevel:i,canExclude:!0,canEquip:!0})})]})})})}var jr=t(94294),Zr=t(72456),gr=t(40165),yr=t(20601),br=t(39783),wr=t(82839),Cr=t(90466),kr=t(12891),Pr=t(42633),Sr=t(27281),Er=t(64694),Or=t(62066);function _r(e){var n=e.chartData,t=e.plotBase,i=e.setPlotBase,a=e.disabled,s=void 0!==a&&a,o=(0,v.useState)(!1),c=(0,r.Z)(o,2),l=c[0],u=c[1],d=(0,v.useState)(!0),h=(0,r.Z)(d,2),p=h[0],m=h[1],j=(0,v.useContext)(k.R).data,Z=["atk","hp","def","eleMas","critRate_","critDMG_","heal_","enerRech_"];"catalyst"!==j.get(me.ri.weaponType).value&&Z.push("physical_dmg_"),Z.push("".concat(j.get(me.ri.charEle).value,"_dmg_"));var b=(0,v.useMemo)((function(){var e,t;if(!n)return{displayData:null,downloadData:null};var r,i=n.data.map((function(e){var n=e.value;return{x:e.plot,y:n}})).sort((function(e,n){return e.x-n.x})),a=[],s=(0,Xe.Z)(i);try{for(s.s();!(r=s.n()).done;){for(var o=r.value,c=void 0;c=a.pop();)if(c.y>o.y){a.push(c);break}a.push(o)}}catch(u){s.e(u)}finally{s.f()}(null===(e=a[0])||void 0===e?void 0:e.x)!==(null===(t=i[0])||void 0===t?void 0:t.x)&&(i[0].min=a[0].y),a.forEach((function(e){e.min=e.y}));var l={minimum:a.map((function(e){return[e.x,e.y]})),allData:i.map((function(e){return[e.x,e.y]}))};return{displayData:i,downloadData:l}}),[n]),w=b.displayData,C=b.downloadData;return(0,$.jsxs)(y.Z,{children:[(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(q.Z,{variant:"h6",children:"Optimization Target vs"})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsxs)(un.Z,{title:t?ne.ZP.get(t):"Not Selected",color:t?"success":"primary",disabled:s,children:[(0,$.jsx)(tn.Z,{onClick:function(){i("")},children:"Unselect"}),(0,$.jsx)(B.Z,{}),Z.map((function(e){return(0,$.jsx)(tn.Z,{onClick:function(){i(e)},children:ne.ZP.get(e)},e)}))]})}),(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(gr.Z,{placement:"top",title:"Using data from the builder, this will generate a graph to visualize Optimization Target vs. a selected stat. The graph will show the maximum Optimization Target value per 0.01 of the selected stat.",children:(0,$.jsx)(jr.Z,{})})}),!!C&&(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(x.Z,{startIcon:p?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:p?"success":"secondary",onClick:function(){return m(!p)},children:"Show Min Stat Threshold"})}),!!C&&(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(x.Z,{color:"info",startIcon:(0,$.jsx)(Zr.Z,{}),onClick:function(){return u(!l)},children:"Download Data"})})]})}),!!w&&(0,$.jsx)(B.Z,{}),n&&!!w&&(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(ve.Z,{in:!!C&&l,children:(0,$.jsx)(g.Z,{sx:{mb:2},children:(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(q.Z,{children:"Min Data"}),(0,$.jsx)(Dr,{data:null===C||void 0===C?void 0:C.minimum}),(0,$.jsx)(q.Z,{children:"All Data"}),(0,$.jsx)(Dr,{data:null===C||void 0===C?void 0:C.allData})]})})}),(0,$.jsx)(Mr,{displayData:w,plotNode:n.plotNode,valueNode:n.valueNode,showMin:p})]})]})}var Ar=(0,Ze.ZP)("textarea")({width:"100%",fontFamily:"monospace",resize:"vertical",minHeight:"5em"});function Dr(e){var n=e.data;return(0,$.jsx)(Ar,{readOnly:!0,value:JSON.stringify(n),onClick:function(e){var n=e.target;n.selectionStart=0,n.selectionEnd=n.value.length}})}function Mr(e){var n,t,r=e.displayData,i=e.plotNode,a=e.valueNode,s=e.showMin,o=ne.ZP.unit(null===(n=i.info)||void 0===n?void 0:n.key),c=ne.ZP.unit(null===(t=a.info)||void 0===t?void 0:t.key);return(0,$.jsx)(yr.h,{width:"100%",height:600,children:(0,$.jsxs)(br.c,{data:r,children:[(0,$.jsx)(wr.q,{strokeDasharray:"3 3"}),(0,$.jsx)(Cr.K,{dataKey:"x",scale:"linear",unit:o,domain:["auto","auto"],tick:{fill:"white"},type:"number",tickFormatter:function(e){return e>1e4?e.toFixed():e.toFixed(1)}}),(0,$.jsx)(kr.B,{name:"DMG",domain:["auto","auto"],unit:c,allowDecimals:!1,tick:{fill:"white"},type:"number"}),(0,$.jsx)(Pr.d,{dataKey:"y",range:[3,25]}),(0,$.jsx)(Sr.D,{}),(0,$.jsx)(Er.b,{name:"Optimization Target",dataKey:"y",fill:"#8884d8",line:!0,lineType:"fitting",isAnimationActive:!1}),s&&(0,$.jsx)(Or.x,{name:"Minimum Stat Requirement Threshold",dataKey:"min",stroke:"#ff7300",type:"stepBefore",connectNulls:!0,strokeWidth:2,isAnimationActive:!1})]})})}var Tr=["sands","goblet","circlet"];function Kr(e){var n=e.disabled,t=void 0!==n&&n,r=(0,m.$)("artifact").t,i=At((0,v.useContext)(C.K).character.key),a=i.buildSetting.mainStatKeys,s=i.buildSettingDispatch;return(0,$.jsx)(de.Z,{display:"flex",flexDirection:"column",gap:1,children:Tr.map((function(e){var n=a[e].length;return(0,$.jsxs)(de.Z,{children:[(0,$.jsx)(B.Z,{}),(0,$.jsxs)(f.Z,{sx:{pt:1},children:[(0,$.jsxs)(de.Z,{sx:{display:"flex",gap:1,alignItems:"center",pb:1},children:[(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsx)(q.Z,{children:r("slotName.".concat(e))}),children:(0,$.jsx)("span",{children:(0,Pt.Ir)(e)})}),(0,$.jsx)(de.Z,{flexGrow:1,children:(0,$.jsx)(Q.Z,{color:"info",children:n?"".concat(n," Selected"):"Any"})}),(0,$.jsx)(x.Z,{color:"error",size:"small",disabled:!a[e].length||t,sx:{mt:-1,mb:-1},onClick:function(){return s({type:"mainStatKey",slotKey:e})},children:(0,$.jsx)(Ce.Z,{})})]}),(0,$.jsx)(le.ZP,{container:!0,spacing:1,children:Ut.ZP.slotMainStats(e).map((function(n,r){var i=T.Kj.find((function(e){return n.includes(e)})),o=a[e].includes(n)?null!==i&&void 0!==i?i:"success":"secondary";return(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,xs:r<3&&"goblet"!==e?4:void 0,children:(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsx)(q.Z,{children:(0,$.jsx)("strong",{children:ne.ZP.getArtStr(n)})}),disableInteractive:!0,children:(0,$.jsx)(x.Z,{fullWidth:!0,size:"small",color:o,sx:{fontSize:"1.2em",height:"100%",pointerEvents:t?"none":void 0,cursor:t?"none":void 0},onClick:function(){return s({type:"mainStatKey",slotKey:e,mainStatKey:n})},children:i?we.hJ[i]:we.ZP[n]})})},n)}))})]})]},e)}))})}var Ir,Rr,zr=t(72814);function $r(e){var n=e.disabled,t=void 0!==n&&n,r=(0,m.$)("page_character").t,i=(0,v.useContext)(C.K).character.key,a=(0,v.useContext)(k.R).data,s=At(i),o=s.buildSetting.statFilters,c=s.buildSettingDispatch,l=(0,v.useCallback)((function(e){return c({statFilters:e})}),[c]),d=(0,v.useMemo)((function(){var e=["atk","hp","def","eleMas","critRate_","critDMG_","heal_","enerRech_"];"catalyst"!==a.get(me.qH.weaponType).value&&e.push("physical_dmg_");var n=a.get(me.qH.charEle).value;return e.push("".concat(n,"_dmg_")),e}),[a]);return(0,$.jsxs)(u.Z,{children:[(0,$.jsx)(y.Z,{children:(0,$.jsxs)(f.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,$.jsx)(q.Z,{children:r(Ir||(Ir=(0,Ue.Z)(["tabOptimize.constraintFilter.title"])))}),(0,$.jsx)(St.Z,{title:(0,$.jsx)(q.Z,{children:r(Rr||(Rr=(0,Ue.Z)(["tabOptimize.constraintFilter.tooltip"])))})})]})}),(0,$.jsx)(u.Z,{display:"flex",flexDirection:"column",gap:.5,children:(0,$.jsx)(Ke.Z,{statKeys:d,statFilters:o,setStatFilters:l,disabled:t})})]})}var Wr=t(89841),Nr=t(70558),Fr=t(1235),Br=t(68125),Vr=t(68087),Lr=t(52991),qr=t(84684),Gr=t(77208),Hr=navigator.hardwareConcurrency||4;function Ur(){return{equipmentPriority:[],threads:Hr}}function Jr(){return(0,Fn.Z)("TabOptimize",Ur)}function Xr(e){var n=e.disabled,t=void 0!==n&&n,i=(0,m.$)("page_character").t,a=(0,v.useContext)(C.K).character.key,s=At(a),o=s.buildSetting.useEquippedArts,c=s.buildSettingDispatch,l=(0,v.useContext)(Wn.t).database,d=(0,E.Z)(!1),h=(0,r.Z)(d,3),p=h[0],j=h[1],Z=h[2],w=Jr(),k=(0,r.Z)(w,2),P=k[0].equipmentPriority,S=k[1],O=(0,v.useMemo)((function(){return(0,oe.Z)(new Set(P)).filter((function(e){return l.chars.get(e)}))}),[l,P]),_=(0,v.useCallback)((function(e){return S({equipmentPriority:e})}),[S]),A=(0,v.useCallback)((function(e,n){var t=(0,oe.Z)(O),r=t[e];t.splice(e,1),t.splice(n,0,r),_(t)}),[O,_]),D=(0,v.useCallback)((function(e){var n=(0,oe.Z)(O);n.splice(e,1),_(n)}),[O,_]),M=(0,v.useCallback)((function(e){return _([].concat((0,oe.Z)(O),[e]))}),[O,_]),T=(0,v.useCallback)((function(){return _([])}),[_]),K=(0,v.useMemo)((function(){var e=O.length,n=O.indexOf(a);return n>=0&&(e=n),e}),[a,O]),I=(0,v.useMemo)((function(){return l.chars.keys.length-1-K}),[K,l]),R=(0,v.useMemo)((function(){return l.chars.keys.length-O.length}),[O,l]);return(0,$.jsxs)(u.Z,{display:"flex",gap:1,children:[(0,$.jsx)(Y.Z,{open:p,onClose:Z,containerProps:{maxWidth:"sm"},children:(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(q.Z,{variant:"h6",children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.modal.title",children:"Character Priority for Equipped Artifacts"})})}),(0,$.jsx)(le.ZP,{item:!0,sx:{mb:-1},children:(0,$.jsx)(b.Z,{onClick:Z})})]})}),(0,$.jsx)(B.Z,{}),(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(y.Z,{sx:{mb:1},children:(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(q.Z,{gutterBottom:!0,children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.modal.desc1",children:"When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list."})}),(0,$.jsx)(q.Z,{gutterBottom:!0,children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.modal.desc2",children:"If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list."})})]})}),(0,$.jsxs)(u.Z,{display:"flex",flexDirection:"column",gap:2,children:[O.map((function(e,n){return(0,$.jsx)(Yr,{characterKey:e,rank:n+1,maxRank:O.length,setRank:function(e){return e&&A(n,e-1)},onRemove:function(){return D(n)},numAbove:K},e)})),(0,$.jsxs)(u.Z,{sx:{display:"flex",gap:1},children:[(0,$.jsx)(Qr,{onAdd:M,list:O}),(0,$.jsx)(x.Z,{color:"error",onClick:T,startIcon:(0,$.jsx)(Ce.Z,{}),children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.modal.clearList",children:"Clear List"})})]}),!!I&&(0,$.jsx)(Q.Z,{color:"success",children:(0,$.jsx)(q.Z,{children:(0,$.jsxs)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.modal.usingNum",count:R,children:["Using artifacts from ",(0,$.jsx)("strong",{children:{count:R}})," unlisted characters"]})})})]})]})]})}),(0,$.jsxs)(ke.Z,{sx:{display:"flex",width:"100%"},children:[(0,$.jsx)(x.Z,{sx:{flexGrow:1},onClick:function(){return c({useEquippedArts:!o})},disabled:t,startIcon:o?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:o?"success":"secondary",children:(0,$.jsxs)(u.Z,{children:[(0,$.jsx)("span",{children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.title",children:"Use Equipped Artifacts"})}),o&&(0,$.jsx)(Q.Z,{children:(0,$.jsxs)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.usingNum",count:I,children:["Using from ",(0,$.jsx)("strong",{children:{count:I}})," characters"]})})]})}),o&&(0,$.jsx)(x.Z,{sx:{flexShrink:1},color:"info",onClick:j,disabled:t,children:(0,$.jsx)(at.Z,{})})]})]})}function Yr(e){var n=e.characterKey,t=e.rank,i=e.maxRank,a=e.setRank,s=e.onRemove,o=e.numAbove,c=(0,m.$)("page_character").t,l=(0,v.useContext)(Wn.t).database,d=(0,O.Z)(n),f=(0,z.Z)();if(!d)return null;var h=d.equippedWeapon,p=d.equippedArtifacts;return(0,$.jsxs)(y.Z,{sx:{p:1},children:[(0,$.jsxs)(u.Z,{sx:{pb:1,display:"flex",justifyContent:"space-between",gap:1},children:[(0,$.jsx)(Q.Z,{color:"info",children:(0,$.jsxs)(q.Z,{children:["#",t]})}),(0,$.jsx)(Q.Z,{sx:{flexGrow:1},color:o===t-1?"warning":t-1<o?"error":"success",children:(0,$.jsx)(q.Z,{children:o===t-1?(0,$.jsx)(st.c,{t:c,i18nKey:"tabOptimize.useEquipped.modal.status.curr",children:"Current character"}):t-1<o?(0,$.jsx)(st.c,{t:c,i18nKey:"tabOptimize.useEquipped.modal.status.dont",children:"Don't Use artifacts"}):(0,$.jsx)(st.c,{t:c,i18nKey:"tabOptimize.useEquipped.modal.status.use",children:"Use artifacts"})})}),(0,$.jsx)(u.Z,{children:(0,$.jsxs)(ke.Z,{sx:{flexGrow:1},size:"small",children:[(0,$.jsx)(Pe.CC,{children:(0,$.jsx)(Pe.ZP,{onChange:a,value:t,inputProps:{min:1,max:i,sx:{textAlign:"center"}},sx:{width:"100%",height:"100%",pl:2}})}),(0,$.jsx)(x.Z,{disabled:1===t,onClick:function(){return a(1)},children:(0,$.jsx)(Wr.Z,{})}),(0,$.jsx)(x.Z,{disabled:1===t,onClick:function(){return a(t-1)},children:(0,$.jsx)(Nr.Z,{})}),(0,$.jsx)(x.Z,{disabled:t===i,onClick:function(){return a(t+1)},children:(0,$.jsx)(Fr.Z,{})}),(0,$.jsx)(x.Z,{disabled:t===i,onClick:function(){return a(i)},children:(0,$.jsx)(Br.Z,{})}),(0,$.jsx)(x.Z,{color:"error",onClick:s,children:(0,$.jsx)(Qe.Z,{})})]})})]}),(0,$.jsxs)(le.ZP,{container:!0,columns:7,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(qr.Z,{characterKey:n,onClick:f})}),(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Gr.Z,{weaponId:h})}),Object.entries(p).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Lr.Z,{slotKey:t,artifactObj:l.arts.get(i)})},t)}))]})]})}function Qr(e){var n=e.onAdd,t=e.list,i=(0,m.$)("page_character").t,a=(0,E.Z)(!1),s=(0,r.Z)(a,3),o=s[0],c=s[1],l=s[2],u=(0,v.useCallback)((function(e){return!!e&&!t.includes(e.key)}),[t]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(I.w,{show:o,onHide:l,onSelect:n,filter:u}),(0,$.jsx)(x.Z,{fullWidth:!0,sx:{height:60},color:"info",onClick:c,startIcon:(0,$.jsx)(Vr.Z,{}),children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useEquipped.modal.add",children:"Add character to list"})})]})}function ei(e){var n=e.disabled,t=void 0!==n&&n,r=e.artsDirty,i=(0,m.$)("page_character").t,a=(0,v.useContext)(C.K).character.key,s=At(a),o=s.buildSetting.useExcludedArts,c=s.buildSettingDispatch,l=(0,v.useContext)(Wn.t).database,d=(0,v.useMemo)((function(){return r&&l.arts.values.reduce((function(e,n){return e+(n.exclude&&n.location!==a?1:0)}),0)}),[l,r,a]);return(0,$.jsx)(x.Z,{fullWidth:!0,onClick:function(){return c({useExcludedArts:!o})},disabled:!d||t,startIcon:o?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:o?"success":"secondary",children:(0,$.jsxs)(u.Z,{children:[(0,$.jsx)("span",{children:(0,$.jsx)(st.c,{t:i,i18nKey:"tabOptimize.useExcluded.title",count:d,children:"Use Excluded Artifacts"})}),o&&(0,$.jsx)(Q.Z,{children:(0,$.jsxs)(st.c,{t:i,i18nKey:"tabOptimize.useExcluded.usingNum",count:d,children:["Using ",(0,$.jsx)("strong",{children:{count:d}})," excluded artifacts"]})})]})})}var ni,ti=t(50765),ri=(0,fn.yY)((0,vn.I8)({dyn:(0,fe.Z)((0,fe.Z)({},me.qH.art),me.qH.artSet)})),ii={art:(0,vn.O)([].concat((0,oe.Z)(ti.r),(0,oe.Z)(ti._)),(function(e){return ri.dyn[e]})),artSet:(0,vn.xh)(me.qH.artSet,(function(e,n){return ri.dyn[n]}))};function ai(e,n,t){var r,i={base:{},values:{flower:[],plume:[],goblet:[],circlet:[],sands:[]}},a=new Set,s=(0,Xe.Z)(e);try{for(s.s();!(r=s.n()).done;){var o,c=r.value,l=Ut.ZP.mainStatValue(c.mainStatKey,c.rarity,Math.max(Math.min(n,4*c.rarity),c.level)),u={id:c.id,set:c.setKey,values:(0,fe.Z)((o={},(0,xn.Z)(o,c.setKey,1),(0,xn.Z)(o,c.mainStatKey,c.mainStatKey.endsWith("_")?l/100:l),o),Object.fromEntries(c.substats.map((function(e){return[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]}))))};delete u.values[""],i.values[c.slotKey].push(u),Object.keys(u.values).forEach((function(e){return a.add(e)}))}}catch(h){s.e(h)}finally{s.f()}if(i.base=(0,vn.O)((0,oe.Z)(a),(function(e){return 0})),t)for(var d=0,f=Object.values(i.values);d<f.length;d++){f[d].push({id:"",values:{}})}return i}function si(e,n,t){var i=t.optimizationTarget,a=t.constraints,s=t.artSetExclusion,o=t.depth,c=t.filters,l=[].concat((0,oe.Z)(a.map((function(e){return e.value}))),[i]),u=a.map((function(e){return e.min}));if(0!==(c=c.filter((function(e){var t=e.maxw;return!u.some((function(e,n){return t[n]<e}))&&!(t[u.length]<n)}))).length){var d=function(e){for(var n=(0,oe.Z)(e[0].lower),t=(0,oe.Z)(e[0].upper),r=(0,oe.Z)(e[0].minw),i=(0,oe.Z)(e[0].maxw),a=1;a<e.length;a++){for(var s=0;s<n.length;s++)n[s]=Math.min(n[s],e[a].lower[s]),t[s]=Math.max(t[s],e[a].upper[s]);for(var o=0;o<r.length;o++)r[o]=Math.min(r[o],e[a].minw[o]),i[o]=Math.max(i[o],e[a].maxw[o])}return{lower:n,upper:t,minw:r,maxw:i}}(c),f=d.lower,h=d.upper,p=Object.fromEntries(e.keys.map((function(e,n){return[e,f[n]]}))),x=Object.fromEntries(e.keys.map((function(e,n){return[e,h[n]]})));l=function(e,n,t){var i=Object.keys(n).filter((function(e){return Math.abs(n[e]-t[e])<1e-6}));return e.map((function(e){var a=e.nodes,s=e.terms,o=Object.entries(a),c=(0,pn.uW)(o.map((function(e){var n=(0,r.Z)(e,2);return n[0],n[1]})),(function(e){return e}),(function(e){switch(e.operation){case"read":return i.includes(e.path[1])?(0,fn.a9)(n[e.path[1]]):e;case"threshold":var a=(0,r.Z)(e.operands,4),s=a[0],o=a[1],c=a[2],l=a[3];if("const"===s.operation&&"const"===o.operation)return s.value>=o.value?c:l;if("read"!==s.operation||"const"!==o.operation)throw Error("Branch between non-read and non-const!!!");return n[s.path[1]]>=o.value?c:t[s.path[1]]<o.value?l:e;case"add":return In(e.operands);case"mul":return Rn(e.operands);case"res":case"sum_frac":if(e.operands.every((function(e){return"const"===e.operation}))){var u=hn.aj[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})));return(0,fn.a9)(u)}return e;case"min":case"max":if(e.operands.every((function(e){return"const"===e.operation}))){var d=hn.aj[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})));return(0,fn.a9)(d)}return e;default:return e}})),l={};c.forEach((function(e,n){if("const"===e.operation){var t=(0,r.Z)(o[n],1)[0];l[t]=e.value}}));var u=s.map((function(e){var n=e.coeff,t=e.terms.filter((function(e){return void 0===l[e]||(n*=l[e],!1)}));return 0===n?{coeff:0,terms:[]}:{coeff:n,terms:t}})),d=Object.fromEntries(c.map((function(e,n){return[o[n][0],e]})));return Object.keys(l).forEach((function(e){return delete d[e]})),{nodes:d,terms:On(u)}}))}(l,p,x);var v=(0,hn.I3)(a.map((function(e){return function(e){var n=e.nodes,t=e.terms;return fn.Sm.apply(void 0,(0,oe.Z)(t.map((function(e){var t=e.coeff,r=e.terms;return fn.WV.apply(void 0,[t].concat((0,oe.Z)(r.map((function(e){return n[e]})))))}))))}(e.value)})),(function(e){return e.path[1]})),m=(0,r.Z)(v,3),j=m[0],Z=m[1],g=m[2];zn(p,Z,g);for(var y=j(),b=u.map((function(e,n){return e>y[n]})),w=l.pop(),C=l.map((function(e,n){return{value:e,min:u[n]}})).filter((function(e,n){return b[n]})),k=C.map((function(e){return e.min})),P={},S=function(){var e=(0,r.Z)(O[E],2),n=e[0],t=e[1];if("uniqueKey"===n){P[n]=t;var i=T.q2.filter((function(e){return x[e]>0})),a=0,o=0;if(i.forEach((function(e){var n=(0,vn.w6)(p[e],x[e]);s[e]&&(n=n.filter((function(n){return!s[e].includes(n)}))),(n.includes(4)||n.includes(5))&&a++,(n.includes(2)||n.includes(3))&&o++})),t.includes(5)&&0===a){if(0===o)return{v:void 0};if(t.includes(3)&&o<2)return{v:void 0}}return"continue"}var c=t.filter((function(e){return p[n]<=e&&e<=x[n]}));if(c.includes(p[n])&&c.includes(x[n]))return{v:void 0};c.length>0&&(P[n]=c)},E=0,O=Object.entries(s);E<O.length;E++){var _=S();if("continue"!==_&&"object"===typeof _)return _.v}var A=[].concat((0,oe.Z)(C.map((function(e){return e.value}))),[w]).map((function(e){return Kn(e,p,x)}));!function(e,n){var t=[],i=[],a=[];n.forEach((function(n){var s=[],o=[];Object.entries(n.w).forEach((function(n){var t=(0,r.Z)(n,2),i=t[0],a=t[1];s.push(e.keys.indexOf(i)),o.push(a)})),t.push(s),i.push(o),a.push(s.reduce((function(n,t,r){return n+e.base[t]*o[r]}),n.c))})),e.baseBuffer=a,T.eV.forEach((function(n){return e.values[n].forEach((function(e){return e.buffer=t.map((function(n,t){return n.reduce((function(n,r,a){return n+e.values[r]*i[t][a]}),0)}))}))}))}(e,A);var D=c.map((function(n){var t=n.filterVec,r=n.lower,i=n.upper,a=function(e,n){return{keys:e.keys,base:e.base,baseBuffer:e.baseBuffer,values:(0,vn.O)(T.eV,(function(t){var r=n[t],i=e.values[t];return r.map((function(e){return i[e]}))}))}}(e,n.filterVec),s=(0,oe.Z)(a.baseBuffer),o=(0,oe.Z)(a.baseBuffer);return T.eV.forEach((function(e){for(var n=li(a.values[e]),t=n.minw,r=n.maxw,i=0;i<s.length;i++)s[i]+=t[i],o[i]+=r[i]})),{filterVec:t,lower:r,upper:i,minw:s,maxw:o}})).filter((function(e){var t=e.maxw;return!k.some((function(e,n){return t[n]<e}))&&!(t[u.length]<n)}));return{cache:!0,optimizationTarget:w,constraints:C,artSetExclusion:P,depth:o,lin:A,filters:D}}}function oi(e){var n=new Set(Object.keys(e.base));Object.values(e.values).forEach((function(e){e.forEach((function(e){e.set&&n.add(e.set),Object.keys(e.values).forEach((function(e){return n.add(e)}))}))}));var t=(0,oe.Z)(n),r=[].concat((0,oe.Z)(t.filter((function(e){return!T.q2.includes(e)}))),(0,oe.Z)(t.filter((function(e){return T.q2.includes(e)}))));return{keys:r,baseBuffer:[],base:r.map((function(n){var t;return null!==(t=e.base[n])&&void 0!==t?t:0})),values:{flower:e.values.flower.map((function(e){var n=e.id,t=e.set,i=e.values;return{id:n,set:t,values:r.map((function(e){var n;return null!==(n=i[e])&&void 0!==n?n:e===t?1:0})),buffer:[]}})),plume:e.values.plume.map((function(e){var n=e.id,t=e.set,i=e.values;return{id:n,set:t,values:r.map((function(e){var n;return null!==(n=i[e])&&void 0!==n?n:e===t?1:0})),buffer:[]}})),sands:e.values.sands.map((function(e){var n=e.id,t=e.set,i=e.values;return{id:n,set:t,values:r.map((function(e){var n;return null!==(n=i[e])&&void 0!==n?n:e===t?1:0})),buffer:[]}})),goblet:e.values.goblet.map((function(e){var n=e.id,t=e.set,i=e.values;return{id:n,set:t,values:r.map((function(e){var n;return null!==(n=i[e])&&void 0!==n?n:e===t?1:0})),buffer:[]}})),circlet:e.values.circlet.map((function(e){var n=e.id,t=e.set,i=e.values;return{id:n,set:t,values:r.map((function(e){var n;return null!==(n=i[e])&&void 0!==n?n:e===t?1:0})),buffer:[]}}))}}}function ci(e,n){var t=n.optimizationTargetNode,i=n.nodes,a=n.minimum,s=n.artSetExclusion,o=(0,vn.Uq)(Object.entries(s),(function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return"rainbow"===t?["uniqueKey",i.map((function(e){return e+1}))]:[t,i.flatMap((function(e){return 2===e?[2,3]:[4,5]}))]})),c=i.map((function(e,n){return{value:_n(e),min:a[n]}})).filter((function(e){return e.min>-1/0})),l=_n(t),u=function(e){var n=(0,oe.Z)(e.base),t=(0,oe.Z)(e.base),r=(0,oe.Z)(e.baseBuffer),i=(0,oe.Z)(e.baseBuffer);return Object.values(e.values).forEach((function(e){for(var a=function(e){for(var n=(0,oe.Z)(e[0].values),t=(0,oe.Z)(e[0].values),r=(0,oe.Z)(e[0].buffer),i=(0,oe.Z)(e[0].buffer),a=1;a<e.length;a++){for(var s=0;s<n.length;s++)n[s]=Math.min(n[s],e[a].values[s]),t[s]=Math.max(t[s],e[a].values[s]);for(var o=0;o<r.length;o++)r[o]=Math.min(r[o],e[a].buffer[o]),i[o]=Math.max(i[o],e[a].buffer[o])}return{lower:n,upper:t,minw:r,maxw:i}}(e),s=0;s<n.length;s++)n[s]+=a.lower[s],t[s]+=a.upper[s];for(var o=0;o<r.length;o++)r[o]+=a.minw[o],i[o]+=a.maxw[o]})),{lower:n,upper:t,minw:r,maxw:i}}(e),d=u.lower,f=u.upper,h=Object.fromEntries(e.keys.map((function(e,n){return[e,d[n]]}))),p=Object.fromEntries(e.keys.map((function(e,n){return[e,f[n]]}))),x=[].concat((0,oe.Z)(c.map((function(e){return e.value}))),[l]).map((function(e){return Kn(e,h,p)})),v=x.map((function(n){return function(e,n){var t=[],i=[];Object.entries(n.w).forEach((function(n){var a=(0,r.Z)(n,2),s=a[0],o=a[1];t.push(e.keys.indexOf(s)),i.push(o)}));var a=t.reduce((function(n,t,r){return n+e.base[t]*i[r]}),n.c),s=Object.values(e.values).reduce((function(e,n){return e+Math.max.apply(Math,(0,oe.Z)(n.map((function(e){return t.reduce((function(n,t,r){return n+e.values[t]*i[r]}),0)}))))}),a);return{minw:Object.values(e.values).reduce((function(e,n){return e+Math.min.apply(Math,(0,oe.Z)(n.map((function(e){return t.reduce((function(n,t,r){return n+e.values[t]*i[r]}),0)}))))}),a),maxw:s}}(e,n)}));console.log("-----------------------------------------------------------------------"),console.log("lin",x),console.log("-----------------------------------------------------------------------");var m={cache:!0,optimizationTarget:l,constraints:c,artSetExclusion:o,filters:[{filterVec:(0,vn.O)(T.eV,(function(n){return e.values[n].map((function(e,n){return n}))})),lower:d,upper:f,maxw:v.map((function(e){return e.maxw})),minw:v.map((function(e){return e.minw}))}],depth:0,lin:x},j=si(e,-1/0,m);return console.log(j),void 0===j?m:j}function li(e){for(var n=(0,oe.Z)(e[0].buffer),t=(0,oe.Z)(e[0].buffer),r=1;r<e.length;r++)for(var i=0;i<n.length;i++)n[i]=Math.min(n[i],e[r].buffer[i]),t[i]=Math.max(t[i],e[r].buffer[i]);return{minw:n,maxw:t}}function ui(){var e,n,t=(0,m.$)("page_character").t,i=(0,v.useContext)(C.K).character,a=i.key,s=i.compareData,c=(0,Fn.Z)("GlobalSettings",Vn.c),l=(0,r.Z)(c,1)[0].tcMode,d=(0,v.useContext)(Wn.t).database,h=(0,v.useState)({type:"inactive",tested:0,failed:0,skipped:0,total:0}),p=(0,r.Z)(h,2),Z=p[0],g=p[1],b="inactive"!==Z.type,P=(0,v.useState)(void 0),S=(0,r.Z)(P,2),E=S[0],O=S[1],A=(0,Bn.Z)(),M=(0,r.Z)(A,2),K=M[0],I=M[1],R=Jr(),W=(0,r.Z)(R,2),N=W[0],F=N.equipmentPriority,V=N.threads,L=void 0===V?Hr:V,G=W[1],H=L>Hr?Hr:L,U=(0,v.useCallback)((function(e){return G({threads:e})}),[G]),J=(0,_.Z)(a),X=(0,z.Z)(),Y=(0,v.useMemo)((function(){return!d.arts.values.length}),[d]),Q=At(a),ee=Q.buildSetting,te=Q.buildSettingDispatch,re=ee.plotBase,ie=ee.optimizationTarget,ae=ee.mainStatAssumptionLevel,se=ee.allowPartial,ce=ee.builds,ue=ee.buildDate,de=ee.maxBuildsToShow,xe=ee.levelLow,ve=ee.levelHigh,je=(0,D.Z)(a,ae),Ze=null!==(e=null===je||void 0===je?void 0:je[a])&&void 0!==e?e:{},ge=Ze.characterSheet,ye=Ze.target,be=(0,v.useMemo)((function(){return ce.map((function(e){return e.map((function(e){return d.arts.get(e)}))}))}),[ce,d]),we=be.length,Ce=(0,v.useState)(0),Pe=(0,r.Z)(Ce,2),Se=Pe[0],Ee=Pe[1],Oe=(0,v.useMemo)((function(){return{numPages:Math.ceil(we/di)}}),[we]).numPages,_e=(0,v.useCallback)((function(e,n){Ee(n-1)}),[Ee]);(0,v.useEffect)((function(){return d.arts.followAny(I)}),[I,d]);var Ae=(0,v.useRef)((function(){}));(0,v.useEffect)((function(){return function(){return Ae.current()}}),[]);var De=(0,v.useCallback)((0,Ye.Z)((0,Je.Z)().mark((function e(){var n,t,i,s,o,c,l,u,f,h,p,x,v,m,j,Z,y,b,w,C,k,P,S,E,_,A,M,K,I,R,z,$,W,N,B,V,L,q,G,U,J,X,Y,Q,re,ie,ae,se,ce,le,ue,de,he,pe,xe,ve,je;return(0,Je.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ie=function(e){return{command:"share",sender:e}},re=function(){var e=G.shift();if(e){var n=e.filters.reduce((function(e,n){var t=n.filterVec;return e+T.eV.reduce((function(e,n){return e*t[n].length}),1)}),0);return n<=q?{command:"iterate",threshold:Y.buildValues[x-1],subproblem:e}:{command:"split",threshold:Y.buildValues[x-1],minCount:q,maxIter:L,subproblem:e}}},Q=function(){return{command:"split",minCount:q,maxIter:L,threshold:Y.buildValues[x-1]}},i=ee.artSetExclusion,s=ee.plotBase,o=ee.statFilters,c=ee.mainStatKeys,l=ee.optimizationTarget,u=ee.mainStatAssumptionLevel,f=ee.useExcludedArts,h=ee.useEquippedArts,p=ee.allowPartial,x=ee.maxBuildsToShow,v=ee.levelLow,m=ee.levelHigh,a&&l){e.next=6;break}return e.abrupt("return");case 6:return j=[],h&&(Z=F.indexOf(a),j=Z<0?(0,oe.Z)(F):F.slice(0,Z)),y=d.arts.values.filter((function(e){if(e.level<v)return!1;if(e.level>m)return!1;var n=c[e.slotKey];return!(null!==n&&void 0!==n&&n.length&&!n.includes(e.mainStatKey))&&(e.location===a||!(e.exclude&&!f)&&(!(e.location&&!h)&&!(e.location&&h&&j.includes(e.location))))})),b=ai(y,u,p),e.next=12,(0,D.V)(d,a,u,[]);case 12:if(w=e.sent){e.next=15;break}return e.abrupt("return");case 15:if(C=null===(n=(0,Nn.Qo)(w.teamData,a)[a])||void 0===n?void 0:n.target.data[0]){e.next=18;break}return e.abrupt("return");case 18:if(Object.assign(C,(0,Nn.b3)([C,ii])),k=(0,vn.Hm)(null!==(t=C.display)&&void 0!==t?t:{},l)){e.next=22;break}return e.abrupt("return");case 22:for(P=k,S=Object.entries(o).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return t.endsWith("_")&&(i/=100),{value:me.ri.total[t],minimum:i}})).filter((function(e){return e.value&&e.minimum>-1/0})),O(void 0),E=new Promise((function(e){return Ae.current=e})),_=[].concat((0,oe.Z)(S.map((function(e){return e.value}))),[k]),A=b,M=[].concat((0,oe.Z)(S.map((function(e){return e.minimum}))),[-1/0]),K={tested:0,failed:0,skipped:0,total:NaN,startTime:performance.now()},s&&(_.push(me.ri.total[s]),M.push(-1/0)),_=(0,hn.tL)(_,C,(function(e){return"dyn"!==(0,r.Z)(e.path,1)[0]})),I=qn(_,M,A,x,i,{reaffine:!0,pruneArtRange:!0,pruneNodeRange:!0,pruneOrder:!0}),_=I.nodes,A=I.arts,_=wn(_=$n(_=(0,hn.tL)(_,C,(function(e){return"dyn"!==(0,r.Z)(e.path,1)[0]})),i)),R=bn(A,_),A=R.a,_=R.nodes,_=(0,hn.tL)(_,{},(function(e){return!1})),z=s?_.pop():void 0,k=_.pop(),$=(0,vn.Uq)(Object.entries(i),(function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return"rainbow"===t?["uniqueKey",i.map((function(e){return e+1}))]:[t,i.flatMap((function(e){return 2===e?[2,3]:[4,5]}))]})),console.log({artSetExclFull:$}),W=_.map((function(e,n){return{value:e,min:M[n]}})).filter((function(e){return e.min>-1/0})),N=oi(A),B=ci(N,{optimizationTargetNode:k,nodes:_,minimum:M,artSetExclusion:i}),V={id:-1,ready:!0},L=5,q=2e3,1,G=[B],U=new Set,J=new Set,X=[],Y={buildValues:Array(x).fill(0).map((function(e){return-1/0}))},K.total=Object.values(A.values).reduce((function(e,n){return e*n.length}),1),ae=[],se=function(e){var n=new sn;X.push(n);var t={command:"setup",id:e,arts:A,artsVec:N,optimizationTarget:k,artSetExclusion:i,plotBase:z,maxBuilds:x,filters:W};n.postMessage(t,void 0);var a=void 0,s=new Promise((function(e){return a=e}));n.onmessage=function(){var e=(0,Ye.Z)((0,Je.Z)().mark((function e(t){var i,s,o,c,l,u,d,f,h,p,v,m;return(0,Je.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.data,e.t0=i.command,e.next="interim"===e.t0?4:"split"===e.t0?9:"iterate"===e.t0?14:"finalize"===e.t0?16:"share"===e.t0?19:"count"===e.t0?21:25;break;case 4:return K.tested+=i.tested,K.failed+=i.failed,K.skipped+=i.skipped,i.buildValues&&((s=Y.buildValues).push.apply(s,(0,oe.Z)(i.buildValues)),Y.buildValues.sort((function(e,n){return n-e})).splice(x)),e.abrupt("return");case 9:return G.push.apply(G,(0,oe.Z)(i.subproblems)),i.ready&&i.id===V.id&&(V.ready=!0),i.ready?J.delete(i.id):J.add(i.id),U.add(i.id),e.abrupt("break",26);case 14:return U.add(i.id),e.abrupt("break",26);case 16:return n.terminate(),a(i),e.abrupt("return");case 19:return i.subproblem?(o={command:"split",threshold:Y.buildValues[x-1],minCount:q,maxIter:L,subproblem:i.subproblem},X[i.sender].postMessage(o),J.add(i.sender)):U.add(i.sender),e.abrupt("break",26);case 21:return c=(0,r.Z)(i.counts,2),l=c[0],u=c[1],K.total=u,K.skipped+=u-l,e.abrupt("return");case 25:console.log("DEBUG",i);case 26:d=(0,oe.Z)(U),f=(0,Xe.Z)(d);try{for(f.s();!(h=f.n()).done;)p=h.value,v=X[p],m=void 0,G.length>=1?m=re():J.has(p)&&(m=Q()),m||(m=re()),V.id<0&&(V.id=p,V.ready=!1),m?(U.delete(p),v.postMessage(m)):V.ready||(U.delete(p),X[V.id].postMessage(ie(p)))}catch(j){f.e(j)}finally{f.f()}0===J.size&&U.size===H&&X.forEach((function(e){return e.postMessage({command:"finalize"})}));case 30:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E.then((function(){return n.terminate()})),ae.push(s)},ce=0;ce<H;ce++)se(ce);return le=setInterval((function(){return g((0,fe.Z)({type:"active"},K))}),100),e.next=64,Promise.any([Promise.all(ae),E]);case 64:ue=e.sent,clearInterval(le),Ae.current=function(){},ue?(s&&(pe=tt(ue.map((function(e){return e.plotData}))),xe=me.ri.total[s],ve=Object.values(pe),"%"===ne.ZP.unit(null===(de=P.info)||void 0===de?void 0:de.key)&&(ve=ve.map((function(e){return{value:100*e.value,plot:e.plot}}))),"%"===ne.ZP.unit(null===(he=xe.info)||void 0===he?void 0:he.key)&&(ve=ve.map((function(e){var n=e.value,t=e.plot;return{value:n,plot:100*(null!==t&&void 0!==t?t:0)}}))),O({valueNode:P,plotNode:xe,data:ve})),je=nt(ue.map((function(e){return e.builds})),x),te({builds:je.map((function(e){return e.artifactIds})),buildDate:Date.now()}),Ee(0)):(K.tested=0,K.failed=0,K.skipped=0,K.total=0),g((0,fe.Z)((0,fe.Z)({},K),{},{type:"inactive",finishTime:performance.now()}));case 69:case"end":return e.stop()}}),e)}))),[a,d,te,H,ee,F,Ee]),Me=null!==(n=null===ge||void 0===ge?void 0:ge.name)&&void 0!==n?n:"Character Name",Te=(0,v.useCallback)((function(e){te({plotBase:e}),O(void 0)}),[te]),Ke=(0,v.useMemo)((function(){return ye&&je&&{data:ye,teamData:je}}),[ye,je]);return(0,$.jsxs)(u.Z,{display:"flex",flexDirection:"column",gap:1,children:[Y&&(0,$.jsxs)(en.Z,{severity:"warning",variant:"filled",children:[" Opps! It looks like you haven't added any artifacts to GO yet! You should go to the ",(0,$.jsx)(nn.Z,{component:j.rU,to:"/artifact",children:"Artifacts"})," page and add some!"]}),Ke&&(0,$.jsxs)(k.R.Provider,{value:Ke,children:[(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:(0,$.jsx)(u.Z,{children:(0,$.jsx)(ln.Z,{characterKey:a,onClickTeammate:X})})}),(0,$.jsxs)(le.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:[(0,$.jsxs)(y.Z,{children:[(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(q.Z,{gutterBottom:!0,children:"Main Stat"}),(0,$.jsx)(cn.Z,{placement:"top",title:(0,$.jsxs)(q.Z,{children:[(0,$.jsx)("strong",{children:"Level Assumption"})," changes mainstat value to be at least a specific level. Does not change substats."]}),children:(0,$.jsx)(u.Z,{children:(0,$.jsx)(It,{mainStatAssumptionLevel:ae,setmainStatAssumptionLevel:function(e){return te({mainStatAssumptionLevel:e})},disabled:b})})})]}),(0,$.jsx)(Kr,{disabled:b})]}),(0,$.jsx)(Rt,{})]}),(0,$.jsxs)(le.ZP,{item:!0,xs:12,sm:6,lg:6,display:"flex",flexDirection:"column",gap:1,children:[(0,$.jsx)(Dt,{disabled:b}),(0,$.jsx)(ei,{disabled:b,artsDirty:K}),(0,$.jsx)(Xr,{disabled:b}),(0,$.jsx)(x.Z,{fullWidth:!0,startIcon:se?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:se?"success":"secondary",onClick:function(){return te({allowPartial:!se})},children:t(ni||(ni=(0,Ue.Z)(["tabOptimize.allowPartial"])))}),(0,$.jsxs)(y.Z,{children:[(0,$.jsx)(f.Z,{children:"Artifact Level Filter"}),(0,$.jsx)(on.Z,{levelLow:xe,levelHigh:ve,setLow:function(e){return te({levelLow:e})},setHigh:function(e){return te({levelHigh:e})},setBoth:function(e,n){return te({levelLow:e,levelHigh:n})},disabled:b})]}),(0,$.jsx)($r,{disabled:b})]})]}),(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsxs)(ke.Z,{children:[(0,$.jsx)(x.Z,{disabled:!a||b||!ie||!(0,vn.Hm)(null===ye||void 0===ye?void 0:ye.getDisplay(),ie),color:a?"success":"warning",onClick:De,startIcon:(0,$.jsx)(o.Z,{}),children:"Generate Builds"}),(0,$.jsxs)(un.Z,{disabled:b||!a,title:(0,$.jsxs)("span",{children:[(0,$.jsx)("b",{children:de})," ",1===de?"Build":"Builds"]}),children:[(0,$.jsx)(tn.Z,{children:(0,$.jsx)(q.Z,{variant:"caption",color:"info.main",children:"Decreasing the number of generated build will decrease build calculation time for large number of builds."})}),(0,$.jsx)(B.Z,{}),Ln.s.map((function(e){return(0,$.jsxs)(tn.Z,{onClick:function(){return te({maxBuildsToShow:e})},children:[e," ",1===e?"Build":"Builds"]},e)}))]}),(0,$.jsxs)(un.Z,{disabled:b||!a,title:(0,$.jsxs)("span",{children:[(0,$.jsx)("b",{children:H})," ",1===H?"Thread":"Threads"]}),children:[(0,$.jsx)(tn.Z,{children:(0,$.jsx)(q.Z,{variant:"caption",color:"info.main",children:"Increasing the number of threads will speed up build time, but will use more CPU power."})}),(0,$.jsx)(B.Z,{}),(0,vn.w6)(1,Hr).reverse().map((function(e){return(0,$.jsxs)(tn.Z,{onClick:function(){return U(e)},children:[e," ",1===e?"Thread":"Threads"]},e)}))]}),(0,$.jsx)(x.Z,{disabled:!b,color:"error",onClick:function(){return Ae.current()},startIcon:(0,$.jsx)(Qe.Z,{}),children:"Cancel"})]})}),(0,$.jsxs)(le.ZP,{item:!0,children:[(0,$.jsx)("span",{children:"Optimization Target: "}),(0,$.jsx)(zr.Z,{optimizationTarget:ie,setTarget:function(e){return te({optimizationTarget:e})},disabled:!!b})]})]}),!!a&&(0,$.jsx)(Ft,{status:Z,characterName:Me,maxBuildsToShow:de}),l&&(0,$.jsx)(u.Z,{children:(0,$.jsx)(_r,{disabled:b,chartData:E,plotBase:re,setPlotBase:Te})}),(0,$.jsx)(y.Z,{children:(0,$.jsxs)(f.Z,{children:[(0,$.jsxs)(u.Z,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,$.jsx)(q.Z,{sx:{flexGrow:1},children:ce?(0,$.jsxs)("span",{children:["Showing ",(0,$.jsx)("strong",{children:ce.length})," Builds generated for ",Me,". ",!!ue&&(0,$.jsxs)("span",{children:["Build generated on: ",(0,$.jsx)("strong",{children:new Date(ue).toLocaleString()})]})]}):(0,$.jsx)("span",{children:"Select a character to generate builds."})}),(0,$.jsx)(x.Z,{disabled:!ce.length,color:"error",onClick:function(){return te({builds:[],buildDate:0})},children:"Clear Builds"})]}),(0,$.jsxs)(le.ZP,{container:!0,display:"flex",spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(w.Hn,{size:"small"})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(w.oX,{size:"small"})}),(0,$.jsx)(le.ZP,{item:!0,flexGrow:1}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsxs)(dn.Z,{exclusive:!0,value:s,onChange:function(e,n){return J({compareData:n})},size:"small",children:[(0,$.jsx)(rn.Z,{value:!1,disabled:!s,children:(0,$.jsx)("small",{children:"Show New artifact Stats"})}),(0,$.jsx)(rn.Z,{value:!0,disabled:s,children:(0,$.jsx)("small",{children:"Compare against equipped artifacts"})})]})})]})]})}),Oe>1&&(0,$.jsx)(pi,{numPages:Oe,pageIdx:Se,setPageIdex:_e}),(0,$.jsx)(rr.Provider,{value:ie,children:(0,$.jsx)(fi,{buildsArts:be,characterKey:a,data:ye,compareData:s,disabled:!!b,pageIdx:Se})}),Oe>1&&(0,$.jsx)(pi,{numPages:Oe,pageIdx:Se,setPageIdex:_e})]})]})}var di=5;function fi(e){var n=e.buildsArts,t=e.characterKey,r=e.data,i=e.compareData,a=e.disabled,s=e.pageIdx;return(0,v.useMemo)((function(){return(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:600}),children:null===n||void 0===n?void 0:n.slice(di*s,di*(s+1)).map((function(e,n){return t&&r&&(0,$.jsx)(hi,{characterKey:t,build:e,oldData:r,children:(0,$.jsx)(hr,{index:di*s+n,compareBuild:i,disabled:a})},n+e.join())}))})}),[n,t,r,i,a,s])}function hi(e){var n=e.children,t=e.characterKey,r=e.build,i=e.oldData,a=At(t).buildSetting.mainStatAssumptionLevel,s=(0,D.Z)(t,a,r),o=(0,v.useMemo)((function(){return s&&{data:s[t].target,teamData:s,oldData:i}}),[s,i,t]);return o?(0,$.jsx)(k.R.Provider,{value:o,children:n}):null}function pi(e){var n=e.numPages,t=e.pageIdx,r=e.setPageIdex;return(0,$.jsx)(g.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,children:[(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(an.Z,{count:n,page:t+1,onChange:r})}),(0,$.jsxs)(le.ZP,{item:!0,children:["page ",t+1," / ",n]})]})})})}var xi,vi,mi=t(14361),ji=t(90690),Zi=t(72910),gi=t(2139),yi=t(97719),bi=t(95193),wi=t(30418),Ci=t(15678),ki=t(901),Pi=t(90543),Si=t(44824),Ei=t(70645),Oi=t(46956),_i=t(99405);function Ai(e){var n=e.artId,t=e.weaponId,i=(0,m.$)("page_character").t,a=(0,E.Z)(!1),s=(0,r.Z)(a,3),o=s[0],c=s[1],l=s[2],u=(0,v.useContext)(Wn.t).database,f=(0,v.useContext)(C.K).character,h=f.key,p=f.equippedArtifacts,j=At(h).buildSetting.mainStatAssumptionLevel,Z=(0,v.useContext)(k.R).data,g=(0,v.useMemo)((function(){var e=u.arts.get(null!==n&&void 0!==n?n:""),t=(0,vn.xh)(p,(function(n,t){return t===(null===e||void 0===e?void 0:e.slotKey)?e:u.arts.get(n)}));return Object.values(t)}),[u,p,n]),y=(0,D.Z)(h,j,g,t?u.weapons.get(t):void 0),b=(0,v.useMemo)((function(){return y&&{data:y[h].target,teamData:y,oldData:Z}}),[h,y,Z]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Y.Z,{open:o,onClose:l,containerProps:{maxWidth:"xl"},children:(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:600}),children:b&&(0,$.jsx)(k.R.Provider,{value:b,children:(0,$.jsx)(hr,{compareBuild:!0,extraButtons:(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(w.Hn,{size:"small"}),(0,$.jsx)(w.oX,{size:"small"}),(0,$.jsx)(x.Z,{size:"small",color:"error",onClick:l,children:(0,$.jsx)(Qe.Z,{})})]})})})})}),(0,$.jsx)(gr.Z,{title:(0,$.jsx)(q.Z,{children:i(xi||(xi=(0,Ue.Z)(["tabEquip.compare"])))}),placement:"top",arrow:!0,children:(0,$.jsx)(x.Z,{color:"info",size:"small",onClick:c,children:(0,$.jsx)(_i.Z,{})})})]})}var Di={xs:6,sm:6,md:9,lg:12,xl:12},Mi=(0,v.lazy)((function(){return t.e(23).then(t.bind(t,80367))}));function Ti(e){var n=e.onChangeId,t=e.slotKey,i=e.show,a=e.onClose,s=(0,m.$)("page_character").t,o=(0,v.useContext)(Wn.t).database,c=(0,v.useCallback)((function(e){n(e),a()}),[n,a]),l=(0,v.useCallback)((function(e,n){return(0,fe.Z)((0,fe.Z)((0,fe.Z)({},e),n),{},{slotKeys:[t]})}),[t]),h=(0,v.useReducer)(l,(0,fe.Z)((0,fe.Z)({},(0,Si.Af)()),{},{slotKeys:[t]})),p=(0,r.Z)(h,2),x=p[0],j=p[1],Z=(0,Bn.Z)(),y=(0,r.Z)(Z,2),w=y[0],C=y[1];(0,v.useEffect)((function(){return o.arts.followAny(C)}),[o,C]);var k=(0,Ei.Z)(),P=(0,v.useMemo)((function(){return(0,Si.EM)()}),[]),S=(0,v.useMemo)((function(){var e=(0,Oi.C)(x,P);return w&&o.arts.values.filter(e).map((function(e){return e.id})).slice(0,Di[k])}),[w,o,P,x,k]);return(0,$.jsx)(Y.Z,{open:i,onClose:a,containerProps:{maxWidth:"xl"},children:(0,$.jsxs)(g.Z,{children:[(0,$.jsxs)(f.Z,{sx:{py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,$.jsxs)(q.Z,{variant:"h6",children:[t?(0,$.jsx)(X.Z,{src:Ht.Z.slot[t]}):null," ",s(vi||(vi=(0,Ue.Z)(["tabEquip.swapArt"])))]}),(0,$.jsx)(b.Z,{onClick:a})]}),(0,$.jsx)(B.Z,{}),(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,$.jsx)(Mi,{filterOption:x,filterOptionDispatch:j,disableSlotFilter:!0})}),(0,$.jsx)(u.Z,{mt:1,children:(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:300}),children:(0,$.jsx)(le.ZP,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:S.map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(fr.Z,{artifactId:e,extraButtons:(0,$.jsx)(Ai,{artId:e}),onClick:c})},e)}))})})})]})]})})}var Ki,Ii,Ri,zi,$i,Wi,Ni,Fi=t(58165),Bi=t(75308),Vi=t(66045),Li=(0,Bi.X)((0,oe.Z)(T.wC));function qi(e){var n=e.onChangeId,t=e.weaponTypeKey,i=e.show,a=e.onClose,s=(0,m.$)(["page_character","page_weapon","weaponNames_gen"]).t,o=(0,v.useContext)(Wn.t).database,c=(0,v.useCallback)((function(e){n(e),a()}),[n,a]),l=(0,Bn.Z)(),d=(0,r.Z)(l,2),h=d[0],p=d[1];(0,v.useEffect)((function(){return o.weapons.followAny(p)}),[p,o]);var x=(0,A.Z)((function(){return sr.Z.getAll}),[]),j=(0,v.useMemo)((function(){return x&&(0,Vi.Xg)(x)}),[x]),Z=(0,v.useMemo)((function(){return x&&(0,Vi.Sn)(x)}),[x]),y=(0,v.useState)([5,4,3]),w=(0,r.Z)(y,2),C=w[0],k=w[1],P=(0,v.useState)(""),S=(0,r.Z)(P,2),E=S[0],O=S[1],_=(0,v.useDeferredValue)(E),D=(0,v.useMemo)((function(){var e;return null!==(e=j&&Z&&h&&o.weapons.values.filter((0,Oi.C)({weaponType:t,rarity:C,name:_},j)).sort((0,Oi.e)("level",!1,Z)).map((function(e){return e.id})))&&void 0!==e?e:[]}),[h,o,j,Z,C,t,_]);return(0,$.jsx)(Y.Z,{open:i,onClose:a,children:(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(f.Z,{sx:{py:1},children:(0,$.jsxs)(le.ZP,{container:!0,children:[(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsxs)(q.Z,{variant:"h6",children:[t?(0,$.jsx)(X.Z,{src:Ht.Z.weaponTypes[t]}):null," ",s(Ki||(Ki=(0,Ue.Z)(["page_character:tabEquip.swapWeapon"])))]})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(b.Z,{onClick:a})})]})}),(0,$.jsx)(B.Z,{}),(0,$.jsxs)(f.Z,{children:[(0,$.jsxs)(le.ZP,{container:!0,spacing:1,mb:1,children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(dn.Z,{sx:{height:"100%"},value:C,size:"small",children:T.wC.map((function(e){return(0,$.jsx)(rn.Z,{value:e,onClick:function(){return k(Li(C,e))},children:(0,$.jsxs)(u.Z,{display:"flex",gap:1,children:[(0,$.jsx)("strong",{children:e}),(0,$.jsx)(Et.q,{stars:1})]})},e)}))})}),(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(Fi.Z,{autoFocus:!0,size:"small",value:E,onChange:function(e){return O(e.target.value)},label:s("page_weapon:weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,$.jsx)(le.ZP,{container:!0,spacing:1,children:D.map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:6,sm:6,md:4,lg:3,children:(0,$.jsx)(Pi.Z,{weaponId:e,onClick:c,extraButtons:(0,$.jsx)(Ai,{weaponId:e})})},e)}))})]})]})})}var Gi=(0,v.lazy)((function(){return t.e(849).then(t.bind(t,49268))}));function Hi(){var e,n=(0,v.useContext)(C.K),t=n.character,i=t.equippedWeapon,a=t.key,s=n.characterSheet,o=At(a).buildSetting.mainStatAssumptionLevel,c=(0,v.useContext)(k.R),l=c.teamData,d=c.data,h=null===(e=l[a])||void 0===e?void 0:e.weaponSheet,p=(0,v.useState)(""),x=(0,r.Z)(p,2),m=x[0],j=x[1],Z=(0,v.useCallback)((function(){return j(i)}),[i]),g=(0,v.useCallback)((function(){return j("")}),[]);(0,v.useEffect)((function(){m&&m!==i&&j(i)}),[m,i]);var b=(0,wi.Z)(),w=(0,bi.Z)(b.breakpoints.up("lg")),P=(0,v.useMemo)((function(){return h&&h.document.length>0&&(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsx)(ct.Z,{sections:h.document})})})}),[h]),S=(0,Fn.Z)("charMeta_".concat(a),Vn.B),E=(0,r.Z)(S,1)[0].rvFilter,O=(0,v.useDeferredValue)(E),_=(0,v.useMemo)((function(){return new Set(O)}),[O]);return(0,$.jsxs)(u.Z,{children:[(0,$.jsx)(v.Suspense,{fallback:!1,children:(0,$.jsx)(Gi,{weaponId:m,footer:!0,onClose:g,extraButtons:(0,$.jsx)(Xi,{weaponTypeKey:s.weaponTypeKey})})}),(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[w&&(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:12,lg:3,xl:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[P&&P,(0,$.jsx)(Qi,{})]}),(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:12,lg:9,xl:9,container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:12,sm:6,md:4,display:"flex",flexDirection:"column",gap:1,children:(0,$.jsx)(Pi.Z,{weaponId:i,onEdit:Z,canEquip:!0,extraButtons:(0,$.jsx)(Ji,{weaponTypeKey:s.weaponTypeKey})})}),T.eV.map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:12,sm:6,md:4,children:d.get(me.ri.art[e].id).value?(0,$.jsx)(fr.Z,{artifactId:d.get(me.ri.art[e].id).value,mainStatAssumptionLevel:o,effFilter:_,extraButtons:(0,$.jsx)(Yi,{slotKey:e}),editor:!0,canExclude:!0,canEquip:!0}):(0,$.jsx)(Ui,{slotKey:e})},e)}))]}),!w&&(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:12,xl:3,container:!0,spacing:1,children:[P&&(0,$.jsx)(le.ZP,{item:!0,xs:12,md:6,lg:4,children:P}),(0,$.jsx)(le.ZP,{item:!0,xs:12,md:6,lg:4,sx:{display:"flex",flexDirection:"column",gap:1},children:(0,$.jsx)(Qi,{})})]})]})]})}function Ui(e){var n=e.slotKey,t=(0,v.useContext)(C.K).character.key,i=(0,v.useContext)(Wn.t).database,a=(0,E.Z)(),s=(0,r.Z)(a,3),o=s[0],c=s[1],l=s[2];return(0,$.jsxs)(y.Z,{sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[(0,$.jsx)(f.Z,{children:(0,$.jsx)(q.Z,{children:(0,$.jsx)(Pt.ZP,{slotKey:n})})}),(0,$.jsx)(B.Z,{}),(0,$.jsxs)(u.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,$.jsx)(Ti,{slotKey:n,show:o,onClose:l,onChangeId:function(e){return i.arts.set(e,{location:t})}}),(0,$.jsx)(x.Z,{onClick:c,color:"info",sx:{borderRadius:"1em"},children:(0,$.jsx)(yi.Z,{sx:{height:100,width:100}})})]})]})}function Ji(e){var n=e.weaponTypeKey,t=(0,m.$)("page_character").t,i=(0,v.useContext)(C.K).character.key,a=(0,v.useContext)(Wn.t).database,s=(0,E.Z)(),o=(0,r.Z)(s,3),c=o[0],l=o[1],u=o[2];return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(gr.Z,{title:(0,$.jsx)(q.Z,{children:t(Ii||(Ii=(0,Ue.Z)(["tabEquip.swapWeapon"])))}),placement:"top",arrow:!0,children:(0,$.jsx)(x.Z,{color:"info",size:"small",onClick:l,children:(0,$.jsx)(yi.Z,{})})}),(0,$.jsx)(qi,{weaponTypeKey:n,onChangeId:function(e){return a.weapons.set(e,{location:i})},show:c,onClose:u})]})}function Xi(e){var n=e.weaponTypeKey,t=(0,m.$)("page_character").t,i=(0,v.useContext)(C.K).character.key,a=(0,v.useContext)(Wn.t).database,s=(0,E.Z)(),o=(0,r.Z)(s,3),c=o[0],l=o[1],u=o[2];return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(x.Z,{color:"info",onClick:l,startIcon:(0,$.jsx)(yi.Z,{}),children:t(Ri||(Ri=(0,Ue.Z)(["tabEquip.swapWeapon"])))}),(0,$.jsx)(qi,{weaponTypeKey:n,onChangeId:function(e){return a.weapons.set(e,{location:i})},show:c,onClose:u})]})}function Yi(e){var n=e.slotKey,t=(0,m.$)("page_character").t,i=(0,v.useContext)(C.K).character.key,a=(0,v.useContext)(Wn.t).database,s=(0,E.Z)(),o=(0,r.Z)(s,3),c=o[0],l=o[1],u=o[2];return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(gr.Z,{title:(0,$.jsx)(q.Z,{children:t(zi||(zi=(0,Ue.Z)(["tabEquip.swapArt"])))}),placement:"top",arrow:!0,children:(0,$.jsx)(x.Z,{color:"info",size:"small",onClick:l,children:(0,$.jsx)(yi.Z,{})})}),(0,$.jsx)(Ti,{slotKey:n,show:c,onClose:u,onChangeId:function(e){return a.arts.set(e,{location:i})}})]})}function Qi(){var e,n=(0,m.$)(["page_character","artifact"]).t,t=(0,v.useContext)(Wn.t).database,i=(0,v.useContext)(C.K),a=i.character,s=i.character,o=s.key,c=s.equippedArtifacts,l=(0,v.useContext)(k.R).data,u=(0,A.Z)((function(){return ot.y.getAll}),[]),d=(0,v.useMemo)((function(){return!!Object.values(c).filter((function(e){return e})).length}),[c]),h=(0,v.useCallback)((function(){a&&window.confirm("Do you want to move all currently equipped artifacts to inventory?")&&Object.values(c).forEach((function(e){return t.arts.set(e,{location:""})}))}),[a,t,c]),p=(0,v.useMemo)((function(){return u&&ot.y.setEffects(u,l)}),[u,l]),j=(0,Fn.Z)("charMeta_".concat(o),Vn.B),Z=(0,r.Z)(j,2),b=Z[0].rvFilter,w=Z[1],P=(0,v.useCallback)((function(e){return w({rvFilter:e})}),[w]),S=(0,E.Z)(),O=(0,r.Z)(S,3),_=O[0],D=O[1],M=O[2],T=(0,v.useDeferredValue)(b),K=(0,v.useMemo)((function(){var e=Object.values(c).reduce((function(e,n){var r=t.arts.get(n);if(r){var i=Ut.ZP.getArtifactEfficiency(r,new Set(T)),a=i.currentEfficiency,s=i.maxEfficiency,o=Ut.ZP.getArtifactEfficiency(r,new Set(ti._)),c=o.currentEfficiency,l=o.maxEfficiency;e.currentEfficiency=e.currentEfficiency+a,e.maxEfficiency=e.maxEfficiency+s,e.currentEfficiency_=e.currentEfficiency_+c,e.maxEfficiency_=e.maxEfficiency_+l}return e}),{currentEfficiency:0,currentEfficiency_:0,maxEfficiency:0,maxEfficiency_:0}),r=e.currentEfficiency,i=e.currentEfficiency_,a=e.maxEfficiency,s=e.maxEfficiency_;return{rvField:{text:n($i||($i=(0,Ue.Z)(["artifact:editor.curSubEff"]))),value:r-i?(0,$.jsxs)("span",{children:[(0,$.jsx)(ki.Z,{value:r,max:4500,valid:!0})," / ",(0,$.jsx)(ki.Z,{value:i,max:4500,valid:!0})]}):(0,$.jsx)(ki.Z,{value:r,max:4500,valid:!0})},rvmField:{text:n(Wi||(Wi=(0,Ue.Z)(["artifact:editor.maxSubEff"]))),canShow:function(){return!!(i-s)},value:a-s?(0,$.jsxs)("span",{children:[(0,$.jsx)(ki.Z,{value:a,max:4500,valid:!0})," / ",(0,$.jsx)(ki.Z,{value:s,max:4500,valid:!0})]}):(0,$.jsx)(ki.Z,{value:a,max:4500,valid:!0})}}}),[n,T,c,t]),I=K.rvField,R=K.rvmField;return(0,$.jsxs)(y.Z,{children:[d&&(0,$.jsx)(x.Z,{color:"error",onClick:h,fullWidth:!0,sx:{borderBottomRightRadius:0,borderBottomLeftRadius:0},children:n(Ni||(Ni=(0,Ue.Z)(["tabEquip.unequipArts"])))}),(0,$.jsx)(f.Z,{children:(0,$.jsxs)(ce.Z,{spacing:1,children:[(0,$.jsxs)(g.Z,{children:[(0,$.jsx)(x.Z,{fullWidth:!0,color:"info",startIcon:(0,$.jsx)(at.Z,{}),sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0},onClick:D,children:"RV Filter"}),(0,$.jsx)(Y.Z,{open:_,onClose:M,children:(0,$.jsx)(g.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsx)(Ci.Z,{selectedKeys:b,onChange:P})})})}),(0,$.jsxs)(Te.lD,{children:[(0,$.jsx)(Te.ms,{field:I,component:ue.ZP}),(null===R||void 0===R||null===(e=R.canShow)||void 0===e?void 0:e.call(R,l))&&(0,$.jsx)(Te.ms,{field:R,component:ue.ZP})]})]}),u&&p&&Object.entries(p).flatMap((function(e){var n=(0,r.Z)(e,2),t=n[0];return n[1].map((function(e){return(0,$.jsx)(g.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,$.jsx)(lt,{setKey:t,setNumKey:e},t+e)},t+e)}))}))]})})]})}function ea(){var e=(0,v.useRef)(),n=(0,v.useCallback)((function(){var n,t;return null===e||void 0===e||null===(n=e.current)||void 0===n||null===(t=n.scrollIntoView)||void 0===t?void 0:t.call(n,{behavior:"smooth"})}),[e]);return(0,$.jsxs)(ce.Z,{spacing:1,children:[(0,$.jsxs)(le.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,$.jsx)(le.ZP,{item:!0,xs:8,sm:5,md:4,lg:2.3,children:(0,$.jsx)(ta,{})}),(0,$.jsxs)(le.ZP,{item:!0,xs:12,sm:7,md:8,lg:9.7,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.jsx)(na,{onClick:n}),(0,$.jsx)(y.Z,{sx:{flexGrow:1,p:1},children:(0,$.jsx)(ir,{})})]})]}),(0,$.jsx)(u.Z,{ref:e,children:(0,$.jsx)(Hi,{})})]})}function na(e){var n=e.onClick,t=(0,v.useContext)(C.K).character.equippedWeapon,r=(0,v.useContext)(k.R).data;return(0,$.jsxs)(le.ZP,{container:!0,spacing:1,columns:{xs:2,sm:2,md:3,lg:6,xl:6},children:[(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(lr,{weaponId:t,BGComponent:y.Z,onClick:n})}),T.eV.map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Qt,{artifactId:r.get(me.ri.art[e].id).value,slotKey:e,BGComponent:y.Z,onClick:n})},e)}))]})}function ta(){var e,n=(0,v.useContext)(C.K),t=n.characterSheet,i=n.character,a=i.key,s=i.team,o=(0,v.useContext)(k.R).data,c=(0,_.Z)(a),l=(0,Z.s0)(),d=o.get(me.ri.charEle).value,h=t.weaponTypeKey,p=o.get(me.ri.lvl).value,x=o.get(me.ri.asc).value,m=o.get(me.ri.constellation).value,j={auto:o.get(me.ri.total.auto).value,skill:o.get(me.ri.total.skill).value,burst:o.get(me.ri.total.burst).value},g={auto:o.get(me.ri.bonus.auto).value,skill:o.get(me.ri.bonus.skill).value,burst:o.get(me.ri.bonus.burst).value},b=(0,Fn.Z)("charMeta_".concat(a),Vn.B),w=(0,r.Z)(b,2),P=w[0].favorite,S=w[1];return(0,$.jsxs)(y.Z,{sx:{height:"100%"},children:[(0,$.jsxs)(u.Z,{sx:{position:"relative"},children:[(0,$.jsxs)(u.Z,{sx:{position:"absolute",width:"100%",height:"100%"},children:[(0,$.jsx)(q.Z,{variant:"h6",sx:{position:"absolute",left:"50%",bottom:0,transform:"translate(-50%, -50%)",opacity:.75},children:(0,$.jsx)(Et.q,{stars:t.rarity,colored:!0})}),(0,$.jsx)(u.Z,{sx:{position:"absolute",left:"50%",bottom:"5%",transform:"translate(-50%, -50%)",opacity:.85,width:"100%",display:"flex",justifyContent:"center",px:1},children:(0,$.jsx)(xe.Z,{color:d,sx:{height:"auto"},label:(0,$.jsxs)(q.Z,{variant:"h6",sx:{display:"flex",gap:1,alignItems:"center"},children:[we.hJ[d],(0,$.jsx)(u.Z,{sx:{whiteSpace:"normal",textAlign:"center"},children:t.name}),(0,$.jsx)(X.Z,{src:null===(e=Ht.Z.weaponTypes)||void 0===e?void 0:e[h]})]})})}),(0,$.jsx)(u.Z,{sx:{position:"absolute",left:0,top:0},children:(0,$.jsx)(ge.Z,{sx:{p:1},color:"error",onClick:function(){return S({favorite:!P})},children:P?(0,$.jsx)(mi.Z,{}):(0,$.jsx)(ji.Z,{})})}),(0,$.jsx)(q.Z,{sx:{p:1,position:"absolute",right:0,top:0,opacity:.8},children:(0,$.jsx)(Q.Z,{children:(0,gi.wQ)(p,x)})})]}),(0,$.jsx)(u.Z,{src:t.cardImg,component:"img",width:"100%",height:"auto"})]}),(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(Lt.Z,{sx:{p:1},onClick:function(){return l("talent")},children:(0,$.jsx)(le.ZP,{container:!0,spacing:1,mt:-1,children:["auto","skill","burst"].map((function(e){var n;return(0,$.jsx)(le.ZP,{item:!0,xs:4,children:(0,$.jsx)(Zi.Z,{badgeContent:j[e],color:g[e]?"info":"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{width:"100%",height:"100%","& > .MuiBadge-badge":{fontSize:"1.25em",padding:".25em .4em",borderRadius:".5em",lineHeight:1,height:"1.25em"}},children:(0,$.jsx)(u.Z,{component:"img",src:null===(n=t.getTalentOfKey(e,d))||void 0===n?void 0:n.img,width:"100%",height:"auto"})})},e)}))})}),(0,$.jsx)(q.Z,{sx:{textAlign:"center",mt:1},variant:"h6",children:t.constellationName}),(0,$.jsx)(le.ZP,{container:!0,spacing:1,children:(0,vn.w6)(1,6).map((function(e){var n;return(0,$.jsx)(le.ZP,{item:!0,xs:4,children:(0,$.jsx)(Lt.Z,{onClick:function(){return c({constellation:e===m?e-1:e})},children:(0,$.jsx)(u.Z,{component:"img",src:null===(n=t.getTalentOfKey("constellation".concat(e),d))||void 0===n?void 0:n.img,sx:(0,fe.Z)({},m>=e?{}:{filter:"brightness(50%)"}),width:"100%",height:"auto"})})},e)}))}),(0,$.jsx)(Lt.Z,{sx:{p:1},onClick:function(){return l("teambuffs")},children:(0,$.jsx)(le.ZP,{container:!0,columns:3,spacing:1,children:(0,vn.w6)(0,2).map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:1,height:"100%",children:(0,$.jsx)(qr.Z,{characterKey:s[e],index:e})},e)}))})})]})]})}var ra={xs:12,sm:6,md:4};function ia(){var e=(0,v.useContext)(C.K),n=e.character,t=e.characterSheet,i=(0,v.useContext)(k.R).data,a=(0,_.Z)(n.key),s=i.get(me.ri.charEle).value,o=i.get(me.ri.asc).value,c=i.get(me.ri.constellation).value,l=(0,wi.Z)(),d=(0,bi.Z)(l.breakpoints.up("lg")),h=(0,v.useMemo)((function(){return(0,vn.w6)(1,6).map((function(e){return(0,$.jsx)(oa,{talentKey:"constellation".concat(e),subtitle:"Constellation Lv. ".concat(e),onClickTitle:function(){return a({constellation:e===c?e-1:e})}})}))}),[c,a]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(aa,{}),(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[d&&(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(q.Z,{variant:"h6",sx:{textAlign:"center"},children:["Constellation Lv. ",c]})})}),h.map((function(e,n){return(0,$.jsx)(u.Z,{sx:{opacity:c>=n+1?1:.5},children:e},n)}))]}),(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:[[["auto","Normal/Charged Attack"],["skill","Elemental Skill"],["burst","Elemental Burst"]].map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},ra),{},{children:(0,$.jsx)(oa,{talentKey:t,subtitle:i})}),t)})),!!t.getTalentOfKey("sprint",s)&&(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},ra),{},{children:(0,$.jsx)(oa,{talentKey:"sprint",subtitle:"Alternative Sprint"})})),!!t.getTalentOfKey("passive",s)&&(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0},ra),{},{children:(0,$.jsx)(oa,{talentKey:"passive",subtitle:"Passive"})})),[["passive1","Unlocked at Ascension 1",1],["passive2","Unlocked at Ascension 4",4],["passive3","Unlocked by Default",0]].map((function(e){var n=(0,r.Z)(e,3),i=n[0],a=n[1],c=n[2],l=o>=c;return t.getTalentOfKey(i,s)?(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0,style:{opacity:l?1:.5}},ra),{},{children:(0,$.jsx)(oa,{talentKey:i,subtitle:a})}),i):null}))]}),!d&&(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:12,children:(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(q.Z,{variant:"h6",sx:{textAlign:"center"},children:["Constellation Lv. ",c]})})})}),h.map((function(e,n){return(0,$.jsx)(le.ZP,(0,fe.Z)((0,fe.Z)({item:!0,sx:{opacity:c>=n+1?1:.5}},ra),{},{children:e}),n)}))]})]})]})}function aa(){var e=(0,v.useContext)(k.R).data.getDisplay().reaction;return(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsx)(le.ZP,{container:!0,spacing:1,children:Object.entries(e).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(g.Z,{children:(0,$.jsx)(f.Z,{sx:{p:1,"&:last-child":{pb:1}},children:(0,$.jsx)(Te.JW,{node:i})})})},t)}))})})})}var sa=[1,1,2,4,6,8,10];function oa(e){var n=e.talentKey,t=e.subtitle,r=e.onClickTitle,i=(0,v.useContext)(C.K),a=i.character.talent,s=i.characterSheet,o=i.characterDispatch,c=(0,v.useContext)(k.R).data,l=(0,v.useCallback)((function(e){return(0,$.jsx)(Lt.Z,{onClick:r,children:e})}),[r]),d=(0,v.useCallback)((function(e,n){return o({talent:(0,fe.Z)((0,fe.Z)({},a),{},(0,xn.Z)({},e,n))})}),[a,o]),h=null;if(n in a){var p=c.get(me.ri.bonus[n]).value,x=c.get(me.ri.total[n]).value,m=c.get(me.ri.asc).value;h=(0,$.jsx)(un.Z,{fullWidth:!0,title:"Talent Lv. ".concat(x),color:p?"info":"primary",sx:{borderRadius:0},children:(0,vn.w6)(1,sa[m]).map((function(e){return(0,$.jsxs)(tn.Z,{selected:a[n]===e,disabled:a[n]===e,onClick:function(){return d(n,e)},children:["Talent Lv. ",e+p]},e)}))})}var j=s.getTalentOfKey(n,c.get(me.ri.charEle).value);return(0,$.jsxs)(y.Z,{sx:{height:"100%"},children:[h,(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(Xt.Z,{condition:!!r,wrapper:l,children:(0,$.jsxs)(le.ZP,{container:!0,sx:{flexWrap:"nowrap"},children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(u.Z,{component:"img",src:null===j||void 0===j?void 0:j.img,sx:{width:60,height:"auto"}})}),(0,$.jsxs)(le.ZP,{item:!0,flexGrow:1,sx:{pl:1},children:[(0,$.jsx)(q.Z,{variant:"h6",children:null===j||void 0===j?void 0:j.name}),(0,$.jsx)(q.Z,{variant:"subtitle1",children:t})]})]})}),null!==j&&void 0!==j&&j.sections?(0,$.jsx)(ct.Z,{sections:j.sections,hideDesc:!0,hideHeader:function(e){var t,r=null===(t=e.header)||void 0===t?void 0:t.action;return!(!r||"string"===typeof r)&&r.props.children.props.key18.includes(n)}}):null]})]})}var ca=t(43992),la=t(31038),ua=t(11741);function da(){return(0,$.jsx)(de.Z,{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch",children:(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsxs)(le.ZP,{item:!0,xs:12,md:6,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.jsx)(fa,{}),(0,$.jsx)(ha,{})]}),(0,vn.w6)(0,2).map((function(e){return(0,$.jsx)(le.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,$.jsx)(pa,{index:e})},e)}))]})})}function fa(){var e,n,t,i=(0,v.useContext)(k.R),a=i.data,s=i.oldData,o=a.getTeamBuff(),c=[];return Object.entries(null!==(e=o.total)&&void 0!==e?e:{}).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return!i.isEmpty&&0!==i.value&&c.push([["total",t],i])})),Object.entries(null!==(n=o.premod)&&void 0!==n?n:{}).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return!i.isEmpty&&0!==i.value&&c.push([["premod",t],i])})),Object.entries(null!==(t=o.enemy)&&void 0!==t?t:{}).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return!i.isEmpty&&"number"===typeof i.value&&0!==i.value&&c.push([["enemy",t],i])})),c.length?(0,$.jsxs)(y.Z,{children:[(0,$.jsx)(f.Z,{children:(0,$.jsx)(q.Z,{children:"Team Buffs"})}),(0,$.jsx)(B.Z,{}),(0,$.jsx)(f.Z,{children:(0,$.jsx)(le.ZP,{container:!0,children:c.map((function(e,n){var t,i,a=(0,r.Z)(e,2),o=a[0],c=a[1];return c&&(0,$.jsx)(le.ZP,{item:!0,xs:12,children:(0,$.jsx)(Te.JW,{node:c,oldValue:null===(i=(0,vn.Hm)(null===s||void 0===s?void 0:s.getTeamBuff(),o))||void 0===i?void 0:i.value})},(null!==(t=c.info.key)&&void 0!==t?t:"")+n)}))})})]}):null}function ha(){var e=(0,v.useContext)(k.R).data;return(0,$.jsx)($.Fragment,{children:ua.J.map((function(n,t){var r=(0,$.jsx)(St.Z,{title:(0,$.jsx)(q.Z,{children:n.desc})}),i=(0,$.jsxs)("span",{children:[n.name," ",r]});return(0,$.jsxs)(y.Z,{sx:{opacity:n.canShow(e)?1:.5},children:[(0,$.jsx)(F.Z,{title:i,action:n.icon,titleTypographyProps:{variant:"subtitle2"}}),n.canShow(e)&&(0,$.jsx)(B.Z,{}),n.canShow(e)&&(0,$.jsx)(f.Z,{children:(0,$.jsx)(ct.Z,{sections:n.sections,teamBuffOnly:!0,hideDesc:!0})})]},t)}))})}function pa(e){var n=e.index,t=(0,v.useContext)(k.R).teamData,r=(0,m.$)("page_character").t,i=(0,v.useContext)(C.K),a=i.character,s=i.character.key,o=i.characterDispatch,c=a.team[n],l=(0,z.Z)(),u=t[c],d=(0,v.useMemo)((function(){var e;return u&&{character:(0,fe.Z)((0,fe.Z)({},u.character),{},{conditional:null!==(e=a.teamConditional[c])&&void 0!==e?e:{}}),characterSheet:u.characterSheet,characterDispatch:function(e){if(c&&"conditional"in e){var n=e.conditional;o({type:"teamConditional",teamMateKey:c,conditional:n})}}}}),[a,c,u,o]),f=(0,v.useMemo)((function(){return u&&{data:u.target,teamData:t}}),[u,t]);return(0,$.jsxs)(y.Z,{children:[(0,$.jsx)(la.Z,{fullWidth:!0,value:c,onChange:function(e){return o({type:"team",index:n,charKey:e})},disable:function(e){return e===s||""!==e&&a.team.includes(e)},labelText:r("teammate",{count:n+1}),defaultText:r("none"),defaultIcon:(0,$.jsx)(ca.Z,{}),showDefault:!0}),d&&(0,$.jsx)(C.K.Provider,{value:d,children:f&&(0,$.jsx)(k.R.Provider,{value:f,children:(0,$.jsx)(ln.Z,{characterKey:c,onClickHeader:l,artifactChildren:(0,$.jsx)(C.K.Provider,{value:d,children:(0,$.jsx)(k.R.Provider,{value:f,children:(0,$.jsx)(xa,{})})}),weaponChildren:(0,$.jsx)(C.K.Provider,{value:d,children:(0,$.jsx)(k.R.Provider,{value:f,children:(0,$.jsx)(va,{})})}),characterChildren:(0,$.jsx)(C.K.Provider,{value:d,children:(0,$.jsx)(k.R.Provider,{value:f,children:(0,$.jsx)(ma,{})})}),isTeammateCard:!0})})})]})}function xa(){var e=(0,v.useContext)(k.R).data,n=(0,A.Z)((function(){return ot.y.getAll}),[]),t=(0,v.useMemo)((function(){return n&&Object.entries(ot.y.setEffects(n,e)).flatMap((function(e){var t=(0,r.Z)(e,2),i=t[0];return t[1].flatMap((function(e){return n[i].setEffectDocument(e)}))}))}),[n,e]);return t?(0,$.jsx)(ct.Z,{sections:t,teamBuffOnly:!0}):null}function va(){var e=(0,v.useContext)(C.K).character.key,n=(0,v.useContext)(k.R).teamData[e].weaponSheet;return n.document?(0,$.jsx)(ct.Z,{sections:n.document,teamBuffOnly:!0}):null}function ma(){var e=(0,v.useContext)(C.K).character.key,n=(0,v.useContext)(k.R),t=n.data,r=n.teamData[e].characterSheet.getTalent(t.get(me.ri.charEle).value),i=Object.values(r.sheets).flatMap((function(e){return e.sections}));return i?(0,$.jsx)(ct.Z,{sections:i,teamBuffOnly:!0}):null}function ja(e,n,t){var r=!0;return(0,pn.aD)([e],(function(e){}),(function(e){var i=e.operation;if("read"===i){if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported [".concat(i,"] node in zero_deriv"));n(e)===t&&(r=!1)}})),r}function Za(e,n,t){var i=e.operation;switch(i){case"read":if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported [".concat(i,"] node in d/dx"));return n(e)===t?(0,fn.a9)(1):(0,fn.a9)(0);case"const":return(0,fn.a9)(0);case"res":if(!ja(e,n,t))throw new Error("[".concat(i,"] node takes only constant inputs. ").concat(e));return(0,fn.a9)(0);case"add":return fn.Sm.apply(void 0,(0,oe.Z)(e.operands.map((function(e){return Za(e,n,t)}))));case"mul":var a=e.operands.map((function(r,i){return fn.WV.apply(void 0,[Za(r,n,t)].concat((0,oe.Z)(e.operands.filter((function(e,n){return n!==i})))))}));return fn.Sm.apply(void 0,(0,oe.Z)(a));case"sum_frac":var s=e.operands[0],o=Za(s,n,t),c=fn.Sm.apply(void 0,(0,oe.Z)(e.operands.slice(1))),l=Za(c,n,t),u=(0,fn.WV)(fn.Sm.apply(void 0,(0,oe.Z)(e.operands)),fn.Sm.apply(void 0,(0,oe.Z)(e.operands))),d=(0,fn.Sm)((0,fn.WV)(c,o),(0,fn.WV)(-1,s,l));return{operation:"sum_frac",operands:[d,(0,fn.WV)(d,-1),u]};case"min":case"max":switch(e.operands.length){case 1:return Za(e.operands[0],n,t);case 2:var f=(0,r.Z)(e.operands,2),h=f[0],p=f[1];if("min"===i)return(0,fn.ER)(h,p,Za(p,n,t),Za(h,n,t));if("max"===i)return(0,fn.ER)(h,p,Za(h,n,t),Za(p,n,t));(0,vn.UT)(i);break;default:throw new Error("[".concat(i,"] node operates on only 1 or 2 arguments. ").concat(e))}break;case"threshold":var x=(0,r.Z)(e.operands,4),v=x[0],m=x[1],j=x[2],Z=x[3];if(!ja(v,n,t)||!ja(m,n,t))throw new Error("[".concat(i,"] node must branch on constant inputs. ").concat(e));return(0,fn.ER)(v,m,Za(j,n,t),Za(Z,n,t));case"match":case"lookup":case"subscript":case"data":throw new Error("Unsupported [".concat(i,"] node in ddx"));default:(0,vn.UT)(i)}}var ga=[[1],[1,1,1,1],[1,2,3,4,3,2,1],[1,3,6,10,12,12,10,6,3,1],[1,4,10,20,31,40,44,40,31,20,10,4,1],[1,5,15,35,65,101,135,155,155,135,101,65,35,15,5,1]];function ya(e,n){for(var t;e>=ga.length;){for(var r=ga.length,i=[],a=0,s=r-1;a<=3*r;a++){var o,c,l,u,d=null!==(o=ga[s][a-3])&&void 0!==o?o:0,f=null!==(c=ga[s][a-2])&&void 0!==c?c:0,h=null!==(l=ga[s][a-1])&&void 0!==l?l:0,p=null!==(u=ga[s][a])&&void 0!==u?u:0;i[a]=d+f+h+p}ga.push(i)}return null!==(t=ga[e][n])&&void 0!==t?t:0}function ba(e,n,t){return void 0===n&&(n=0),void 0===t&&(t=1),t<=0?0:Math.exp(-(n-e)*(n-e)/t/2)/Math.sqrt(2*Math.PI*t)}var wa=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.reduce((function(e,n){return e.flatMap((function(e){return n.map((function(n){return[e,n].flat()}))}))}))},Ca=[270/1024,80/1024,0,12/256,8/256,120/1024,0,60/1024,4/256,60/1024,4/256,30/1024,24/256,.15625,1/64,1/64,24/256,1/64,12/256,0,6/256,2/16,6/256,0,81/256,.0625,0,27/64,12/64,0,1/16,1/16,12/64,1/16,6/64,3/4,.5,243/1024,.03125,0,108/256,.125,0,9/64,6/64,.1875,0,24/256,3/64,5/1024,3/64,5/1024,0,405/1024,80/1024,0,54/256,90/1024,40/1024,0,1/256,1/256,40/1024,1/256,20/1024,9/16,.25,0,1/4,1/4,0,1/4,27/64,8/64,0,6/16,.25,10/1024,0,10/1024,2/16,0,0,0,15/1024,10/1024,1/1024,1/1024,0,1/1024],ka=[35,64,70,21,33,45,12,0,53,76,48,86];function Pa(e,n){var t=e.reduce((function(e,n){return e+n}));if(e.length>4||t>n)return 0;if(4===e.length&&t!==n)return 0;3===e.length&&(e=[].concat((0,oe.Z)(e),[n-t])),e.sort().reverse();var r=13*n+e.length-14+16*e[0];e.length>1&&(r+=4*e[1]);var i=r%12,a=Math.trunc(r/12);return Ca[i+ka[a]]}function Sa(e,n){if(0!==e)for(var t=e;t>=0;t--)for(var r=e-t;r>=0;r--)for(var i=e-t-r;i>=0;i--){var a=e-t-r-i;n([t,r,i,a],Pa([t,r,i,a],e))}else n([0,0,0,0],1)}function Ea(e){var n=e.statsBase,t=e.rollsLeft,r=e.subs,i=e.skippableDerivs,a=e.fourthsubOpts,s=e.evalFn,o=function(e){return e.endsWith("_")?Ut.ZP.substatValue(e,5)/1e3:Ut.ZP.substatValue(e,5)/10},c=n,l=[];return Sa(t,(function(e,n){a&&(e[3]+=1);var t=e.map((function(e,n){if(a&&3===n)return(0,vn.w6)(7*e,10*e);var t=r[n];return t&&!i[ti._.indexOf(t)]?(0,vn.w6)(7*e,10*e):[NaN]}));wa.apply(void 0,(0,oe.Z)(t)).forEach((function(t){for(var i=(0,fe.Z)({},c),u=1,d=0;d<3;d++){var f;if(!isNaN(t[d])){var h=r[d],p=t[d],x=e[d];i[h]=(null!==(f=i[h])&&void 0!==f?f:0)+p*o(h);var v=Math.pow(4,-x)*ya(x,p-7*x);u*=v}}if(void 0===a){if(!isNaN(t[3])){var m,j=r[3],Z=t[3],g=e[3];i[j]=(null!==(m=i[j])&&void 0!==m?m:0)+Z*o(j);var y=Math.pow(4,-g)*ya(g,Z-7*g);u*=y}l.push({v:s(i).map((function(e){return e.v})),p:n*u})}else a.forEach((function(r){var a,c=r.sub,d=r.subprob,f=(0,fe.Z)({},i),h=c,p=t[3],x=e[3];f[h]=(null!==(a=f[h])&&void 0!==a?a:0)+p*o(h);var v=Math.pow(4,-x)*ya(x,p-7*x)*d,m=u*v;l.push({v:s(f).map((function(e){return e.v})),p:n*m})}))}))})),l}var Oa=t(61503);function _a(e,n,t){if(n<1e-5)return e>t?{p:1,upAvg:e-t}:{p:0,upAvg:0};var r=(t-e)/Math.sqrt(n),i=(1-function(e){var n=1;e<0&&(n=-1);var t=1/(1+.3275911*(e=Math.abs(e)));return n*(1-((((1.061405429*t-1.453152027)*t+1.421413741)*t-.284496736)*t+.254829592)*t*Math.exp(-e*e))}(r/Math.sqrt(2)))/2;if(r>5){var a=1/r,s=a*a;return{p:i,upAvg:Math.sqrt(n)*a*(1-2*s*(1-s*(5+37*s)))}}var o=Math.exp(-r*r/2)/Math.sqrt(2*Math.PI);return{p:i,upAvg:e-t+Math.sqrt(n)*o/i}}function Aa(e){var n={};return Object.values(e).forEach((function(e){e&&Object.entries(e.values).forEach((function(e){var t,i=(0,r.Z)(e,2),a=i[0],s=i[1];return n[a]=(null!==(t=n[a])&&void 0!==t?t:0)+s}))})),n}function Da(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,fe.Z)({},e.curBuild);i[n.slot]=n;var a=Aa(i),s=(0,fe.Z)({},a),o=function(e){return e.endsWith("_")?Ut.ZP.substatValue(e,n.rarity)/1e3:Ut.ZP.substatValue(e,n.rarity)/10},c=Ut.ZP.rollsRemaining(n.level,n.rarity)-(4-n.subs.length);if(4===n.subs.length&&(r=!1),r){var l=Object.keys(n.values).filter((function(e){return!n.subs.includes(e)})).filter((function(e){return!T.q2.includes(e)}));if(1!==l.length)throw Error("Failed to extract artifact main stat");var u=l[0],d=ti._.filter((function(e){return!n.subs.includes(e)&&e!==u})),f=d.map((function(i){var s=[].concat((0,oe.Z)(n.subs),[i]),l={rollsLeft:c,subs:s,calc4th:r,stats:a,thresholds:e.thresholds,objectiveEval:function(n){return e.evalFn(n).map((function(e){var n=e.v,t=e.grads;return{v:n,ks:s.map((function(e){return t[ti._.indexOf(e)]*o(e)}))}}))},scale:o},d=t?Ta(l):Ma(l);return(0,fe.Z)((0,fe.Z)({},d),{},{p2:Wa(i,[].concat((0,oe.Z)(n.subs),[u]))})})),h=f.reduce((function(e,n){return e+n.prob*n.p2}),0),p=h<1e-6?0:f.reduce((function(e,n){return e+n.prob*n.p2*n.upAvg}),0)/h,x=f.reduce((function(e,n){var t,r=n.p2,i=n.distr;return e.lower=Math.min(e.lower,i.lower),e.upper=Math.max(e.upper,i.upper),(t=e.gmm).push.apply(t,(0,oe.Z)(i.gmm.map((function(e){var n=e.phi,t=e.cp,i=e.mu,a=e.sig2;return{phi:r*n,cp:t,mu:i,sig2:a}})))),e}),{gmm:[],lower:1/0,upper:-1/0});return{id:n.id,subs:n.subs,fourthsubOpts:d.map((function(e){return{sub:e,subprob:Wa(e,[].concat((0,oe.Z)(n.subs),[u]))}})),rollsLeft:c,statsBase:s,prob:h,upAvg:p,distr:x,evalFn:e.evalFn,skippableDerivs:e.skippableDerivs,thresholds:e.thresholds,evalMode:t?"slow":"fast"}}var v={rollsLeft:c,subs:n.subs,calc4th:r,stats:a,thresholds:e.thresholds,objectiveEval:function(t){return e.evalFn(t).map((function(e){var t=e.v,r=e.grads;return{v:t,ks:n.subs.map((function(e){return r[ti._.indexOf(e)]*o(e)}))}}))},scale:o},m=t?Ta(v):Ma(v);return(0,fe.Z)((0,fe.Z)({id:n.id,subs:n.subs,rollsLeft:c,statsBase:s},m),{},{evalFn:e.evalFn,skippableDerivs:e.skippableDerivs,thresholds:e.thresholds,evalMode:t?"slow":"fast"})}function Ma(e){var n=e.rollsLeft,t=e.subs,r=e.stats,i=e.thresholds,a=e.calc4th,s=e.scale,o=e.objectiveEval,c=(0,fe.Z)({},r);t.forEach((function(e,t){var r,i=a&&3===t?1:0;c[e]=(null!==(r=c[e])&&void 0!==r?r:0)+8.5*(n/4+i)*s(e)}));for(var l=n,u=o(c),d=1,f=-1,h={gmm:[],lower:u[0].v,upper:u[0].v},p=0;p<u.length;p++){var x=u[p],v=x.v,m=x.ks,j=m.reduce((function(e,n){return e+n})),Z=v,g=(147/8*m.reduce((function(e,n){return e+n*n}),0)-289/64*j*j)*l+(a?5/4*m[3]*m[3]:0),y=_a(Z,g,i[p]),b=y.p,w=y.upAvg;0===p&&(f=w,h={gmm:[{phi:1,mu:Z,sig2:g,cp:1}],lower:Z-4*Math.sqrt(g),upper:Z+4*Math.sqrt(g)}),d=Math.min(b,d)}return{prob:d,upAvg:f,distr:h}}function Ta(e){var n=e.rollsLeft,t=e.stats,r=e.subs,i=e.thresholds,a=e.calc4th,s=e.scale,o=e.objectiveEval,c={gmm:[],lower:i[0],upper:i[0]},l=[];Sa(n,(function(e,n){var u=(0,fe.Z)({},t);a&&(e[3]+=1),r.forEach((function(n,t){var r;u[n]=(null!==(r=u[n])&&void 0!==r?r:0)+8.5*e[t]*s(n)}));var d=o(u),f=d.map((function(e){return e.v})),h=d.map((function(n){return d.map((function(t){return n.ks.reduce((function(r,i,a){return r+n.ks[a]*t.ks[a]*e[a]}),0)}))})),p=function(e,n,t){var r=new Oa.Y.MVNHandle(e.length);try{return t.forEach((function(e){return r.pushX(e)})),e.forEach((function(e){return r.pushMu(e)})),n.forEach((function(e){return e.forEach((function(e){return r.pushCov(e)}))})),r.compute(),{p:r.p,upAvg:r.Eup,cp:r.cp}}finally{r.delete()}}(f,h,i);l.push((0,fe.Z)({l:n},p)),c.gmm.push({phi:n,mu:f[0],sig2:h[0][0],cp:p.cp}),c.lower=Math.min(c.lower,f[0]-4*Math.sqrt(h[0][0])),c.upper=Math.max(c.upper,f[0]+4*Math.sqrt(h[0][0]))}));var u=0,d=0;return l.forEach((function(e){var n=e.l,t=e.p,r=e.upAvg,i=e.cp;u+=n*t*i,d+=n*t*i*r})),u<1e-10?{prob:0,upAvg:0,distr:c}:{prob:u,upAvg:d/=u,distr:c}}function Ka(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=[];e.forEach((function(e){a.push.apply(a,[e].concat((0,oe.Z)(ti._.map((function(n){return Za(e,(function(e){return e.path[1]}),n)})))))}));var s=(0,hn.tL)(a,i,(function(e){return"dyn"!==(0,r.Z)(e.path,1)[0]}));s=(0,hn.tL)(s,i,(function(e){return"dyn"!==(0,r.Z)(e.path,1)[0]}));var o=(0,hn.I3)(s,(function(e){return e.path[1]})),c=(0,r.Z)(o,3),l=c[0],u=c[1],d=c[2],f=Aa(t);zn(f,u,d);var h=l()[0],p=ti._.map((function(n){return e.every((function(e){return ja(e,(function(e){return e.path[1]}),n)}))})),x=function(n){Object.values(u).forEach((function(e){return d[e]=0})),zn(n,u,d);var t=l();return e.map((function(e,n){var r=n*(1+ti._.length);return{v:t[r],grads:ti._.map((function(e,n){return t[r+1+n]}))}}))};return{formulas:e,thresholds:[h].concat((0,oe.Z)(n)),curBuild:t,evalFn:x,skippableDerivs:p}}function Ia(e,n){var t;void 0===n&&(n=e.level);var r=Ut.ZP.mainStatValue(e.mainStatKey,e.rarity,n),i={id:e.id,slot:e.slotKey,level:e.level,rarity:e.rarity,values:(0,fe.Z)((t={},(0,xn.Z)(t,e.setKey,1),(0,xn.Z)(t,e.mainStatKey,e.mainStatKey.endsWith("_")?r/100:r),t),Object.fromEntries(e.substats.map((function(e){return[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]})))),subs:e.substats.reduce((function(e,n){return""!==n.key&&e.push(n.key),e}),[])};return delete i.values[""],i}function Ra(e,n){if(n.prob>1e-5||e.prob>1e-5)return n.prob*n.upAvg-e.prob*e.upAvg;var t=e.distr.gmm.reduce((function(e,n){return e+n.phi*n.mu}),0);return n.distr.gmm.reduce((function(e,n){return e+n.phi*n.mu}),0)-t}var za={hp:6,atk:6,def:6,hp_:4,atk_:4,def_:4,eleMas:4,enerRech_:4,critRate_:3,critDMG_:3},$a=Object.values(za).reduce((function(e,n){return e+n}));function Wa(e,n){if(n.includes(e))return 0;var t=$a-n.reduce((function(e,n){var t;return e+(null!==(t=za[n])&&void 0!==t?t:0)}),0);return za[e]/t}var Na=t(17684),Fa=t(18602),Ba=t(94783),Va=t(48004),La=t(35667);var qa=50;function Ga(e){var n=e.upgradeOpt,t=e.objMin,i=e.objMax,a=(0,v.useState)(!1),s=(0,r.Z)(a,2),o=s[0],c=s[1],l=(0,v.useContext)(Wn.t).database,d=l.arts.get(n.id);if(!d)throw new Error("artifact ".concat(n.id," not found."));var h=n.thresholds.length>1,p=d.slotKey,m=(0,v.useContext)(k.R).data,j=(0,v.useMemo)((function(){return T.eV.map((function(e){var n;return[e,l.arts.get(null!==(n=m.get(me.ri.art[e].id).value)&&void 0!==n?n:"")]}))}),[m,l]),Z=function(e){return n.distr.gmm.reduce((function(n,t){var r=t.phi,i=t.cp,a=t.mu,s=t.sig2;return n+i*r*ba(e,a,s)}),0)},g=n.thresholds,b=g[0],w=(0,v.useCallback)((function(e){return 100*(e-b)/b}),[b]),C=t,P=i,S=0,E=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,t=[],r=((arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)-e)/n,i=0;i<n;++i)t.push(e+i*r);return t}(C,P,500).map((function(e){var t,r=(t=e,n.distr.gmm.reduce((function(e,n){var r=n.phi,i=n.mu,a=n.sig2;return e+r*ba(t,i,a)}),0));return S=Math.max(S,r),{x:w(e),est:r,estCons:Z(e)}}));0===S&&(S=qa/(P-C));var O={},_={};n.distr.gmm.forEach((function(e){var n,t,r=e.phi,i=e.mu,a=e.sig2,s=e.cp;a<=0&&(O[i]=(null!==(n=O[i])&&void 0!==n?n:0)+r,_[i]=(null!==(t=_[i])&&void 0!==t?t:0)+r*s)})),Object.entries(O).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return E.push({x:w(parseFloat(t)),est:i*qa/(P-C),estCons:_[t]*qa/(P-C)})})),E.sort((function(e,n){return e.x-n.x}));var A=(b-C)/(P-C),D=(0,v.useState)([]),M=(0,r.Z)(D,2),K=M[0],I=M[1],R=(0,v.useState)(-1),z=(0,r.Z)(R,2),W=z[0],N=z[1],F=(0,v.useState)(-1),B=(0,r.Z)(F,2),V=B[0],L=B[1];if((0,v.useEffect)((function(){if(o){var e=Ea(n),t=0,r=0,i=new Array(qa).fill(0),a=new Array(qa).fill(0),s=(P-C)/qa;e.forEach((function(e){var n=e.p,o=e.v,c=Math.min(Math.trunc((o[0]-C)/s),49);i[c]+=n,o.every((function(e,n){return 0===n||e>g[n]}))&&(a[c]+=n,o[0]>b&&(t+=n,r+=n*(o[0]-b)))})),t>0&&(r/=t);var c=i.map((function(e,n){return{x:w(C+n*s),exact:e/s,exactCons:a[n]/s}}));N(t),L(r),I(c)}}),[o,P,C,b,g,n,w]),0===K.length)for(var q=(P-C)/qa,G=0;G<qa;G++)K.push({x:w(C+G*q),exact:0,exactCons:0});var H=W>=0?W:n.prob,U=V>=0?V:n.upAvg,J=E.concat(K),X=function(e){var n=e.active;e.payload,e.label;return n?(0,$.jsxs)("div",{className:"custom-tooltip",children:[(0,$.jsx)("p",{className:"label"}),(0,$.jsxs)("p",{className:"desc",children:["prob. upgrade",W>=0?"":" (est.)",": ",(100*H).toFixed(1),"%"]}),(0,$.jsxs)("p",{className:"desc",children:["average increase",V>=0?"":" (est.)",": ",U<=0?"":"+",(100*U/b).toFixed(1),"%"]})]}):null};return(0,$.jsx)(y.Z,{children:(0,$.jsxs)(f.Z,{children:[(0,$.jsx)(yr.h,{width:"100%",aspect:2.5,children:(0,$.jsxs)(br.c,{data:J,margin:{top:5,right:30,left:20,bottom:20},children:[(0,$.jsx)(Cr.K,{dataKey:"x",type:"number",domain:["auto","auto"],allowDecimals:!1,tickFormatter:function(e){return"".concat(e<=0?"":"+").concat(e,"%")},children:(0,$.jsx)(Na._,{value:"Relative Damage Potential",position:"insideBottom",style:{fill:"#eaebed"},offset:-10})}),(0,$.jsx)(kr.B,{type:"number",domain:[0,S],tick:!1,children:(0,$.jsx)(Na._,{value:"Probability",position:"insideLeft",angle:-90,style:{fill:"#eaebed"}})}),(0,$.jsx)(Sr.D,{verticalAlign:"top",height:36}),(0,$.jsx)("defs",{children:(0,$.jsxs)("linearGradient",{id:"splitOpacity".concat(n.id),x1:"0",y1:"0",x2:A,y2:"0",children:[(0,$.jsx)("stop",{offset:1,stopColor:"orange",stopOpacity:0}),(0,$.jsx)("stop",{offset:0,stopColor:"orange",stopOpacity:1})]})}),(0,$.jsx)(Or.x,{dataKey:"dne",stroke:"red",name:"Current Damage"}),h&&!o&&(0,$.jsx)(Fa.u,{type:"monotone",dataKey:"est",stroke:"grey",dot:!1,fill:"grey",legendType:"none",tooltipType:"none",opacity:.5,activeDot:!1}),h&&o&&(0,$.jsx)(Fa.u,{type:"stepAfter",dataKey:"exact",dot:!1,legendType:"none",tooltipType:"none",opacity:.7,activeDot:!1,fill:"grey",stroke:"grey"}),(0,$.jsx)(Fa.u,{type:"monotone",dataKey:"estCons",stroke:"orange",dot:!1,fill:"url(#splitOpacity".concat(n.id,")"),opacity:.5,name:"Estimated Distribution",activeDot:!1}),o&&(0,$.jsx)(Fa.u,{type:"stepAfter",dataKey:"exactCons",dot:!1,opacity:.7,name:"Exact".concat(h?" Constrained":""," Distribution (Histogram)"),activeDot:!1}),(0,$.jsx)(Ba.d,{x:w(b),stroke:"red",strokeDasharray:"3 3",name:"Current Damage"}),(0,$.jsx)(Va.q,{x:w(b+U),y:(Z(b+U)||S)/2,shape:(0,$.jsx)("circle",{radius:1,opacity:.5})}),(0,$.jsx)(La.u,{content:(0,$.jsx)(X,{}),cursor:!1})]})},n.id),(0,$.jsx)(le.ZP,{direction:"row",container:!0,spacing:.75,columns:12,children:j.map((function(e){var t=(0,r.Z)(e,2),i=t[0],a=t[1];return i!==p?(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(Lr.Z,{slotKey:i,artifactObj:a})},"".concat(i,"_").concat(n.id)):(0,$.jsx)(le.ZP,{item:!0,xs:1,children:(0,$.jsx)(x.Z,{variant:"contained",style:{height:"100%",width:"100%"},onClick:function(){return c(!0)},startIcon:(0,$.jsx)(u.Z,{sx:{position:"absolute",width:"70%",height:"70%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",opacity:.7},component:"img",src:Ht.Z.slot[i]}),sx:{minWidth:0}})},"".concat(i,"_").concat(n.id))}))}),(0,$.jsx)("br",{}),(0,$.jsx)("span",{children:"Click above to calculate Exact upgrade distribution"}),(0,$.jsx)("br",{})]})})}function Ha(){var e,n=(0,v.useContext)(C.K),t=n.character,i=n.character.key,a=(0,v.useContext)(Wn.t).database,s=(0,_.Z)(i),o=(0,z.Z)(),c=(0,v.useMemo)((function(){return!a.arts.values.length}),[a]),l=At(i),h=l.buildSetting,p=l.buildSettingDispatch,m=h.optimizationTarget,Z=h.levelLow,b=h.levelHigh,P=(0,D.Z)(i),S=null!==(e=null===P||void 0===P?void 0:P[i])&&void 0!==e?e:{},E=S.characterSheet,O=S.target,A=(0,v.useState)(void 0),M=(0,r.Z)(A,2),K=M[0],I=M[1],R=(0,v.useState)(!0),W=(0,r.Z)(R,2),N=W[0],F=W[1],B=(0,v.useState)(!0),V=(0,r.Z)(B,2),L=V[0],q=V[1],G=(0,v.useState)(!1),H=(0,r.Z)(G,2),U=H[0],J=H[1],X=(0,v.useCallback)((function(e,n,t){var r=e.query,i=e.arts,s=a.arts.values.filter((function(e){return 5===e.rarity})).map((function(e){return Ia(e,20)})),o={};s.forEach((function(e){return o[e.id]=e}));var c=i.slice(0,n),l=i.slice(n),u=0,d=Math.min(t-n+5,l.length);do{for(;u<d;u++){var f=o[l[u].id];f&&(l[u]=Da(r,f,!0,L))}for(l.sort(Ra),u=0;u<d&&"fast"!==l[u].evalMode;u++);}while(u<d);return{query:r,arts:[].concat((0,oe.Z)(c),(0,oe.Z)(l))}}),[a,L]),Y=(0,v.useState)(0),Q=(0,r.Z)(Y,2),ee=Q[0],ne=Q[1],te=(0,v.useRef)(null),re=(0,v.useMemo)((function(){if(!K)return{artifactsToShow:[],numPages:0,toShow:0,minObj0:0,maxObj0:0};var e=Math.ceil(K.arts.length/5),n=(0,vn.uZ)(ee,0,e-1),t=K.arts.slice(5*n,5*(n+1)),r=t.length>0?t[0].thresholds[0]:0;return{artifactsToShow:t,numPages:e,currentPageIndex:n,minObj0:t.reduce((function(e,n){return Math.min(n.distr.lower,e)}),r),maxObj0:t.reduce((function(e,n){return Math.max(n.distr.upper,e)}),r)}}),[K,5,ee]),ie=re.artifactsToShow,ae=re.numPages,se=re.currentPageIndex,ce=re.minObj0,ue=re.maxObj0,de=(0,v.useCallback)((function(e,n){var t;if(K){null===(t=te.current)||void 0===t||t.scrollIntoView({behavior:"smooth"});var r=X(K,5*(se+1),5*n);I(r),ne(n-1)}}),[ne,I,te,se,5,K,X]),xe=(0,v.useCallback)((0,Ye.Z)((0,Je.Z)().mark((function e(){var n,t,s,o,c,l,u,d,f,p,x,v,m,j,Z,g,y,b,w,C,k,P,S,E;return(0,Je.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=function(e){var n=(0,fe.Z)({},y);n[e.slotKey]=e.setKey;var t={};if(T.eV.forEach((function(e){var r;return t[n[e]]=(null!==(r=t[n[e]])&&void 0!==r?r:0)+1})),!Object.entries(t).every((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];if(!p[t])return!0;switch(i){case 0:case 1:return!0;case 2:case 3:return!p[t].includes(2);case 4:case 5:return!p[t].includes(4);default:throw Error("error in respectSex: num > 5")}})))return!1;if(!p.rainbow)return!0;switch(Object.values(t).reduce((function(e,n){return e+n%2}),0)){case 0:case 1:return!0;case 2:case 3:return!p.rainbow.includes(2);case 4:case 5:return!p.rainbow.includes(4);default:throw Error("error in respectSex: nRainbow > 5")}},c=h.statFilters,l=h.optimizationTarget,u=h.mainStatKeys,d=h.levelLow,f=h.levelHigh,p=h.artSetExclusion,i&&l){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,(0,D.V)(a,i,0,[]);case 6:if(x=e.sent){e.next=9;break}return e.abrupt("return");case 9:if(v=null===(n=(0,Nn.Qo)(x.teamData,i)[i])||void 0===n?void 0:n.target.data[0]){e.next=12;break}return e.abrupt("return");case 12:if(Object.assign(v,(0,Nn.b3)([v,ii])),m=(0,vn.Hm)(null!==(t=v.display)&&void 0!==t?t:{},l)){e.next=16;break}return e.abrupt("return");case 16:I(void 0),ne(0),j=Object.entries(c).map((function(e){var n=(0,r.Z)(e,2),t=n[0],i=n[1];return t.endsWith("_")&&(i/=100),{value:me.ri.total[t],minimum:i}})).filter((function(e){return e.value&&e.minimum>-1/0})),Z=null!==(s=null===(o=a.chars.get(i))||void 0===o?void 0:o.equippedArtifacts)&&void 0!==s?s:{},g=(0,vn.O)(T.eV,(function(e){var n,t=a.arts.get(null!==(n=Z[e])&&void 0!==n?n:"");return t?Ia(t):void 0})),y=(0,vn.O)(T.eV,(function(e){var n,t,r=a.arts.get(null!==(n=Z[e])&&void 0!==n?n:"");return null!==(t=null===r||void 0===r?void 0:r.setKey)&&void 0!==t?t:""})),w=a.arts.values.filter((function(e){return 5===e.rarity})).filter(b).filter((function(e){return N||20!==e.level})).filter((function(e){var n,t;return!U||!(null!==(n=u[e.slotKey])&&void 0!==n&&n.length)||(null===(t=u[e.slotKey])||void 0===t?void 0:t.includes(e.mainStatKey))})).filter((function(e){return!U||d<=e.level&&e.level<=f})).map((function(e){return Ia(e,20)})),C={},w.forEach((function(e){return C[e.id]=e})),k=[m].concat((0,oe.Z)(j.map((function(e){return e.value})))),k=(0,hn.tL)(k,v,(function(e){return"dyn"!==(0,r.Z)(e.path,1)[0]})),P=Ka(k,j.map((function(e){return e.minimum})),g,O),S=(S=w.map((function(e){return Da(P,e,!1,L)}))).sort((function(e,n){return n.prob*n.upAvg-e.prob*e.upAvg})),E=X(E={query:P,arts:S},0,5),I(E),console.log("result",E);case 34:case"end":return e.stop()}}),e)}))),[N,L,U,i,h,O,a,I,ne,X]),ve=(0,v.useMemo)((function(){return t&&O&&E&&P&&{data:O,characterSheet:E,character:t,mainStatAssumptionLevel:0,teamData:P,characterDispatch:s}}),[O,E,t,P,s]);return(0,$.jsxs)(u.Z,{display:"flex",flexDirection:"column",gap:1,children:[c&&(0,$.jsxs)(en.Z,{severity:"warning",variant:"filled",children:[" Opps! It looks like you haven't added any artifacts to GO yet! You should go to the ",(0,$.jsx)(nn.Z,{component:j.rU,to:"/artifact",children:"Artifacts"})," page and add some!"]}),ve&&(0,$.jsx)(k.R.Provider,{value:ve,children:(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsxs)(le.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:[(0,$.jsx)(u.Z,{children:(0,$.jsx)(ln.Z,{characterKey:i,onClickTeammate:o})}),(0,$.jsx)(Rt,{})]}),(0,$.jsxs)(le.ZP,{item:!0,xs:12,sm:6,lg:9,display:"flex",flexDirection:"column",gap:1,children:[(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsxs)(le.ZP,{item:!0,lg:4,display:"flex",flexDirection:"column",gap:1,children:[(0,$.jsx)(y.Z,{children:(0,$.jsxs)(f.Z,{children:[(0,$.jsx)("span",{children:"Optimization Target: "}),(0,$.jsx)(zr.Z,{optimizationTarget:m,setTarget:function(e){return p({optimizationTarget:e})},disabled:!1})]})}),(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsx)($r,{disabled:!1})})}),U&&(0,$.jsxs)(y.Z,{children:[(0,$.jsx)(f.Z,{sx:{py:1},children:"Artifact Level Filter"}),(0,$.jsx)(on.Z,{levelLow:Z,levelHigh:b,setLow:function(e){return p({levelLow:e})},setHigh:function(e){return p({levelHigh:e})},setBoth:function(e,n){return p({levelLow:e,levelHigh:n})},disabled:!1}),(0,$.jsx)(f.Z,{children:(0,$.jsx)(Kr,{disabled:!1})})]})]}),(0,$.jsxs)(le.ZP,{item:!0,lg:8,display:"flex",flexDirection:"column",gap:1,children:[(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsx)(Dt,{disabled:!1})})}),(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(x.Z,{startIcon:N?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:N?"success":"secondary",onClick:function(){return F(!N)},children:"show lvl 20"})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(x.Z,{startIcon:L?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:L?"success":"secondary",onClick:function(){return q(!L)},children:"compute 4th sub"})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(x.Z,{startIcon:U?(0,$.jsx)(he.Z,{}):(0,$.jsx)(pe.Z,{}),color:U?"success":"secondary",onClick:function(){return J(!U)},children:"enable filters"})})]})})})]})]}),(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,lg:12,children:(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(x.Z,{disabled:!i||!m||!(0,vn.Hm)(null===O||void 0===O?void 0:O.getDisplay(),m),color:i?"success":"warning",onClick:xe,startIcon:(0,$.jsx)(it.G,{icon:rt.lTt}),children:"Calc Upgrade Priority"})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(w.Hn,{size:"small"})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(w.oX,{size:"small"})})]})})})}),ae>1&&(0,$.jsx)(g.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,children:[(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(an.Z,{count:ae,page:se+1,onChange:de})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(Ua,{numShowing:ie.length,total:null===K||void 0===K?void 0:K.arts.length})})]})})}),(0,$.jsx)(le.ZP,{item:!0,lg:12,spacing:1,children:(0,$.jsxs)(le.ZP,{container:!0,display:"flex",flexDirection:"column",gap:1,children:[c&&(0,$.jsxs)(en.Z,{severity:"info",variant:"filled",children:["Looks like you haven't added any artifacts yet. If you want, there are ",(0,$.jsx)(nn.Z,{color:"warning.main",component:j.rU,to:"/scanner",children:"automatic scanners"})," that can speed up the import process!"]}),(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",sx:{width:"100%",height:600,minHeight:5e3}}),children:ie.map((function(e){return(0,$.jsxs)(le.ZP,{container:!0,spacing:1,children:[(0,$.jsx)(le.ZP,{item:!0,xs:5,sm:4,md:4,lg:3,xl:3,children:(0,$.jsx)(fr.Z,{artifactId:e.id,editor:!0})}),(0,$.jsx)(le.ZP,{item:!0,xs:7,sm:8,md:8,lg:9,xl:9,children:(0,$.jsx)(Ga,{upgradeOpt:e,objMax:ue,objMin:ce})})]},e.id+"asdfsf")}))})]})}),ae>1&&(0,$.jsx)(g.Z,{children:(0,$.jsx)(f.Z,{children:(0,$.jsxs)(le.ZP,{container:!0,children:[(0,$.jsx)(le.ZP,{item:!0,flexGrow:1,children:(0,$.jsx)(an.Z,{count:ae,page:se+1,onChange:de})}),(0,$.jsx)(le.ZP,{item:!0,children:(0,$.jsx)(Ua,{numShowing:ie.length,total:null===K||void 0===K?void 0:K.arts.length})})]})})})]})]})]})})]})}function Ua(e){var n=e.numShowing,t=e.total;return(0,$.jsx)(q.Z,{color:"text.secondary",children:(0,$.jsxs)(st.c,{i18nKey:"showingNum",count:n,value:t,children:["Showing ",(0,$.jsx)("b",{children:{count:n}})," out of ",{value:t}," Artifacts"]})})}var Ja=t(53343);function Xa(){var e=(0,v.useContext)(C.K),n=e.character,t=e.characterSheet,r=e.characterDispatch,i=n.elementKey,a=void 0===i?"anemo":i;return"talents"in t.sheet?(0,$.jsx)(un.Z,{color:a,title:(0,$.jsx)("strong",{children:(0,Ja.Oy)("element.".concat(a))}),children:Object.keys(t.sheet.talents).map((function(e){return(0,$.jsx)(tn.Z,{selected:a===e,disabled:a===e,onClick:function(){return r({elementKey:e})},children:(0,$.jsx)("strong",{children:(0,$.jsx)(J.Z,{color:e,children:(0,Ja.Oy)("element.".concat(e))})})},e)}))}):null}function Ya(){var e,n=(0,Z.s0)(),t=(0,v.useCallback)((function(){return n("/characters")}),[n]),r=(0,Z.UO)().characterKey;return!T.IV.includes(null!==(e=r)&&void 0!==e?e:"")?(0,$.jsx)(Z.Fg,{to:"/characters"}):(0,$.jsx)(u.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:1e3}),children:r&&(0,$.jsx)(Qa,{characterKey:r,onClose:t})})})}function Qa(e){var n,t,r,i=e.characterKey,a=e.onClose,s=(0,O.Z)(i),o=(0,A.Z)((function(){return S.Z.get(i)}),[i]),c=(0,D.Z)(i),l=(null!==(n=null===c||void 0===c?void 0:c[i])&&void 0!==n?n:{}).target,h=(null!==(t=(0,Z.bS)({path:"/characters/:charKey/:tab",end:!1}))&&void 0!==t?t:{params:{tab:"overview"}}).params.tab,p=void 0===h?"overview":h,x=(0,m.$)().t;(0,M.Z)("".concat(x("char_".concat(i,"_gen:name"))," - ").concat(x("page_character:tabs.".concat(p))));var j=(0,_.Z)(null!==(r=null===s||void 0===s?void 0:s.key)&&void 0!==r?r:""),E=(0,v.useMemo)((function(){if(c&&l)return{data:l,teamData:c,oldData:void 0}}),[l,c]),T=(0,v.useMemo)((function(){if(s&&o)return{character:s,characterSheet:o,characterDispatch:j}}),[s,o,j]);return(0,$.jsx)(g.Z,{children:E&&T?(0,$.jsx)(C.K.Provider,{value:T,children:(0,$.jsx)(k.R.Provider,{value:E,children:(0,$.jsx)(P.B,{children:(0,$.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,$.jsxs)(u.Z,{display:"flex",children:[(0,$.jsxs)(u.Z,{display:"flex",gap:1,flexWrap:"wrap",flexGrow:1,children:[(0,$.jsx)(W,{}),(0,$.jsx)(Xa,{}),(0,$.jsx)(ts,{}),(0,$.jsx)(K.J,{}),(0,$.jsx)(rs,{})]}),!!a&&(0,$.jsx)(b.Z,{onClick:a})]}),(0,$.jsxs)(u.Z,{display:"flex",gap:1,flexWrap:"wrap",children:[s&&(0,$.jsx)(se.Z,{level:s.level,ascension:s.ascension,setBoth:j}),(0,$.jsx)(w.Hn,{size:"small"}),(0,$.jsx)(w.pg,{}),(0,$.jsx)(w.oX,{size:"small"})]}),(0,$.jsx)(y.Z,{children:(0,$.jsx)(ns,{tab:p})}),(0,$.jsx)(es,{}),(0,$.jsx)(y.Z,{children:(0,$.jsx)(ns,{tab:p})})]})})})}):(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:1e3})})}function es(){return(0,$.jsx)(v.Suspense,{fallback:(0,$.jsx)(d.Z,{variant:"rectangular",width:"100%",height:500}),children:(0,$.jsxs)(Z.Z5,{children:[(0,$.jsx)(Z.AW,{index:!0,element:(0,$.jsx)(ea,{})}),(0,$.jsx)(Z.AW,{path:"/talent",element:(0,$.jsx)(ia,{})}),(0,$.jsx)(Z.AW,{path:"/teambuffs",element:(0,$.jsx)(da,{})}),(0,$.jsx)(Z.AW,{path:"/optimize",element:(0,$.jsx)(ui,{})}),(0,$.jsx)(Z.AW,{path:"/upgradeOpt",element:(0,$.jsx)(Ha,{})})]})})}function ns(e){var n=e.tab,t=(0,m.$)("page_character").t;return(0,$.jsxs)(h.Z,{value:n,variant:"scrollable",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"}},children:[(0,$.jsx)(p.Z,{sx:{minWidth:"20%"},value:"overview",label:t("tabs.overview"),icon:(0,$.jsx)(i.Z,{}),component:j.rU,to:""}),(0,$.jsx)(p.Z,{sx:{minWidth:"20%"},value:"talent",label:t("tabs.talent"),icon:(0,$.jsx)(a.Z,{}),component:j.rU,to:"talent"}),(0,$.jsx)(p.Z,{sx:{minWidth:"20%"},value:"teambuffs",label:t("tabs.teambuffs"),icon:(0,$.jsx)(s.Z,{}),component:j.rU,to:"teambuffs"}),(0,$.jsx)(p.Z,{sx:{minWidth:"20%"},value:"optimize",label:t("tabs.optimize"),icon:(0,$.jsx)(o.Z,{}),component:j.rU,to:"optimize"}),(0,$.jsx)(p.Z,{sx:{minWidth:"20%"},value:"upgradeOpt",label:t("tabs.upgradeOpt"),icon:(0,$.jsx)(c.Z,{}),component:j.rU,to:"upgradeOpt"})]})}function ts(){var e=(0,E.Z)(),n=(0,r.Z)(e,3),t=n[0],i=n[1],a=n[2];return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(x.Z,{color:"info",startIcon:(0,$.jsx)(l.Z,{}),onClick:i,children:"Detailed Stats"}),(0,$.jsx)(Re,{open:t,onClose:a})]})}function rs(){var e=(0,v.useContext)(P.M).onModalOpen;return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(x.Z,{color:"info",startIcon:(0,$.jsx)(c.Z,{}),onClick:e,children:["Formulas ","&"," Calcs"]}),(0,$.jsx)(te,{})]})}},90543:function(e,n,t){"use strict";t.d(n,{Z:function(){return z}});var r,i=t(30168),a=t(53174),s=t(54483),o=t(40117),c=t(62002),l=t(63204),u=t(66647),d=t(68870),f=t(47047),h=t(13400),p=t(20890),x=t(39504),v=t(2199),m=t(40165),j=t(24518),Z=t(72791),g=t(22020),y=t(10658),b=t(71310),w=t(31038),C=t(40020),k=t(20005),P=t(55942),S=t(10157),E=t(75545),O=t(2139),_=t(66218),A=t(7618),D=t(26138),M=t(73036),T=t(79406),K=t(42320),I=t(74480),R=t(80184);function z(e){var n,t=e.weaponId,z=e.onClick,$=e.onEdit,W=e.onDelete,N=e.canEquip,F=void 0!==N&&N,B=e.extraButtons,V=(0,g.$)(["page_weapon","ui"]).t,L=(0,Z.useContext)(A.t).database,q=(0,I.Z)(t),G=(0,K.Z)((function(){return null!==q&&void 0!==q&&q.key?_.Z.get(q.key):void 0}),[null===q||void 0===q?void 0:q.key]),H=(0,Z.useCallback)((function(e){return e.weaponTypeKey===(null===G||void 0===G?void 0:G.weaponType)}),[G]),U=(0,Z.useCallback)((function(e){return(0,R.jsx)(u.Z,{onClick:function(){return null===z||void 0===z?void 0:z(t)},children:e})}),[z,t]),J=(0,Z.useCallback)((function(e){return(0,R.jsx)(d.Z,{children:e})}),[]),X=(0,Z.useCallback)((function(e){return L.weapons.set(t,{location:e})}),[L,t]),Y=(0,Z.useMemo)((function(){return G&&q&&(0,M.mP)([G.data,(0,M.v0)(q)])}),[G,q]);if(!q||!G||!Y)return null;var Q=q.level,ee=q.ascension,ne=q.refinement,te=q.id,re=q.location,ie=void 0===re?"":re,ae=q.lock,se=Y.get(D.ri.weapon.type).value,oe=[D.ri.weapon.main,D.ri.weapon.sub,D.ri.weapon.sub2].map((function(e){return Y.get(e)})),ce=G.getImg(ee);return(0,R.jsx)(Z.Suspense,{fallback:(0,R.jsx)(f.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:300}}),children:(0,R.jsxs)(b.Z,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,R.jsxs)(k.Z,{condition:!!z,wrapper:U,falseWrapper:J,children:[(0,R.jsxs)(d.Z,{className:"grad-".concat(G.rarity,"star"),sx:{position:"relative",pt:2,px:2},children:[!z&&(0,R.jsx)(h.Z,{color:"primary",onClick:function(){return L.weapons.set(te,{lock:!ae})},sx:{position:"absolute",right:0,bottom:0,zIndex:2},children:ae?(0,R.jsx)(o.Z,{}):(0,R.jsx)(c.Z,{})}),(0,R.jsxs)(d.Z,{sx:{position:"relative",zIndex:1},children:[(0,R.jsxs)(d.Z,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,R.jsx)(P.Z,{sx:{fontSize:"1.5em"},src:null===(n=y.Z.weaponTypes)||void 0===n?void 0:n[se]}),(0,R.jsx)(p.Z,{noWrap:!0,sx:{textAlign:"center",backgroundColor:"rgba(100,100,100,0.35)",borderRadius:"1em",px:1},children:(0,R.jsx)("strong",{children:G.name})})]}),(0,R.jsxs)(p.Z,{component:"span",variant:"h5",children:["Lv. ",Q]}),(0,R.jsxs)(p.Z,{component:"span",variant:"h5",color:"text.secondary",children:["/",O.SJ[ee]]}),(0,R.jsxs)(p.Z,{variant:"h6",children:["Refinement ",(0,R.jsx)("strong",{children:ne})]}),(0,R.jsx)(p.Z,{children:(0,R.jsx)(S.q,{stars:G.rarity,colored:!0})})]}),(0,R.jsx)(d.Z,{sx:{height:"100%",position:"absolute",right:0,top:0},children:(0,R.jsx)(d.Z,{component:"img",src:null!==ce&&void 0!==ce?ce:"",width:"auto",height:"100%",sx:{float:"right"}})})]}),(0,R.jsx)(x.Z,{children:oe.map((function(e){if(!e.info.key)return null;var n=(0,T.EC)(e.value,e.unit,e.unit?void 0:0);return(0,R.jsxs)(d.Z,{sx:{display:"flex"},children:[(0,R.jsxs)(p.Z,{flexGrow:1,children:[E.ZP[e.info.key]," ",T.ZP.get(e.info.key)]}),(0,R.jsx)(p.Z,{children:n})]},e.info.key)}))})]}),(0,R.jsxs)(d.Z,{sx:{p:1,display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[F?(0,R.jsx)(w.Z,{size:"small",sx:{flexGrow:1},disable:function(e){return""===e},showDefault:!0,defaultIcon:(0,R.jsx)(l.Z,{}),defaultText:V("ui:inventory"),value:ie,onChange:X,filter:H,disableClearable:!0}):(0,R.jsx)(C.Z,{location:ie}),(0,R.jsxs)(v.Z,{children:[!!$&&(0,R.jsx)(m.Z,{title:(0,R.jsx)(p.Z,{children:V(r||(r=(0,i.Z)(["page_weapon:edit"])))}),placement:"top",arrow:!0,children:(0,R.jsx)(j.Z,{color:"info",onClick:function(){return $(te)},children:(0,R.jsx)(s.G,{icon:a.Xcf,className:"fa-fw"})})}),!!W&&(0,R.jsx)(j.Z,{color:"error",onClick:function(){return W(te)},disabled:!!ie||ae,children:(0,R.jsx)(s.G,{icon:a.I7k,className:"fa-fw"})}),B]})]})]})})}},52771:function(e,n,t){"use strict";t.d(n,{JR:function(){return l},e6:function(){return u},g4:function(){return a},mf:function(){return o},vL:function(){return i},yJ:function(){return s}});var r=t(60393),i=1e3,a=60*i,s=60*a,o=24*s;function c(e){var n=e%1e3,t=Math.floor(e/1e3%60),r=Math.floor(e/6e4%60);return{hours:Math.floor(e/36e5),minutes:r,seconds:t,milliseconds:n}}function l(e){var n=c(e),t=n.hours,i=n.minutes,a=n.seconds,s="Minutes";return t&&(s="Hours"),"".concat(t?"".concat(t,":"):"").concat((0,r.H_)(i,"0",2),":").concat((0,r.H_)(a,"0",2)," ").concat(s)}function u(e){var n=c(e),t=n.hours,i=n.minutes,a=n.seconds,s=n.milliseconds,o="Minutes";return t&&(o="Hours"),"".concat(t?"".concat(t,":"):"").concat((0,r.H_)(i,"0",2),":").concat((0,r.H_)(a,"0",2),".").concat((0,r.H_)(s,"0",3)," ").concat(o)}},66045:function(e,n,t){"use strict";t.d(n,{Ol:function(){return i},Sn:function(){return a},Xg:function(){return s}});var r=t(72828),i=["level","rarity"];function a(e){return{level:{getValue:function(e){var n;return null!==(n=e.level*e.ascension)&&void 0!==n?n:0},tieBreaker:"rarity"},rarity:{getValue:function(n){var t;return null===e||void 0===e||null===(t=e[n.key])||void 0===t?void 0:t.rarity},tieBreaker:"level"}}}function s(e){return{rarity:function(n,t){var r;return t.includes(null===e||void 0===e||null===(r=e[n.key])||void 0===r?void 0:r.rarity)},weaponType:function(n,t){var r;return t.includes(null===e||void 0===e||null===(r=e[n.key])||void 0===r?void 0:r.weaponType)},name:function(e,n){return r.Z.t("weaponNames_gen:".concat(e.key)).toLowerCase().includes(n.toLowerCase())}}}},61503:function(e,n,t){"use strict";t.d(n,{Y:function(){return l}}),e=t.hmd(e);var r,i,a,s,o,c,l="undefined"!==typeof l?l:{},u=Object.assign,d=u({},l),f=[],h="object"===typeof window,p="function"===typeof importScripts,x="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,v="";x?(v=p?t(10699).dirname(v)+"/":"//",c=function(){o||(s=t(21678),o=t(10699))},r=function(e,n){return c(),e=o.normalize(e),s.readFileSync(e,n?null:"utf8")},a=function(e){var n=r(e,!0);return n.buffer||(n=new Uint8Array(n)),n},i=function(e,n,t){c(),e=o.normalize(e),s.readFile(e,(function(e,r){e?t(e):n(r.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),f=process.argv.slice(2),e.exports=l,process.on("uncaughtException",(function(e){if(!(e instanceof wn))throw e})),process.on("unhandledRejection",(function(e){throw e})),function(e,n){if(L())throw process.exitCode=e,n;var t;(t=n)instanceof wn||m("exiting due to exception: "+t),process.exit(e)},l.inspect=function(){return"[Emscripten Module object]"}):(h||p)&&(p?v=self.location.href:"undefined"!==typeof document&&document.currentScript&&(v=document.currentScript.src),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",r=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(null),n.responseText},p&&(a=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),i=function(e,n,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?n(r.response):t()},r.onerror=t,r.send(null)});l.print||console.log.bind(console);var m=l.printErr||console.warn.bind(console);u(l,d),d=null,l.arguments&&(f=l.arguments),l.thisProgram&&l.thisProgram,l.quit&&l.quit;var j;l.wasmBinary&&(j=l.wasmBinary);var Z,g=l.noExitRuntime||!0;"object"!==typeof WebAssembly&&U("no native wasm support detected");var y=!1;var b="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function w(e,n){return e?function(e,n,t){for(var r=n+t,i=n;e[i]&&!(i>=r);)++i;if(i-n>16&&e.subarray&&b)return b.decode(e.subarray(n,i));for(var a="";n<i;){var s=e[n++];if(128&s){var o=63&e[n++];if(192!=(224&s)){var c=63&e[n++];if((s=224==(240&s)?(15&s)<<12|o<<6|c:(7&s)<<18|o<<12|c<<6|63&e[n++])<65536)a+=String.fromCharCode(s);else{var l=s-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else a+=String.fromCharCode((31&s)<<6|o)}else a+=String.fromCharCode(s)}return a}(S,e,n):""}function C(e,n,t){return function(e,n,t,r){if(!(r>0))return 0;for(var i=t,a=t+r-1,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++s)),o<=127){if(t>=a)break;n[t++]=o}else if(o<=2047){if(t+1>=a)break;n[t++]=192|o>>6,n[t++]=128|63&o}else if(o<=65535){if(t+2>=a)break;n[t++]=224|o>>12,n[t++]=128|o>>6&63,n[t++]=128|63&o}else{if(t+3>=a)break;n[t++]=240|o>>18,n[t++]=128|o>>12&63,n[t++]=128|o>>6&63,n[t++]=128|63&o}}return n[t]=0,t-i}(e,S,n,t)}var k,P,S,E,O,_,A,D,M,T="undefined"!==typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function K(e,n){for(var t=e,r=t>>1,i=r+n/2;!(r>=i)&&O[r];)++r;if((t=r<<1)-e>32&&T)return T.decode(S.subarray(e,t));for(var a="",s=0;!(s>=n/2);++s){var o=E[e+2*s>>1];if(0==o)break;a+=String.fromCharCode(o)}return a}function I(e,n,t){if(void 0===t&&(t=2147483647),t<2)return 0;for(var r=n,i=(t-=2)<2*e.length?t/2:e.length,a=0;a<i;++a){var s=e.charCodeAt(a);E[n>>1]=s,n+=2}return E[n>>1]=0,n-r}function R(e){return 2*e.length}function z(e,n){for(var t=0,r="";!(t>=n/4);){var i=_[e+4*t>>2];if(0==i)break;if(++t,i>=65536){var a=i-65536;r+=String.fromCharCode(55296|a>>10,56320|1023&a)}else r+=String.fromCharCode(i)}return r}function $(e,n,t){if(void 0===t&&(t=2147483647),t<4)return 0;for(var r=n,i=r+t-4,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a);if(_[n>>2]=s,(n+=4)+4>i)break}return _[n>>2]=0,n-r}function W(e){for(var n=0,t=0;t<e.length;++t){var r=e.charCodeAt(t);r>=55296&&r<=57343&&++t,n+=4}return n}l.INITIAL_MEMORY;var N,F=[],B=[],V=[];function L(){return g||!1}var q=0,G=null,H=null;function U(e){throw l.onAbort&&l.onAbort(e),m(e="Aborted("+e+")"),y=!0,1,e+=". Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}l.preloadedImages={},l.preloadedAudios={};var J,X;function Y(e){return e.startsWith("data:application/octet-stream;base64,")}function Q(e){return e.startsWith("file://")}function ee(e){try{if(e==J&&j)return new Uint8Array(j);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}catch(m){U(m)}}function ne(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var t=n.func;"number"===typeof t?void 0===n.arg?re(t)():re(t)(n.arg):t(void 0===n.arg?null:n.arg)}else n(l)}}Y(J="assembly.wasm")||(X=J,J=l.locateFile?l.locateFile(X,v):v+X);var te=[];function re(e){var n=te[e];return n||(e>=te.length&&(te.length=e+1),te[e]=n=N.get(e)),n}function ie(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){_[this.ptr+4>>2]=e},this.get_type=function(){return _[this.ptr+4>>2]},this.set_destructor=function(e){_[this.ptr+8>>2]=e},this.get_destructor=function(){return _[this.ptr+8>>2]},this.set_refcount=function(e){_[this.ptr>>2]=e},this.set_caught=function(e){e=e?1:0,P[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=P[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,P[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=P[this.ptr+13>>0]},this.init=function(e,n){this.set_type(e),this.set_destructor(n),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=_[this.ptr>>2];_[this.ptr>>2]=e+1},this.release_ref=function(){var e=_[this.ptr>>2];return _[this.ptr>>2]=e-1,1===e}}function ae(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var se=void 0;function oe(e){for(var n="",t=e;S[t];)n+=se[S[t++]];return n}var ce={},le={},ue={};function de(e){if(void 0===e)return"_unknown";var n=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return n>=48&&n<=57?"_"+e:e}function fe(e,n){return e=de(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(n)}function he(e,n){var t=fe(n,(function(e){this.name=n,this.message=e;var t=new Error(e).stack;void 0!==t&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))}));return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},t}var pe=void 0;function xe(e){throw new pe(e)}var ve=void 0;function me(e){throw new ve(e)}function je(e,n,t){function r(n){var r=t(n);r.length!==e.length&&me("Mismatched type converter count");for(var i=0;i<e.length;++i)Ze(e[i],r[i])}e.forEach((function(e){ue[e]=n}));var i=new Array(n.length),a=[],s=0;n.forEach((function(e,n){le.hasOwnProperty(e)?i[n]=le[e]:(a.push(e),ce.hasOwnProperty(e)||(ce[e]=[]),ce[e].push((function(){i[n]=le[e],++s===a.length&&r(i)})))})),0===a.length&&r(i)}function Ze(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=n.name;if(e||xe('type "'+r+'" must have a positive integer typeid pointer'),le.hasOwnProperty(e)){if(t.ignoreDuplicateRegistrations)return;xe("Cannot register type '"+r+"' twice")}if(le[e]=n,delete ue[e],ce.hasOwnProperty(e)){var i=ce[e];delete ce[e],i.forEach((function(e){e()}))}}function ge(e){if(!(this instanceof Me))return!1;if(!(e instanceof Me))return!1;for(var n=this.$$.ptrType.registeredClass,t=this.$$.ptr,r=e.$$.ptrType.registeredClass,i=e.$$.ptr;n.baseClass;)t=n.upcast(t),n=n.baseClass;for(;r.baseClass;)i=r.upcast(i),r=r.baseClass;return n===r&&t===i}function ye(e){xe(e.$$.ptrType.registeredClass.name+" instance already deleted")}var be=!1;function we(e){}function Ce(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)}function ke(e){return"undefined"===typeof FinalizationGroup?(ke=function(e){return e},e):(be=new FinalizationGroup((function(e){for(var n=e.next();!n.done;n=e.next()){var t=n.value;t.ptr?Ce(t):console.warn("object already deleted: "+t.ptr)}})),ke=function(e){return be.register(e,e.$$,e.$$),e},we=function(e){be.unregister(e.$$)},ke(e))}function Pe(){if(this.$$.ptr||ye(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e,n=ke(Object.create(Object.getPrototypeOf(this),{$$:{value:(e=this.$$,{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType})}}));return n.$$.count.value+=1,n.$$.deleteScheduled=!1,n}function Se(){this.$$.ptr||ye(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&xe("Object already scheduled for deletion"),we(this),Ce(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ee(){return!this.$$.ptr}var Oe=void 0,_e=[];function Ae(){for(;_e.length;){var e=_e.pop();e.$$.deleteScheduled=!1,e.delete()}}function De(){return this.$$.ptr||ye(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&xe("Object already scheduled for deletion"),_e.push(this),1===_e.length&&Oe&&Oe(Ae),this.$$.deleteScheduled=!0,this}function Me(){}var Te={};function Ke(e,n,t){if(void 0===e[n].overloadTable){var r=e[n];e[n]=function(){return e[n].overloadTable.hasOwnProperty(arguments.length)||xe("Function '"+t+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[n].overloadTable+")!"),e[n].overloadTable[arguments.length].apply(this,arguments)},e[n].overloadTable=[],e[n].overloadTable[r.argCount]=r}}function Ie(e,n,t,r,i,a,s,o){this.name=e,this.constructor=n,this.instancePrototype=t,this.rawDestructor=r,this.baseClass=i,this.getActualType=a,this.upcast=s,this.downcast=o,this.pureVirtualFunctions=[]}function Re(e,n,t){for(;n!==t;)n.upcast||xe("Expected null or instance of "+t.name+", got an instance of "+n.name),e=n.upcast(e),n=n.baseClass;return e}function ze(e,n){if(null===n)return this.isReference&&xe("null is not a valid "+this.name),0;n.$$||xe('Cannot pass "'+xn(n)+'" as a '+this.name),n.$$.ptr||xe("Cannot pass deleted object as a pointer of type "+this.name);var t=n.$$.ptrType.registeredClass;return Re(n.$$.ptr,t,this.registeredClass)}function $e(e,n){var t;if(null===n)return this.isReference&&xe("null is not a valid "+this.name),this.isSmartPointer?(t=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,t),t):0;n.$$||xe('Cannot pass "'+xn(n)+'" as a '+this.name),n.$$.ptr||xe("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&n.$$.ptrType.isConst&&xe("Cannot convert argument of type "+(n.$$.smartPtrType?n.$$.smartPtrType.name:n.$$.ptrType.name)+" to parameter type "+this.name);var r=n.$$.ptrType.registeredClass;if(t=Re(n.$$.ptr,r,this.registeredClass),this.isSmartPointer)switch(void 0===n.$$.smartPtr&&xe("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:n.$$.smartPtrType===this?t=n.$$.smartPtr:xe("Cannot convert argument of type "+(n.$$.smartPtrType?n.$$.smartPtrType.name:n.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:t=n.$$.smartPtr;break;case 2:if(n.$$.smartPtrType===this)t=n.$$.smartPtr;else{var i=n.clone();t=this.rawShare(t,pn.toHandle((function(){i.delete()}))),null!==e&&e.push(this.rawDestructor,t)}break;default:xe("Unsupporting sharing policy")}return t}function We(e,n){if(null===n)return this.isReference&&xe("null is not a valid "+this.name),0;n.$$||xe('Cannot pass "'+xn(n)+'" as a '+this.name),n.$$.ptr||xe("Cannot pass deleted object as a pointer of type "+this.name),n.$$.ptrType.isConst&&xe("Cannot convert argument of type "+n.$$.ptrType.name+" to parameter type "+this.name);var t=n.$$.ptrType.registeredClass;return Re(n.$$.ptr,t,this.registeredClass)}function Ne(e){return this.fromWireType(A[e>>2])}function Fe(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function Be(e){this.rawDestructor&&this.rawDestructor(e)}function Ve(e){null!==e&&e.delete()}function Le(e,n,t){if(n===t)return e;if(void 0===t.baseClass)return null;var r=Le(e,n,t.baseClass);return null===r?null:t.downcast(r)}function qe(){return Object.keys(Ue).length}function Ge(){var e=[];for(var n in Ue)Ue.hasOwnProperty(n)&&e.push(Ue[n]);return e}function He(e){Oe=e,_e.length&&Oe&&Oe(Ae)}var Ue={};function Je(e,n){return n=function(e,n){for(void 0===n&&xe("ptr should not be undefined");e.baseClass;)n=e.upcast(n),e=e.baseClass;return n}(e,n),Ue[n]}function Xe(e,n){return n.ptrType&&n.ptr||me("makeClassHandle requires ptr and ptrType"),!!n.smartPtrType!==!!n.smartPtr&&me("Both smartPtrType and smartPtr must be specified"),n.count={value:1},ke(Object.create(e,{$$:{value:n}}))}function Ye(e){var n=this.getPointee(e);if(!n)return this.destructor(e),null;var t=Je(this.registeredClass,n);if(void 0!==t){if(0===t.$$.count.value)return t.$$.ptr=n,t.$$.smartPtr=e,t.clone();var r=t.clone();return this.destructor(e),r}function i(){return this.isSmartPointer?Xe(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:n,smartPtrType:this,smartPtr:e}):Xe(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var a,s=this.registeredClass.getActualType(n),o=Te[s];if(!o)return i.call(this);a=this.isConst?o.constPointerType:o.pointerType;var c=Le(n,this.registeredClass,a.registeredClass);return null===c?i.call(this):this.isSmartPointer?Xe(a.registeredClass.instancePrototype,{ptrType:a,ptr:c,smartPtrType:this,smartPtr:e}):Xe(a.registeredClass.instancePrototype,{ptrType:a,ptr:c})}function Qe(e,n,t,r,i,a,s,o,c,l,u){this.name=e,this.registeredClass=n,this.isReference=t,this.isConst=r,this.isSmartPointer=i,this.pointeeType=a,this.sharingPolicy=s,this.rawGetPointee=o,this.rawConstructor=c,this.rawShare=l,this.rawDestructor=u,i||void 0!==n.baseClass?this.toWireType=$e:r?(this.toWireType=ze,this.destructorFunction=null):(this.toWireType=We,this.destructorFunction=null)}function en(e,n,t){return e.includes("j")?function(e,n,t){var r=l["dynCall_"+e];return t&&t.length?r.apply(null,[n].concat(t)):r.call(null,n)}(e,n,t):re(n).apply(null,t)}function nn(e,n){var t=(e=oe(e)).includes("j")?function(e,n){var t=[];return function(){t.length=arguments.length;for(var r=0;r<arguments.length;r++)t[r]=arguments[r];return en(e,n,t)}}(e,n):re(n);return"function"!==typeof t&&xe("unknown function pointer with signature "+e+": "+n),t}var tn=void 0;function rn(e){var n=bn(e),t=oe(n);return yn(n),t}function an(e,n){var t=[],r={};throw n.forEach((function e(n){r[n]||le[n]||(ue[n]?ue[n].forEach(e):(t.push(n),r[n]=!0))})),new tn(e+": "+t.map(rn).join([", "]))}function sn(e,n){for(var t=[],r=0;r<e;r++)t.push(_[(n>>2)+r]);return t}function on(e){for(;e.length;){var n=e.pop();e.pop()(n)}}function cn(e,n,t,r,i){var a=n.length;a<2&&xe("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=null!==n[1]&&null!==t,o=!1,c=1;c<n.length;++c)if(null!==n[c]&&void 0===n[c].destructorFunction){o=!0;break}var l="void"!==n[0].name,u="",d="";for(c=0;c<a-2;++c)u+=(0!==c?", ":"")+"arg"+c,d+=(0!==c?", ":"")+"arg"+c+"Wired";var f="return function "+de(e)+"("+u+") {\nif (arguments.length !== "+(a-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(a-2)+" args!');\n}\n";o&&(f+="var destructors = [];\n");var h=o?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],x=[xe,r,i,on,n[0],n[1]];s&&(f+="var thisWired = classParam.toWireType("+h+", this);\n");for(c=0;c<a-2;++c)f+="var arg"+c+"Wired = argType"+c+".toWireType("+h+", arg"+c+"); // "+n[c+2].name+"\n",p.push("argType"+c),x.push(n[c+2]);if(s&&(d="thisWired"+(d.length>0?", ":"")+d),f+=(l?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",o)f+="runDestructors(destructors);\n";else for(c=s?1:2;c<n.length;++c){var v=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==n[c].destructorFunction&&(f+=v+"_dtor("+v+"); // "+n[c].name+"\n",p.push(v+"_dtor"),x.push(n[c].destructorFunction))}return l&&(f+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),f+="}\n",p.push(f),function(e,n){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var t=fe(e.name||"unknownFunctionName",(function(){}));t.prototype=e.prototype;var r=new t,i=e.apply(r,n);return i instanceof Object?i:r}(Function,p).apply(null,x)}function ln(e,n,t){return e instanceof Object||xe(t+' with invalid "this": '+e),e instanceof n.registeredClass.constructor||xe(t+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||xe("cannot call emscripten binding method "+t+" on deleted object"),Re(e.$$.ptr,e.$$.ptrType.registeredClass,n.registeredClass)}var un=[],dn=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function fn(){for(var e=0,n=5;n<dn.length;++n)void 0!==dn[n]&&++e;return e}function hn(){for(var e=5;e<dn.length;++e)if(void 0!==dn[e])return dn[e];return null}var pn={toValue:function(e){return e||xe("Cannot use deleted val. handle = "+e),dn[e].value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var n=un.length?un.pop():dn.length;return dn[n]={refcount:1,value:e},n}}};function xn(e){if(null===e)return"null";var n=typeof e;return"object"===n||"array"===n||"function"===n?e.toString():""+e}function vn(e,n){switch(n){case 2:return function(e){return this.fromWireType(D[e>>2])};case 3:return function(e){return this.fromWireType(M[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function mn(e,n,t){switch(n){case 0:return t?function(e){return P[e]}:function(e){return S[e]};case 1:return t?function(e){return E[e>>1]}:function(e){return O[e>>1]};case 2:return t?function(e){return _[e>>2]}:function(e){return A[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}!function(){for(var e=new Array(256),n=0;n<256;++n)e[n]=String.fromCharCode(n);se=e}(),pe=l.BindingError=he(Error,"BindingError"),ve=l.InternalError=he(Error,"InternalError"),Me.prototype.isAliasOf=ge,Me.prototype.clone=Pe,Me.prototype.delete=Se,Me.prototype.isDeleted=Ee,Me.prototype.deleteLater=De,Qe.prototype.getPointee=Fe,Qe.prototype.destructor=Be,Qe.prototype.argPackAdvance=8,Qe.prototype.readValueFromPointer=Ne,Qe.prototype.deleteObject=Ve,Qe.prototype.fromWireType=Ye,l.getInheritedInstanceCount=qe,l.getLiveInheritedInstances=Ge,l.flushPendingDeletes=Ae,l.setDelayFunction=He,tn=l.UnboundTypeError=he(Error,"UnboundTypeError"),l.count_emval_handles=fn,l.get_first_emval=hn;var jn,Zn={__cxa_allocate_exception:function(e){return gn(e+16)+16},__cxa_throw:function(e,n,t){throw new ie(e).init(n,t),e,e},_embind_register_bigint:function(e,n,t,r,i){},_embind_register_bool:function(e,n,t,r,i){var a=ae(t);Ze(e,{name:n=oe(n),fromWireType:function(e){return!!e},toWireType:function(e,n){return n?r:i},argPackAdvance:8,readValueFromPointer:function(e){var r;if(1===t)r=P;else if(2===t)r=E;else{if(4!==t)throw new TypeError("Unknown boolean type size: "+n);r=_}return this.fromWireType(r[e>>a])},destructorFunction:null})},_embind_register_class:function(e,n,t,r,i,a,s,o,c,u,d,f,h){d=oe(d),a=nn(i,a),o&&(o=nn(s,o)),u&&(u=nn(c,u)),h=nn(f,h);var p=de(d);!function(e,n,t){l.hasOwnProperty(e)?((void 0===t||void 0!==l[e].overloadTable&&void 0!==l[e].overloadTable[t])&&xe("Cannot register public name '"+e+"' twice"),Ke(l,e,e),l.hasOwnProperty(t)&&xe("Cannot register multiple overloads of a function with the same number of arguments ("+t+")!"),l[e].overloadTable[t]=n):(l[e]=n,void 0!==t&&(l[e].numArguments=t))}(p,(function(){an("Cannot construct "+d+" due to unbound types",[r])})),je([e,n,t],r?[r]:[],(function(n){var t,i;n=n[0],i=r?(t=n.registeredClass).instancePrototype:Me.prototype;var s=fe(p,(function(){if(Object.getPrototypeOf(this)!==c)throw new pe("Use 'new' to construct "+d);if(void 0===f.constructor_body)throw new pe(d+" has no accessible constructor");var e=f.constructor_body[arguments.length];if(void 0===e)throw new pe("Tried to invoke ctor of "+d+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(f.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),c=Object.create(i,{constructor:{value:s}});s.prototype=c;var f=new Ie(d,s,c,h,t,a,o,u),x=new Qe(d,f,!0,!1,!1),v=new Qe(d+"*",f,!1,!1,!1),m=new Qe(d+" const*",f,!1,!0,!1);return Te[e]={pointerType:v,constPointerType:m},function(e,n,t){l.hasOwnProperty(e)||me("Replacing nonexistant public symbol"),void 0!==l[e].overloadTable&&void 0!==t?l[e].overloadTable[t]=n:(l[e]=n,l[e].argCount=t)}(p,s),[x,v,m]}))},_embind_register_class_constructor:function(e,n,t,r,i,a){var s;n>0||U(s);var o=sn(n,t);i=nn(r,i),je([],[e],(function(e){var t="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[n-1])throw new pe("Cannot register multiple constructors with identical number of parameters ("+(n-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[n-1]=function(){an("Cannot construct "+e.name+" due to unbound types",o)},je([],o,(function(r){return r.splice(1,0,null),e.registeredClass.constructor_body[n-1]=cn(t,r,null,i,a),[]})),[]}))},_embind_register_class_function:function(e,n,t,r,i,a,s,o){var c=sn(t,r);n=oe(n),a=nn(i,a),je([],[e],(function(e){var r=(e=e[0]).name+"."+n;function i(){an("Cannot call "+r+" due to unbound types",c)}n.startsWith("@@")&&(n=Symbol[n.substring(2)]),o&&e.registeredClass.pureVirtualFunctions.push(n);var l=e.registeredClass.instancePrototype,u=l[n];return void 0===u||void 0===u.overloadTable&&u.className!==e.name&&u.argCount===t-2?(i.argCount=t-2,i.className=e.name,l[n]=i):(Ke(l,n,r),l[n].overloadTable[t-2]=i),je([],c,(function(i){var o=cn(r,i,e,a,s);return void 0===l[n].overloadTable?(o.argCount=t-2,l[n]=o):l[n].overloadTable[t-2]=o,[]})),[]}))},_embind_register_class_property:function(e,n,t,r,i,a,s,o,c,l){n=oe(n),i=nn(r,i),je([],[e],(function(e){var r=(e=e[0]).name+"."+n,u={get:function(){an("Cannot access "+r+" due to unbound types",[t,s])},enumerable:!0,configurable:!0};return u.set=c?function(){an("Cannot access "+r+" due to unbound types",[t,s])}:function(e){xe(r+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,n,u),je([],c?[t,s]:[t],(function(t){var s=t[0],u={get:function(){var n=ln(this,e,r+" getter");return s.fromWireType(i(a,n))},enumerable:!0};if(c){c=nn(o,c);var d=t[1];u.set=function(n){var t=ln(this,e,r+" setter"),i=[];c(l,t,d.toWireType(i,n)),on(i)}}return Object.defineProperty(e.registeredClass.instancePrototype,n,u),[]})),[]}))},_embind_register_emval:function(e,n){Ze(e,{name:n=oe(n),fromWireType:function(e){var n=pn.toValue(e);return function(e){e>4&&0===--dn[e].refcount&&(dn[e]=void 0,un.push(e))}(e),n},toWireType:function(e,n){return pn.toHandle(n)},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:null})},_embind_register_float:function(e,n,t){var r=ae(t);Ze(e,{name:n=oe(n),fromWireType:function(e){return e},toWireType:function(e,n){return n},argPackAdvance:8,readValueFromPointer:vn(n,r),destructorFunction:null})},_embind_register_integer:function(e,n,t,r,i){n=oe(n),-1===i&&(i=4294967295);var a=ae(t),s=function(e){return e};if(0===r){var o=32-8*t;s=function(e){return e<<o>>>o}}var c=n.includes("unsigned");Ze(e,{name:n,fromWireType:s,toWireType:c?function(e,n){return this.name,n>>>0}:function(e,n){return this.name,n},argPackAdvance:8,readValueFromPointer:mn(n,a,0!==r),destructorFunction:null})},_embind_register_memory_view:function(e,n,t){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][n];function i(e){var n=A,t=n[e>>=2],i=n[e+1];return new r(k,i,t)}Ze(e,{name:t=oe(t),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},_embind_register_std_string:function(e,n){var t="std::string"===(n=oe(n));Ze(e,{name:n,fromWireType:function(e){var n,r=A[e>>2];if(t)for(var i=e+4,a=0;a<=r;++a){var s=e+4+a;if(a==r||0==S[s]){var o=w(i,s-i);void 0===n?n=o:(n+=String.fromCharCode(0),n+=o),i=s+1}}else{var c=new Array(r);for(a=0;a<r;++a)c[a]=String.fromCharCode(S[e+4+a]);n=c.join("")}return yn(e),n},toWireType:function(e,n){var r;n instanceof ArrayBuffer&&(n=new Uint8Array(n));var i="string"===typeof n;i||n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Int8Array||xe("Cannot pass non-string to std::string"),r=t&&i?function(){return function(e){for(var n=0,t=0;t<e.length;++t){var r=e.charCodeAt(t);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++t)),r<=127?++n:n+=r<=2047?2:r<=65535?3:4}return n}(n)}:function(){return n.length};var a=r(),s=gn(4+a+1);if(A[s>>2]=a,t&&i)C(n,s+4,a+1);else if(i)for(var o=0;o<a;++o){var c=n.charCodeAt(o);c>255&&(yn(s),xe("String has UTF-16 code units that do not fit in 8 bits")),S[s+4+o]=c}else for(o=0;o<a;++o)S[s+4+o]=n[o];return null!==e&&e.push(yn,s),s},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:function(e){yn(e)}})},_embind_register_std_wstring:function(e,n,t){var r,i,a,s,o;t=oe(t),2===n?(r=K,i=I,s=R,a=function(){return O},o=1):4===n&&(r=z,i=$,s=W,a=function(){return A},o=2),Ze(e,{name:t,fromWireType:function(e){for(var t,i=A[e>>2],s=a(),c=e+4,l=0;l<=i;++l){var u=e+4+l*n;if(l==i||0==s[u>>o]){var d=r(c,u-c);void 0===t?t=d:(t+=String.fromCharCode(0),t+=d),c=u+n}}return yn(e),t},toWireType:function(e,r){"string"!==typeof r&&xe("Cannot pass non-string to C++ string type "+t);var a=s(r),c=gn(4+a+n);return A[c>>2]=a>>o,i(r,c+4,a+n),null!==e&&e.push(yn,c),c},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:function(e){yn(e)}})},_embind_register_void:function(e,n){Ze(e,{isVoid:!0,name:n=oe(n),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,n){}})},abort:function(){U("")},emscripten_memcpy_big:function(e,n,t){S.copyWithin(e,n,n+t)},emscripten_resize_heap:function(e){S.length,U("OOM")}},gn=(function(){var e={env:Zn,wasi_snapshot_preview1:Zn};function n(e,n){var t,r,i=e.exports;l.asm=i,Z=l.asm.memory,t=Z.buffer,k=t,l.HEAP8=P=new Int8Array(t),l.HEAP16=E=new Int16Array(t),l.HEAP32=_=new Int32Array(t),l.HEAPU8=S=new Uint8Array(t),l.HEAPU16=O=new Uint16Array(t),l.HEAPU32=A=new Uint32Array(t),l.HEAPF32=D=new Float32Array(t),l.HEAPF64=M=new Float64Array(t),N=l.asm.__indirect_function_table,r=l.asm.__wasm_call_ctors,B.unshift(r),function(e){if(q--,l.monitorRunDependencies&&l.monitorRunDependencies(q),0==q&&(null!==G&&(clearInterval(G),G=null),H)){var n=H;H=null,n()}}()}function t(e){n(e.instance)}function r(n){return function(){if(!j&&(h||p)){if("function"===typeof fetch&&!Q(J))return fetch(J,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+J+"'";return e.arrayBuffer()})).catch((function(){return ee(J)}));if(i)return new Promise((function(e,n){i(J,(function(n){e(new Uint8Array(n))}),n)}))}return Promise.resolve().then((function(){return ee(J)}))}().then((function(n){return WebAssembly.instantiate(n,e)})).then((function(e){return e})).then(n,(function(e){m("failed to asynchronously prepare wasm: "+e),U(e)}))}if(q++,l.monitorRunDependencies&&l.monitorRunDependencies(q),l.instantiateWasm)try{return l.instantiateWasm(e,n)}catch(a){return m("Module.instantiateWasm callback failed with error: "+a),!1}j||"function"!==typeof WebAssembly.instantiateStreaming||Y(J)||Q(J)||"function"!==typeof fetch?r(t):fetch(J,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,e).then(t,(function(e){return m("wasm streaming compile failed: "+e),m("falling back to ArrayBuffer instantiation"),r(t)}))}))}(),l.___wasm_call_ctors=function(){return(l.___wasm_call_ctors=l.asm.__wasm_call_ctors).apply(null,arguments)},l._malloc=function(){return(gn=l._malloc=l.asm.malloc).apply(null,arguments)}),yn=l._free=function(){return(yn=l._free=l.asm.free).apply(null,arguments)},bn=l.___getTypeName=function(){return(bn=l.___getTypeName=l.asm.__getTypeName).apply(null,arguments)};l.___embind_register_native_and_builtin_types=function(){return(l.___embind_register_native_and_builtin_types=l.asm.__embind_register_native_and_builtin_types).apply(null,arguments)},l.___errno_location=function(){return(l.___errno_location=l.asm.__errno_location).apply(null,arguments)},l.stackSave=function(){return(l.stackSave=l.asm.stackSave).apply(null,arguments)},l.stackRestore=function(){return(l.stackRestore=l.asm.stackRestore).apply(null,arguments)},l.stackAlloc=function(){return(l.stackAlloc=l.asm.stackAlloc).apply(null,arguments)};function wn(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Cn(e){function n(){jn||(jn=!0,l.calledRun=!0,y||(!0,ne(B),l.onRuntimeInitialized&&l.onRuntimeInitialized(),function(){if(l.postRun)for("function"==typeof l.postRun&&(l.postRun=[l.postRun]);l.postRun.length;)e=l.postRun.shift(),V.unshift(e);var e;ne(V)}()))}e=e||f,q>0||(!function(){if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)e=l.preRun.shift(),F.unshift(e);var e;ne(F)}(),q>0||(l.setStatus?(l.setStatus("Running..."),setTimeout((function(){setTimeout((function(){l.setStatus("")}),1),n()}),1)):n()))}if(H=function e(){jn||Cn(),jn||(H=e)},l.run=Cn,l.preInit)for("function"==typeof l.preInit&&(l.preInit=[l.preInit]);l.preInit.length>0;)l.preInit.pop()();Cn()},21678:function(){},10699:function(){}}]);
//# sourceMappingURL=884.a2f8a367.chunk.js.map