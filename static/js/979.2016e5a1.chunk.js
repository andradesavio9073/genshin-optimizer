"use strict";(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[979],{3992:function(e,t,n){var r=n(66934),a=n(57621),i=(0,r.ZP)(a.Z)((function(e){return{backgroundColor:e.theme.palette.contentDark.main}}));t.Z=i},71310:function(e,t,n){var r=n(66934),a=n(57621),i=(0,r.ZP)(a.Z)((function(e){return{backgroundColor:e.theme.palette.contentLight.main}}));t.Z=i},10600:function(e,t,n){n.d(t,{CC:function(){return v},ZP:function(){return x},el:function(){return f}});var r=n(29439),a=n(1413),i=n(45987),s=n(66934),o=n(4834),c=n(24518),l=n(72791),u=n(80184),d=["children","disableRipple","disableFocusRipple","disableTouchRipple"],h=["value","onChange","disabled","float"],f=(0,s.ZP)(o.ZP)((function(e){var t=e.theme;return{backgroundColor:t.palette.primary.main,transition:"all 0.5s ease","&:hover":{backgroundColor:t.palette.primary.dark},"&.Mui-focused":{backgroundColor:t.palette.primary.dark},"&.Mui-disabled":{backgroundColor:t.palette.primary.dark}}})),p=(0,s.ZP)(c.Z)((function(e){return{backgroundColor:e.theme.palette.primary.main,padding:0,overflow:"hidden",div:{width:"100%",height:"100%"}}}));function v(e){var t=e.children,n=(e.disableRipple,e.disableFocusRipple,e.disableTouchRipple,(0,i.Z)(e,d));return(0,u.jsx)(p,(0,a.Z)((0,a.Z)({disableRipple:!0,disableFocusRipple:!0,disableTouchRipple:!0},n),{},{children:t}))}function x(e){var t=e.value,n=void 0===t?0:t,s=e.onChange,o=e.disabled,c=void 0!==o&&o,d=e.float,p=void 0!==d&&d,v=(0,i.Z)(e,h),x=(0,l.useState)(n),g=(0,r.Z)(x,2),Z=g[0],m=g[1],j=(0,l.useState)(!1),b=(0,r.Z)(j,2),y=b[0],w=b[1],C=(0,l.useMemo)((function(){return p?parseFloat:parseInt}),[p]),k=(0,l.useCallback)((function(){s(Z),w(!1)}),[s,Z,w]),S=(0,l.useCallback)((function(){w(!0)}),[w]);(0,l.useEffect)((function(){return m(n)}),[n,m]);var _=(0,l.useCallback)((function(e){return m(C(e.target.value)||0)}),[m,C]),D=(0,l.useCallback)((function(e){return"Enter"===e.key&&k()}),[k]);return(0,u.jsx)(f,(0,a.Z)({value:y&&!Z?"":Z,"aria-label":"custom-input",type:"number",inputProps:{step:p?.1:1},onChange:_,onBlur:k,onFocus:S,disabled:c,onKeyDown:D},v))}},33890:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(1413),a=n(29439),i=n(45987),s=n(1235),o=n(24518),c=n(47047),l=n(65117),u=n(72791),d=n(80184),h=["title","children","id"];function f(e){var t=e.title,n=e.children,f=e.id,p=void 0===f?"dropdownbtn":f,v=(0,i.Z)(e,h),x=(0,u.useState)(null),g=(0,a.Z)(x,2),Z=g[0],m=g[1],j=Boolean(Z),b=(0,u.useCallback)((function(e){return m(e.currentTarget)}),[m]),y=(0,u.useCallback)((function(){return m(null)}),[m]);return(0,d.jsxs)(u.Suspense,{fallback:(0,d.jsx)(o.Z,(0,r.Z)((0,r.Z)({endIcon:(0,d.jsx)(s.Z,{})},v),{},{children:(0,d.jsx)(c.Z,{width:50})})),children:[(0,d.jsx)(o.Z,(0,r.Z)((0,r.Z)({},v),{},{id:p,"aria-controls":"basic-menu","aria-haspopup":"true","aria-expanded":j?"true":void 0,onClick:b,endIcon:(0,d.jsx)(s.Z,{}),children:t})),(0,d.jsx)(l.Z,{id:"basic-menu",anchorEl:Z,open:j,onClose:y,MenuListProps:{"aria-labelledby":p},onClick:y,children:(0,d.jsx)(u.Suspense,{fallback:(0,d.jsx)(c.Z,{width:"100%",height:"1000"}),children:n})})]})}},9321:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(1413),a=n(45987),i=n(66934),s=n(29968),o=n(89164),c=n(39504),l=n(47047),u=n(72791),d=n(71310),h=n(80184),f=["children","containerProps"],p=(0,i.ZP)(s.Z)((function(e){var t=e.theme;return{overflow:"scroll",paddingTop:t.spacing(2),paddingBottom:t.spacing(2)}})),v=(0,i.ZP)(o.Z)((function(e){e.theme;return{padding:0,minHeight:"100%",display:"flex",flexDirection:"column",justifyContent:"center",pointerEvents:"none","& > *":{pointerEvents:"auto"}}}));function x(e){var t=e.children,n=e.containerProps,i=(0,a.Z)(e,f);return(0,h.jsx)(p,(0,r.Z)((0,r.Z)({},i),{},{children:(0,h.jsx)(v,(0,r.Z)((0,r.Z)({},n),{},{children:(0,h.jsx)(u.Suspense,{fallback:(0,h.jsx)(d.Z,{children:(0,h.jsx)(c.Z,{children:(0,h.jsx)(l.Z,{variant:"rectangular",width:"100%",height:300})})}),children:t})}))}))}},20323:function(e,t,n){function r(){return{tcMode:!1}}n.d(t,{c:function(){return r}})},76979:function(e,t,n){n.r(t),n.d(t,{default:function(){return De}});var r=n(39504),a=n(20890),i=n(94721),s=n(10757),o=n(22020),c=n(76899),l=n(3992),u=n(29439),d=n(30168),h=n(53174),f=n(74223),p=n(80184),v=(0,f.Z)((0,p.jsx)("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),x=(0,f.Z)((0,p.jsx)("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload"),g=n(72456),Z=(0,f.Z)((0,p.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),m=n(61889),j=n(24518),b=n(81918),y=n(52791),w=n(72791),C=n(71310),k=n(10600),S=n(82095),_=n(9321),D=n(7618),O=n(23741),P=n(1413),M="Genshin Optimizer";var B=n(3608);function W(e){var t=new Map,n=e.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("artifact_")})).map((function(e,n){var r=(0,u.Z)(e,2),a=r[0],i=r[1];return t.set(a,n),JSON.parse(i)}));return{format:"GOOD",dbVersion:B.U,source:M,version:1,characters:e.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("char_")})).map((function(e){var t=(0,u.Z)(e,2),n=(t[0],t[1]);return JSON.parse(n)})),artifacts:n,weapons:e.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("weapon_")})).map((function(e){var t=(0,u.Z)(e,2),n=(t[0],t[1]);return JSON.parse(n)})),states:e.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("state_")})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return(0,P.Z)((0,P.Z)({},JSON.parse(r)),{},{key:n.split("state_")[1]})})),buildSettings:e.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("buildSetting_")})).map((function(e){var n=(0,u.Z)(e,2),r=n[0],a=n[1],i=(0,P.Z)((0,P.Z)({},JSON.parse(a)),{},{key:r.split("buildSetting_")[1]});return i.builds=i.builds.map((function(e){return e.map((function(e){return t.has(e)?"artifact_".concat(t.get(e)):""})).filter((function(e){return e}))})),i}))}}var F=n(24711),I=n(17278),T=n(60393),E=n(74165),K=n(15861),R=n(54483),G=n(66934),z=n(68870),H=n(45987),V=n(93433),N=n(37762);var J=n(45748),L=["key"],$=["key"];function A(e,t){if(1===e.version)return function(e,t){var n=function(e){var t=e.source,n=new O.NI,r={type:"GOOD",storage:n,source:t};if(e.artifacts){r.artifacts={total:0,invalid:[],new:[],updated:[],unchanged:[],removed:[]};var a=r.artifacts;a.total=e.artifacts.length,e.artifacts.forEach((function(e,t){(0,J.R$)(e)?n.set("artifact_".concat(t),e):a.invalid.push(e)}))}if(e.weapons){r.weapons={total:0,invalid:[],new:[],updated:[],unchanged:[],removed:[]};var i=r.weapons;i.total=e.weapons.length,e.weapons.forEach((function(e,t){var r=(0,J.S0)(e);return r?n.set("weapon_".concat(t),e):i.invalid.push(e),r?[r]:[]})),r.weapons=i}if(e.characters){r.characters={total:0,invalid:[],new:[],updated:[],unchanged:[],removed:[]};var s=r.characters;s.total=e.characters.length,e.characters.forEach((function(e){(0,J.J0)(e)||s.invalid.push(e),e.buildSettings&&(e.buildSettings.builds=[],e.buildSettings.buildDate=0),n.set("char_".concat(e.key),e)}))}if(t===M){var o=e,c=o.dbVersion,l=o.states,u=o.buildSettings;if(c<8)return;n.setDBVersion(c),l&&l.forEach((function(e){var t=e,r=t.key,a=(0,H.Z)(t,L);r&&n.set("state_".concat(r),a)})),u&&u.forEach((function(e){var t=e,r=t.key,a=(0,H.Z)(t,$);r&&n.set("buildSetting_".concat(r),a)}))}else n.setDBVersion(8);return r}(e);if(!n)return;return(0,B.T)(n.storage),function(e,t){var n=e.artifacts,r=e.weapons,a=e.characters,i=e.storage;if(n?function(){var e,r=i.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("artifact_")})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return[n,JSON.parse(r)]})),a=new Set(t.arts.values.map((function(e){return e.id}))),s=r.some((function(e){return e[1].location})),o=(0,N.Z)(r);try{for(o.s();!(e=o.n()).done;){var c,l=(0,u.Z)(e.value,2),d=l[0],h=l[1],f=t.arts.findDups(h),p=f.duplicated,v=f.upgraded;p=p.filter((function(e){return a.has(e.id)})),v=v.filter((function(e){return a.has(e.id)}));var x=null!==(c=p[0])&&void 0!==c?c:v[0];if(x){for(var g in a.delete(x.id),x)g in h||"location"===g||(h[g]=x[g]);s||(h.location=x.location)}p.length?n.unchanged.push(h):v.length?n.updated.push(h):n.new.push(h),i.set(d,h)}}catch(Z){o.e(Z)}finally{o.f()}n.removed=(0,V.Z)(a).map((function(e){return t.arts.get(e)}))}():t.arts.values.forEach((function(e,t){return i.set("artifact_".concat(t),e)})),r?function(){var e,n=i.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("weapon_")})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return[n,JSON.parse(r)]})),a=new Set(t.weapons.values.map((function(e){return e.id}))),s=n.some((function(e){return e[1].location})),o=(0,N.Z)(n);try{for(o.s();!(e=o.n()).done;){var c,l=(0,u.Z)(e.value,2),d=l[0],h=l[1],f=t.weapons.findDup(h),p=f.duplicated,v=f.upgraded;p=p.filter((function(e){return a.has(e.id)})),v=v.filter((function(e){return a.has(e.id)}));var x=null!==(c=p[0])&&void 0!==c?c:v[0];if(x){for(var g in a.delete(x.id),x)g in h||"location"===g||(h[g]=x[g]);s||(h.location=x.location)}p.length?r.unchanged.push(h):v.length?r.updated.push(h):r.new.push(h),i.set(d,h)}}catch(Z){o.e(Z)}finally{o.f()}r.removed=(0,V.Z)(a).map((function(e){return t.weapons.get(e)}))}():t.weapons.values.forEach((function(e,t){return i.set("weapon_".concat(t),e)})),a){var s=i.entries.filter((function(e){return(0,u.Z)(e,1)[0].startsWith("char_")})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return[n.slice(5),JSON.parse(r)]})),o=new Set(s.map((function(e){return(0,u.Z)(e,1)[0]}))),c=new Set(t.chars.keys);a.updated=[],a.new=[];var l,d=s.some((function(e){var t=(0,u.Z)(e,2);return t[0],t[1].team.some((function(e){return e}))})),h=(0,N.Z)(s);try{for(h.s();!(l=h.n()).done;){var f=(0,u.Z)(l.value,2),p=f[0],v=f[1],x=t.chars.get(p);if(x){for(var g in a.updated.push(v),x)g in v||(v[g]=x[g]);d||(v.team=x.team),i.set("char_".concat(p),v)}else a.new.push(v)}}catch(y){h.e(y)}finally{h.f()}a.removed=(0,V.Z)(c).filter((function(e){var t=(0,u.Z)(e,1)[0];return o.has(t)})).map((function(e){return t.chars.get(e)})),a.unchanged=[]}else t.chars.keys.forEach((function(e){return i.set("char_".concat(e),t.chars.get(e))}));var Z,m=new Set(i.keys),j=(0,N.Z)(t.storage.keys);try{for(j.s();!(Z=j.n()).done;){var b=Z.value;m.has(b)||b.startsWith("artifact_")||b.startsWith("weapon_")||b.startsWith("char_")||i.setString(b,t.storage.getString(b))}}catch(y){j.e(y)}finally{j.f()}}(n,t),n}(e,t)}var U={1:function(e){var t=[];for(var n in e)if(n in re){var r,a=(0,N.Z)(e[n]);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=i.setName,o=i.star,c=i.level,l=i.position,u=i.mainTag,d={setKey:ae[s],rarity:o,level:c,slotKey:re[l],mainStatKey:ie[u.name],substats:i.normalTags.map((function(e){var t=e.name,n=e.value,r=se[t];return{key:r,value:null!==r&&void 0!==r&&r.endsWith("_")?Math.round(1e3*n)/10:n}}))};t.push(d)}}catch(h){a.e(h)}finally{a.f()}}return{artifacts:t}}};var Y,q,Q,X,ee,te,ne,re={flower:"flower",feather:"plume",sand:"sands",cup:"goblet",head:"circlet"},ae={adventurer:"Adventurer",archaicPetra:"ArchaicPetra",berserker:"Berserker",blizzardStrayer:"BlizzardStrayer",bloodstainedChivalry:"BloodstainedChivalry",braveHeart:"BraveHeart",crimsonWitch:"CrimsonWitchOfFlames",defenderWill:"DefendersWill",gambler:"Gambler",gladiatorFinale:"GladiatorsFinale",heartOfDepth:"HeartOfDepth",instructor:"Instructor",lavaWalker:"Lavawalker",luckyDog:"LuckyDog",maidenBeloved:"MaidenBeloved",martialArtist:"MartialArtist",noblesseOblige:"NoblesseOblige",prayersForDestiny:"PrayersForDestiny",prayersForIllumination:"PrayersForIllumination",prayersForWisdom:"PrayersForWisdom",prayersToSpringtime:"PrayersToSpringtime",resolutionOfSojourner:"ResolutionOfSojourner",retracingBolide:"RetracingBolide",scholar:"Scholar",exile:"TheExile",thunderingFury:"ThunderingFury",thunderSmoother:"Thundersoother",tinyMiracle:"TinyMiracle",travelingDoctor:"TravelingDoctor",viridescentVenerer:"ViridescentVenerer",wandererTroupe:"WanderersTroupe",tenacityOfTheMillelith:"TenacityOfTheMillelith",paleFlame:"PaleFlame",emblemOfSeveredFate:"EmblemOfSeveredFate",shimenawaReminiscence:"ShimenawasReminiscence",huskOfOpulentDreams:"HuskOfOpulentDreams",oceanHuedClam:"OceanHuedClam",EchoesOfAnOffering:"EchoesOfAnOffering",VermillionHereafter:"VermillionHereafter"},ie={cureEffect:"heal_",lifeStatic:"hp",lifePercentage:"hp_",attackStatic:"atk",attackPercentage:"atk_",defendPercentage:"def_",critical:"critRate_",criticalDamage:"critDMG_",elementalMastery:"eleMas",recharge:"enerRech_",thunderBonus:"electro_dmg_",fireBonus:"pyro_dmg_",waterBonus:"hydro_dmg_",iceBonus:"cryo_dmg_",windBonus:"anemo_dmg_",rockBonus:"geo_dmg_",physicalBonus:"physical_dmg_"},se={lifeStatic:"hp",lifePercentage:"hp_",attackStatic:"atk",attackPercentage:"atk_",defendStatic:"def",defendPercentage:"def_",critical:"critRate_",criticalDamage:"critDMG_",elementalMastery:"eleMas",recharge:"enerRech_"},oe=(0,G.ZP)("input")({display:"none"});function ce(e){var t,n=e.onReplace,i=(0,w.useContext)(D.t).database,s=(0,o.$)("settings").t,d=(0,w.useState)(""),f=(0,u.Z)(d,2),v=f[0],g=f[1],Z=(0,w.useState)(""),b=(0,u.Z)(Z,2),y=b[0],k=b[1],S=(0,w.useState)(""),_=(0,u.Z)(S,2),O=_[0],P=_[1],M=(0,w.useMemo)((function(){if(v){var e;try{if("object"!==typeof(e=JSON.parse(v)))return void P("uploadCard.error.jsonParse")}catch(r){return void P("uploadCard.error.jsonParse")}if("1"===e.version&&["flower","feather","sand","cup","head"].some((function(t){return Object.keys(e).includes(t)}))){var t=function(e,t){var n,r,a=null!==(n=e.version)&&void 0!==n?n:"1",i=null===(r=U[a])||void 0===r?void 0:r.call(U,e);if(i)return A({format:"GOOD",source:"mona-uranai",version:1,artifacts:i.artifacts},t)}(e,i);return t||void P("uploadCard.error.monaInvalid")}if("GOOD"===e.format){var n=A(e,i);return n||void P("uploadCard.error.goInvalid")}P("uploadCard.error.unknown")}}),[v,i]),B=function(){var e=(0,K.Z)((0,E.Z)().mark((function e(t){var n,r;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],t.target.value=null,n&&k(n.name),(r=new FileReader).onload=function(){return g(r.result)},r.readAsText(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,p.jsxs)(C.Z,{children:[(0,p.jsx)(r.Z,{sx:{py:1},children:(0,p.jsx)(c.c,{t:s,i18nKey:"settings:uploadCard.title"})}),(0,p.jsxs)(r.Z,{children:[(0,p.jsxs)(m.ZP,{container:!0,spacing:2,sx:{mb:1},children:[(0,p.jsx)(m.ZP,{item:!0,children:(0,p.jsxs)("label",{htmlFor:"icon-button-file",children:[(0,p.jsx)(oe,{accept:".json",id:"icon-button-file",type:"file",onChange:B}),(0,p.jsx)(j.Z,{component:"span",startIcon:(0,p.jsx)(x,{}),children:"Upload"})]})}),(0,p.jsx)(m.ZP,{item:!0,flexGrow:1,children:(0,p.jsx)(l.Z,{sx:{px:2,py:1},children:(0,p.jsx)(a.Z,{children:y?(0,p.jsxs)("span",{children:[(0,p.jsx)(R.G,{icon:h.w49})," ",y]}):(0,p.jsxs)("span",{children:[(0,p.jsx)(R.G,{icon:h.acZ})," ",(0,p.jsx)(c.c,{t:s,i18nKey:"settings:uploadCard.hint"})]})})})})]}),(0,p.jsx)(a.Z,{gutterBottom:!0,variant:"caption",children:(0,p.jsx)(c.c,{t:s,i18nKey:"settings:uploadCard.hintPaste"})}),(0,p.jsx)(z.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",mb:2,resize:"vertical"},value:v,onChange:function(e){return g(e.target.value)}}),null!==(t=le(M))&&void 0!==t?t:s(O)]}),ue(M,(function(){g(""),k(""),n()}))]})}function le(e){if("GOOD"===(null===e||void 0===e?void 0:e.type))return(0,p.jsx)(de,{data:e})}function ue(e,t){if("GOOD"===(null===e||void 0===e?void 0:e.type))return(0,p.jsx)(fe,{data:e,reset:t})}function de(e){var t=e.data,n=t.source,s=t.artifacts,u=t.characters,d=t.weapons,h=(e.data,(0,o.$)("settings").t);return(0,p.jsxs)(l.Z,{children:[(0,p.jsx)(r.Z,{sx:{py:1},children:(0,p.jsxs)(a.Z,{children:[(0,p.jsx)(c.c,{t:h,i18nKey:"uploadCard.dbSource"}),(0,p.jsxs)("strong",{children:[" ",n]})]})}),(0,p.jsx)(i.Z,{}),(0,p.jsx)(r.Z,{children:(0,p.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,p.jsx)(m.ZP,{item:!0,flexGrow:1,children:(0,p.jsx)(he,{result:s,type:"arts"})}),(0,p.jsx)(m.ZP,{item:!0,flexGrow:1,children:(0,p.jsx)(he,{result:d,type:"weapons"})}),(0,p.jsx)(m.ZP,{item:!0,flexGrow:1,children:(0,p.jsx)(he,{result:u,type:"chars"})})]})})]})}function he(e){var t,n,s=e.result,l=e.type,u=(0,o.$)("settings").t;return s?(0,p.jsxs)(C.Z,{children:[(0,p.jsx)(r.Z,{sx:{py:1},children:(0,p.jsxs)(a.Z,{children:[(0,p.jsx)(c.c,{t:u,i18nKey:"count.".concat(l)})," ",null!==(t=s.total)&&void 0!==t?t:0]})}),(0,p.jsx)(i.Z,{}),(0,p.jsxs)(r.Z,{children:[(0,p.jsxs)(a.Z,{children:[(0,p.jsx)(c.c,{t:u,i18nKey:"count.new"})," ",(0,p.jsx)("strong",{children:s.new.length})," / ",s.total]}),(0,p.jsxs)(a.Z,{children:[(0,p.jsx)(c.c,{t:u,i18nKey:"count.updated"})," ",(0,p.jsx)("strong",{children:s.updated.length})," / ",s.total]}),(0,p.jsxs)(a.Z,{children:[(0,p.jsx)(c.c,{t:u,i18nKey:"count.unchanged"})," ",(0,p.jsx)("strong",{children:s.unchanged.length})," / ",s.total]}),(0,p.jsxs)(a.Z,{color:"warning.main",children:[(0,p.jsx)(c.c,{t:u,i18nKey:"count.removed"})," ",(0,p.jsx)("strong",{children:s.removed.length})]}),!(null===(n=s.invalid)||void 0===n||!n.length)&&(0,p.jsxs)("div",{children:[(0,p.jsxs)(a.Z,{color:"error.main",children:[(0,p.jsx)(c.c,{t:u,i18nKey:"count.invalid"})," ",(0,p.jsx)("strong",{children:s.invalid.length})," / ",s.total]}),(0,p.jsx)(z.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",resize:"vertical"},value:JSON.stringify(s.invalid,void 0,2),disabled:!0})]})]})]}):null}function fe(e){var t,n,a,s=e.data.storage,l=e.data,u=e.reset,d=(0,w.useContext)(D.t),f=d.database,v=d.setDatabase,x=(0,o.$)("settings").t,g=(null===(t=l.characters)||void 0===t?void 0:t.total)||(null===(n=l.artifacts)||void 0===n?void 0:n.total)||(null===(a=l.weapons)||void 0===a?void 0:a.total);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.Z,{}),(0,p.jsx)(r.Z,{sx:{py:1},children:(0,p.jsx)(j.Z,{color:g?"success":"error",disabled:!g,onClick:function(){f.clear(),f.storage.copyFrom(s),v(new D.M(f.storage)),u()},startIcon:(0,p.jsx)(R.G,{icon:h.Y9i}),children:(0,p.jsx)(c.c,{t:x,i18nKey:"settings:uploadCard.replaceDatabase"})})})]})}function pe(){var e=(0,w.useContext)(D.t),t=parseInt(e.database.storage.getString("dbIndex")||"1"),n=(0,o.$)(["settings"]).t;return(0,p.jsxs)(C.Z,{children:[(0,p.jsx)(r.Z,{sx:{py:1},children:(0,p.jsx)(a.Z,{variant:"subtitle1",children:n(Y||(Y=(0,d.Z)(["DatabaseCard.title"])))})}),(0,p.jsx)(i.Z,{}),(0,p.jsx)(r.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,p.jsx)(m.ZP,{container:!0,spacing:2,columns:{xs:1,md:2},children:(0,T.w6)(1,4).map((function(n){return(0,p.jsx)(m.ZP,{item:!0,xs:1,children:n===t?(0,p.jsx)(xe,{index:n}):(0,p.jsx)(ve,{index:n,children:(0,p.jsx)(xe,{index:n,databaseContextObj:e})})},n)}))})})]})}function ve(e){var t=e.index,n=e.children,r=(0,w.useState)((function(){var e,n="extraDatabase_".concat(t),r=new O.Bc(n),a=JSON.parse(null!==(e=localStorage.getItem(n))&&void 0!==e?e:'{ "dbIndex": "'.concat(t,'" }'));r.setStorage(a),r.removeForKeys((function(e){return e.startsWith("extraDatabase_")}));var i=new D.M(r);return r.saveStorage(),i})),a=(0,u.Z)(r,2),i=a[0],s=a[1];return(0,p.jsx)(D.t.Provider,{value:{database:i,setDatabase:s},children:n})}function xe(e){var t=e.index,n=e.databaseContextObj,s=(0,w.useContext)(D.t),f=s.database,C=s.setDatabase,P=(0,I.Z)("dbMeta",(0,I.t)(t)),M=(0,u.Z)(P,2),B=M[0],T=B.name,E=B.lastEdit,K=M[1],R=!n,G=(0,F.Z)(),z=(0,u.Z)(G,3),H=z[0],V=z[1],N=z[2],J=(0,o.$)(["settings"]).t,L=f.chars.keys.length,$=f.arts.values.length,A=f.weapons.values.length,U=Boolean(L||$||A),Y=(0,w.useCallback)((function(){return navigator.clipboard.writeText(JSON.stringify(W(f.storage))).then((function(){return alert("Copied database to clipboard.")})).catch(console.error)}),[f]),re=(0,w.useCallback)((function(){(N(),R)||f.storage.saveStorage()}),[N,R,f.storage]),ae=(0,w.useCallback)((function(){if(R)f.clear(),C(new D.M(f.storage));else{var e=f.storage.databaseName,t=new O.Bc(e);t.setStorage({}),C(new D.M(t)),localStorage.removeItem(e)}}),[f,R,C]),ie=(0,w.useCallback)((function(){var e=(new Date).toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),t=JSON.stringify(W(f.storage)),n="".concat(T.trim().replaceAll(" ","_"),"_").concat(e,".json"),r=document.createElement("a");r.download=n,r.href="data:".concat("application/json;charset=utf-8",",").concat(encodeURIComponent(t)),r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)}),[f,T]),se=(0,w.useCallback)((function(){if(n){var e=parseInt(n.database.storage.getString("dbIndex")||"1"),r=new O.Bc("extraDatabase_".concat(e),n.database.storage);r.removeForKeys((function(e){return e.startsWith("extraDatabase_")})),r.saveStorage();var a=f.storage.databaseName;localStorage.removeItem(a),n.database.clear(),n.database.storage.copyFrom(f.storage),n.database.storage.set("dbIndex",t),n.setDatabase(new D.M(n.database.storage))}}),[n,f,t]),oe=(0,w.useState)(T),le=(0,u.Z)(oe,2),ue=le[0],de=le[1];(0,w.useEffect)((function(){return de(T)}),[T]);var he=(0,w.useCallback)((function(){K({name:ue}),R||f.storage.saveStorage()}),[K,ue,f,R]),fe=(0,w.useCallback)((function(e){return"Enter"===e.key&&he()}),[he]);return(0,p.jsxs)(l.Z,{sx:{height:"100%"},children:[(0,p.jsxs)(r.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,p.jsx)(k.el,{value:ue,sx:{borderRadius:1,px:1,flexGrow:1},onChange:function(e){return de(e.target.value)},onBlur:he,onKeyDown:fe}),!R&&(0,p.jsx)(j.Z,{startIcon:(0,p.jsx)(v,{}),onClick:se,color:"success",children:J(q||(q=(0,d.Z)(["DatabaseCard.button.swap"])))}),(0,p.jsx)(b.Z,{color:R?"success":"secondary",label:R?J(Q||(Q=(0,d.Z)(["DatabaseCard.currentDB"]))):"".concat(J(X||(X=(0,d.Z)(["DatabaseCard.title"])))," ").concat(t)})]}),(0,p.jsx)(i.Z,{}),(0,p.jsx)(r.Z,{children:(0,p.jsxs)(y.Z,{display:"flex",gap:2,children:[(0,p.jsxs)(y.Z,{flexGrow:1,children:[(0,p.jsxs)(a.Z,{noWrap:!0,children:[(0,p.jsx)(c.c,{t:J,i18nKey:"count.chars"})," ",(0,p.jsx)("strong",{children:L})]}),(0,p.jsxs)(a.Z,{noWrap:!0,children:[(0,p.jsx)(c.c,{t:J,i18nKey:"count.arts"})," ",(0,p.jsx)("strong",{children:$})]}),(0,p.jsxs)(a.Z,{noWrap:!0,children:[(0,p.jsx)(c.c,{t:J,i18nKey:"count.weapons"})," ",(0,p.jsx)("strong",{children:A})]}),!!E&&(0,p.jsx)(a.Z,{noWrap:!0,children:(0,p.jsx)("strong",{children:new Date(E).toLocaleString()})})]}),(0,p.jsx)(y.Z,{children:(0,p.jsxs)(m.ZP,{container:!0,spacing:1,columns:{xs:2},children:[(0,p.jsx)(m.ZP,{item:!0,xs:1,children:(0,p.jsx)(j.Z,{fullWidth:!0,disabled:!U,color:"info",onClick:Y,startIcon:(0,p.jsx)(S.Z,{icon:h.Yjj}),children:(0,p.jsx)(c.c,{t:J,i18nKey:"DatabaseCard.button.copy"})})}),(0,p.jsxs)(m.ZP,{item:!0,xs:1,children:[(0,p.jsx)(_.Z,{open:H,onClose:N,children:(0,p.jsx)(ce,{onReplace:re})}),(0,p.jsx)(j.Z,{fullWidth:!0,component:"span",color:"info",startIcon:(0,p.jsx)(x,{}),onClick:V,children:J(ee||(ee=(0,d.Z)(["DatabaseCard.button.upload"])))})]}),(0,p.jsx)(m.ZP,{item:!0,xs:1,children:(0,p.jsx)(j.Z,{fullWidth:!0,disabled:!U,onClick:ie,startIcon:(0,p.jsx)(g.Z,{}),children:J(te||(te=(0,d.Z)(["DatabaseCard.button.download"])))})}),(0,p.jsx)(m.ZP,{item:!0,xs:1,children:(0,p.jsx)(j.Z,{fullWidth:!0,disabled:!U,color:"error",onClick:ae,startIcon:(0,p.jsx)(Z,{}),children:J(ne||(ne=(0,d.Z)(["DatabaseCard.button.delete"])))})})]})})]})})]})}var ge=n(23786),Ze=n(33890),me=n(25617),je=n(72828);function be(){var e=(0,o.$)().t;return(0,p.jsxs)(C.Z,{children:[(0,p.jsxs)(r.Z,{sx:{py:1},children:[e("settings:languageCard.selectLanguage")," ",(0,p.jsx)(me.Z,{color:"warning",children:e("ui:underConstruction")})]}),(0,p.jsx)(i.Z,{}),(0,p.jsx)(r.Z,{children:(0,p.jsx)(we,{})})]})}var ye={chs:"\u4e2d\u6587 \u6b63\u4f53\u5b57",cht:"\u4e2d\u6587 \u7e41\u9ad4\u5b57",de:"Deutsch",en:"English",es:"espa\xf1ol",fr:"fran\xe7ais",id:"Bahasa Indonesia",ja:"\u65e5\u672c\u8a9e",ko:"\ud55c\uad6d\uc5b4",pt:"Portugu\xeas",ru:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a",th:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22",vi:"Ti\u1ebfng Vi\u1ec7t"};function we(){var e=(0,o.$)(["ui","settings"]),t=e.t,n=e.i18n,r=function(e){return function(){return n.changeLanguage(e)}},a=n.languages[0];return(0,p.jsx)(Ze.Z,{fullWidth:!0,title:t("settings:languageCard.languageFormat",{language:t("languages:".concat(a))}),children:je.C.map((function(e){return(0,p.jsxs)(ge.Z,{selected:a===e,disabled:a===e,onClick:r(e),children:[(0,p.jsx)(c.c,{i18nKey:"languages:".concat(e)}),e!==a?" (".concat(ye[e],")"):""]},e)}))})}var Ce=n(72247),ke=n(9912),Se=n(20323);function _e(){var e=(0,I.Z)("GlobalSettings",Se.c),t=(0,u.Z)(e,2),n=t[0].tcMode,i=t[1];return(0,p.jsx)(C.Z,{children:(0,p.jsxs)(r.Z,{children:[(0,p.jsx)(a.Z,{gutterBottom:!0,color:"warning.main",children:"Enabling this toggle will show some features that might be too complex for the average user."}),(0,p.jsx)(j.Z,{fullWidth:!0,onClick:function(){return i({tcMode:!n})},color:n?"success":"primary",startIcon:n?(0,p.jsx)(Ce.Z,{}):(0,p.jsx)(ke.Z,{}),children:"Theorycrafting Mode"})]})})}function De(){var e=(0,o.$)(["settings"]).t;return s.ZP.send({hitType:"pageview",page:"/setting"}),(0,p.jsxs)(l.Z,{sx:{my:1},children:[(0,p.jsx)(r.Z,{sx:{py:1},children:(0,p.jsx)(a.Z,{variant:"subtitle1",children:(0,p.jsx)(c.c,{t:e,i18nKey:"title"})})}),(0,p.jsx)(i.Z,{}),(0,p.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,p.jsx)(be,{}),(0,p.jsx)(pe,{}),(0,p.jsx)(_e,{})]})]})}},24711:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(29439),a=n(72791);function i(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,a.useState)(e),n=(0,r.Z)(t,2),i=n[0],s=n[1],o=(0,a.useCallback)((function(){return s(!0)}),[s]),c=(0,a.useCallback)((function(){return s(!1)}),[s]);return[i,o,c]}},72247:function(e,t,n){var r=n(74223),a=n(80184);t.Z=(0,r.Z)((0,a.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},9912:function(e,t,n){var r=n(74223),a=n(80184);t.Z=(0,r.Z)((0,a.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},72456:function(e,t,n){var r=n(74223),a=n(80184);t.Z=(0,r.Z)((0,a.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download")},52791:function(e,t,n){var r=(0,n(23814).Z)();t.Z=r},15861:function(e,t,n){function r(e,t,n,r,a,i,s){try{var o=e[i](s),c=o.value}catch(l){return void n(l)}o.done?t(c):Promise.resolve(c).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var s=e.apply(t,n);function o(e){r(s,a,i,o,c,"next",e)}function c(e){r(s,a,i,o,c,"throw",e)}o(void 0)}))}}n.d(t,{Z:function(){return a}})}}]);
//# sourceMappingURL=979.2016e5a1.chunk.js.map