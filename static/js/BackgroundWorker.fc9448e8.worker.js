/*! For license information please see BackgroundWorker.fc9448e8.worker.js.LICENSE.txt */
!function(){"use strict";function e(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function r(r,t){if(r){if("string"===typeof r)return e(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(r,t):void 0}}function t(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw i}}}}function n(t){return function(r){if(Array.isArray(r))return e(r)}(t)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(){c=function(){return e};var e={},r=Object.prototype,t=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function s(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{s({},"")}catch(A){s=function(e,r,t){return e[r]=t}}function l(e,r,t,n){var a=r&&r.prototype instanceof h?r:h,o=Object.create(a.prototype),i=new O(n||[]);return o._invoke=function(e,r,t){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return M()}for(t.method=a,t.arg=o;;){var i=t.delegate;if(i){var u=x(i,t);if(u){if(u===p)continue;return u}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===n)throw n="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n="executing";var c=f(e,r,t);if("normal"===c.type){if(n=t.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:t.done}}"throw"===c.type&&(n="completed",t.method="throw",t.arg=c.arg)}}}(e,t,i),o}function f(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(A){return{type:"throw",arg:A}}}e.wrap=l;var p={};function h(){}function d(){}function v(){}var m={};s(m,a,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(j([])));g&&g!==r&&t.call(g,a)&&(m=g);var y=v.prototype=h.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(r){s(e,r,(function(e){return this._invoke(r,e)}))}))}function k(e,r){function n(a,o,i,c){var s=f(e[a],e,o);if("throw"!==s.type){var l=s.arg,p=l.value;return p&&"object"==u(p)&&t.call(p,"__await")?r.resolve(p.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):r.resolve(p).then((function(e){l.value=e,i(l)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;this._invoke=function(e,t){function o(){return new r((function(r,a){n(e,t,r,a)}))}return a=a?a.then(o,o):o()}}function x(e,r){var t=e.iterator[r.method];if(void 0===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,x(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=f(t,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,p;var a=n.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function E(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function S(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function j(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(t.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=void 0,r.done=!0,r};return o.next=o}}return{next:M}}function M(){return{value:void 0,done:!0}}return d.prototype=v,s(y,"constructor",v),s(v,"constructor",d),d.displayName=s(v,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},w(k.prototype),s(k.prototype,o,(function(){return this})),e.AsyncIterator=k,e.async=function(r,t,n,a,o){void 0===o&&(o=Promise);var i=new k(l(r,t,n,a),o);return e.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(y),s(y,i,"Generator"),s(y,a,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var r=[];for(var t in e)r.push(t);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=j,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&t.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t,n){return i.type="throw",i.arg=e,r.next=t,n&&(r.method="next",r.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=t.call(o,"catchLoc"),c=t.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&t.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=r,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(i)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),p},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),S(t),p}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var a=n.arg;S(t)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,t){return this.delegate={iterator:j(e),resultName:r,nextLoc:t},"next"===this.method&&(this.arg=void 0),p}},e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,o=[],i=!0,u=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(o.push(n.value),!r||o.length!==r);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==t.return||t.return()}finally{if(u)throw a}}return o}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,r){if(e&&r)return!Array.isArray(r)&&console.error(r),r.reduce((function(e,r){return null===e||void 0===e?void 0:e[r]}),e)}function f(e,r){return Object.fromEntries(e.map((function(e,t){return[e,r(e,t)]})))}function p(e,r){return Object.fromEntries(e.map((function(e){return r(e)})))}function h(e,r){return Object.fromEntries(Object.entries(e).map((function(e,t){var n=s(e,2),a=n[0],o=n[1];return[a,r(o,a,t)]})))}var d=c().mark((function e(r,t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r;case 1:if(!(n<=t)){e.next=7;break}return e.next=4,n;case 4:n++,e.next=1;break;case 7:case"end":return e.stop()}}),e)}));function v(e,r){return n(d(e,r))}function m(e){throw new Error("Should not reach this with value ".concat(e))}function b(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.reduce((function(e,r){return e.flatMap((function(e){return r.map((function(r){return[e,[r]].flat()}))}))}),[[]])}g(NaN,{key:"TODO"}),y(1),y(0);function g(e,r){return{operation:"const",operands:[],value:e,info:r}}function y(e,r){return e>=Number.MAX_VALUE/100&&(e=1/0),e<=-Number.MAX_VALUE/100&&(e=-1/0),g(e,i({key:"_"},r))}function w(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return{operation:"min",operands:O(r)}}function k(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return{operation:"max",operands:O(r)}}function x(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return{operation:"add",operands:O(r)}}function E(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return{operation:"mul",operands:O(r)}}function S(e,r){return{operation:"read",operands:[],path:e,info:r,type:"number"}}function O(e){return e.map((function(e){return"object"===typeof e?e:g(e)}))}function j(e){return"object"!==typeof e?g(e):e}function M(e,r,t){var n=new Set,a=new Set;e.forEach((function e(o){a.has(o)||(n.has(o)?console.error("Found cyclical dependency during formula traversal"):(n.add(o),r(o),o.operands.forEach(e),t(o),n.delete(o),a.add(o)))}))}function A(e,r,t){var n=new Set,a=new Map,o=new Map;function u(e){var c=a.get(e);if(c)return c;c=r(e);var s=o.get(c);return s||(n.has(c)?(console.error("Found cyclical dependency during formula mapping"),g(NaN)):(n.add(c),s=t(function(e){var r=e.operands.map(u);return B(r,e.operands)?e:i(i({},e),{},{operands:r})}(c),e),n.delete(c),a.set(e,s),o.set(c,s),s))}var c=e.map(u);return B(c,e)?e:c}function B(e,r){return void 0===e?void 0===r:void 0!==r&&(e.length===r.length&&e.every((function(e,t){return e===r[t]})))}var P={min:function(e){return Math.min.apply(Math,n(e))},max:function(e){return Math.max.apply(Math,n(e))},add:function(e){return e.reduce((function(e,r){return e+r}),0)},mul:function(e){return e.reduce((function(e,r){return e*r}),1)}},N=i(i({},P),{},{res:function(e){var r=s(e,1)[0];return r<0?1-r/2:r>=.75?1/(4*r+1):1-r},sum_frac:function(e){return e[0]/e.reduce((function(e,r){return e+r}))},threshold:function(e){var r=s(e,4),t=r[0],n=r[1],a=r[2],o=r[3];return t>=n?a:o}}),T=new Set(Object.keys(P));function L(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!1};return e=_(e=R(e=C(e,r,t)))}function F(e,r){var t=new Set,a=new Set,o=new Map;M(e,(function(e){}),(function(e){var n=e.operation;switch(n){case"read":if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error("Unsupported ".concat(n," node in precompute"));var i=r(e);t.add(i),o.set(e,i);break;case"add":case"min":case"max":case"mul":case"threshold":case"res":case"sum_frac":o.set(e,{ins:e.operands.map((function(e){return o.get(e)}))});break;case"const":if("number"!==typeof e.value)throw new Error("Found string constant while precomputing");var u=e.value;a.add(u),o.set(e,u);break;case"match":case"lookup":case"subscript":case"prio":case"small":case"data":throw new Error("Unsupported ".concat(n," node in precompute"));default:m(n)}}));var i=new Map,u=n(t),c=e.length,l=n(a),p=[];e.forEach((function(e,r){i.set(e,r),"const"===e.operation&&i.set(e.value,r)})),u.forEach((function(r,t){return i.set(r,t+e.length)}));var h=e.length+u.length;l.forEach((function(e){return i.has(e)||i.set(e,h++)})),o.forEach((function(e,r){"object"===typeof e?(i.has(r)||i.set(r,h++),p.push({out:i.get(r),ins:r.operands.map((function(e){return i.get(e)})),op:N[r.operation],buff:Array(r.operands.length).fill(0)})):i.set(r,i.get(e))}));var d=new Float64Array(h).fill(0);a.forEach((function(e){return d[i.get(e)]=e}));var v=e.map((function(e,r){var t=i.get(e);return t!==r?[t,r]:void 0})).filter((function(e){return e})),b=v.length?function(){v.forEach((function(e){var r=s(e,2),t=r[0],n=r[1];return d[n]=d[t]}))}:void 0;return[function(){return p.forEach((function(e){var r=e.out,t=e.ins,n=e.op,a=e.buff;t.forEach((function(e,r){return a[r]=d[e]})),d[r]=n(a)})),null===b||void 0===b||b(),d},f(u,(function(e,r){return c+r})),d]}function R(e){return A(e,(function(e){return e}),(function(e){var r=e;if(T.has(e.operation)){var t=e,n=t.operation,a=!1,o=t.operands.flatMap((function(e){return e.operation===n?(a=!0,e.operands):[e]}));r=a?i(i({},t),{},{operands:o}):t}return r}))}function _(e){function r(e){var r,n=new Map,a=t(e);try{for(a.s();!(r=a.n()).done;){var o,i=r.value;n.set(i,(null!==(o=n.get(i))&&void 0!==o?o:0)+1)}}catch(u){a.e(u)}finally{a.f()}return n}for(var a={common:{counts:new Map,formulas:new Set,operation:"add"}},o=function(){for(var o,u=void 0,c={operation:a.common.operation,operands:(o=a.common.counts,n(o).flatMap((function(e){var r=s(e,2),t=r[0],n=r[1];return Array(n).fill(t)})))},l=new Map,f=0,p=Object.keys(P);f<p.length;f++){var h=p[f];l.set(h,[])}if(e=A(e,(function(e){if(a.common.formulas.has(e)){var r=e,t=new Map(a.common.counts),n=r.operands.filter((function(e){var r=t.get(e);return!r||(t.set(e,r-1),!1)}));return n.length?(n.push(c),i(i({},r),{},{operands:n})):c}return e}),(function(e){if(!T.has(e.operation))return e;var n=e;if(u){if(u.operation===n.operation){var a,o=r(n.operands),i=new Map,c=u.counts,f=0,p=t(o.entries());try{for(p.s();!(a=p.n()).done;){var h,d=s(a.value,2),v=d[0],m=d[1],b=Math.min(m,null!==(h=c.get(v))&&void 0!==h?h:0);b?(i.set(v,b),f+=b):i.delete(v)}}catch(R){p.e(R)}finally{p.f()}f>1&&(u.counts=i,u.formulas.add(n))}}else{var g,y=l.get(n.operation),w=r(n.operands),k=t(y);try{for(k.s();!(g=k.n()).done;){var x,E=s(g.value,2),S=E[0],O=E[1],j=0,M=new Map,A=t(O.entries());try{for(A.s();!(x=A.n()).done;){var B,P=s(x.value,2),N=P[0],L=P[1],F=Math.min(L,null!==(B=w.get(N))&&void 0!==B?B:0);F&&(M.set(N,F),j+=F)}}catch(R){A.e(R)}finally{A.f()}if(j>1){u={counts:M,formulas:new Set([n,S]),operation:n.operation},l.clear();break}}}catch(R){k.e(R)}finally{k.f()}u||y.push([n,w])}return n})),!u)return"break";a.common=u};;){if("break"===o())break}return e}function C(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!1},o={data:[],processed:new Map},u=new Map([[o,new Map]]);function c(e,r){var f,p=r.processed.get(e);if(p)return p;var h,d=e.operation;switch(d){case"const":return e;case"add":case"mul":case"max":case"min":var v=N[d],b=[],y=e.operands.filter((function(e){var t=c(e,r);return"const"!==t.operation||(b.push(t.value),!1)})).map((function(e){return c(e,r)})),w=v(b);if(isFinite(w)){if("mul"===d&&0===w){h=g(w);break}}else if("mul"!==d&&("max"!==d||w>0)&&("min"!==d||w<0)){h=g(w);break}w!==v([])&&y.push(g(w)),h=y.length<=1?null!==(f=y[0])&&void 0!==f?f:g(v([])):{operation:d,operands:y};break;case"res":case"sum_frac":var k=e.operands.map((function(e){return c(e,r)})),x=N[d];h=k.every((function(e){return"const"===e.operation}))?g(x(k.map((function(e){return e.value})))):i(i({},e),{},{operands:k});break;case"lookup":var E=c(e.operands[0],r);if("const"===E.operation){var S,O=null!==(S=e.table[E.value])&&void 0!==S?S:e.operands[1];if(O){h=c(O,r);break}}throw new Error("Unsupported ".concat(d," node while folding"));case"prio":var j=e.operands.find((function(e){var t=c(e,r);if("const"!==t.operation)throw new Error("Unsupported ".concat(d," node while folding"));return void 0!==t.value}));h=j?c(j,r):g(void 0);break;case"small":var M,A,B=void 0,P=t(e.operands);try{for(P.s();!(A=P.n()).done;){var T,L=c(A.value,r);if("const"!==L.operation)throw new Error("Unsupported ".concat(d," node while folding"));(void 0===(null===(T=B)||void 0===T?void 0:T.value)||void 0!==L.value&&L.value<B.value)&&(B=L)}}catch(J){P.e(J)}finally{P.f()}h=null!==(M=B)&&void 0!==M?M:g(void 0);break;case"match":var F=s(e.operands.map((function(e){return c(e,r)})),4),R=F[0],_=F[1],C=F[2],D=F[3];if("const"!==R.operation||"const"!==_.operation)throw new Error("Unsupported ".concat(d," node while folding"));h=R.value===_.value?C:D;break;case"threshold":var I=s(e.operands.map((function(e){return c(e,r)})),4),G=I[0],W=I[1],V=I[2],z=I[3];h="const"===G.operation&&"const"===W.operation?G.value>=W.value?V:z:i(i({},e),{},{operands:[G,W,V,z]});break;case"subscript":var H=s(e.operands.map((function(e){return c(e,r)})),1)[0];h="const"===H.operation?g(e.list[H.value]):i(i({},e),{},{operands:[H]});break;case"read":var U=r.data.map((function(r){return l(r,e.path)})).filter((function(e){return e}));if(0===U.length)if(a(e)){var q=e.accu;h=void 0===q||"small"===q?"string"===e.type?g(void 0):g(NaN):g(N[q]([]))}else h=e;else h=void 0===e.accu||1===U.length?c(U[U.length-1],r):c({operation:e.accu,operands:U},r);break;case"data":e.reset&&(r=o);var Y=u.get(r),K=Y.get(e.data);K||(K={data:[].concat(n(r.data),[e.data]),processed:new Map},u.set(K,new Map),Y.set(e.data,K)),h=c(e.operands[0],K);break;default:m(d)}return r.processed.set(e,h),h}var f={data:[r],processed:new Map};return u.set(f,new Map),u.get(o).set(r,f),e.map((function(e){return c(e,f)}))}var D=["flower","plume","sands","goblet","circlet"],I=(["physical"].concat(["anemo","geo","electro","hydro","pyro","cryo"]),[].concat(["AmenomaKageuchi","AquilaFavonia","BlackcliffLongsword","CinnabarSpindle","CoolSteel","DarkIronSword","DullBlade","FavoniusSword","FesteringDesire","FilletBlade","FreedomSworn","HaranGeppakuFutsu","HarbingerOfDawn","IronSting","LionsRoar","MistsplitterReforged","PrimordialJadeCutter","PrototypeRancour","RoyalLongsword","SacrificialSword","SilverSword","SkyriderSword","SkywardBlade","SummitShaper","SwordOfDescension","TheAlleyFlash","TheBlackSword","TheFlute","TravelersHandySword"],["Akuoumaru","BlackcliffSlasher","BloodtaintedGreatsword","DebateClub","FavoniusGreatsword","FerrousShadow","KatsuragikiriNagamasa","LithicBlade","LuxuriousSeaLord","OldMercsPal","PrototypeArchaic","Rainslasher","RedhornStonethresher","RoyalGreatsword","SacrificialGreatsword","SerpentSpine","SkyriderGreatsword","SkywardPride","SnowTombedStarsilver","SongOfBrokenPines","TheBell","TheUnforged","WasterGreatsword","Whiteblind","WhiteIronGreatsword","WolfsGravestone"],["BeginnersProtector","BlackcliffPole","BlackTassel","CalamityQueller","CrescentPike","Deathmatch","DragonsBane","DragonspineSpear","EngulfingLightning","FavoniusLance","Halberd","IronPoint","KitainCrossSpear","LithicSpear","PrimordialJadeWingedSpear","PrototypeStarglitter","RoyalSpear","SkywardSpine","StaffOfHoma","TheCatch","VortexVanquisher","WavebreakersFin","WhiteTassel"],["AlleyHunter","AmosBow","AquaSimulacra","BlackcliffWarbow","CompoundBow","ElegyForTheEnd","FadingTwilight","FavoniusWarbow","Hamayumi","HuntersBow","Messenger","MitternachtsWaltz","MouunsMoon","PolarStar","Predator","PrototypeCrescent","RavenBow","RecurveBow","RoyalBow","Rust","SacrificialBow","SeasonedHuntersBow","SharpshootersOath","SkywardHarp","Slingshot","TheStringless","TheViridescentHunt","ThunderingPulse","WindblumeOde"],["ApprenticesNotes","BlackcliffAgate","DodocoTales","EmeraldOrb","EverlastingMoonglow","EyeOfPerception","FavoniusCodex","Frostbearer","HakushinRing","KagurasVerity","LostPrayerToTheSacredWinds","MagicGuide","MappaMare","MemoryOfDust","OathswornEye","OtherworldlyStory","PocketGrimoire","PrototypeAmber","RoyalGrimoire","SacrificialFragments","SkywardAtlas","SolarPearl","TheWidsith","ThrillingTalesOfDragonSlayers","TwinNephrite","WineAndSong"]),c().mark($)),G=c().mark(ee);function W(e,r,t,n,a,o){for(var u=o,c={pruneNodeRange:!0},s={pruneNodeRange:!0},l={reaffine:!0},f={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0},p=0;Object.values(u).some((function(e){return e}))&&p++<20;){if(u.pruneOrder){delete u.pruneOrder;var h=z(t,n,a);t!==h&&(t=h,u=i(i({},u),c))}if(u.pruneArtRange){delete u.pruneArtRange;var d=H(e,t,r);t!==d&&(t=d,u=i(i({},u),s))}if(u.pruneNodeRange){delete u.pruneNodeRange;var v=U(e,t);e!==v&&(e=v,u=i(i({},u),l))}if(u.reaffine){delete u.reaffine;var m=V(e,t),b=m.nodes,g=m.arts;e===b&&t===g||(e=b,t=g,u=i(i({},u),f))}}return{nodes:e,arts:t}}function V(e,r){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new Set,u=new Set;function c(e,r){r?o.add(e):e.operands.forEach((function(e){var r=e;o.has(r)&&u.add(r)}))}var l=new Set;if(M(e,(function(e){}),(function(e){var r=e.operation;switch(r){case"read":if("number"!==e.type||"dyn"!==e.path[0]||"add"!==e.accu)throw new Error("Found unsupported ".concat(r," node at path ").concat(e.path," when computing affine nodes"));l.add(e.path[1]),c(e,!0);break;case"add":c(e,e.operands.every((function(e){return o.has(e)})));break;case"mul":var t=e.operands.filter((function(e){return"const"!==e.operation}));c(e,0===t.length||1===t.length&&o.has(t[0]));break;case"const":if("string"===typeof e.value||void 0===e.value)throw new Error("Found constant ".concat(e.value," while compacting"));c(e,!0);break;case"res":case"threshold":case"sum_frac":case"max":case"min":c(e,!1);break;case"data":case"subscript":case"lookup":case"match":case"prio":case"small":throw new Error("Found unsupported ".concat(r," node when computing affine nodes"));default:m(r)}})),n(u).every((function(e){var r=e.operation;return"read"===r||"const"===r}))&&Object.keys(r.base).length===l.size)return{nodes:e,arts:r};var p=-1;function d(){for(;l.has("".concat(++p)););return"".concat(p)}e.forEach((function(e){return o.has(e)&&u.add(e)}));var v=n(u).filter((function(e){return"const"!==e.operation})),b=new Map(v.map((function(e){return[e,a||"read"!==e.operation||"dyn"!==e.path[0]?i(i({},S(["dyn","".concat(d())])),{},{accu:"add"}):e]})));function y(e){var r=C(n(b.keys()),{dyn:h(e,(function(e){return g(e)}))},(function(e){return!0}));return Object.fromEntries(n(b.values()).map((function(e,t){return[e.path[1],r[t].value]})))}for(var w={nodes:e=A(e,(function(e){var r;return null!==(r=b.get(e))&&void 0!==r?r:e}),(function(e){return e})),arts:{base:y(r.base),values:f(D,(function(e){return r.values[e].map((function(e){return{id:e.id,set:e.set,values:y(e.values)}}))}))}},k=Object.entries(y({})),x=0,E=Object.values(w.arts.values);x<E.length;x++){var O,j=E[x],B=t(j);try{for(B.s();!(O=B.n()).done;){var P,N=O.value.values,T=t(k);try{for(T.s();!(P=T.n()).done;){var L=s(P.value,2),F=L[0],R=L[1];N[F]-=R}}catch(_){T.e(_)}finally{T.f()}}}catch(_){B.e(_)}finally{B.f()}}return w}function z(e,r,t){var n,a=!1,o=!(null!==(n=t.rainbow)&&void 0!==n&&n.length),i=new Set(Object.entries(t).filter((function(e){var r=s(e,2);r[0];return r[1].length})).map((function(e){return s(e,1)[0]}))),u=new Set(Object.entries(t).filter((function(e){var r=s(e,2),t=(r[0],r[1]);return t.includes(2)&&!t.includes(4)})).map((function(e){return s(e,1)[0]}))),c=f(D,(function(t){var n=e.values[t],c=n.filter((function(e){var t=0;return n.every((function(n){var a=Object.entries(n.values).every((function(r){var t=s(r,2),n=t[0];return t[1]>=e.values[n]})),c=Object.entries(n.values).some((function(r){var t=s(r,2),n=t[0];return t[1]>e.values[n]}));return a&&(c||n.id>e.id)&&(o&&!i.has(n.set)&&!u.has(e.set)||e.set===n.set)&&t++,t<r}))}));return c.length!==n.length&&(a=!0),c}));return a?{base:e.base,values:c}:e}function H(e,r,t){for(var n=Object.fromEntries(Object.entries(r.base).map((function(e){var r=s(e,2),t=r[0],n=r[1];return[t,{min:n,max:n}]}))),a={arts:r},o=function(){var r=f(D,(function(e){return Y(a.arts.values[e])})),o=f(D,(function(e){return q(Object.entries(r).map((function(r){return r[0]===e?n:r[1]})).filter((function(e){return e})))})),i=!1,u=f(D,(function(r){var n=a.arts.values[r].filter((function(n){var a=q([Y([n]),o[r]]),i=K(e,a);return e.every((function(e,r){var n;return i.get(e).max>=(null!==(n=t[r])&&void 0!==n?n:-1/0)}))}));return n.length!==a.arts.values[r].length&&(i=!0),n}));if(!i)return"break";a.arts={base:a.arts.base,values:u}};;){if("break"===o())break}return a.arts}function U(e,r){var t=K(e,q([Object.fromEntries(Object.entries(r.base).map((function(e){var r=s(e,2),t=r[0],n=r[1];return[t,{min:n,max:n}]})))].concat(n(Object.values(r.values).map((function(e){return Y(e)}))))));return A(e,(function(e){var r=e.operation,a=e.operands.map((function(e){return t.get(e)}));switch(r){case"threshold":var o=s(a,4),i=o[0],u=o[1],c=o[2],l=o[3];if(i.min>=u.max)return e.operands[2];if(i.max<u.min)return g(0);if(c.max===c.min&&l.max===l.min&&c.min===l.min&&isFinite(c.min))return g(c.max);break;case"min":var f=e.operands.filter((function(e,r){var t=a[r];return a.every((function(e,r){return t.min<=e.max}))}));if(f.length<a.length)return w.apply(void 0,n(f));break;case"max":var p=e.operands.filter((function(e,r){var t=a[r];return a.every((function(e){return t.max>=e.min}))}));if(p.length<a.length)return k.apply(void 0,n(p))}return e}),(function(e){return e}))}function q(e){var r={};return e.forEach((function(e){Object.entries(e).forEach((function(e){var t=s(e,2),n=t[0],a=t[1];r[n]?(r[n].min+=a.min,r[n].max+=a.max):r[n]=i({},a)}))})),r}function Y(e){var r={};return e.length&&(Object.keys(e[0].values).filter((function(r){return e.every((function(e){return e.values[r]}))})).forEach((function(t){return r[t]={min:e[0].values[t],max:e[0].values[t]}})),e.forEach((function(e){for(var t=e.values,n=0,a=Object.entries(t);n<a.length;n++){var o=s(a[n],2),i=o[0],u=o[1];r[i]?(r[i].max<u&&(r[i].max=u),r[i].min>u&&(r[i].min=u)):r[i]={min:0,max:u}}}))),r}function K(e,r){var t=new Map;return M(e,(function(e){}),(function(e){var n,a,o=e,i=o.operation,u=o.operands.map((function(e){return t.get(e)}));switch(i){case"read":if("dyn"!==o.path[0])throw new Error("Found non-dyn path ".concat(o.path," while computing range"));a=null!==(n=r[o.path[1]])&&void 0!==n?n:{min:0,max:0};break;case"const":a=J([o.value]);break;case"subscript":a=J(o.list);break;case"add":case"min":case"max":a={min:N[i](u.map((function(e){return e.min}))),max:N[i](u.map((function(e){return e.max})))};break;case"res":a={min:N[i]([u[0].max]),max:N[i]([u[0].min])};break;case"mul":a=u.reduce((function(e,r){return J([e.min*r.min,e.min*r.max,e.max*r.min,e.max*r.max])}));break;case"threshold":a=u[0].min>=u[1].max?u[2]:u[0].max<u[1].min?J([0]):J([0],[u[2]]);break;case"sum_frac":var c=s(u,2),l=c[0],f=c[1],p={min:l.min+f.min,max:l.max+f.max};a=p.min<=0&&p.max>=0?l.min<=0&&l.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:J([l.min/p.min,l.min/p.max,l.max/p.min,l.max/p.max]);break;case"data":case"lookup":case"match":throw new Error("Unsupported ".concat(i," node"));default:m(i)}t.set(o,a)})),t}function J(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=Math.max.apply(Math,n(e).concat(n(r.map((function(e){return e.max}))))),a=Math.min.apply(Math,n(e).concat(n(r.map((function(e){return e.min})))));return{min:a,max:t}}function X(e,r){return{base:e.base,values:f(D,(function(t){var n=r[t];switch(n.kind){case"id":return e.values[t].filter((function(e){return n.ids.has(e.id)}));case"exclude":return e.values[t].filter((function(e){return!n.sets.has(e.set)}));case"required":return e.values[t].filter((function(e){return n.sets.has(e.set)}))}}))}}function Q(e){return D.reduce((function(r,t){return r*e.values[t].length}),1)}function $(e,r){var a,o,i,u,l,f,p;return c().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:a=h(r.values,(function(e){return new Set(e.map((function(e){return e.set})))})),o=t(e),c.prev=2,o.s();case 4:if((i=o.n()).done){c.next=19;break}u=i.value,l=function(){var e=s(p[f],2),r=e[0],t=e[1],o=a[r];switch(t.kind){case"required":if(n(t.sets).every((function(e){return!o.has(e)})))return"continue|filter_loop";break;case"exclude":if(n(o).every((function(e){return t.sets.has(e)})))return"continue|filter_loop"}},f=0,p=Object.entries(u);case 8:if(!(f<p.length)){c.next=15;break}if("continue|filter_loop"!==l()){c.next=12;break}return c.abrupt("continue",17);case 12:f++,c.next=8;break;case 15:return c.next=17,u;case 17:c.next=4;break;case 19:c.next=24;break;case 21:c.prev=21,c.t0=c.catch(2),o.e(c.t0);case 24:return c.prev=24,o.f(),c.finish(24);case 27:case"end":return c.stop()}}),I,null,[[2,21,24,27]])}function Z(e){return new Set(null!==e&&void 0!==e&&e.includes(2)?e.includes(4)?[0,1]:[0,1,4,5]:null!==e&&void 0!==e&&e.includes(4)?[0,1,2,3]:[0,1,2,3,4,5])}function ee(e,r){var a,o,u,l,p,d,m,b,g,y,w,k,x,E,S,O;return c().wrap((function(j){for(;;)switch(j.prev=j.next){case 0:for(x=function(e){var r,u,s,l,f,p,h,d,m,b,g;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:g=function(e){var r,a,s,l,p,h,d,m,b,x,E,S,O,j;return c().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:r=f.length-e,a=[],s=[],l=[],p=0,h=t(o),u.prev=3,m=function(){var e=d.value,t=k[e],o=w[e];if(!t)return"continue";v(1,r).every((function(e){return!t.has(o+e)}))?l.push(e):t.has(o)?v(0,r).some((function(e){return!t.has(o+e)}))&&a.push(e):(p+=n(t).find((function(e){return e>o}))-o,s.push(e))},h.s();case 6:if((d=h.n()).done){u.next=12;break}if("continue"!==m()){u.next=10;break}return u.abrupt("continue",10);case 10:u.next=6;break;case 12:u.next=17;break;case 14:u.prev=14,u.t0=u.catch(3),h.e(u.t0);case 17:return u.prev=17,h.f(),u.finish(17);case 20:if(!(p>r)){u.next=22;break}return u.abrupt("return");case 22:if(e!==f.length){u.next=26;break}return u.next=25,i({},y);case 25:return u.abrupt("return");case 26:if(p!==r){u.next=47;break}b=t(s),u.prev=28,b.s();case 30:if((x=b.n()).done){u.next=38;break}return E=x.value,w[E]++,y[D[f[e]]]={kind:"required",sets:new Set([E])},u.delegateYield(g(e+1),"t1",35);case 35:w[E]--;case 36:u.next=30;break;case 38:u.next=43;break;case 40:u.prev=40,u.t2=u.catch(28),b.e(u.t2);case 43:return u.prev=43,b.f(),u.finish(43);case 46:return u.abrupt("return");case 47:S=0,O=[].concat(a,s);case 48:if(!(S<O.length)){u.next=57;break}return j=O[S],w[j]++,y[D[f[e]]]={kind:"required",sets:new Set([j])},u.delegateYield(g(e+1),"t3",53);case 53:w[j]--;case 54:S++,u.next=48;break;case 57:return y[D[f[e]]]={kind:"exclude",sets:new Set([].concat(s,l,a))},u.delegateYield(g(e+1),"t4",59);case 59:case"end":return u.stop()}}),u,null,[[3,14,17,20],[28,40,43,46]])},b=function(e){var n,a,i;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e!==l.length){r.next=3;break}return r.delegateYield(g(0),"t0",2);case 2:return r.abrupt("return",r.t0);case 3:n=t(o),r.prev=4,i=c().mark((function r(){var t,n,o,i,u;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=a.value,!s.has(t)){r.next=3;break}return r.abrupt("return","continue");case 3:if(n=l[e].length,o=k[t],i=0,!o||o.has(n)){r.next=9;break}if(!((i=(null!==(u=v(n+1,5).find((function(e){return o.has(e)})))&&void 0!==u?u:6)-n)>m)){r.next=9;break}return r.abrupt("return","continue");case 9:return s.add(t),w[t]=l[e].length,l[e].forEach((function(e){return y[D[e]]={kind:"required",sets:new Set([t])}})),m-=i,r.delegateYield(b(e+1),"t0",14);case 14:m+=i,w[t]=0,s.delete(t);case 17:case"end":return r.stop()}}),r)})),n.s();case 7:if((a=n.n()).done){r.next=14;break}return r.delegateYield(i(),"t1",9);case 9:if("continue"!==r.t1){r.next=12;break}return r.abrupt("continue",12);case 12:r.next=7;break;case 14:r.next=19;break;case 16:r.prev=16,r.t2=r.catch(4),n.e(r.t2);case 19:return r.prev=19,n.f(),r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[4,16,19,22]])},r=c().mark(b),u=c().mark(g),s=new Set,l=[],f=[],p=t(e);try{for(p.s();!(h=p.n()).done;)d=h.value,l.push([]),5===d?f.push(l.length-1):l[d].push(l.length-1)}catch(x){p.e(x)}finally{p.f()}return l=l.filter((function(e){return e.length})).sort((function(e,r){return r.length-e.length})),m=f.length,a.delegateYield(b(0),"t0",10);case 10:case"end":return a.stop()}}),a)},d=function(e,r){if(!v(r+1,4).some((function(r){return 5!==e[r]})))return(e=n(e))[r]=5,e.reduce((function(e,r){return 6*e+r}),0)},p=function(e,r,a){if(5!==e.length){var o,i=t(r);try{var c=function(){var t=o.value;p([].concat(n(e),[t]),r,a.filter((function(e){return e!==t})))};for(i.s();!(o=i.n()).done;)c()}catch(s){i.e(s)}finally{i.f()}p([].concat(n(e),[e.length]),new Set([].concat(n(r),[e.length])),[].concat(n(a),[e.length]))}else u.has(a.length)&&l.push(e)},a=c().mark(x),o=n(new Set(r)),u=Z(e.rainbow),l=[],p([0],new Set([0]),[0]),m=function(e){var r,a=new Map,o=t(l);try{for(o.s();!(r=o.n()).done;){var i,u=r.value,c=d(u,e);void 0!==c&&a.set(c,(null!==(i=a.get(c))&&void 0!==i?i:new Set(u.slice(0,e)).size+1)-1)}}catch(v){o.e(v)}finally{o.f()}var f,p=t(a.entries());try{var h=function(){var r=s(f.value,2),t=r[0];if(0===r[1]){var a=n(l.find((function(r){return d(r,e)===t})));a[e]=5,l=l.filter((function(r){return d(r,e)!==t})),l.push(a)}};for(p.s();!(f=p.n()).done;)h()}catch(v){p.e(v)}finally{p.f()}},b=4;b>=0;b--)m(b);g={kind:"exclude",sets:new Set},y=f(D,(function(e){return g})),w=i(i({},h(e,(function(e){return 0}))),f(o,(function(e){return 0}))),k=h(e,Z),E=t(l),j.prev=14,E.s();case 16:if((S=E.n()).done){j.next=21;break}return O=S.value,j.delegateYield(x(O),"t0",19);case 19:j.next=16;break;case 21:j.next=26;break;case 23:j.prev=23,j.t1=j.catch(14),E.e(j.t1);case 26:return j.prev=26,E.f(),j.finish(26);case 29:case"end":return j.stop()}}),G,null,[[14,23,26,29]])}f(D,(function(e){return{kind:"exclude",sets:new Set}}));function re(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function te(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,r,t){return r&&te(e.prototype,r),t&&te(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var ae=function(){function e(r,t){var n=this,a=r.arts,o=r.optimizationTarget,u=r.filters,c=r.plotBase,s=r.maxBuilds;re(this,e),this.builds=[],this.buildValues=void 0,this.plotData=void 0,this.plotBase=void 0,this.threshold=-1/0,this.maxBuilds=void 0,this.min=void 0,this.arts=void 0,this.nodes=void 0,this.callback=void 0,this.interimReport=function(e){n.refresh(!1),n.callback(i({command:"interim",buildValues:n.buildValues},e)),n.buildValues=void 0,e.tested=0,e.failed=0,e.skipped=0},this.arts=a,this.min=u.map((function(e){return e.min})),this.maxBuilds=s,this.callback=t,this.nodes=u.map((function(e){return e.value})),this.nodes.push(o),c&&(this.plotData={},this.plotBase=c,this.nodes.push(c))}return ne(e,[{key:"compute",value:function(e,r){this.threshold<e&&(this.threshold=e);r.optimizationTarget;var a=r.constraints,o=r.filter,i=r.artSetExclusion,u=r.depth,c=this.interimReport,l=this,f=X(this.arts,o),p=Q(f);if(!(r.cache&&r.cachedCompute.maxEst[r.cachedCompute.maxEst.length-1]<this.threshold)){var h=this.nodes,d=this.min;void 0!==this.plotBase&&h.push(this.plotBase);var v=W(h=L(h,{},(function(e){return!1})),d,f,this.maxBuilds,{},{pruneArtRange:!0,pruneNodeRange:!0});h=v.nodes,f=v.arts;for(var m=F(h,(function(e){return e.path[1]})),b=s(m,3),g=b[0],y=b[1],w=b[2],k=Object.values(f.values).sort((function(e,r){return e.length-r.length})).map((function(e){return e.map((function(e){return{id:e.id,set:e.set,values:Object.entries(e.values).map((function(e){var r=s(e,2),t=r[0],n=r[1];return{key:y[t],value:n,cache:0}})).filter((function(e){var r=e.key,t=e.value;return void 0!==r&&0!==t}))}}))})),x=Array(k.length).fill(""),E={tested:0,failed:0,skipped:p-Q(f)},S=-1/0,O=0,j=Object.entries(f.base);O<j.length;O++){var M=s(j[O],2),A=M[0],B=M[1],P=y[A];void 0!==P&&(w[P]=B)}if(R(k.length-1,{}),r.cache){var N=r.cachedCompute,T=N.maxEst[N.maxEst.length-1];console.log("enumerated",{count:Q(f),depth:u},this.threshold,{gap:T-S},{nodes:h,preArts:f},N)}return this.interimReport(E),this.threshold}function R(e,r){if(e<0){var o=g();S=Math.max(o[a.length],S);var u=Object.entries(i).every((function(e){var t=s(e,2),n=t[0];return!t[1].includes(r[n])}));if(u&&void 0!==i.uniqueKey){var f=Object.values(r).reduce((function(e,r){return e+r%2}),0);u=!i.uniqueKey.includes(f)}if(u&&d.every((function(e,r){return e<=o[r]}))){var p,h=o[d.length],v=l.builds,m=l.plotData;if(h>=l.threshold&&(p={value:h,artifactIds:n(x)},v.push(p)),m){var b=o[d.length+1];(!m[b]||m[b].value<h)&&(p||(p={value:h,artifactIds:n(x)}),p.plot=b,m[b]=p)}}else E.failed+=1}else k[e].forEach((function(n){var a,o,i,u,c,s;x[e]=n.id;var l,f=t(n.values);try{for(f.s();!(l=f.n()).done;){var p=l.value,h=p.key,d=p.value;p.cache=w[h],w[h]+=d}}catch(k){f.e(k)}finally{f.f()}r[null!==(a=n.set)&&void 0!==a?a:""]=1+(null!==(o=r[null!==(i=n.set)&&void 0!==i?i:""])&&void 0!==o?o:0),R(e-1,r),r[null!==(u=n.set)&&void 0!==u?u:""]-=1,0===r[null!==(c=n.set)&&void 0!==c?c:""]&&delete r[null!==(s=n.set)&&void 0!==s?s:""];var v,m=t(n.values);try{for(m.s();!(v=m.n()).done;){var b=v.value,g=b.key,y=b.cache;w[g]=y}}catch(k){m.e(k)}finally{m.f()}})),0===e&&(E.tested+=k[0].length,E.tested>8192&&c(E))}this.interimReport({tested:0,failed:0,skipped:p})}},{key:"refresh",value:function(e){var r,a,o=this.maxBuilds;Object.keys(null!==(r=this.plotData)&&void 0!==r?r:{}).length>=1e5&&(this.plotData=function(e){for(var r=.01,a=new Set(e.flatMap((function(e){return Object.values(e).map((function(e){return Math.round(e.plot/r)}))})));a.size>1500;)r*=2,a=new Set(n(a).map((function(e){return Math.round(e/2)})));var o,i={},u=t(e);try{for(u.s();!(o=u.n()).done;)for(var c=o.value,s=0,l=Object.values(c);s<l.length;s++){var f=l[s],p=Math.round(f.plot/r)*r;(!i[p]||i[p].value<f.value)&&(i[p]=f)}}catch(h){u.e(h)}finally{u.f()}return i}([this.plotData])),this.builds=this.builds.sort((function(e,r){return r.value-e.value})).slice(0,o),this.buildValues=this.builds.map((function(e){return e.value})),this.threshold=Math.max(this.threshold,null!==(a=this.buildValues[o-1])&&void 0!==a?a:-1/0)}}]),e}();function oe(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.flat()}function ie(){return b.apply(void 0,arguments).map((function(e){return e.reduce((function(e,r){var t;return e.coeff*=r.coeff,(t=e.terms).push.apply(t,n(r.terms)),e}),{coeff:1,terms:[]})}))}function ue(e){return[{coeff:e,terms:[]}]}function ce(e){return[{coeff:1,terms:[e]}]}function se(e){var r=n(e);r.forEach((function(e){return e.terms.sort()})),r.sort((function(e,r){var t=e.terms,n=r.terms;if(t.length!==n.length)return t.length-n.length;for(var a=0;a<t.length;a++)if(t[a]!==n[a])return t[a]<n[a]?-1:1;return 0}));for(var t=function(e){var t,n,a=r[e].terms,o=r[e+1].terms;if(a.length!==o.length)return"continue";a.every((function(e,r){return e===o[r]}))&&(r[e].coeff=(null!==(t=r[e].coeff)&&void 0!==t?t:0)+(null!==(n=r[e+1].coeff)&&void 0!==n?n:0),r.splice(e+1,1))},a=r.length-2;a>=0;a--)t(a);return r}function le(e){var r=e.nodes,t=e.terms;return x.apply(void 0,n(t.map((function(e){var t=e.coeff,a=e.terms;return E.apply(void 0,[t].concat(n(a.map((function(e){return r[e]})))))}))))}function fe(e,r){for(var t=r.i,n=r.j,a=e[t][n],o=0;o<e.length;o++)if(o!==t)for(var i=0;i<e[0].length;i++)i!==n&&(e[o][i]-=e[t][i]*e[o][n]/a);for(var u=0;u<e.length;u++)u!==t&&(e[u][n]=-e[u][n]/a);for(var c=0;c<e[0].length;c++)c!==n&&(e[t][c]=e[t][c]/a);e[t][n]=1/a}function pe(e){for(var r=e.length,t=e[0].length,n={i:-1,j:-1,cmp:1/0},a=0;a<t-1;a++)if(!(e[r-1][a]>=0)){for(var o=0;o<r-1;o++)if(e[o][a]>1e-5){var i=e[o][t-1]/e[o][a];i<n.cmp&&(n={i:o,j:a,cmp:i})}if(n.i<0)throw Error("UNBOUNDED FEASIBLE")}if(n.i<0)throw Error("NO PIVOTS (done)");return{i:n.i,j:n.j}}function he(e){for(var r=e.length,t=e[0].length,n={i:-1,j:-1,cmp:1/0},a=0;a<r-1;a++)if(!(e[a][t-1]>=0)){for(var o=0;o<t-1;o++)if(e[a][o]<-1e-5){var i=e[a][t-1]/e[a][o];i<n.cmp&&(n={i:a,j:o,cmp:i})}if(n.i<0)throw Error("INFEASIBLE");return{i:n.i,j:n.j}}throw Error("NO PIVOTS (done)")}function de(e,r,t){var n=s(F([e],(function(e){return e.path[1]})),3),a=n[0],o=n[1],i=n[2];xe(r,o,i);var u=a()[0];return xe(t,o,i),[u,a()[0]]}function ve(e,r,t){var a=function e(r){switch(r.operation){case"add":return x.apply(void 0,n(r.operands.map((function(r){return e(r)}))));case"const":return g(-r.value);case"threshold":var t=s(r.operands,4),a=t[0],o=t[1],i=t[2],u=t[3];if("const"===i.operation&&"const"===u.operation&&i.value<=u.value)return c=a,l=o,f=-i.value,p=-u.value,{operation:"threshold",operands:[j(c),j(l),j(f),j(p)],info:h};throw console.log(r),Error("(res neg slope): threshold. Something went wrong.");default:throw console.log(r),Error("(res neg slope) Havent written logic to handle this")}var c,l,f,p,h}(e.operands[0]),o=s(de(a,r,t),2),i=o[0],u=o[1],c=N.res,l=[c([-i]),c([-u])],f=l[0],p=l[1];return u>0&&i>-1.75?x(1,E(.5,a)):x((u*f-i*p)/(u-i),E((f-p)/(u-i),a))}function me(e,r,t){var o=e.nodes,i=e.terms,u={};Object.entries(o).forEach((function(e){var r=s(e,2),t=r[0],n=r[1];"read"===n.operation&&(u[n.path[1]]=t)}));function c(e){switch(e.operation){case"const":return ue(e.value);case"read":return ce(u[e.path[1]]);case"add":return oe.apply(void 0,n(e.operands.map(c)));case"mul":return ie.apply(void 0,n(e.operands.map(c)));case"threshold":var a=s(e.operands,4),o=a[0],i=a[1],l=a[2],f=a[3];if("read"===o.operation&&"const"===i.operation&&"const"===f.operation&&"const"===l.operation){if(l.value<f.value)throw console.log(e),Error("Not Implemented (threshold must be increasing)");var p=o.path[1];if(r[p]>=i.value)return ue(l.value);if(t[p]<i.value)return ue(f.value);var h=ie(ue((l.value-f.value)/(i.value-r[p])),ce(u[o.path[1]]));return 0===f.value?h:oe(ue(f.value),h)}throw console.log(e),Error("Not Implemented (threshold must branch between constants)");case"res":return c(ve(e,r,t));case"min":case"max":var d=s(e.operands,2),v=d[0],m=d[1];if("const"!==m.operation){var b=[m,v];v=b[0],m=b[1]}if("min"===e.operation)return c(v);if("const"===m.operation){var g=m.value,y=s(de(v,r,t),2),w=y[0],k=y[1];if(w>g)return c(v);if(g>k)return ue(g);var x=(k-g)/(k-w);return oe(ue(g-w),ie(ue(x),c(v)))}throw console.log(e),Error("Not Implemented (max between two non-constants)");case"sum_frac":var E=s(e.operands,2),S=E[0],O=E[1];if("const"!==O.operation)throw Error("Not Implemented (non-constant sum_frac denominator)");var j=s(de(S,r,t),2),M=j[0],A=j[1],B=O.value,P=Math.sqrt((M+B)*(A+B))-B,N=(B+P)*(B+P),T=B/N;return oe(ue(P*P/N),ie(ue(T),c(S)));default:throw console.log(e),Error("Not Implemented")}}var l=Object.fromEntries(Object.entries(o).filter((function(e){var r=s(e,2);r[0];return"read"!==r[1].operation})).map((function(e){var r=s(e,2);return[r[0],c(r[1])]}))),f=i.flatMap((function(e){var r=e.coeff,t=e.terms;return ie.apply(void 0,[ue(r)].concat(n(t.map((function(e){var r;return null!==(r=l[e])&&void 0!==r?r:ce(e)})))))}));f=(f=se(f)).map((function(e){var r=e.coeff,t=e.terms;return{coeff:r,terms:t=t.map((function(e){var r=o[e];if(!r||"read"!==r.operation)throw Error("MUST be a read node.");return r.path[1]}))}}));var p=f.map((function(e){var o=e.coeff,i=e.terms;if(0===i.length)return{w:{},c:o,err:0};if(1===i.length)return{w:a({},i[0],o),c:0,err:0};var u=function(e){if(0===e.length)return{w:[],c:0,err:0};var r=e.length,t=e.map((function(e){return e.upper})),a=t.reduce((function(e,r){return e*r}),1);e=e.map((function(e){return{lower:e.lower/e.upper,upper:1}}));var o,i=b.apply(void 0,n(e.map((function(e){return[e.lower,e.upper]})))).flatMap((function(e){var r=e.reduce((function(e,r){return e*r}),1);return[[].concat(n(e.map((function(e){return-e}))),[1,0,-r]),[].concat(n(e),[-1,-1,r])]})),u=[].concat(n(e.map((function(e){return 0}))),[0,1]);try{o=function(e,r){var t=r.length+1,n=r[0].length,a=Array(t).fill(0).map((function(e){return Array(n).fill(0)}));r.forEach((function(e,r){return e.forEach((function(e,t){return a[r][t]=e}))})),e.forEach((function(e,r){return a[t-1][r]=e}));for(var o=[];a.some((function(e,r){return r<t-1&&e[n-1]<0}));){var i=he(a);o.push(i),fe(a,i)}for(;a[t-1].some((function(e,r){return r<n-1&&e<0}));){var u=pe(a);o.push(u),fe(a,u)}return e.map((function(e,r){return function(e,r,t){var n=1;r.forEach((function(e){var r=e.i,a=e.j;1===n&&a===t?(t=r,n=0):0===n&&r===t&&(t=a,n=1)}));var a=e[0].length;return 0===n?e[t][a-1]:0}(a,o,r)}))}(u,i)}catch(c){throw console.log("ERROR on bounds",e),console.log("Possibly numerical instability issue."),c}return{w:o.slice(0,r).map((function(e,r){return e*a/t[r]})),c:-a*o[r],err:a*o[r+1]}}(i.map((function(e){return{lower:r[e],upper:t[e]}}))),c=u.w,s=u.c,l=u.err;return{w:c.reduce((function(e,r,t){var n;return e[i[t]]=r*o+(null!==(n=e[i[t]])&&void 0!==n?n:0),e}),{}),c:o*s,err:o*l+0}}));return p.reduce((function(e,r){return e.c+=r.c,e.err+=r.err,Object.entries(r.w).forEach((function(r){var t,n=s(r,2),a=n[0],o=n[1];return e.w[a]=o+(null!==(t=e.w[a])&&void 0!==t?t:0)})),e}),{w:{},c:0,err:0})}function be(e,r){return ge([r],[e.base])[0]+r.c+Object.entries(e.values).reduce((function(e,t){var n=s(t,2),a=(n[0],n[1]);return e+ge([r],a.map((function(e){return e.values})))[0]}),0)}function ge(e,r){return e.map((function(e){var t=e.w;return Math.max.apply(Math,n(r.map((function(e){return Object.entries(t).reduce((function(r,t){var n,a=s(t,2),o=a[0];return r+a[1]*(null!==(n=e[o])&&void 0!==n?n:0)}),0)}))))}))}function ye(e){var r={},t={},n=new Set;return e.forEach((function(e){for(var a in e.values){var o,i;r[a]=Math.min(e.values[a],null!==(o=r[a])&&void 0!==o?o:1/0),t[a]=Math.max(e.values[a],null!==(i=t[a])&&void 0!==i?i:-1/0)}e.set&&(t[e.set]=1,r[e.set]=0),n.add(e.set)})),1===n.size&&e[0].set&&(r[e[0].set]=1),{statsMin:r,statsMax:t}}function we(e,r,t){var a=Object.keys(r).filter((function(e){return r[e]===t[e]}));return e.map((function(e){var o=e.nodes,i=e.terms,u=Object.entries(o),c=A(u.map((function(e){var r=s(e,2);r[0];return r[1]})),(function(e){return e}),(function(e){switch(e.operation){case"read":return a.includes(e.path[1])?g(r[e.path[1]]):e;case"threshold":var o=s(e.operands,4),i=o[0],u=o[1],c=o[2],l=o[3];if("const"===i.operation&&"const"===u.operation)return i.value>=u.value?c:l;if("read"!==i.operation||"const"!==u.operation)throw Error("Branch between non-read and non-const!!!");return r[i.path[1]]>=u.value?c:t[i.path[1]]<u.value?l:e;case"add":return function(e){if(1===e.length)return e[0];var r=(e=e.flatMap((function(e){return"add"===e.operation?e.operands:e}))).reduce((function(e,r){return"const"===r.operation?e+r.value:e}),0);return 0===(e=e.filter((function(e){return"const"!==e.operation}))).length?g(r):0===r?x.apply(void 0,n(e)):x.apply(void 0,n(e).concat([g(r)]))}(e.operands);case"mul":return function(e){if(1===e.length)return e[0];var r=(e=e.flatMap((function(e){return"mul"===e.operation?e.operands:e}))).reduce((function(e,r){return"const"===r.operation?e*r.value:e}),1);return 0===(e=e.filter((function(e){return"const"!==e.operation}))).length?g(r):1===r?E.apply(void 0,n(e)):E.apply(void 0,n(e).concat([g(r)]))}(e.operands);case"res":case"sum_frac":return e.operands.every((function(e){return"const"===e.operation}))?g(N[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})))):e;case"min":case"max":return e.operands.every((function(e){return"const"===e.operation}))?g(N[e.operation](e.operands.map((function(e){return"const"===e.operation?e.value:NaN})))):e;default:return e}})),l={};c.forEach((function(e,r){if("const"===e.operation){var t=s(u[r],1)[0];l[t]=e.value}}));var f=i.map((function(e){var r=e.coeff,t=e.terms.filter((function(e){return void 0===l[e]||(r*=l[e],!1)}));return 0===r?{coeff:0,terms:[]}:{coeff:r,terms:t}})),p=Object.fromEntries(c.map((function(e,r){return[u[r][0],e]})));return Object.keys(l).forEach((function(e){return delete p[e]})),{nodes:p,terms:se(f)}}))}function ke(e){var r=e.f,t=e.a,n=e.cachedCompute;if(void 0===r)return i({maxEst:n.lin.map((function(e){return be(t,e)}))},n);var a=n.lower,o=n.upper,u=r.map((function(e){var r=me(e,a,o);return{maxEst:be(t,r),lin:r}}));return{maxEst:u.map((function(e){return e.maxEst})),lin:u.map((function(e){return e.lin})),lower:a,upper:o}}function xe(e,r,t){Object.entries(e).filter((function(e){var t=s(e,1)[0];return void 0!==r[t]})).forEach((function(e){var n=s(e,2),a=n[0],o=n[1];return t[r[a]]=o}))}var Ee,Se,Oe,je=function(){function e(r,t){var n=r.arts,a=r.optimizationTarget,o=r.filters,i=r.artSetExclusion;re(this,e),this.min=void 0,this.arts=void 0,this.nodes=void 0,this.artSet=void 0,this.subproblems=[],this.callback=void 0,this.arts=n,this.min=o.map((function(e){return e.min})),this.nodes=o.map((function(e){return e.value})),this.callback=t,this.min.push(-1/0),this.nodes.push(a),this.artSet=p(Object.entries(i),(function(e){var r=s(e,2),t=r[0],n=r[1];return"rainbow"===t?["uniqueKey",n.map((function(e){return e+1}))]:[t,n.flatMap((function(e){return 2===e?[2,3]:[4,5]}))]}))}return ne(e,[{key:"addSubProblem",value:function(e){var r=Q(X(this.arts,e.filter));if(0!==r){var t=e.cache?e.cachedCompute.maxEst[e.cachedCompute.maxEst.length-1]:0;this.subproblems.push({count:r,heur:t,subproblem:e})}}},{key:"split",value:function(e){var r=this,t=e.threshold,n=e.minCount,a=e.maxIter,o=e.subproblem;t>this.min[this.min.length-1]&&(this.min[this.min.length-1]=t),o&&this.addSubProblem(o);for(var i=this.subproblems.reduce((function(e,r){return e+r.count}),0),u=0;u<a&&this.subproblems.length;){u+=1;var c=this.subproblems.pop(),s=c.count,l=c.subproblem;if(s<=n){var f=this.subproblems.reduce((function(e,r){return e+r.count}),0)+s;return this.callback({command:"interim",tested:0,failed:0,skipped:i-f,buildValues:void 0}),[l]}this.splitBNB(this.min[this.min.length-1],l).forEach((function(e){return r.addSubProblem(e)}))}var p=this.subproblems.reduce((function(e,r){return e+r.count}),0);return this.callback({command:"interim",tested:0,failed:0,skipped:i-p,buildValues:void 0}),[]}},{key:"popOne",value:function(){if(0!==this.subproblems.length){for(var e={i:-1,heur:-1/0},r=1;r<this.subproblems.length;r++){var t=this.subproblems[r],n=t.heur;t.subproblem;n>e.heur&&(e={i:r,heur:n})}if(!(e.i<0))return this.subproblems.splice(e.i,1)[0].subproblem}}},{key:"splitWork",value:function(e){var r=this,t=e.threshold,n=e.numSplits,a=e.subproblem;t>this.min[this.min.length-1]&&(this.min[this.min.length-1]=t),a&&this.addSubProblem(a);var o=this.subproblems.reduce((function(e,r){return e+r.count}),0);for(console.log("splitWork",this.min[this.min.length-1],{todo:this.subproblems.length,buildsleft:this.subproblems.reduce((function(e,r){return e+r.count}),0)});this.subproblems.length>0&&this.subproblems.length<=n;){var i=this.subproblems.shift().subproblem;this.splitBNB(this.min[this.min.length-1],i).forEach((function(e){return r.addSubProblem(e)}))}var u=this.subproblems.reduce((function(e,r){return e+r.count}),0);return this.callback({command:"interim",tested:0,failed:0,skipped:o-u,buildValues:void 0}),console.log("exit splitWork. Filters pre-exit",this.subproblems),this.subproblems.splice(0,n).map((function(e){return e.subproblem}))}},{key:"splitBNB",value:function(e,r){var t=X(this.arts,r.filter);if(!1===r.cache){var a=function(e){var r=i({},e.base),t=i({},e.base);return Object.entries(e.values).forEach((function(e){var n=s(e,2),a=(n[0],ye(n[1])),o=a.statsMin,i=a.statsMax;Object.keys(o).forEach((function(e){var n,a;r[e]=o[e]+(null!==(n=r[e])&&void 0!==n?n:0),t[e]=i[e]+(null!==(a=t[e])&&void 0!==a?a:0)}))})),{statsMin:r,statsMax:t}}(t),o=a.statsMin,u=a.statsMax,c=Me(r,o,u);if(void 0===c)return[];var l=ke({f:[].concat(n(c.constraints.map((function(e){return e.value}))),[c.optimizationTarget]),a:t,cachedCompute:{lower:o,upper:u}});if(c.constraints.some((function(e,r){var t=e.min;return l.maxEst[r]<t})))return[];if(l.maxEst[l.maxEst.length-1]<e)return[];r=i(i({},c),{},{cache:!0,cachedCompute:l})}var h=r.cachedCompute,d=h.maxEst,v=h.lin;if(d[d.length-1]<e)return[];Object.values(t.values).reduce((function(e,r){return e*r.length}),1);var m=function(e,r,t){var a=t.constraints,o=t.cachedCompute.lin,i=(t.artSetExclusion,ge(o,[e.base])),u=ge(o,[e.base]);Object.entries(e.values).forEach((function(e){var r,t=s(e,2),a=(t[0],t[1]),c=(r=o,a.map((function(e){return e.values})).map((function(e){return r.map((function(r){var t=r.w;return Object.entries(t).reduce((function(r,t){var n,a=s(t,2),o=a[0];return r+a[1]*(null!==(n=e[o])&&void 0!==n?n:0)}),0)}))})));i.forEach((function(e,r){u[r]+=Math.max.apply(Math,n(c.map((function(e){return e[r]})))),i[r]+=Math.min.apply(Math,n(c.map((function(e){return e[r]}))))}))}));var c=[].concat(n(a.map((function(e){return e.min}))),[r]),l=c.map((function(e,r){return(e-i[r])/(u[r]-i[r])})).map((function(e){return e<.5?-1:e}));l[l.length-1]=Math.max(l[l.length-1],0);var f=l.reduce((function(e,r,t){return r>l[e]?t:e}),0),p=o[f],h=Object.keys(p.w),d={k:"",heur:-1};if(h.forEach((function(r){var t=Object.entries(e.values).reduce((function(e,t){var a=s(t,2),o=(a[0],a[1].map((function(e){return e.values[r]}))),i=Math.min.apply(Math,n(o)),u=Math.max.apply(Math,n(o));if(i===u)return e;var c=(i+u)/2,l=Math.max.apply(Math,n(o.filter((function(e){return e<=c})))),f=Math.min.apply(Math,n(o.filter((function(e){return e>c}))));return e+Math.min(u-l,f-i)}),0),a=p.w[r]*t;a>d.heur&&(d={k:r,heur:a})})),""===d.k)throw console.log(t,Me(t,t.cachedCompute.lower,t.cachedCompute.upper,!0)),console.log("===================== SHATTER BROKE ====================",o,e),Error("Shatter broke...");return d}(t,e,r),g=m.k,y=Object.fromEntries(Object.entries(t.values).map((function(e){var r=s(e,2),t=r[0],a=r[1].map((function(e){return e.values[g]}));return[t,(Math.min.apply(Math,n(a))+Math.max.apply(Math,n(a)))/2]}))),w=Object.fromEntries(Object.entries(t.values).map((function(e){var r=s(e,2),t=r[0],n=r[1],a=n.filter((function(e){return e.values[g]<y[t]})),o=n.filter((function(e){return!(e.values[g]<y[t])})),u=ge(v,a.map((function(e){return e.values}))),c=ge(v,o.map((function(e){return e.values})));return[t,[i(i({arts:o},ye(o)),{},{ww:c}),i(i({arts:a},ye(a)),{},{ww:u})]]}))),k=ge(v,[t.base]).map((function(e,r){return e+v[r].c})),x=[];return b([0,1],[0,1],[0,1],[0,1],[0,1]).forEach((function(a){var o=s(a,5),u=o[0],c=o[1],l=o[2],h=o[3],d=o[4],v={flower:w.flower[u],plume:w.plume[c],sands:w.sands[l],goblet:w.goblet[h],circlet:w.circlet[d]},m={base:i({},t.base),values:p(Object.entries(v),(function(e){var r=s(e,2);return[r[0],r[1].arts]}))},b=Object.values(m.values).reduce((function(e,r){return e*r.length}),1);if(0!==b){var g=n(k);if(Object.values(v).forEach((function(e){return e.ww.forEach((function(e,r){return g[r]+=e}))})),!r.constraints.some((function(e,r){var t=e.min;return g[r]<t}))&&!(g[g.length-1]<e)){var y=i({},t.base),E=i({},t.base);Object.values(v).forEach((function(e){var r=e.statsMin,t=e.statsMax;Object.entries(r).forEach((function(e){var r,t=s(e,2),n=t[0],a=t[1];return y[n]=a+(null!==(r=y[n])&&void 0!==r?r:0)})),Object.entries(t).forEach((function(e){var r,t=s(e,2),n=t[0],a=t[1];return E[n]=a+(null!==(r=E[n])&&void 0!==r?r:0)}))}));var S=Me(r,y,E);if(void 0!==S){var O=[].concat(n(S.constraints.map((function(e){return e.value}))),[S.optimizationTarget]),j=ke({a:m,f:O,cachedCompute:{lower:y,upper:E}});if(!S.constraints.some((function(e,r){var t=e.min;return j.maxEst[r]<t}))&&!(j.maxEst[j.maxEst.length-1]<e)){var M=f(D,(function(e){return{kind:"id",ids:new Set(m.values[e].map((function(e){return e.id})))}}));x.push({numBuilds:b,heur:j.maxEst[j.maxEst.length-1],subproblem:i(i({},S),{},{filter:M,cache:!0,cachedCompute:j,depth:S.depth+1})})}}}}})),x.sort((function(e,r){return r.numBuilds-e.numBuilds})),x.map((function(e){return e.subproblem}))}}]),e}();function Me(e,r,t){var a=e.optimizationTarget,o=e.constraints,i=e.artSetExclusion,u=e.filter,c=e.depth,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=[].concat(n(o.map((function(e){return e.value}))),[a]),p=o.map((function(e){return e.min}));f=we(f,r,t);var h=F(o.map((function(e){return le(e.value)})),(function(e){return e.path[1]})),d=s(h,3),v=d[0],m=d[1],b=d[2];xe(r,m,b);var g=v(),y=p.map((function(e,r){return e>g[r]})),w=f.pop(),k=f.map((function(e,r){return{value:e,min:p[r]}})).filter((function(e,r){return y[r]}));l&&console.log("reduceSubP",{statsMin:r,subnodes:f,submin:p,result:g,active:y});for(var x={},E=function(){var e=s(O[S],2),n=e[0],a=e[1];if("uniqueKey"===n)return x[n]=a,"continue";var o=a.filter((function(e){return r[n]<=e&&e<=t[n]}));if(o.includes(r[n])&&o.includes(t[n]))return{v:void 0};o.length>0&&(x[n]=o)},S=0,O=Object.entries(i);S<O.length;S++){var j=E();if("continue"!==j&&"object"===typeof j)return j.v}return{cache:!1,optimizationTarget:w,constraints:k,artSetExclusion:x,filter:u,depth:c}}onmessage=function(e){var r,a=e.data,o=a.command;switch(o){case"setup":Ee=a.id;var u=function(e){return postMessage(i({id:Ee},e))};Se=new je(a,u),Oe=new ae(a,u),r={command:"iterate"};break;case"split":r={command:"split",subproblems:Se.split(a),ready:0===Se.subproblems.length};break;case"splitwork":r={command:"split",subproblems:Se.splitWork(a),ready:0===Se.subproblems.length};break;case"iterate":var c=a.threshold,s=a.subproblem;Oe.compute(c,s),r={command:"iterate"};break;case"finalize":Oe.refresh(!0);var l=Oe,f=l.builds,p=l.plotData;r={command:"finalize",builds:f,plotData:p};break;case"count":if("break"===function(){var e,o=a.exclusion,i=Oe.arts,u=$(ee(o,n(new Set(Object.values(i.values).flatMap((function(e){return e.map((function(e){return e.set}))}))))),i),c=a.arts.map((function(e){return 0})),s=t(u);try{var l=function(){var r=e.value;a.arts.forEach((function(e,t){return c[t]+=Q(X(e,r))}))};for(s.s();!(e=s.n()).done;)l()}catch(f){s.e(f)}finally{s.f()}return r={command:"count",counts:c},"break"}())break;case"share":var h=Se.popOne();r={command:"share",subproblem:h,sender:a.sender};break;default:m(o)}postMessage(i({id:Ee},r))}}();
//# sourceMappingURL=BackgroundWorker.fc9448e8.worker.js.map